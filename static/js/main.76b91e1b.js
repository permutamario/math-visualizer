/*! For license information please see main.76b91e1b.js.LICENSE.txt */
(()=>{var e={579:(e,t,n)=>{"use strict";e.exports=n(1153)},589:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HitCanvas=t.SceneCanvas=t.Canvas=void 0;const r=n(7149),i=n(3354),a=n(4602);let o;class s{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const t=(e||{}).pixelRatio||a.Konva.pixelRatio||function(){if(o)return o;const e=r.Util.createCanvasElement(),t=e.getContext("2d");return o=(a.Konva._global.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1),r.Util.releaseCanvas(e),o}();this.pixelRatio=t,this._canvas=r.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch(n){try{return this._canvas.toDataURL()}catch(i){return r.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}t.Canvas=s;t.SceneCanvas=class extends s{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:0,height:0,willReadFrequently:!1};super(e),this.context=new i.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}};t.HitCanvas=class extends s{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:0,height:0};super(e),this.hitCanvas=!0,this.context=new i.HitContext(this),this.setSize(e.width,e.height)}}},1008:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ring=void 0;const r=n(1751),i=n(3304),a=n(9910),o=n(4602),s=2*Math.PI;class l extends i.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,s,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),s,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}t.Ring=l,l.prototype.className="Ring",l.prototype._centroid=!0,l.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,o._registerNode)(l),r.Factory.addGetterSetter(l,"innerRadius",0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(l,"outerRadius",0,(0,a.getNumberValidator)())},1126:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Threshold=void 0;const r=n(1751),i=n(1189),a=n(9910);t.Threshold=function(e){const t=255*this.threshold(),n=e.data,r=n.length;for(let i=0;i<r;i+=1)n[i]=n[i]<t?0:255},r.Factory.addGetterSetter(i.Node,"threshold",.5,(0,a.getNumberValidator)(),r.Factory.afterSetFilter)},1147:e=>{"use strict";var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},r={"\u2013":"\\--","\u2014":"\\---"," ":"~","\t":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},i=function(e,n){return t({},e,n)};e.exports=function(e){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=a.preserveFormatting,s=void 0!==o&&o,l=a.escapeMapFn,c=void 0===l?i:l,u=String(e),h="",d=c(t({},n),s?t({},r):{}),f=Object.keys(d),p=function(){var e=!1;f.forEach((function(t,n){e||u.length>=t.length&&u.slice(0,t.length)===t&&(h+=d[f[n]],u=u.slice(t.length,u.length),e=!0)})),e||(h+=u.slice(0,1),u=u.slice(1,u.length))};u;)p();return h}},1153:(e,t,n)=>{"use strict";var r=n(5043),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},1189:(e,t,n)=>{"use strict";var r=n(1847).default;const i=["x","y"];Object.defineProperty(t,"__esModule",{value:!0}),t.Node=void 0;const a=n(7149),o=n(1751),s=n(589),l=n(4602),c=n(8727),u=n(9910),h="absoluteOpacity",d="allEventListeners",f="absoluteTransform",p="absoluteScale",m="canvas",g="listening",v="mouseenter",y="mouseleave",x="Shape",b=" ",_="stage",w="transform",S="visible",M=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(b);let D=1;class E{constructor(e){this._id=D++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){e!==w&&e!==f||!this._cache.get(e)?e?this._cache.delete(e):this._cache.clear():this._cache.get(e).dirty=!0}_getCache(e,t){let n=this._cache.get(e);return(void 0===n||(e===w||e===f)&&!0===n.dirty)&&(n=t.call(this),this._cache.set(e,n)),n}_calculate(e,t,n){if(!this._attachedDepsListeners.get(e)){const n=t.map((e=>e+"Change.konva")).join(b);this.on(n,(()=>{this._clearCache(e)})),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,n)}_getCanvasCache(){return this._cache.get(m)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===f&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(m)){const{scene:e,filter:t,hit:n}=this._cache.get(m);a.Util.releaseCanvas(e,t,n),this._cache.delete(m)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const t=e||{};let n={};void 0!==t.x&&void 0!==t.y&&void 0!==t.width&&void 0!==t.height||(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(t.width||n.width),i=Math.ceil(t.height||n.height),o=t.pixelRatio,l=void 0===t.x?Math.floor(n.x):t.x,c=void 0===t.y?Math.floor(n.y):t.y,u=t.offset||0,d=t.drawBorder||!1,f=t.hitCanvasPixelRatio||1;if(!r||!i)return void a.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");r+=2*u+(Math.abs(Math.round(n.x)-l)>.5?1:0),i+=2*u+(Math.abs(Math.round(n.y)-c)>.5?1:0),l-=u,c-=u;const g=new s.SceneCanvas({pixelRatio:o,width:r,height:i}),v=new s.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),y=new s.HitCanvas({pixelRatio:f,width:r,height:i}),x=g.getContext(),b=y.getContext();return y.isCache=!0,g.isCache=!0,this._cache.delete(m),this._filterUpToDate=!1,!1===t.imageSmoothingEnabled&&(g.getContext()._context.imageSmoothingEnabled=!1,v.getContext()._context.imageSmoothingEnabled=!1),x.save(),b.save(),x.translate(-l,-c),b.translate(-l,-c),this._isUnderCache=!0,this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(p),this.drawScene(g,this),this.drawHit(y,this),this._isUnderCache=!1,x.restore(),b.restore(),d&&(x.save(),x.beginPath(),x.rect(0,0,r,i),x.closePath(),x.setAttr("strokeStyle","red"),x.setAttr("lineWidth",5),x.stroke(),x.restore()),this._cache.set(m,{scene:g,filter:v,hit:y,x:l,y:c}),this._requestDraw(),this}isCached(){return this._cache.has(m)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){const n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let r=1/0,i=1/0,a=-1/0,o=-1/0;const s=this.getAbsoluteTransform(t);return n.forEach((function(e){const t=s.point(e);void 0===r&&(r=a=t.x,i=o=t.y),r=Math.min(r,t.x),i=Math.min(i,t.y),a=Math.max(a,t.x),o=Math.max(o,t.y)})),{x:r,y:i,width:a-r,height:o-i}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();e.translate(t.x,t.y);const n=this._getCachedSceneCanvas(),r=n.pixelRatio;e.drawImage(n._canvas,0,0,n.width/r,n.height/r),e.restore()}_drawCachedHitCanvas(e){const t=this._getCanvasCache(),n=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e,t,n,r,i=this.filters(),o=this._getCanvasCache(),s=o.scene,l=o.filter,c=l.getContext();if(i){if(!this._filterUpToDate){const o=s.pixelRatio;l.setSize(s.width/s.pixelRatio,s.height/s.pixelRatio);try{for(e=i.length,c.clear(),c.drawImage(s._canvas,0,0,s.getWidth()/o,s.getHeight()/o),t=c.getImageData(0,0,l.getWidth(),l.getHeight()),n=0;n<e;n++)r=i[n],"function"===typeof r?(r.call(this,t),c.putImageData(t,0,0)):a.Util.error("Filter should be type of function, but got "+typeof r+" instead. Please check correct filters")}catch(u){a.Util.error("Unable to apply filter. "+u.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return l}return s}on(e,t){if(this._cache&&this._cache.delete(d),3===arguments.length)return this._delegate.apply(this,arguments);let n,r,i,a,o,s=e.split(b),l=s.length;for(n=0;n<l;n++)r=s[n],i=r.split("."),a=i[0],o=i[1]||"",this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push({name:o,handler:t});return this}off(e,t){let n,r,i,a,o,s,l=(e||"").split(b),c=l.length;if(this._cache&&this._cache.delete(d),!e)for(r in this.eventListeners)this._off(r);for(n=0;n<c;n++)if(i=l[n],a=i.split("."),o=a[0],s=a[1],o)this.eventListeners[o]&&this._off(o,s,t);else for(r in this.eventListeners)this._off(r,s,t);return this}dispatchEvent(e){const t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,(function(e){t.call(this,e.evt)})),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,n){const r=this;this.on(e,(function(e){const i=e.target.findAncestors(t,!0,r);for(let t=0;t<i.length;t++)(e=a.Util.cloneObject(e)).currentTarget=i[t],n.call(i[t],e)}))}remove(){return this.isDragging()&&this.stopDrag(),c.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(f),this._clearSelfAndDescendantCache(h),this._clearSelfAndDescendantCache(p),this._clearSelfAndDescendantCache(_),this._clearSelfAndDescendantCache(S),this._clearSelfAndDescendantCache(g)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const t="get"+a.Util._capitalize(e);return a.Util._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){let e=this.getParent(),t=[];for(;e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges((()=>{let t,n;if(!e)return this;for(t in e)"children"!==t&&(n="set"+a.Util._capitalize(t),a.Util._isFunction(this[n])?this[n](e[t]):this._setAttr(t,e[t]))})),this}isListening(){return this._getCache(g,this._isListening)}_isListening(e){if(!this.listening())return!1;const t=this.getParent();return!t||t===e||this===e||t._isListening(e)}isVisible(){return this._getCache(S,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const t=this.getParent();return!t||t===e||this===e||t._isVisible(e)}shouldDrawHit(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e)return this._isVisible(e)&&this._isListening(e);const n=this.getLayer();let r=!1;c.DD._dragElements.forEach((e=>{"dragging"===e.dragStatus&&("Stage"===e.node.nodeType||e.node.getLayer()===n)&&(r=!0)}));const i=!t&&!l.Konva.hitOnDragEnabled&&(r||l.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!i}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e,t,n,r,i=this.getDepth(),a=this,o=0;const s=this.getStage();return"Stage"!==a.nodeType&&s&&function s(l){for(e=[],t=l.length,n=0;n<t;n++)r=l[n],o++,r.nodeType!==x&&(e=e.concat(r.getChildren().slice())),r._id===a._id&&(n=t);e.length>0&&e[0].getDepth()<=i&&s(e)}(s.getChildren()),o}getDepth(){let e=0,t=this.parent;for(;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(w),this._clearSelfAndDescendantCache(f)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges((()=>{this.x(e.x),this.y(e.y)})),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const t=e.getPointerPosition();if(!t)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(t)}getAbsolutePosition(e){let t=!1,n=this.parent;for(;n;){if(n.isCached()){t=!0;break}n=n.parent}t&&!e&&(e=!0);const r=this.getAbsoluteTransform(e).getMatrix(),i=new a.Transform,o=this.offset();return i.m=r.slice(),i.translate(o.x,o.y),i.getTranslation()}setAbsolutePosition(e){const t=this._clearTransform(),{x:n,y:a}=t,o=r(t,i);this.attrs.x=n,this.attrs.y=a,this._clearCache(w);const s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(e.x,e.y),e={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(o),this.setPosition({x:e.x,y:e.y}),this._clearCache(w),this._clearSelfAndDescendantCache(f),this}_setTransform(e){let t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let t=e.x,n=e.y,r=this.x(),i=this.y();return void 0!==t&&(r+=t),void 0!==n&&(i+=n),this.setPosition({x:r,y:i}),this}_eachAncestorReverse(e,t){let n,r,i=[],a=this.getParent();if(!t||t._id!==this._id){for(i.unshift(this);a&&(!t||a._id!==t._id);)i.unshift(a),a=a.parent;for(n=i.length,r=0;r<n;r++)e(i[r])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return a.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index;return e<this.parent.getChildren().length-1&&(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0)}moveUp(){if(!this.parent)return a.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index;return e<this.parent.getChildren().length-1&&(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0)}moveDown(){if(!this.parent)return a.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0&&(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0)}moveToBottom(){if(!this.parent)return a.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0&&(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)}setZIndex(e){if(!this.parent)return a.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&a.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(h,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e,t,n,r,i,o=this.getAttrs();const s={attrs:{},className:this.getClassName()};for(e in o)t=o[e],i=a.Util.isObject(t)&&!a.Util._isPlainObject(t)&&!a.Util._isArray(t),i||(n="function"===typeof this[e]&&this[e],delete o[e],r=n?n.call(this):null,o[e]=t,r!==t&&(s.attrs[e]=t));return a.Util._prepareToStringify(s)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,n){const r=[];t&&this._isMatch(e)&&r.push(this);let i=this.parent;for(;i;){if(i===n)return r;i._isMatch(e)&&r.push(i),i=i.parent}return r}isAncestorOf(e){return!1}findAncestor(e,t,n){return this.findAncestors(e,t,n)[0]}_isMatch(e){if(!e)return!1;if("function"===typeof e)return e(this);let t,n,r=e.replace(/ /g,"").split(","),i=r.length;for(t=0;t<i;t++)if(n=r[t],a.Util.isValidSelector(n)||(a.Util.warn('Selector "'+n+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),a.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),a.Util.warn("Konva is awesome, right?")),"#"===n.charAt(0)){if(this.id()===n.slice(1))return!0}else if("."===n.charAt(0)){if(this.hasName(n.slice(1)))return!0}else if(this.className===n||this.nodeType===n)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(_,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.target=t.target||this,n?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(f,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let t;if(e)return t=new a.Transform,this._eachAncestorReverse((function(e){const n=e.transformsEnabled();"all"===n?t.multiply(e.getTransform()):"position"===n&&t.translate(e.x()-e.offsetX(),e.y()-e.offsetY())}),e),t;{t=this._cache.get(f)||new a.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();const e=this.transformsEnabled();if("all"===e)t.multiply(this.getTransform());else if("position"===e){const e=this.attrs.x||0,n=this.attrs.y||0,r=this.attrs.offsetX||0,i=this.attrs.offsetY||0;t.translate(e-r,n-i)}return t.dirty=!1,t}}getAbsoluteScale(e){let t=this;for(;t;)t._isUnderCache&&(e=t),t=t.getParent();const n=this.getAbsoluteTransform(e).decompose();return{x:n.scaleX,y:n.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(w,this._getTransform)}_getTransform(){var e,t;const n=this._cache.get(w)||new a.Transform;n.reset();const r=this.x(),i=this.y(),o=l.Konva.getAngle(this.rotation()),s=null!==(e=this.attrs.scaleX)&&void 0!==e?e:1,c=null!==(t=this.attrs.scaleY)&&void 0!==t?t:1,u=this.attrs.skewX||0,h=this.attrs.skewY||0,d=this.attrs.offsetX||0,f=this.attrs.offsetY||0;return 0===r&&0===i||n.translate(r,i),0!==o&&n.rotate(o),0===u&&0===h||n.skew(u,h),1===s&&1===c||n.scale(s,c),0===d&&0===f||n.translate(-1*d,-1*f),n.dirty=!1,n}clone(e){let t,n,r,i,o,s=a.Util.cloneObject(this.attrs);for(t in e)s[t]=e[t];const l=new this.constructor(s);for(t in this.eventListeners)for(n=this.eventListeners[t],r=n.length,i=0;i<r;i++)o=n[i],o.name.indexOf("konva")<0&&(l.eventListeners[t]||(l.eventListeners[t]=[]),l.eventListeners[t].push(o));return l}_toKonvaCanvas(e){e=e||{};const t=this.getClientRect(),n=this.getStage(),r=void 0!==e.x?e.x:Math.floor(t.x),i=void 0!==e.y?e.y:Math.floor(t.y),a=e.pixelRatio||1,o=new s.SceneCanvas({width:e.width||Math.ceil(t.width)||(n?n.width():0),height:e.height||Math.ceil(t.height)||(n?n.height():0),pixelRatio:a}),l=o.getContext(),c=new s.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(r),height:o.height/o.pixelRatio+Math.abs(i),pixelRatio:o.pixelRatio});return!1===e.imageSmoothingEnabled&&(l._context.imageSmoothingEnabled=!1),l.save(),(r||i)&&l.translate(-1*r,-1*i),this.drawScene(o,void 0,c),l.restore(),o}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){const t=(e=e||{}).mimeType||null,n=e.quality||null,r=this._toKonvaCanvas(e).toDataURL(t,n);return e.callback&&e.callback(r),r}toImage(e){return new Promise(((t,n)=>{try{const n=null===e||void 0===e?void 0:e.callback;n&&delete e.callback,a.Util._urlToImage(this.toDataURL(e),(function(e){t(e),null===n||void 0===n||n(e)}))}catch(r){n(r)}}))}toBlob(e){return new Promise(((t,n)=>{try{const n=null===e||void 0===e?void 0:e.callback;n&&delete e.callback,this.toCanvas(e).toBlob((e=>{t(e),null===n||void 0===n||n(e)}),null===e||void 0===e?void 0:e.mimeType,null===e||void 0===e?void 0:e.quality)}catch(r){n(r)}}))}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():l.Konva.dragDistance}_off(e,t,n){let r,i,a,o=this.eventListeners[e];for(r=0;r<o.length;r++)if(i=o[r].name,a=o[r].handler,("konva"!==i||"konva"===t)&&(!t||i===t)&&(!n||n===a)){if(o.splice(r,1),0===o.length){delete this.eventListeners[e];break}r--}}_fireChangeEvent(e,t,n){this._fire(e+"Change",{oldVal:t,newVal:n})}addName(e){if(!this.hasName(e)){const t=this.name(),n=t?t+" "+e:e;this.name(n)}return this}hasName(e){if(!e)return!1;const t=this.name();if(!t)return!1;return-1!==(t||"").split(/\s/g).indexOf(e)}removeName(e){const t=(this.name()||"").split(/\s/g),n=t.indexOf(e);return-1!==n&&(t.splice(n,1),this.name(t.join(" "))),this}setAttr(e,t){const n=this["set"+a.Util._capitalize(e)];return a.Util._isFunction(n)?n.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(l.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();null===e||void 0===e||e.batchDraw()}}_setAttr(e,t){const n=this.attrs[e];(n!==t||a.Util.isObject(t))&&(void 0===t||null===t?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,n,t),this._requestDraw())}_setComponentAttr(e,t,n){let r;void 0!==n&&(r=this.attrs[e],r||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=n,this._fireChangeEvent(e,r,n))}_fireAndBubble(e,t,n){t&&this.nodeType===x&&(t.target=this);if(!((e===v||e===y)&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||"Stage"===this.nodeType&&!n))){this._fire(e,t);const r=(e===v||e===y)&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!r&&(n&&n.parent?this._fireAndBubble.call(this.parent,e,t,n):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){var t,n,r;const i=null!==(t=this._cache.get(d))&&void 0!==t?t:{};let a=null===i||void 0===i?void 0:i[e];if(void 0===a){a=[];let t=Object.getPrototypeOf(this);for(;t;){const i=null!==(r=null===(n=t.eventListeners)||void 0===n?void 0:n[e])&&void 0!==r?r:[];a.push(...i),t=Object.getPrototypeOf(t)}i[e]=a,this._cache.set(d,i)}return a}_fire(e,t){(t=t||{}).currentTarget=this,t.type=e;const n=this._getProtoListeners(e);if(n)for(var r=0;r<n.length;r++)n[r].handler.call(this,t);const i=this.eventListeners[e];if(i)for(r=0;r<i.length;r++)i[r].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const t=e?e.pointerId:void 0,n=this.getStage(),r=this.getAbsolutePosition();if(!n)return;const i=n._getPointerById(t)||n._changedPointerPositions[0]||r;c.DD._dragElements.set(this._id,{node:this,startPointerPos:i,offset:{x:i.x-r.x,y:i.y-r.y},dragStatus:"ready",pointerId:t})}startDrag(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];c.DD._dragElements.has(this._id)||this._createDragElement(e);c.DD._dragElements.get(this._id).dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){const n=this.getStage()._getPointerById(t.pointerId);if(!n)return;let r={x:n.x-t.offset.x,y:n.y-t.offset.y};const i=this.dragBoundFunc();if(void 0!==i){const t=i.call(this,r,e);t?r=t:a.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===r.x&&this._lastPos.y===r.y||(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(e){const t=c.DD._dragElements.get(this._id);t&&(t.dragStatus="stopped"),c.DD._endDragBefore(e),c.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=c.DD._dragElements.get(this._id);return!!e&&"dragging"===e.dragStatus}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",(function(e){if(!(!(void 0!==e.evt.button)||l.Konva.dragButtons.indexOf(e.evt.button)>=0))return;if(this.isDragging())return;let t=!1;c.DD._dragElements.forEach((e=>{this.isAncestorOf(e.node)&&(t=!0)})),t||this._createDragElement(e)}))}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();if(!this.getStage())return;const e=c.DD._dragElements.get(this._id),t=e&&"dragging"===e.dragStatus,n=e&&"ready"===e.dragStatus;t?this.stopDrag():n&&c.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};const t=this.getStage();if(!t)return!1;const n={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return a.Util.haveIntersection(n,this.getClientRect())}static create(e,t){return a.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){let n,r,i,o=E.prototype.getClassName.call(e),s=e.children;t&&(e.attrs.container=t),l.Konva[o]||(a.Util.warn('Can not find a node with class name "'+o+'". Fallback to "Shape".'),o="Shape");if(n=new(0,l.Konva[o])(e.attrs),s)for(r=s.length,i=0;i<r;i++)n.add(E._createNode(s[i]));return n}}t.Node=E,E.prototype.nodeType="Node",E.prototype._attrsAffectingSize=[],E.prototype.eventListeners={},E.prototype.on.call(E.prototype,M,(function(){this._batchingTransformChange?this._needClearTransformCache=!0:(this._clearCache(w),this._clearSelfAndDescendantCache(f))})),E.prototype.on.call(E.prototype,"visibleChange.konva",(function(){this._clearSelfAndDescendantCache(S)})),E.prototype.on.call(E.prototype,"listeningChange.konva",(function(){this._clearSelfAndDescendantCache(g)})),E.prototype.on.call(E.prototype,"opacityChange.konva",(function(){this._clearSelfAndDescendantCache(h)}));const C=o.Factory.addGetterSetter;C(E,"zIndex"),C(E,"absolutePosition"),C(E,"position"),C(E,"x",0,(0,u.getNumberValidator)()),C(E,"y",0,(0,u.getNumberValidator)()),C(E,"globalCompositeOperation","source-over",(0,u.getStringValidator)()),C(E,"opacity",1,(0,u.getNumberValidator)()),C(E,"name","",(0,u.getStringValidator)()),C(E,"id","",(0,u.getStringValidator)()),C(E,"rotation",0,(0,u.getNumberValidator)()),o.Factory.addComponentsGetterSetter(E,"scale",["x","y"]),C(E,"scaleX",1,(0,u.getNumberValidator)()),C(E,"scaleY",1,(0,u.getNumberValidator)()),o.Factory.addComponentsGetterSetter(E,"skew",["x","y"]),C(E,"skewX",0,(0,u.getNumberValidator)()),C(E,"skewY",0,(0,u.getNumberValidator)()),o.Factory.addComponentsGetterSetter(E,"offset",["x","y"]),C(E,"offsetX",0,(0,u.getNumberValidator)()),C(E,"offsetY",0,(0,u.getNumberValidator)()),C(E,"dragDistance",void 0,(0,u.getNumberValidator)()),C(E,"width",0,(0,u.getNumberValidator)()),C(E,"height",0,(0,u.getNumberValidator)()),C(E,"listening",!0,(0,u.getBooleanValidator)()),C(E,"preventDefault",!0,(0,u.getBooleanValidator)()),C(E,"filters",void 0,(function(e){return this._filterUpToDate=!1,e})),C(E,"visible",!0,(0,u.getBooleanValidator)()),C(E,"transformsEnabled","all",(0,u.getStringValidator)()),C(E,"size"),C(E,"dragBoundFunc"),C(E,"draggable",!1,(0,u.getBooleanValidator)()),o.Factory.backCompat(E,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"})},1222:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextPath=void 0;const r=n(7149),i=n(1751),a=n(3304),o=n(7289),s=n(3169),l=n(9910),c=n(4602),u="normal";function h(e){e.fillText(this.partialText,0,0)}function d(e){e.strokeText(this.partialText,0,0)}class f extends a.Shape{constructor(e){super(e),this.dummyCanvas=r.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",(function(){this._readDataAttribute(),this._setTextData()})),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return o.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;return e-1>this.pathLength?null:o.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=o.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const t=this.textDecoration(),n=this.fill(),r=this.fontSize(),i=this.glyphInfo;"underline"===t&&e.beginPath();for(let a=0;a<i.length;a++){e.save();const n=i[a].p0;e.translate(n.x,n.y),e.rotate(i[a].rotation),this.partialText=i[a].text,e.fillStrokeShape(this),"underline"===t&&(0===a&&e.moveTo(0,r/2+1),e.lineTo(r,r/2+1)),e.restore()}"underline"===t&&(e.strokeStyle=n,e.lineWidth=r/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const t=this.glyphInfo;if(t.length>=1){const n=t[0].p0;e.moveTo(n.x,n.y)}for(let n=0;n<t.length;n++){const r=t[n].p1;e.lineTo(r.x,r.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return r.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return s.Text.prototype.setText.call(this,e)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(e){const t=this.dummyCanvas.getContext("2d");t.save(),t.font=this._getContextFont();const n=t.measureText(e);return t.restore(),{width:n.width,height:parseInt("".concat(this.fontSize()),10)}}_setTextData(){const{width:e,height:t}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=t,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),r=this.align(),i=this.kerningFunc(),a=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let l=0;"center"===r&&(l=Math.max(0,this.pathLength/2-a/2)),"right"===r&&(l=Math.max(0,this.pathLength-a));const c=(0,s.stringToArray)(this.text());let u=l;for(let s=0;s<c.length;s++){const e=this._getPointAtLength(u);if(!e)return;let t=this._getTextSize(c[s]).width+n;if(" "===c[s]&&"justify"===r){const e=this.text().split(" ").length-1;t+=(this.pathLength-a)/e}const l=this._getPointAtLength(u+t);if(!l)return;const d=o.Path.getLineLength(e.x,e.y,l.x,l.y);let f=0;if(i)try{f=i(c[s-1],c[s])*this.fontSize()}catch(h){f=0}e.x+=f,l.x+=f,this.textWidth+=f;const p=o.Path.getPointOnLine(f+d/2,e.x,e.y,l.x,l.y),m=Math.atan2(l.y-e.y,l.x-e.x);this.glyphInfo.push({transposeX:p.x,transposeY:p.y,text:c[s],rotation:m,p0:e,p1:l}),u+=t}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach((function(t){e.push(t.p0.x),e.push(t.p0.y),e.push(t.p1.x),e.push(t.p1.y)}));let t,n,r=e[0]||0,i=e[0]||0,a=e[1]||0,o=e[1]||0;for(let l=0;l<e.length/2;l++)t=e[2*l],n=e[2*l+1],r=Math.min(r,t),i=Math.max(i,t),a=Math.min(a,n),o=Math.max(o,n);const s=this.fontSize();return{x:r-s/2,y:a-s/2,width:i-r+s,height:o-a+s}}destroy(){return r.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}t.TextPath=f,f.prototype._fillFunc=h,f.prototype._strokeFunc=d,f.prototype._fillFuncHit=h,f.prototype._strokeFuncHit=d,f.prototype.className="TextPath",f.prototype._attrsAffectingSize=["text","fontSize","data"],(0,c._registerNode)(f),i.Factory.addGetterSetter(f,"data"),i.Factory.addGetterSetter(f,"fontFamily","Arial"),i.Factory.addGetterSetter(f,"fontSize",12,(0,l.getNumberValidator)()),i.Factory.addGetterSetter(f,"fontStyle",u),i.Factory.addGetterSetter(f,"align","left"),i.Factory.addGetterSetter(f,"letterSpacing",0,(0,l.getNumberValidator)()),i.Factory.addGetterSetter(f,"textBaseline","middle"),i.Factory.addGetterSetter(f,"fontVariant",u),i.Factory.addGetterSetter(f,"text",""),i.Factory.addGetterSetter(f,"textDecoration",""),i.Factory.addGetterSetter(f,"kerningFunc",void 0)},1234:()=>{},1269:(e,t,n)=>{var r={"./mirror-curve/index.js":[1601,601],"./polytope-viewer/index.js":[3307,307]};function i(e){if(!n.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],i=t[0];return n.e(t[1]).then((()=>n(i)))}i.keys=()=>Object.keys(r),i.id=1269,e.exports=i},1300:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Rect=void 0;const r=n(1751),i=n(3304),a=n(4602),o=n(7149),s=n(9910);class l extends i.Shape{_sceneFunc(e){const t=this.cornerRadius(),n=this.width(),r=this.height();e.beginPath(),t?o.Util.drawRoundedRectPath(e,n,r,t):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}}t.Rect=l,l.prototype.className="Rect",(0,a._registerNode)(l),r.Factory.addGetterSetter(l,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4))},1416:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Layer=void 0;const r=n(7149),i=n(4598),a=n(1189),o=n(1751),s=n(589),l=n(9910),c=n(3304),u=n(4602),h=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],d=h.length;class f extends i.Container{constructor(e){super(e),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){a.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!a.Node.prototype.moveUp.call(this))return!1;const e=this.getStage();return!(!e||!e.content)&&(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(a.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(a.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return a.Node.prototype.remove.call(this),e&&e.parentNode&&r.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize(e){let{width:t,height:n}=e;return this.canvas.setSize(t,n),this.hitCanvas.setSize(t,n),this._setSmoothEnabled(),this}_validateAdd(e){const t=e.getType();"Group"!==t&&"Shape"!==t&&r.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return(e=e||{}).width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=void 0!==e.x?e.x:this.x(),e.y=void 0!==e.y?e.y:this.y(),a.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){const e=this.visible();this.canvas._canvas.style.display=e?"block":"none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){r.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){r.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,r.Util.requestAnimFrame((()=>{this.draw(),this._waitingForDraw=!1}))),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let t=1,n=!1;for(;;){for(let r=0;r<d;r++){const i=h[r],a=this._getIntersection({x:e.x+i.x*t,y:e.y+i.y*t}),o=a.shape;if(o)return o;if(n=!!a.antialiased,!a.antialiased)break}if(!n)return null;t+=1}}_getIntersection(e){const t=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,i=n[3];if(255===i){const e=r.Util._rgbToHex(n[0],n[1],n[2]),t=c.shapes["#"+e];return t?{shape:t}:{antialiased:!0}}return i>0?{antialiased:!0}:{}}drawScene(e,t){const n=this.getLayer(),r=e||n&&n.getCanvas();return this._fire("beforeDraw",{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),i.Container.prototype.drawScene.call(this,r,t),this._fire("draw",{node:this}),this}drawHit(e,t){const n=this.getLayer(),r=e||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),i.Container.prototype.drawHit.call(this,r,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){r.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return r.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return r.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}t.Layer=f,f.prototype.nodeType="Layer",(0,u._registerNode)(f),o.Factory.addGetterSetter(f,"imageSmoothingEnabled",!0),o.Factory.addGetterSetter(f,"clearBeforeDraw",!0),o.Factory.addGetterSetter(f,"hitGraphEnabled",!0,(0,l.getBooleanValidator)())},1485:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pixelate=void 0;const r=n(1751),i=n(7149),a=n(1189),o=n(9910);t.Pixelate=function(e){let t,n,r,a,o,s,l,c,u,h,d,f,p,m,g=Math.ceil(this.pixelSize()),v=e.width,y=e.height,x=Math.ceil(v/g),b=Math.ceil(y/g),_=e.data;if(g<=0)i.Util.error("pixelSize value can not be <= 0");else for(f=0;f<x;f+=1)for(p=0;p<b;p+=1){for(a=0,o=0,s=0,l=0,c=f*g,u=c+g,h=p*g,d=h+g,m=0,t=c;t<u;t+=1)if(!(t>=v))for(n=h;n<d;n+=1)n>=y||(r=4*(v*n+t),a+=_[r+0],o+=_[r+1],s+=_[r+2],l+=_[r+3],m+=1);for(a/=m,o/=m,s/=m,l/=m,t=c;t<u;t+=1)if(!(t>=v))for(n=h;n<d;n+=1)n>=y||(r=4*(v*n+t),_[r+0]=a,_[r+1]=o,_[r+2]=s,_[r+3]=l)}},r.Factory.addGetterSetter(a.Node,"pixelSize",8,(0,o.getNumberValidator)(),r.Factory.afterSetFilter)},1518:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RGB=void 0;const r=n(1751),i=n(1189),a=n(9910);t.RGB=function(e){const t=e.data,n=t.length,r=this.red(),i=this.green(),a=this.blue();for(let o=0;o<n;o+=4){const e=(.34*t[o]+.5*t[o+1]+.16*t[o+2])/255;t[o]=e*r,t[o+1]=e*i,t[o+2]=e*a,t[o+3]=t[o+3]}},r.Factory.addGetterSetter(i.Node,"red",0,(function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)})),r.Factory.addGetterSetter(i.Node,"green",0,(function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)})),r.Factory.addGetterSetter(i.Node,"blue",0,a.RGBComponent,r.Factory.afterSetFilter)},1618:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Circle=void 0;const r=n(1751),i=n(3304),a=n(9910),o=n(4602);class s extends i.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,2*Math.PI,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}t.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,o._registerNode)(s),r.Factory.addGetterSetter(s,"radius",0,(0,a.getNumberValidator)())},1751:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const r=n(7149),i=n(9910),a="get",o="set";t.Factory={addGetterSetter(e,n,r,i,a){t.Factory.addGetter(e,n,r),t.Factory.addSetter(e,n,i,a),t.Factory.addOverloadedGetterSetter(e,n)},addGetter(e,t,n){var i=a+r.Util._capitalize(t);e.prototype[i]=e.prototype[i]||function(){const e=this.attrs[t];return void 0===e?n:e}},addSetter(e,n,i,a){var s=o+r.Util._capitalize(n);e.prototype[s]||t.Factory.overWriteSetter(e,n,i,a)},overWriteSetter(e,t,n,i){var a=o+r.Util._capitalize(t);e.prototype[a]=function(e){return n&&void 0!==e&&null!==e&&(e=n.call(this,e,t)),this._setAttr(t,e),i&&i.call(this),this}},addComponentsGetterSetter(e,n,s,l,c){const u=s.length,h=r.Util._capitalize,d=a+h(n),f=o+h(n);e.prototype[d]=function(){const e={};for(let t=0;t<u;t++){const r=s[t];e[r]=this.getAttr(n+h(r))}return e};const p=(0,i.getComponentValidator)(s);e.prototype[f]=function(e){const t=this.attrs[n];l&&(e=l.call(this,e,n)),p&&p.call(this,e,n);for(const r in e)e.hasOwnProperty(r)&&this._setAttr(n+h(r),e[r]);return e||s.forEach((e=>{this._setAttr(n+h(e),void 0)})),this._fireChangeEvent(n,t,e),c&&c.call(this),this},t.Factory.addOverloadedGetterSetter(e,n)},addOverloadedGetterSetter(e,t){var n=r.Util._capitalize(t),i=o+n,s=a+n;e.prototype[t]=function(){return arguments.length?(this[i](arguments[0]),this):this[s]()}},addDeprecatedGetterSetter(e,n,i,o){r.Util.error("Adding deprecated "+n);const s=a+r.Util._capitalize(n),l=n+" property is deprecated and will be removed soon. Look at Konva change log for more information.";e.prototype[s]=function(){r.Util.error(l);const e=this.attrs[n];return void 0===e?i:e},t.Factory.addSetter(e,n,o,(function(){r.Util.error(l)})),t.Factory.addOverloadedGetterSetter(e,n)},backCompat(e,t){r.Util.each(t,(function(t,n){const i=e.prototype[n],s=a+r.Util._capitalize(t),l=o+r.Util._capitalize(t);function c(){i.apply(this,arguments),r.Util.error('"'+t+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}e.prototype[t]=c,e.prototype[s]=c,e.prototype[l]=c}))},afterSetFilter(){this._filterUpToDate=!1}}},1801:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Arrow=void 0;const r=n(1751),i=n(5804),a=n(9910),o=n(4602),s=n(7289);class l extends i.Line{_sceneFunc(e){super._sceneFunc(e);const t=2*Math.PI,n=this.points();let r=n;const i=0!==this.tension()&&n.length>4;i&&(r=this.getTensionPoints());const a=this.pointerLength(),o=n.length;let l,c;if(i){const e=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],n[o-2],n[o-1]],t=s.Path.calcLength(r[r.length-4],r[r.length-3],"C",e),i=s.Path.getPointOnQuadraticBezier(Math.min(1,1-a/t),e[0],e[1],e[2],e[3],e[4],e[5]);l=n[o-2]-i.x,c=n[o-1]-i.y}else l=n[o-2]-n[o-4],c=n[o-1]-n[o-3];const u=(Math.atan2(c,l)+t)%t,h=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(n[o-2],n[o-1]),e.rotate(u),e.moveTo(0,0),e.lineTo(-a,h/2),e.lineTo(-a,-h/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(n[0],n[1]),i?(l=(r[0]+r[2])/2-n[0],c=(r[1]+r[3])/2-n[1]):(l=n[2]-n[0],c=n[3]-n[1]),e.rotate((Math.atan2(-c,-l)+t)%t),e.moveTo(0,0),e.lineTo(-a,h/2),e.lineTo(-a,-h/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x,y:e.y-t,width:e.width,height:e.height+2*t}}}t.Arrow=l,l.prototype.className="Arrow",(0,o._registerNode)(l),r.Factory.addGetterSetter(l,"pointerLength",10,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(l,"pointerWidth",10,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(l,"pointerAtBeginning",!1),r.Factory.addGetterSetter(l,"pointerAtEnding",!0)},1847:(e,t,n)=>{var r=n(4893);e.exports=function(e,t){if(null==e)return{};var n,i,a=r(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a},e.exports.__esModule=!0,e.exports.default=e.exports},2078:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Grayscale=void 0;t.Grayscale=function(e){const t=e.data,n=t.length;for(let r=0;r<n;r+=4){const e=.34*t[r]+.5*t[r+1]+.16*t[r+2];t[r]=e,t[r+1]=e,t[r+2]=e}}},2157:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5191);e.exports=r.Konva},2430:function(e,t,n){var r;!function(i,a,o){var s,l=256,c=o.pow(l,6),u=o.pow(2,52),h=2*u,d=255;function f(e,t,n){var r=[],d=v(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(a)]:null==e?function(){try{var e;return s&&(e=s.randomBytes)?e=e(l):(e=new Uint8Array(l),(i.crypto||i.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=i.navigator,n=t&&t.plugins;return[+new Date,i,n,i.screen,y(a)]}}():e,3),r),f=new p(r),x=function(){for(var e=f.g(6),t=c,n=0;e<u;)e=(e+n)*l,t*=l,n=f.g(1);for(;e>=h;)e/=2,t/=2,n>>>=1;return(e+n)/t};return x.int32=function(){return 0|f.g(4)},x.quick=function(){return f.g(4)/4294967296},x.double=x,v(y(f.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,f),e.state=function(){return m(f,{})}),n?(o.random=e,t):e})(x,d,"global"in t?t.global:this==o,t.state)}function p(e){var t,n=e.length,r=this,i=0,a=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);i<l;)o[i]=i++;for(i=0;i<l;i++)o[i]=o[a=d&a+e[i%n]+(t=o[i])],o[a]=t;(r.g=function(e){for(var t,n=0,i=r.i,a=r.j,o=r.S;e--;)t=o[i=d&i+1],n=n*l+o[d&(o[i]=o[a=d&a+t])+(o[a]=t)];return r.i=i,r.j=a,n})(l)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var n,r=[],i=typeof e;if(t&&"object"==i)for(n in e)try{r.push(g(e[n],t-1))}catch(a){}return r.length?r:"string"==i?e:e+"\0"}function v(e,t){for(var n,r=e+"",i=0;i<r.length;)t[d&i]=d&(n^=19*t[d&i])+r.charCodeAt(i++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(v(o.random(),a),e.exports){e.exports=f;try{s=n(1234)}catch(x){}}else void 0===(r=function(){return f}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},2544:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HSV=void 0;const r=n(1751),i=n(1189),a=n(9910);t.HSV=function(e){const t=e.data,n=t.length,r=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,o=r*i*Math.cos(a*Math.PI/180),s=r*i*Math.sin(a*Math.PI/180),l=.299*r+.701*o+.167*s,c=.587*r-.587*o+.33*s,u=.114*r-.114*o-.497*s,h=.299*r-.299*o-.328*s,d=.587*r+.413*o+.035*s,f=.114*r-.114*o+.293*s,p=.299*r-.3*o+1.25*s,m=.587*r-.586*o-1.05*s,g=.114*r+.886*o-.2*s;let v,y,x,b;for(let _=0;_<n;_+=4)v=t[_+0],y=t[_+1],x=t[_+2],b=t[_+3],t[_+0]=l*v+c*y+u*x,t[_+1]=h*v+d*y+f*x,t[_+2]=p*v+m*y+g*x,t[_+3]=b},r.Factory.addGetterSetter(i.Node,"hue",0,(0,a.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(i.Node,"saturation",0,(0,a.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(i.Node,"value",0,(0,a.getNumberValidator)(),r.Factory.afterSetFilter)},2672:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Blur=void 0;const r=n(1751),i=n(1189),a=n(9910);function o(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],l=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];t.Blur=function(e){const t=Math.round(this.blurRadius());t>0&&function(e,t){const n=e.data,r=e.width,i=e.height;let a,c,u,h,d,f,p,m,g,v,y,x,b,_,w,S,M,D,E,C,A,T,N,R;const P=t+t+1,F=r-1,O=i-1,I=t+1,B=I*(I+1)/2,k=new o,L=s[t],U=l[t];let z=null,H=k,V=null,G=null;for(u=1;u<P;u++)H=H.next=new o,u===I&&(z=H);for(H.next=k,p=f=0,c=0;c<i;c++){for(S=M=D=E=m=g=v=y=0,x=I*(C=n[f]),b=I*(A=n[f+1]),_=I*(T=n[f+2]),w=I*(N=n[f+3]),m+=B*C,g+=B*A,v+=B*T,y+=B*N,H=k,u=0;u<I;u++)H.r=C,H.g=A,H.b=T,H.a=N,H=H.next;for(u=1;u<I;u++)h=f+((F<u?F:u)<<2),m+=(H.r=C=n[h])*(R=I-u),g+=(H.g=A=n[h+1])*R,v+=(H.b=T=n[h+2])*R,y+=(H.a=N=n[h+3])*R,S+=C,M+=A,D+=T,E+=N,H=H.next;for(V=k,G=z,a=0;a<r;a++)n[f+3]=N=y*L>>U,0!==N?(N=255/N,n[f]=(m*L>>U)*N,n[f+1]=(g*L>>U)*N,n[f+2]=(v*L>>U)*N):n[f]=n[f+1]=n[f+2]=0,m-=x,g-=b,v-=_,y-=w,x-=V.r,b-=V.g,_-=V.b,w-=V.a,h=p+((h=a+t+1)<F?h:F)<<2,S+=V.r=n[h],M+=V.g=n[h+1],D+=V.b=n[h+2],E+=V.a=n[h+3],m+=S,g+=M,v+=D,y+=E,V=V.next,x+=C=G.r,b+=A=G.g,_+=T=G.b,w+=N=G.a,S-=C,M-=A,D-=T,E-=N,G=G.next,f+=4;p+=r}for(a=0;a<r;a++){for(M=D=E=S=g=v=y=m=0,f=a<<2,x=I*(C=n[f]),b=I*(A=n[f+1]),_=I*(T=n[f+2]),w=I*(N=n[f+3]),m+=B*C,g+=B*A,v+=B*T,y+=B*N,H=k,u=0;u<I;u++)H.r=C,H.g=A,H.b=T,H.a=N,H=H.next;for(d=r,u=1;u<=t;u++)f=d+a<<2,m+=(H.r=C=n[f])*(R=I-u),g+=(H.g=A=n[f+1])*R,v+=(H.b=T=n[f+2])*R,y+=(H.a=N=n[f+3])*R,S+=C,M+=A,D+=T,E+=N,H=H.next,u<O&&(d+=r);for(f=a,V=k,G=z,c=0;c<i;c++)h=f<<2,n[h+3]=N=y*L>>U,N>0?(N=255/N,n[h]=(m*L>>U)*N,n[h+1]=(g*L>>U)*N,n[h+2]=(v*L>>U)*N):n[h]=n[h+1]=n[h+2]=0,m-=x,g-=b,v-=_,y-=w,x-=V.r,b-=V.g,_-=V.b,w-=V.a,h=a+((h=c+I)<O?h:O)*r<<2,m+=S+=V.r=n[h],g+=M+=V.g=n[h+1],v+=D+=V.b=n[h+2],y+=E+=V.a=n[h+3],V=V.next,x+=C=G.r,b+=A=G.g,_+=T=G.b,w+=N=G.a,S-=C,M-=A,D-=T,E-=N,G=G.next,f+=r}}(e,t)},r.Factory.addGetterSetter(i.Node,"blurRadius",0,(0,a.getNumberValidator)(),r.Factory.afterSetFilter)},2715:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Enhance=void 0;const r=n(1751),i=n(1189),a=n(9910);function o(e,t,n,r,i){const a=n-t,o=i-r;if(0===a)return r+o/2;if(0===o)return r;let s=(e-t)/a;return s=o*s+r,s}t.Enhance=function(e){const t=e.data,n=t.length;let r,i,a,s=t[0],l=s,c=t[1],u=c,h=t[2],d=h;const f=this.enhance();if(0===f)return;for(let o=0;o<n;o+=4)r=t[o+0],r<s?s=r:r>l&&(l=r),i=t[o+1],i<c?c=i:i>u&&(u=i),a=t[o+2],a<h?h=a:a>d&&(d=a);let p,m,g,v,y,x,b,_,w;l===s&&(l=255,s=0),u===c&&(u=255,c=0),d===h&&(d=255,h=0),f>0?(m=l+f*(255-l),g=s-f*(s-0),y=u+f*(255-u),x=c-f*(c-0),_=d+f*(255-d),w=h-f*(h-0)):(p=.5*(l+s),m=l+f*(l-p),g=s+f*(s-p),v=.5*(u+c),y=u+f*(u-v),x=c+f*(c-v),b=.5*(d+h),_=d+f*(d-b),w=h+f*(h-b));for(let S=0;S<n;S+=4)t[S+0]=o(t[S+0],s,l,g,m),t[S+1]=o(t[S+1],c,u,x,y),t[S+2]=o(t[S+2],h,d,w,_)},r.Factory.addGetterSetter(i.Node,"enhance",0,(0,a.getNumberValidator)(),r.Factory.afterSetFilter)},2730:(e,t,n)=>{"use strict";var r=n(5043),i=n(8853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function x(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),C=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var F=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var B,k=Object.assign;function L(e){if(void 0===B)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);B=t&&t[1]||""}return"\n"+B+e}var U=!1;function z(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=s);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L(e):""}function H(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case w:return"Portal";case D:return"Profiler";case M:return"StrictMode";case T:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case R:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function j(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=j(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=j(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return k({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function J(e,t){Q(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return k({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function ae(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=k({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function xe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Se=null,Me=null;function De(e){if(e=xi(e)){if("function"!==typeof we)throw Error(a(280));var t=e.stateNode;t&&(t=_i(t),we(e.stateNode,e.type,t))}}function Ee(e){Se?Me?Me.push(e):Me=[e]:Se=e}function Ce(){if(Se){var e=Se,t=Me;if(Me=Se=null,De(e),t)for(e=0;e<t.length;e++)De(t[e])}}function Ae(e,t){return e(t)}function Te(){}var Ne=!1;function Re(e,t,n){if(Ne)return e(t,n);Ne=!0;try{return Ae(e,t,n)}finally{Ne=!1,(null!==Se||null!==Me)&&(Te(),Ce())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=_i(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Fe=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Fe=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){Fe=!1}function Ie(e,t,n,r,i,a,o,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Be=!1,ke=null,Le=!1,Ue=null,ze={onError:function(e){Be=!0,ke=e}};function He(e,t,n,r,i,a,o,s,l){Be=!1,ke=null,Ie.apply(ze,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Ve(e)!==e)throw Error(a(188))}function je(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return qe(i),e;if(o===r)return qe(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Xe=i.unstable_scheduleCallback,Ye=i.unstable_cancelCallback,Ze=i.unstable_shouldYield,Ke=i.unstable_requestPaint,Qe=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,$e=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~i;0!==s?r=ht(s):0!==(a&=o)&&(r=ht(a))}else 0!==(o=n&~i)?r=ht(o):0!==a&&(r=ht(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var xt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,wt,St,Mt,Dt,Et=!1,Ct=[],At=null,Tt=null,Nt=null,Rt=new Map,Pt=new Map,Ft=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function It(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":Rt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Bt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=xi(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function kt(e){var t=yi(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ge(n)))return e.blockedOn=t,void Dt(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xi(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Ut(e,t,n){Lt(e)&&n.delete(t)}function zt(){Et=!1,null!==At&&Lt(At)&&(At=null),null!==Tt&&Lt(Tt)&&(Tt=null),null!==Nt&&Lt(Nt)&&(Nt=null),Rt.forEach(Ut),Pt.forEach(Ut)}function Ht(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zt)))}function Vt(e){function t(t){return Ht(t,e)}if(0<Ct.length){Ht(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==At&&Ht(At,e),null!==Tt&&Ht(Tt,e),null!==Nt&&Ht(Nt,e),Rt.forEach(t),Pt.forEach(t),n=0;n<Ft.length;n++)(r=Ft[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ft.length&&null===(n=Ft[0]).blockedOn;)kt(n),null===n.blockedOn&&Ft.shift()}var Gt=b.ReactCurrentBatchConfig,qt=!0;function jt(e,t,n,r){var i=xt,a=Gt.transition;Gt.transition=null;try{xt=1,Xt(e,t,n,r)}finally{xt=i,Gt.transition=a}}function Wt(e,t,n,r){var i=xt,a=Gt.transition;Gt.transition=null;try{xt=4,Xt(e,t,n,r)}finally{xt=i,Gt.transition=a}}function Xt(e,t,n,r){if(qt){var i=Zt(e,t,n,r);if(null===i)qr(e,t,r,Yt,n),It(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return At=Bt(At,e,t,n,r,i),!0;case"dragenter":return Tt=Bt(Tt,e,t,n,r,i),!0;case"mouseover":return Nt=Bt(Nt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Rt.set(a,Bt(Rt.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Pt.set(a,Bt(Pt.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(It(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var a=xi(i);if(null!==a&&_t(a),null===(a=Zt(e,t,n,r))&&qr(e,t,r,Yt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Yt=null;function Zt(e,t,n,r){if(Yt=null,null!==(e=yi(e=_e(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case $e:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Jt=null,$t=null;function en(){if($t)return $t;var e,t,n=Jt,r=n.length,i="value"in Qt?Qt.value:Qt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return $t=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return k(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),hn=k({},cn,{view:0,detail:0}),dn=an(hn),fn=k({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Dn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=an(fn),mn=an(k({},fn,{dataTransfer:0})),gn=an(k({},hn,{relatedTarget:0})),vn=an(k({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=k({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xn=an(yn),bn=an(k({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Dn(){return Mn}var En=k({},hn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Dn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=an(En),An=an(k({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=an(k({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Dn})),Nn=an(k({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=k({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=an(Rn),Fn=[9,13,27,32],On=u&&"CompositionEvent"in window,In=null;u&&"documentMode"in document&&(In=document.documentMode);var Bn=u&&"TextEvent"in window&&!In,kn=u&&(!On||In&&8<In&&11>=In),Ln=String.fromCharCode(32),Un=!1;function zn(e,t){switch(e){case"keyup":return-1!==Fn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function jn(e,t,n,r){Ee(r),0<(t=Wr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,Xn=null;function Yn(e){Lr(e,0)}function Zn(e){if(X(bi(e)))return e}function Kn(e,t){if("change"===e)return t}var Qn=!1;if(u){var Jn;if(u){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}Jn=$n}else Jn=!1;Qn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),Xn=Wn=null)}function nr(e){if("value"===e.propertyName&&Zn(Xn)){var t=[];jn(t,Xn,e,_e(e)),Re(Yn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Xn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Zn(Xn)}function ar(e,t){if("click"===e)return Zn(t)}function or(e,t){if("input"===e||"change"===e)return Zn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=ur(n,a);var o=ur(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,xr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xr||null==gr||gr!==Y(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Wr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},Sr={},Mr={};function Dr(e){if(Sr[e])return Sr[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Mr)return Sr[e]=n[t];return e}u&&(Mr=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Er=Dr("animationend"),Cr=Dr("animationiteration"),Ar=Dr("animationstart"),Tr=Dr("transitionend"),Nr=new Map,Rr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Nr.set(e,t),l(t,[e])}for(var Fr=0;Fr<Rr.length;Fr++){var Or=Rr[Fr];Pr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Pr(Er,"onAnimationEnd"),Pr(Cr,"onAnimationIteration"),Pr(Ar,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Tr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ir="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Br=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ir));function kr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,s,l,c){if(He.apply(this,arguments),Be){if(!Be)throw Error(a(198));var u=ke;Be=!1,ke=null,Le||(Le=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function Lr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&i.isPropagationStopped())break e;kr(i,s,c),a=l}else for(o=0;o<r.length;o++){if(l=(s=r[o]).instance,c=s.currentTarget,s=s.listener,l!==a&&i.isPropagationStopped())break e;kr(i,s,c),a=l}}}if(Le)throw e=Ue,Le=!1,Ue=null,e}function Ur(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Gr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Gr(n,e,r,t)}var Hr="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[Hr]){e[Hr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Br.has(t)||zr(t,!1,e),zr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Hr]||(t[Hr]=!0,zr("selectionchange",!1,t))}}function Gr(e,t,n,r){switch(Kt(t)){case 1:var i=jt;break;case 4:i=Wt;break;default:i=Xt}n=i.bind(null,t,n,e),i=void 0,!Fe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=yi(s)))return;if(5===(l=o.tag)||6===l){r=a=o;continue e}s=s.parentNode}}r=r.return}Re((function(){var r=a,i=_e(n),o=[];e:{var s=Nr.get(e);if(void 0!==s){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case Er:case Cr:case Ar:l=vn;break;case Tr:l=Nn;break;case"scroll":l=dn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==s?s+"Capture":null:s;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Pe(p,d))&&u.push(jr(p,m,f)))),h)break;p=p.return}0<u.length&&(s=new l(s,c,null,n,i),o.push({event:s,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!yi(c)&&!c[pi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?yi(c):null)&&(c!==(h=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=An,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?s:bi(l),f=null==c?s:bi(c),(s=new u(m,p+"leave",l,n,i)).target=h,s.relatedTarget=f,m=null,yi(i)===r&&((u=new u(d,p+"enter",c,n,i)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Xr(f))p++;for(f=0,m=d;m;m=Xr(m))f++;for(;0<p-f;)u=Xr(u),p--;for(;0<f-p;)d=Xr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Xr(u),d=Xr(d)}u=null}else u=null;null!==l&&Yr(o,s,l,u,!1),null!==c&&null!==h&&Yr(o,h,c,u,!0)}if("select"===(l=(s=r?bi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Kn;else if(qn(s))if(Qn)g=or;else{g=ir;var v=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ar);switch(g&&(g=g(e,r))?jn(o,g,n,i):(v&&v(e,s,r),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=r?bi(r):window,e){case"focusin":(qn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":xr=!0;break;case"contextmenu":case"mouseup":case"dragend":xr=!1,br(o,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":br(o,n,i)}var y;if(On)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Vn?zn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(kn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==x?"onCompositionEnd"===x&&Vn&&(y=en()):(Jt="value"in(Qt=i)?Qt.value:Qt.textContent,Vn=!0)),0<(v=Wr(r,x)).length&&(x=new bn(x,e,null,n,i),o.push({event:x,listeners:v}),y?x.data=y:null!==(y=Hn(n))&&(x.data=y))),(y=Bn?function(e,t){switch(e){case"compositionend":return Hn(t);case"keypress":return 32!==t.which?null:(Un=!0,Ln);case"textInput":return(e=t.data)===Ln&&Un?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!On&&zn(e,t)?(e=en(),$t=Jt=Qt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return kn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Wr(r,"onBeforeInput")).length&&(i=new bn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=y))}Lr(o,t)}))}function jr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Pe(e,n))&&r.unshift(jr(e,a,i)),null!=(a=Pe(e,t))&&r.push(jr(e,a,i))),e=e.return}return r}function Xr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,i?null!=(l=Pe(n,a))&&o.unshift(jr(n,l,s)):i||null!=(l=Pe(n,a))&&o.push(jr(n,l,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Zr=/\r\n?/g,Kr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace(Zr,"\n").replace(Kr,"")}function Jr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(a(425))}function $r(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Vt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,vi="__reactHandles$"+hi;function yi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[di])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function xi(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function _i(e){return e[fi]||null}var wi=[],Si=-1;function Mi(e){return{current:e}}function Di(e){0>Si||(e.current=wi[Si],wi[Si]=null,Si--)}function Ei(e,t){Si++,wi[Si]=e.current,e.current=t}var Ci={},Ai=Mi(Ci),Ti=Mi(!1),Ni=Ci;function Ri(e,t){var n=e.type.contextTypes;if(!n)return Ci;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Fi(){Di(Ti),Di(Ai)}function Oi(e,t,n){if(Ai.current!==Ci)throw Error(a(168));Ei(Ai,t),Ei(Ti,n)}function Ii(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,G(e)||"Unknown",i));return k({},n,r)}function Bi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,Ni=Ai.current,Ei(Ai,e),Ei(Ti,Ti.current),!0}function ki(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Ii(e,t,Ni),r.__reactInternalMemoizedMergedChildContext=e,Di(Ti),Di(Ai),Ei(Ai,e)):Di(Ti),Ei(Ti,n)}var Li=null,Ui=!1,zi=!1;function Hi(e){null===Li?Li=[e]:Li.push(e)}function Vi(){if(!zi&&null!==Li){zi=!0;var e=0,t=xt;try{var n=Li;for(xt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Li=null,Ui=!1}catch(i){throw null!==Li&&(Li=Li.slice(e+1)),Xe($e,Vi),i}finally{xt=t,zi=!1}}return null}var Gi=[],qi=0,ji=null,Wi=0,Xi=[],Yi=0,Zi=null,Ki=1,Qi="";function Ji(e,t){Gi[qi++]=Wi,Gi[qi++]=ji,ji=e,Wi=t}function $i(e,t,n){Xi[Yi++]=Ki,Xi[Yi++]=Qi,Xi[Yi++]=Zi,Zi=e;var r=Ki;e=Qi;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var a=32-ot(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ki=1<<32-ot(t)+i|n<<i|r,Qi=a+e}else Ki=1<<a|n<<i|r,Qi=e}function ea(e){null!==e.return&&(Ji(e,1),$i(e,1,0))}function ta(e){for(;e===ji;)ji=Gi[--qi],Gi[qi]=null,Wi=Gi[--qi],Gi[qi]=null;for(;e===Zi;)Zi=Xi[--Yi],Xi[Yi]=null,Qi=Xi[--Yi],Xi[Yi]=null,Ki=Xi[--Yi],Xi[Yi]=null}var na=null,ra=null,ia=!1,aa=null;function oa(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function sa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Zi?{id:Ki,overflow:Qi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ia){var t=ra;if(t){var n=t;if(!sa(e,t)){if(la(e))throw Error(a(418));t=ci(n.nextSibling);var r=na;t&&sa(e,t)?oa(r,n):(e.flags=-4097&e.flags|2,ia=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,na=e}}}function ua(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ha(e){if(e!==na)return!1;if(!ia)return ua(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ra)){if(la(e))throw da(),Error(a(418));for(;t;)oa(e,t),t=ci(t.nextSibling)}if(ua(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?ci(e.stateNode.nextSibling):null;return!0}function da(){for(var e=ra;e;)e=ci(e.nextSibling)}function fa(){ra=na=null,ia=!1}function pa(e){null===aa?aa=[e]:aa.push(e)}var ma=b.ReactCurrentBatchConfig;function ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function va(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ya(e){return(0,e._init)(e._payload)}function xa(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Fc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=kc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===S?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===P&&ya(a)===t.type)?((r=i(t,n.props)).ref=ga(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=ga(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Lc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,a){return null===t||7!==t.tag?((t=Ic(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=kc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=ga(e,null,t),n.return=e,n;case w:return(t=Lc(t,e.mode,n)).return=e,t;case P:return d(e,(0,t._init)(t._payload),n)}if(te(t)||I(t))return(t=Ic(t,e.mode,n,null)).return=e,t;va(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===i?c(e,t,n,r):null;case w:return n.key===i?u(e,t,n,r):null;case P:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||I(n))return null!==i?null:h(e,t,n,r,null);va(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case w:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||I(r))return h(t,e=e.get(n)||null,r,i,null);va(t,r)}return null}function m(i,a,s,l){for(var c=null,u=null,h=a,m=a=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(i,h,s[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(i,h),a=o(v,a,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===s.length)return n(i,h),ia&&Ji(i,m),c;if(null===h){for(;m<s.length;m++)null!==(h=d(i,s[m],l))&&(a=o(h,a,m),null===u?c=h:u.sibling=h,u=h);return ia&&Ji(i,m),c}for(h=r(i,h);m<s.length;m++)null!==(g=p(h,i,m,s[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),a=o(g,a,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(i,e)})),ia&&Ji(i,m),c}function g(i,s,l,c){var u=I(l);if("function"!==typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var h=u=null,m=s,g=s=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var x=f(i,m,y.value,c);if(null===x){null===m&&(m=v);break}e&&m&&null===x.alternate&&t(i,m),s=o(x,s,g),null===h?u=x:h.sibling=x,h=x,m=v}if(y.done)return n(i,m),ia&&Ji(i,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(i,y.value,c))&&(s=o(y,s,g),null===h?u=y:h.sibling=y,h=y);return ia&&Ji(i,g),u}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=p(m,i,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=o(y,s,g),null===h?u=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(i,e)})),ia&&Ji(i,g),u}return function e(r,a,o,l){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case _:e:{for(var c=o.key,u=a;null!==u;){if(u.key===c){if((c=o.type)===S){if(7===u.tag){n(r,u.sibling),(a=i(u,o.props.children)).return=r,r=a;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&ya(c)===u.type){n(r,u.sibling),(a=i(u,o.props)).ref=ga(r,u,o),a.return=r,r=a;break e}n(r,u);break}t(r,u),u=u.sibling}o.type===S?((a=Ic(o.props.children,r.mode,l,o.key)).return=r,r=a):((l=Oc(o.type,o.key,o.props,null,r.mode,l)).ref=ga(r,a,o),l.return=r,r=l)}return s(r);case w:e:{for(u=o.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Lc(o,r.mode,l)).return=r,r=a}return s(r);case P:return e(r,a,(u=o._init)(o._payload),l)}if(te(o))return m(r,a,o,l);if(I(o))return g(r,a,o,l);va(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=kc(o,r.mode,l)).return=r,r=a),s(r)):n(r,a)}}var ba=xa(!0),_a=xa(!1),wa=Mi(null),Sa=null,Ma=null,Da=null;function Ea(){Da=Ma=Sa=null}function Ca(e){var t=wa.current;Di(wa),e._currentValue=t}function Aa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ta(e,t){Sa=e,Da=Ma=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function Na(e){var t=e._currentValue;if(Da!==e)if(e={context:e,memoizedValue:t,next:null},null===Ma){if(null===Sa)throw Error(a(308));Ma=e,Sa.dependencies={lanes:0,firstContext:e}}else Ma=Ma.next=e;return t}var Ra=null;function Pa(e){null===Ra?Ra=[e]:Ra.push(e)}function Fa(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Pa(t)):(n.next=i.next,i.next=n),t.interleaved=n,Oa(e,r)}function Oa(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ia=!1;function Ba(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ka(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function La(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ua(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Al)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Oa(e,n)}return null===(i=r.interleaved)?(t.next=t,Pa(r)):(t.next=i.next,i.next=t),r.interleaved=t,Oa(e,n)}function za(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Ha(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Va(e,t,n,r){var i=e.updateQueue;Ia=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?a=c:o.next=c,o=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==a){var h=i.baseState;for(o=0,u=c=l=null,s=a;;){var d=s.lane,f=s.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=k({},h,d);break e;case 2:Ia=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(d=s).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Bl|=o,e.lanes=o,e.memoizedState=h}}function Ga(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var qa={},ja=Mi(qa),Wa=Mi(qa),Xa=Mi(qa);function Ya(e){if(e===qa)throw Error(a(174));return e}function Za(e,t){switch(Ei(Xa,t),Ei(Wa,e),Ei(ja,qa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Di(ja),Ei(ja,t)}function Ka(){Di(ja),Di(Wa),Di(Xa)}function Qa(e){Ya(Xa.current);var t=Ya(ja.current),n=le(t,e.type);t!==n&&(Ei(Wa,e),Ei(ja,n))}function Ja(e){Wa.current===e&&(Di(ja),Di(Wa))}var $a=Mi(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=b.ReactCurrentDispatcher,io=b.ReactCurrentBatchConfig,ao=0,oo=null,so=null,lo=null,co=!1,uo=!1,ho=0,fo=0;function po(){throw Error(a(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function go(e,t,n,r,i,o){if(ao=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?$o:es,e=n(r,i),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(a(301));o+=1,lo=so=null,t.updateQueue=null,ro.current=ts,e=n(r,i)}while(uo)}if(ro.current=Jo,t=null!==so&&null!==so.next,ao=0,lo=so=oo=null,co=!1,t)throw Error(a(300));return e}function vo(){var e=0!==ho;return ho=0,e}function yo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function xo(){if(null===so){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=so.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,so=e;else{if(null===e)throw Error(a(310));e={memoizedState:(so=e).memoizedState,baseState:so.baseState,baseQueue:so.baseQueue,queue:so.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function bo(e,t){return"function"===typeof t?t(e):t}function _o(e){var t=xo(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=so,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=s=null,c=null,u=o;do{var h=u.lane;if((ao&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,s=r):c=c.next=d,oo.lanes|=h,Bl|=h}u=u.next}while(null!==u&&u!==o);null===c?s=r:c.next=l,sr(r,t.memoizedState)||(xs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,oo.lanes|=o,Bl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wo(e){var t=xo(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);sr(o,t.memoizedState)||(xs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function So(){}function Mo(e,t){var n=oo,r=xo(),i=t(),o=!sr(r.memoizedState,i);if(o&&(r.memoizedState=i,xs=!0),r=r.queue,Bo(Co.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Ro(9,Eo.bind(null,n,r,i,t),void 0,null),null===Tl)throw Error(a(349));0!==(30&ao)||Do(n,t,i)}return i}function Do(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Eo(e,t,n,r){t.value=n,t.getSnapshot=r,Ao(t)&&To(e)}function Co(e,t,n){return n((function(){Ao(t)&&To(e)}))}function Ao(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function To(e){var t=Oa(e,1);null!==t&&nc(t,e,1,-1)}function No(e){var t=yo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bo,lastRenderedState:e},t.queue=e,e=e.dispatch=Yo.bind(null,oo,e),[t.memoizedState,e]}function Ro(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Po(){return xo().memoizedState}function Fo(e,t,n,r){var i=yo();oo.flags|=e,i.memoizedState=Ro(1|t,n,void 0,void 0===r?null:r)}function Oo(e,t,n,r){var i=xo();r=void 0===r?null:r;var a=void 0;if(null!==so){var o=so.memoizedState;if(a=o.destroy,null!==r&&mo(r,o.deps))return void(i.memoizedState=Ro(t,n,a,r))}oo.flags|=e,i.memoizedState=Ro(1|t,n,a,r)}function Io(e,t){return Fo(8390656,8,e,t)}function Bo(e,t){return Oo(2048,8,e,t)}function ko(e,t){return Oo(4,2,e,t)}function Lo(e,t){return Oo(4,4,e,t)}function Uo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oo(4,4,Uo.bind(null,t,e),n)}function Ho(){}function Vo(e,t){var n=xo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Go(e,t){var n=xo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qo(e,t,n){return 0===(21&ao)?(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=n):(sr(n,t)||(n=mt(),oo.lanes|=n,Bl|=n,e.baseState=!0),t)}function jo(e,t){var n=xt;xt=0!==n&&4>n?n:4,e(!0);var r=io.transition;io.transition={};try{e(!1),t()}finally{xt=n,io.transition=r}}function Wo(){return xo().memoizedState}function Xo(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Zo(e))Ko(t,n);else if(null!==(n=Fa(e,t,n,r))){nc(n,e,r,ec()),Qo(n,t,r)}}function Yo(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Zo(e))Ko(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,o)){var l=t.interleaved;return null===l?(i.next=i,Pa(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Fa(e,t,i,r))&&(nc(n,e,r,i=ec()),Qo(n,t,r))}}function Zo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function Ko(e,t){uo=co=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Qo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var Jo={readContext:Na,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},$o={readContext:Na,useCallback:function(e,t){return yo().memoizedState=[e,void 0===t?null:t],e},useContext:Na,useEffect:Io,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Fo(4194308,4,Uo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Fo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fo(4,2,e,t)},useMemo:function(e,t){var n=yo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=yo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Xo.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},yo().memoizedState=e},useState:No,useDebugValue:Ho,useDeferredValue:function(e){return yo().memoizedState=e},useTransition:function(){var e=No(!1),t=e[0];return e=jo.bind(null,e[1]),yo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,i=yo();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Tl)throw Error(a(349));0!==(30&ao)||Do(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Io(Co.bind(null,r,o,e),[e]),r.flags|=2048,Ro(9,Eo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=yo(),t=Tl.identifierPrefix;if(ia){var n=Qi;t=":"+t+"R"+(n=(Ki&~(1<<32-ot(Ki)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Na,useCallback:Vo,useContext:Na,useEffect:Bo,useImperativeHandle:zo,useInsertionEffect:ko,useLayoutEffect:Lo,useMemo:Go,useReducer:_o,useRef:Po,useState:function(){return _o(bo)},useDebugValue:Ho,useDeferredValue:function(e){return qo(xo(),so.memoizedState,e)},useTransition:function(){return[_o(bo)[0],xo().memoizedState]},useMutableSource:So,useSyncExternalStore:Mo,useId:Wo,unstable_isNewReconciler:!1},ts={readContext:Na,useCallback:Vo,useContext:Na,useEffect:Bo,useImperativeHandle:zo,useInsertionEffect:ko,useLayoutEffect:Lo,useMemo:Go,useReducer:wo,useRef:Po,useState:function(){return wo(bo)},useDebugValue:Ho,useDeferredValue:function(e){var t=xo();return null===so?t.memoizedState=e:qo(t,so.memoizedState,e)},useTransition:function(){return[wo(bo)[0],xo().memoizedState]},useMutableSource:So,useSyncExternalStore:Mo,useId:Wo,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=k({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:k({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var is={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),a=La(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,i))&&(nc(t,e,i,r),za(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),a=La(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,i))&&(nc(t,e,i,r),za(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=La(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Ua(e,i,r))&&(nc(t,e,r,n),za(t,e,r))}};function as(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,a))}function os(e,t,n){var r=!1,i=Ci,a=t.contextType;return"object"===typeof a&&null!==a?a=Na(a):(i=Pi(t)?Ni:Ai.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ri(e,i):Ci),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=is,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&is.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Ba(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Na(a):(a=Pi(t)?Ni:Ai.current,i.context=Ri(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(rs(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&is.enqueueReplaceState(i,i.state,null),Va(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var n="",r=t;do{n+=H(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=La(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,jl=r),hs(0,t)},n}function ps(e,t,n){(n=La(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){hs(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!==typeof r&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Dc.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=La(-1,1)).tag=2,Ua(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ys=b.ReactCurrentOwner,xs=!1;function bs(e,t,n,r){t.child=null===e?_a(t,null,n,r):ba(t,e.child,n,r)}function _s(e,t,n,r,i){n=n.render;var a=t.ref;return Ta(t,i),r=go(e,t,n,r,a,i),n=vo(),null===e||xs?(ia&&n&&ea(t),t.flags|=1,bs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qs(e,t,i))}function ws(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Pc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ss(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return qs(e,t,i)}return t.flags|=1,(e=Fc(a,r)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(lr(a,r)&&e.ref===t.ref){if(xs=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,qs(e,t,i);0!==(131072&e.flags)&&(xs=!0)}}return Es(e,t,n,r,i)}function Ms(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ei(Fl,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ei(Fl,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ei(Fl,Pl),Pl|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ei(Fl,Pl),Pl|=r;return bs(e,t,i,n),t.child}function Ds(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Es(e,t,n,r,i){var a=Pi(n)?Ni:Ai.current;return a=Ri(t,a),Ta(t,i),n=go(e,t,n,r,a,i),r=vo(),null===e||xs?(ia&&r&&ea(t),t.flags|=1,bs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qs(e,t,i))}function Cs(e,t,n,r,i){if(Pi(n)){var a=!0;Bi(t)}else a=!1;if(Ta(t,i),null===t.stateNode)Gs(e,t),os(t,n,r),ls(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Na(c):c=Ri(t,c=Pi(n)?Ni:Ai.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||l!==c)&&ss(t,o,r,c),Ia=!1;var d=t.memoizedState;o.state=d,Va(t,r,o,i),l=t.memoizedState,s!==r||d!==l||Ti.current||Ia?("function"===typeof u&&(rs(t,n,u,r),l=t.memoizedState),(s=Ia||as(t,n,s,r,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ka(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:ns(t.type,s),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Na(l):l=Ri(t,l=Pi(n)?Ni:Ai.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||d!==l)&&ss(t,o,r,l),Ia=!1,d=t.memoizedState,o.state=d,Va(t,r,o,i);var p=t.memoizedState;s!==h||d!==p||Ti.current||Ia?("function"===typeof f&&(rs(t,n,f,r),p=t.memoizedState),(c=Ia||as(t,n,c,r,d,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return As(e,t,n,r,a,i)}function As(e,t,n,r,i,a){Ds(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&ki(t,n,!1),qs(e,t,a);r=t.stateNode,ys.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=ba(t,e.child,null,a),t.child=ba(t,null,s,a)):bs(e,t,s,a),t.memoizedState=r.state,i&&ki(t,n,!0),t.child}function Ts(e){var t=e.stateNode;t.pendingContext?Oi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oi(0,t.context,!1),Za(e,t.containerInfo)}function Ns(e,t,n,r,i){return fa(),pa(i),t.flags|=256,bs(e,t,n,r),t.child}var Rs,Ps,Fs,Os,Is={dehydrated:null,treeContext:null,retryLane:0};function Bs(e){return{baseLanes:e,cachePool:null,transitions:null}}function ks(e,t,n){var r,i=t.pendingProps,o=$a.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ei($a,1&o),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,s?(i=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Bc(l,i,0,null),e=Ic(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Bs(n),t.memoizedState=Is,e):Ls(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,s){if(n)return 256&t.flags?(t.flags&=-257,Us(e,t,s,r=us(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Bc({mode:"visible",children:r.children},i,0,null),(o=Ic(o,i,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&ba(t,e.child,null,s),t.child.memoizedState=Bs(s),t.memoizedState=Is,o);if(0===(1&t.mode))return Us(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Us(e,t,s,r=us(o=Error(a(419)),r,void 0))}if(l=0!==(s&e.childLanes),xs||l){if(null!==(r=Tl)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Oa(e,i),nc(r,e,i,-1))}return mc(),Us(e,t,s,r=us(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,ra=ci(i.nextSibling),na=t,ia=!0,aa=null,null!==e&&(Xi[Yi++]=Ki,Xi[Yi++]=Qi,Xi[Yi++]=Zi,Ki=e.id,Qi=e.overflow,Zi=t),t=Ls(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(s){s=i.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Fc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Fc(r,s):(s=Ic(s,l,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,l=null===(l=e.child.memoizedState)?Bs(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Is,i}return e=(s=e.child).sibling,i=Fc(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ls(e,t){return(t=Bc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Us(e,t,n,r){return null!==r&&pa(r),ba(t,e.child,null,n),(e=Ls(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Aa(e.return,t,n)}function Hs(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Vs(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(bs(e,t,r.children,n),0!==(2&(r=$a.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zs(e,n,t);else if(19===e.tag)zs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ei($a,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Hs(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===eo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Hs(t,!0,n,null,a);break;case"together":Hs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Bl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Fc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Fc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function js(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ws(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Xs(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ws(t),null;case 1:case 17:return Pi(t.type)&&Fi(),Ws(t),null;case 3:return r=t.stateNode,Ka(),Di(Ti),Di(Ai),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(oc(aa),aa=null))),Ps(e,t),Ws(t),null;case 5:Ja(t);var i=Ya(Xa.current);if(n=t.type,null!==e&&null!=t.stateNode)Fs(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Ws(t),null}if(e=Ya(ja.current),ha(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[di]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<Ir.length;i++)Ur(Ir[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":K(r,o),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ur("invalid",r);break;case"textarea":ie(r,o),Ur("invalid",r)}for(var l in ye(n,o),i=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":W(r),$(r,o,!0);break;case"textarea":W(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=$r)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[fi]=r,Rs(e,t,!1,!1),t.stateNode=e;e:{switch(l=xe(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<Ir.length;i++)Ur(Ir[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":K(e,r),i=Z(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=k({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(o in ye(n,i),c=i)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Ur("scroll",e):null!=u&&x(e,o,u,l))}switch(n){case"input":W(e),$(e,r,!1);break;case"textarea":W(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=$r)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ws(t),null;case 6:if(e&&null!=t.stateNode)Os(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Ya(Xa.current),Ya(ja.current),ha(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(o=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return Ws(t),null;case 13:if(Di($a),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))da(),fa(),t.flags|=98560,o=!1;else if(o=ha(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[di]=t}else fa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ws(t),o=!1}else null!==aa&&(oc(aa),aa=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$a.current)?0===Ol&&(Ol=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ws(t),null);case 4:return Ka(),Ps(e,t),null===e&&Vr(t.stateNode.containerInfo),Ws(t),null;case 10:return Ca(t.type._context),Ws(t),null;case 19:if(Di($a),null===(o=t.memoizedState))return Ws(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)js(o,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,js(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ei($a,1&$a.current|2),t.child}e=e.sibling}null!==o.tail&&Qe()>Vl&&(t.flags|=128,r=!0,js(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),js(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ia)return Ws(t),null}else 2*Qe()-o.renderingStartTime>Vl&&1073741824!==n&&(t.flags|=128,r=!0,js(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Qe(),t.sibling=null,n=$a.current,Ei($a,r?1&n|2:1&n),t):(Ws(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(Ws(t),6&t.subtreeFlags&&(t.flags|=8192)):Ws(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Ys(e,t){switch(ta(t),t.tag){case 1:return Pi(t.type)&&Fi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ka(),Di(Ti),Di(Ai),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ja(t),null;case 13:if(Di($a),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Di($a),null;case 4:return Ka(),null;case 10:return Ca(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Rs=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ps=function(){},Fs=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ya(ja.current);var a,o=null;switch(n){case"input":i=Z(e,i),r=Z(e,r),o=[];break;case"select":i=k({},i,{value:void 0}),r=k({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=$r)}for(u in ye(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},Os=function(e,t,n,r){n!==r&&(t.flags|=4)};var Zs=!1,Ks=!1,Qs="function"===typeof WeakSet?WeakSet:Set,Js=null;function $s(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Mc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Mc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&el(t,n,a)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=$r));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,hl=!1;function dl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:Ks||$s(n,t);case 6:var r=ul,i=hl;ul=null,dl(e,t,n),hl=i,null!==(ul=r)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Vt(e)):li(ul,n.stateNode));break;case 4:r=ul,i=hl,ul=n.stateNode.containerInfo,hl=!0,dl(e,t,n),ul=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Ks&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&el(n,t,o),i=i.next}while(i!==r)}dl(e,t,n);break;case 1:if(!Ks&&($s(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Mc(n,t,s)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Ks=(r=Ks)||null!==n.memoizedState,dl(e,t,n),Ks=r):dl(e,t,n);break;default:dl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qs),t.forEach((function(t){var r=Ac.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));fl(o,s,i),ul=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Mc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Mc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Mc(e,e.return,g)}}break;case 1:ml(t,e),vl(e),512&r&&null!==n&&$s(n,n.return);break;case 5:if(ml(t,e),vl(e),512&r&&null!==n&&$s(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){Mc(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&Q(i,o),xe(l,s);var u=xe(l,o);for(s=0;s<c.length;s+=2){var h=c[s],d=c[s+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):x(i,h,d,u)}switch(l){case"input":J(i,o);break;case"textarea":ae(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(g){Mc(e,e.return,g)}}break;case 6:if(ml(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Mc(e,e.return,g)}}break;case 3:if(ml(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){Mc(e,e.return,g)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Hl=Qe())),4&r&&pl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ks=(u=Ks)||h,ml(t,e),Ks=u):ml(t,e),vl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Js=e,h=e.child;null!==h;){for(d=Js=h;null!==Js;){switch(p=(f=Js).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:$s(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Mc(r,n,g)}}break;case 5:$s(f,f.return);break;case 22:if(null!==f.memoizedState){_l(d);continue}}null!==p?(p.return=f,Js=p):_l(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,s=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",s))}catch(g){Mc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Mc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),vl(e),4&r&&pl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),cl(e,sl(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;ll(e,sl(e),o);break;default:throw Error(a(161))}}catch(s){Mc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Js=e,xl(e,t,n)}function xl(e,t,n){for(var r=0!==(1&e.mode);null!==Js;){var i=Js,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Zs;if(!o){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Ks;s=Zs;var c=Ks;if(Zs=o,(Ks=l)&&!c)for(Js=i;null!==Js;)l=(o=Js).child,22===o.tag&&null!==o.memoizedState?wl(i):null!==l?(l.return=o,Js=l):wl(i);for(;null!==a;)Js=a,xl(a,t,n),a=a.sibling;Js=i,Zs=s,Ks=c}bl(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Js=a):bl(e)}}function bl(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ks||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ks)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ga(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ga(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Vt(d)}}}break;default:throw Error(a(163))}Ks||512&t.flags&&il(t)}catch(f){Mc(t,t.return,f)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function _l(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function wl(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Mc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Mc(t,i,l)}}var a=t.return;try{il(t)}catch(l){Mc(t,a,l)}break;case 5:var o=t.return;try{il(t)}catch(l){Mc(t,o,l)}}}catch(l){Mc(t,t.return,l)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var Sl,Ml=Math.ceil,Dl=b.ReactCurrentDispatcher,El=b.ReactCurrentOwner,Cl=b.ReactCurrentBatchConfig,Al=0,Tl=null,Nl=null,Rl=0,Pl=0,Fl=Mi(0),Ol=0,Il=null,Bl=0,kl=0,Ll=0,Ul=null,zl=null,Hl=0,Vl=1/0,Gl=null,ql=!1,jl=null,Wl=null,Xl=!1,Yl=null,Zl=0,Kl=0,Ql=null,Jl=-1,$l=0;function ec(){return 0!==(6&Al)?Qe():-1!==Jl?Jl:Jl=Qe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Al)&&0!==Rl?Rl&-Rl:null!==ma.transition?(0===$l&&($l=mt()),$l):0!==(e=xt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function nc(e,t,n,r){if(50<Kl)throw Kl=0,Ql=null,Error(a(185));vt(e,n,r),0!==(2&Al)&&e===Tl||(e===Tl&&(0===(2&Al)&&(kl|=n),4===Ol&&sc(e,Rl)),rc(e,r),1===n&&0===Al&&0===(1&t.mode)&&(Vl=Qe()+500,Ui&&Vi()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ot(a),s=1<<o,l=i[o];-1===l?0!==(s&n)&&0===(s&r)||(i[o]=ft(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=dt(e,e===Tl?Rl:0);if(0===r)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Ui=!0,Hi(e)}(lc.bind(null,e)):Hi(lc.bind(null,e)),oi((function(){0===(6&Al)&&Vi()})),n=null;else{switch(bt(r)){case 1:n=$e;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Jl=-1,$l=0,0!==(6&Al))throw Error(a(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var r=dt(e,e===Tl?Rl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var i=Al;Al|=2;var o=pc();for(Tl===e&&Rl===t||(Gl=null,Vl=Qe()+500,dc(e,t));;)try{yc();break}catch(l){fc(e,l)}Ea(),Dl.current=o,Al=i,null!==Nl?t=0:(Tl=null,Rl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=ac(e,i))),1===t)throw n=Il,dc(e,0),sc(e,r),rc(e,Qe()),n;if(6===t)sc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!sr(a(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,r))&&(0!==(o=pt(e))&&(r=o,t=ac(e,o))),1===t))throw n=Il,dc(e,0),sc(e,r),rc(e,Qe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:_c(e,zl,Gl);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=Hl+500-Qe())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(_c.bind(null,e,zl,Gl),t);break}_c(e,zl,Gl);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>i&&(i=s),r&=~o}if(r=i,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ml(r/1960))-r)){e.timeoutHandle=ri(_c.bind(null,e,zl,Gl),r);break}_c(e,zl,Gl);break;default:throw Error(a(329))}}}return rc(e,Qe()),e.callbackNode===n?ic.bind(null,e):null}function ac(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zl,zl=n,null!==t&&oc(t)),e}function oc(e){null===zl?zl=e:zl.push.apply(zl,e)}function sc(e,t){for(t&=~Ll,t&=~kl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Al))throw Error(a(327));wc();var t=dt(e,0);if(0===(1&t))return rc(e,Qe()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Il,dc(e,0),sc(e,t),rc(e,Qe()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,zl,Gl),rc(e,Qe()),null}function cc(e,t){var n=Al;Al|=1;try{return e(t)}finally{0===(Al=n)&&(Vl=Qe()+500,Ui&&Vi())}}function uc(e){null!==Yl&&0===Yl.tag&&0===(6&Al)&&wc();var t=Al;Al|=1;var n=Cl.transition,r=xt;try{if(Cl.transition=null,xt=1,e)return e()}finally{xt=r,Cl.transition=n,0===(6&(Al=t))&&Vi()}}function hc(){Pl=Fl.current,Di(Fl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Nl)for(n=Nl.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Fi();break;case 3:Ka(),Di(Ti),Di(Ai),no();break;case 5:Ja(r);break;case 4:Ka();break;case 13:case 19:Di($a);break;case 10:Ca(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Tl=e,Nl=e=Fc(e.current,null),Rl=Pl=t,Ol=0,Il=null,Ll=kl=Bl=0,zl=Ul=null,null!==Ra){for(t=0;t<Ra.length;t++)if(null!==(r=(n=Ra[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}Ra=null}return e}function fc(e,t){for(;;){var n=Nl;try{if(Ea(),ro.current=Jo,co){for(var r=oo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}co=!1}if(ao=0,lo=so=oo=null,uo=!1,ho=0,El.current=null,null===n||null===n.return){Ol=1,Il=t,Nl=null;break}e:{var o=e,s=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=gs(s);if(null!==p){p.flags&=-257,vs(p,s,l,0,t),1&p.mode&&ms(o,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ms(o,u,t),mc();break e}c=Error(a(426))}else if(ia&&1&l.mode){var v=gs(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vs(v,s,l,0,t),pa(cs(c,l));break e}}o=c=cs(c,l),4!==Ol&&(Ol=2),null===Ul?Ul=[o]:Ul.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ha(o,fs(0,c,t));break e;case 1:l=c;var y=o.type,x=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===Wl||!Wl.has(x)))){o.flags|=65536,t&=-t,o.lanes|=t,Ha(o,ps(o,l,t));break e}}o=o.return}while(null!==o)}bc(n)}catch(b){t=b,Nl===n&&null!==n&&(Nl=n=n.return);continue}break}}function pc(){var e=Dl.current;return Dl.current=Jo,null===e?Jo:e}function mc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Tl||0===(268435455&Bl)&&0===(268435455&kl)||sc(Tl,Rl)}function gc(e,t){var n=Al;Al|=2;var r=pc();for(Tl===e&&Rl===t||(Gl=null,dc(e,t));;)try{vc();break}catch(i){fc(e,i)}if(Ea(),Al=n,Dl.current=r,null!==Nl)throw Error(a(261));return Tl=null,Rl=0,Ol}function vc(){for(;null!==Nl;)xc(Nl)}function yc(){for(;null!==Nl&&!Ze();)xc(Nl)}function xc(e){var t=Sl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?bc(e):Nl=t,El.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Xs(n,t,Pl)))return void(Nl=n)}else{if(null!==(n=Ys(n,t)))return n.flags&=32767,void(Nl=n);if(null===e)return Ol=6,void(Nl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Nl=t);Nl=t=e}while(null!==t);0===Ol&&(Ol=5)}function _c(e,t,n){var r=xt,i=Cl.transition;try{Cl.transition=null,xt=1,function(e,t,n,r){do{wc()}while(null!==Yl);if(0!==(6&Al))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,o),e===Tl&&(Nl=Tl=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Xl||(Xl=!0,Tc(tt,(function(){return wc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Cl.transition,Cl.transition=null;var s=xt;xt=1;var l=Al;Al|=4,El.current=null,function(e,t){if(ei=qt,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(_){n=null;break e}var s=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=s+i),d!==o||0!==r&&3!==d.nodeType||(c=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=s),f===o&&++h===r&&(c=s),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},qt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,x=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(a(163))}}catch(_){Mc(t,t.return,_)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}m=tl,tl=!1}(e,n),gl(n,e),pr(ti),qt=!!ei,ti=ei=null,e.current=n,yl(n,e,i),Ke(),Al=l,xt=s,Cl.transition=o}else e.current=n;if(Xl&&(Xl=!1,Yl=e,Zl=i),o=e.pendingLanes,0===o&&(Wl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ql)throw ql=!1,e=jl,jl=null,e;0!==(1&Zl)&&0!==e.tag&&wc(),o=e.pendingLanes,0!==(1&o)?e===Ql?Kl++:(Kl=0,Ql=e):Kl=0,Vi()}(e,t,n,r)}finally{Cl.transition=i,xt=r}return null}function wc(){if(null!==Yl){var e=bt(Zl),t=Cl.transition,n=xt;try{if(Cl.transition=null,xt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Zl=0,0!==(6&Al))throw Error(a(331));var i=Al;for(Al|=4,Js=e.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Js=u;null!==Js;){var h=Js;switch(h.tag){case 0:case 11:case 15:nl(8,h,o)}var d=h.child;if(null!==d)d.return=h,Js=d;else for(;null!==Js;){var f=(h=Js).sibling,p=h.return;if(al(h),h===u){Js=null;break}if(null!==f){f.return=p,Js=f;break}Js=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else e:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:nl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Js=y;break e}Js=o.return}}var x=e.current;for(Js=x;null!==Js;){var b=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,Js=b;else e:for(s=x;null!==Js;){if(0!==(2048&(l=Js).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(w){Mc(l,l.return,w)}if(l===s){Js=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,Js=_;break e}Js=l.return}}if(Al=i,Vi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(w){}r=!0}return r}finally{xt=n,Cl.transition=t}}return!1}function Sc(e,t,n){e=Ua(e,t=fs(0,t=cs(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),rc(e,t))}function Mc(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Wl||!Wl.has(r))){t=Ua(t,e=ps(t,e=cs(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function Dc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Rl&n)===n&&(4===Ol||3===Ol&&(130023424&Rl)===Rl&&500>Qe()-Hl?dc(e,0):Ll|=n),rc(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Oa(e,t))&&(vt(e,t,n),rc(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function Ac(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Ec(e,n)}function Tc(e,t){return Xe(e,t)}function Nc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,r){return new Nc(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,i,o){var s=2;if(r=e,"function"===typeof e)Pc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Ic(n.children,i,o,t);case M:s=8,i|=8;break;case D:return(e=Rc(12,n,t,2|i)).elementType=D,e.lanes=o,e;case T:return(e=Rc(13,n,t,i)).elementType=T,e.lanes=o,e;case N:return(e=Rc(19,n,t,i)).elementType=N,e.lanes=o,e;case F:return Bc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:s=10;break e;case C:s=9;break e;case A:s=11;break e;case R:s=14;break e;case P:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Rc(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Ic(e,t,n,r){return(e=Rc(7,e,r,t)).lanes=n,e}function Bc(e,t,n,r){return(e=Rc(22,e,r,t)).elementType=F,e.lanes=n,e.stateNode={isHidden:!1},e}function kc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function Lc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,i,a,o,s,l){return e=new Uc(e,t,n,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Rc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ba(a),e}function Hc(e){if(!e)return Ci;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Pi(n))return Ii(e,n,t)}return t}function Vc(e,t,n,r,i,a,o,s,l){return(e=zc(n,r,!0,e,0,a,0,s,l)).context=Hc(null),n=e.current,(a=La(r=ec(),i=tc(n))).callback=void 0!==t&&null!==t?t:null,Ua(n,a,i),e.current.lanes=i,vt(e,i,r),rc(e,r),e}function Gc(e,t,n,r){var i=t.current,a=ec(),o=tc(i);return n=Hc(n),null===t.context?t.context=n:t.pendingContext=n,(t=La(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ua(i,t,o))&&(nc(e,i,o,a),za(e,i,o)),o}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function jc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){jc(e,t),(e=e.alternate)&&jc(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ti.current)xs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xs=!1,function(e,t,n){switch(t.tag){case 3:Ts(t),fa();break;case 5:Qa(t);break;case 1:Pi(t.type)&&Bi(t);break;case 4:Za(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ei(wa,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ei($a,1&$a.current),t.flags|=128,null):0!==(n&t.child.childLanes)?ks(e,t,n):(Ei($a,1&$a.current),null!==(e=qs(e,t,n))?e.sibling:null);Ei($a,1&$a.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Vs(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ei($a,$a.current),r)break;return null;case 22:case 23:return t.lanes=0,Ms(e,t,n)}return qs(e,t,n)}(e,t,n);xs=0!==(131072&e.flags)}else xs=!1,ia&&0!==(1048576&t.flags)&&$i(t,Wi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Gs(e,t),e=t.pendingProps;var i=Ri(t,Ai.current);Ta(t,n),i=go(null,t,r,e,i,n);var o=vo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pi(r)?(o=!0,Bi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ba(t),i.updater=is,t.stateNode=i,i._reactInternals=t,ls(t,r,e,n),t=As(null,t,r,!0,o,n)):(t.tag=0,ia&&o&&ea(t),bs(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Gs(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===R)return 14}return 2}(r),e=ns(r,e),i){case 0:t=Es(null,t,r,e,n);break e;case 1:t=Cs(null,t,r,e,n);break e;case 11:t=_s(null,t,r,e,n);break e;case 14:t=ws(null,t,r,ns(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Es(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 1:return r=t.type,i=t.pendingProps,Cs(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 3:e:{if(Ts(t),null===e)throw Error(a(387));r=t.pendingProps,i=(o=t.memoizedState).element,ka(e,t),Va(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ns(e,t,r,n,i=cs(Error(a(423)),t));break e}if(r!==i){t=Ns(e,t,r,n,i=cs(Error(a(424)),t));break e}for(ra=ci(t.stateNode.containerInfo.firstChild),na=t,ia=!0,aa=null,n=_a(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===i){t=qs(e,t,n);break e}bs(e,t,r,n)}t=t.child}return t;case 5:return Qa(t),null===e&&ca(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==o&&ni(r,o)&&(t.flags|=32),Ds(e,t),bs(e,t,s,n),t.child;case 6:return null===e&&ca(t),null;case 13:return ks(e,t,n);case 4:return Za(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ba(t,null,r,n):bs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,_s(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 7:return bs(e,t,t.pendingProps,n),t.child;case 8:case 12:return bs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Ei(wa,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===i.children&&!Ti.current){t=qs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=La(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Aa(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Aa(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}bs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ta(t,n),r=r(i=Na(i)),t.flags|=1,bs(e,t,r,n),t.child;case 14:return i=ns(r=t.type,t.pendingProps),ws(e,t,r,i=ns(r.type,i),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ns(r,i),Gs(e,t),t.tag=1,Pi(r)?(e=!0,Bi(t)):e=!1,Ta(t,n),os(t,r,i),ls(t,r,i,n),As(null,t,r,!0,e,n);case 19:return Vs(e,t,n);case 22:return Ms(e,t,n)}throw Error(a(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Zc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function $c(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var s=i;i=function(){var e=qc(o);s.call(e)}}Gc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=qc(o);a.call(e)}}var o=Vc(t,r,e,0,null,!1,0,"",Jc);return e._reactRootContainer=o,e[pi]=o.current,Vr(8===e.nodeType?e.parentNode:e),uc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=qc(l);s.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[pi]=l.current,Vr(8===e.nodeType?e.parentNode:e),uc((function(){Gc(t,l,n,r)})),l}(n,t,e,i,r);return qc(o)}Zc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Gc(e,t,null,null)},Zc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Gc(null,e,null,null)})),t[pi]=null}},Zc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Mt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ft.length&&0!==t&&t<Ft[n].priority;n++);Ft.splice(n,0,e),0===n&&kt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Qe()),0===(6&Al)&&(Vl=Qe()+500,Vi()))}break;case 13:uc((function(){var t=Oa(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Wc(e,1)}},wt=function(e){if(13===e.tag){var t=Oa(e,134217728);if(null!==t)nc(t,e,134217728,ec());Wc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),n=Oa(e,t);if(null!==n)nc(n,e,t,ec());Wc(e,t)}},Mt=function(){return xt},Dt=function(e,t){var n=xt;try{return xt=e,t()}finally{xt=n}},we=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_i(r);if(!i)throw Error(a(90));X(r),J(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=cc,Te=uc;var eu={usingClientEntryPoint:!1,Events:[xi,bi,_i,Ee,Ce,cc]},tu={findFiberByHostInstance:yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=je(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),at=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Kc(e))throw Error(a(299));var n=!1,r="",i=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=je(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Qc(t))throw Error(a(200));return $c(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Kc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",s=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Vc(t,null,e,1,null!=n?n:null,i,0,o,s),e[pi]=t.current,Vr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Zc(t)},t.render=function(e,t,n){if(!Qc(t))throw Error(a(200));return $c(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Qc(e))throw Error(a(40));return!!e._reactRootContainer&&(uc((function(){$c(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Qc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return $c(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},2897:(e,t,n)=>{var r=n(3693);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},2941:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Image=void 0;const r=n(7149),i=n(1751),a=n(3304),o=n(4602),s=n(9910);class l extends a.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",(e=>{this._removeImageLoad(e.oldVal),this._setImageLoad()})),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&4===e.readyState||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),t=this.hasShadow();return!(!e||!t)||super._useBufferCanvas(!0)}_sceneFunc(e){const t=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;let o;if(a){const e=this.attrs.cropWidth,r=this.attrs.cropHeight;o=e&&r?[a,this.cropX(),this.cropY(),e,r,0,0,t,n]:[a,0,0,t,n]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?r.Util.drawRoundedRectPath(e,t,n,i):e.rect(0,0,t,n),e.closePath(),e.fillStrokeShape(this)),a&&(i&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){const t=this.width(),n=this.height(),i=this.cornerRadius();e.beginPath(),i?r.Util.drawRoundedRectPath(e,t,n,i):e.rect(0,0,t,n),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t;return null!==(e=this.attrs.width)&&void 0!==e?e:null===(t=this.image())||void 0===t?void 0:t.width}getHeight(){var e,t;return null!==(e=this.attrs.height)&&void 0!==e?e:null===(t=this.image())||void 0===t?void 0:t.height}static fromURL(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=r.Util.createImageElement();i.onload=function(){const e=new l({image:i});t(e)},i.onerror=n,i.crossOrigin="Anonymous",i.src=e}}t.Image=l,l.prototype.className="Image",(0,o._registerNode)(l),i.Factory.addGetterSetter(l,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),i.Factory.addGetterSetter(l,"image"),i.Factory.addComponentsGetterSetter(l,"crop",["x","y","width","height"]),i.Factory.addGetterSetter(l,"cropX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(l,"cropY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(l,"cropWidth",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(l,"cropHeight",0,(0,s.getNumberValidator)())},3169:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Text=void 0,t.stringToArray=c;const r=n(7149),i=n(1751),a=n(3304),o=n(4602),s=n(9910),l=n(4602);function c(e){return[...e].reduce(((e,t,n,r)=>{if(/(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9\uDEF0-\uDEF8])/.test(t)){const i=r[n+1];i&&/(?:\uD83C[\uDFFB-\uDFFF])|\u200D/.test(i)?(e.push(t+i),r[n+1]=""):e.push(t)}else/(?:\uD83C[\uDDE6-\uDDFF]){2}/.test(t+(r[n+1]||""))?e.push(t+r[n+1]):n>0&&/(?:[\u0300-\u036F\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0897-\u089F\u08CA-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2\u09E3\u09FE\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B55\u0B56\u0B62\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C04\u0C3C\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CBF\u0CC6\u0CCC\u0CCD\u0CE2\u0CE3\u0D00\u0D01\u0D3B\u0D3C\u0D41-\u0D44\u0D4D\u0D62\u0D63\u0D81\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732\u1733\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u180F\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1ABF-\u1ACE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DFF\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099\u309A\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA82C\uA8C4\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9BD\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]|\uD800[\uDDFD\uDEE0\uDF76-\uDF7A]|\uD802[\uDE01-\uDE03\uDE05\uDE06\uDE0C-\uDE0F\uDE38-\uDE3A\uDE3F\uDEE5\uDEE6]|\uD803[\uDD24-\uDD27\uDD69-\uDD6D\uDEAB\uDEAC\uDEFC-\uDEFF\uDF46-\uDF50\uDF82-\uDF85]|\uD804[\uDC01\uDC38-\uDC46\uDC70\uDC73\uDC74\uDC7F-\uDC81\uDCB3-\uDCB6\uDCB9\uDCBA\uDCC2\uDD00-\uDD02\uDD27-\uDD2B\uDD2D-\uDD34\uDD73\uDD80\uDD81\uDDB6-\uDDBE\uDDC9-\uDDCC\uDDCF\uDE2F-\uDE31\uDE34\uDE36\uDE37\uDE3E\uDE41\uDEDF\uDEE3-\uDEEA\uDF00\uDF01\uDF3B\uDF3C\uDF40\uDF66-\uDF6C\uDF70-\uDF74\uDFBB-\uDFC0\uDFCE\uDFD0\uDFD2\uDFE1\uDFE2]|\uD805[\uDC38-\uDC3F\uDC42-\uDC44\uDC46\uDC5E\uDCB3-\uDCB8\uDCBA\uDCBF\uDCC0\uDCC2\uDCC3\uDDB2-\uDDB5\uDDBC\uDDBD\uDDBF\uDDC0\uDDDC\uDDDD\uDE33-\uDE3A\uDE3D\uDE3F\uDE40\uDEAB\uDEAD\uDEB0-\uDEB5\uDEB7\uDF1D\uDF1F\uDF22-\uDF25\uDF27-\uDF2B]|\uD806[\uDC2F-\uDC37\uDC39\uDC3A\uDD3B\uDD3C\uDD3E\uDD43\uDDD4-\uDDD7\uDDDA\uDDDB\uDDE0\uDE01-\uDE0A\uDE33-\uDE38\uDE3B-\uDE3E\uDE47\uDE51-\uDE56\uDE59-\uDE5B\uDE8A-\uDE96\uDE98\uDE99]|\uD807[\uDC30-\uDC36\uDC38-\uDC3D\uDC3F\uDC92-\uDCA7\uDCAA-\uDCB0\uDCB2\uDCB3\uDCB5\uDCB6\uDD31-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD45\uDD47\uDD90\uDD91\uDD95\uDD97\uDEF3\uDEF4\uDF00\uDF01\uDF36-\uDF3A\uDF40\uDF42\uDF5A]|\uD80D[\uDC40\uDC47-\uDC55]|\uD818[\uDD1E-\uDD29\uDD2D-\uDD2F]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF4F\uDF8F-\uDF92\uDFE4]|\uD82F[\uDC9D\uDC9E]|\uD833[\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD67-\uDD69\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC8F\uDD30-\uDD36\uDEAE\uDEEC-\uDEEF]|\uD839[\uDCEC-\uDCEF\uDDEE\uDDEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD4A]|\uDB40[\uDD00-\uDDEF])|[\u0488\u0489\u1ABE\u20DD-\u20E0\u20E2-\u20E4\uA670-\uA672]|(?:[\u0903\u093B\u093E-\u0940\u0949-\u094C\u094E\u094F\u0982\u0983\u09BE-\u09C0\u09C7\u09C8\u09CB\u09CC\u09D7\u0A03\u0A3E-\u0A40\u0A83\u0ABE-\u0AC0\u0AC9\u0ACB\u0ACC\u0B02\u0B03\u0B3E\u0B40\u0B47\u0B48\u0B4B\u0B4C\u0B57\u0BBE\u0BBF\u0BC1\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD7\u0C01-\u0C03\u0C41-\u0C44\u0C82\u0C83\u0CBE\u0CC0-\u0CC4\u0CC7\u0CC8\u0CCA\u0CCB\u0CD5\u0CD6\u0CF3\u0D02\u0D03\u0D3E-\u0D40\u0D46-\u0D48\u0D4A-\u0D4C\u0D57\u0D82\u0D83\u0DCF-\u0DD1\u0DD8-\u0DDF\u0DF2\u0DF3\u0F3E\u0F3F\u0F7F\u102B\u102C\u1031\u1038\u103B\u103C\u1056\u1057\u1062-\u1064\u1067-\u106D\u1083\u1084\u1087-\u108C\u108F\u109A-\u109C\u1715\u1734\u17B6\u17BE-\u17C5\u17C7\u17C8\u1923-\u1926\u1929-\u192B\u1930\u1931\u1933-\u1938\u1A19\u1A1A\u1A55\u1A57\u1A61\u1A63\u1A64\u1A6D-\u1A72\u1B04\u1B35\u1B3B\u1B3D-\u1B41\u1B43\u1B44\u1B82\u1BA1\u1BA6\u1BA7\u1BAA\u1BE7\u1BEA-\u1BEC\u1BEE\u1BF2\u1BF3\u1C24-\u1C2B\u1C34\u1C35\u1CE1\u1CF7\u302E\u302F\uA823\uA824\uA827\uA880\uA881\uA8B4-\uA8C3\uA952\uA953\uA983\uA9B4\uA9B5\uA9BA\uA9BB\uA9BE-\uA9C0\uAA2F\uAA30\uAA33\uAA34\uAA4D\uAA7B\uAA7D\uAAEB\uAAEE\uAAEF\uAAF5\uABE3\uABE4\uABE6\uABE7\uABE9\uABEA\uABEC]|\uD804[\uDC00\uDC02\uDC82\uDCB0-\uDCB2\uDCB7\uDCB8\uDD2C\uDD45\uDD46\uDD82\uDDB3-\uDDB5\uDDBF\uDDC0\uDDCE\uDE2C-\uDE2E\uDE32\uDE33\uDE35\uDEE0-\uDEE2\uDF02\uDF03\uDF3E\uDF3F\uDF41-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF57\uDF62\uDF63\uDFB8-\uDFBA\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC\uDFCD\uDFCF]|\uD805[\uDC35-\uDC37\uDC40\uDC41\uDC45\uDCB0-\uDCB2\uDCB9\uDCBB-\uDCBE\uDCC1\uDDAF-\uDDB1\uDDB8-\uDDBB\uDDBE\uDE30-\uDE32\uDE3B\uDE3C\uDE3E\uDEAC\uDEAE\uDEAF\uDEB6\uDF1E\uDF20\uDF21\uDF26]|\uD806[\uDC2C-\uDC2E\uDC38\uDD30-\uDD35\uDD37\uDD38\uDD3D\uDD40\uDD42\uDDD1-\uDDD3\uDDDC-\uDDDF\uDDE4\uDE39\uDE57\uDE58\uDE97]|\uD807[\uDC2F\uDC3E\uDCA9\uDCB1\uDCB4\uDD8A-\uDD8E\uDD93\uDD94\uDD96\uDEF5\uDEF6\uDF03\uDF34\uDF35\uDF3E\uDF3F\uDF41]|\uD818[\uDD2A-\uDD2C]|\uD81B[\uDF51-\uDF87\uDFF0\uDFF1]|\uD834[\uDD65\uDD66\uDD6D-\uDD72])/.test(t)?e[e.length-1]+=t:t&&e.push(t);return e}),[])}const u="auto",h="inherit",d="justify",f="left",p="middle",m="normal",g=" ",v="none",y=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],x=y.length;let b;function _(){return b||(b=r.Util.createCanvasElement().getContext("2d"),b)}class w extends a.Shape{constructor(e){super(function(e){return(e=e||{}).fillLinearGradientColorStops||e.fillRadialGradientColorStops||e.fillPatternImage||(e.fill=e.fill||"black"),e}(e)),this._partialTextX=0,this._partialTextY=0;for(let t=0;t<x;t++)this.on(y[t]+"Change.konva",this._setTextData);this._setTextData()}_sceneFunc(e){const t=this.textArr,n=t.length;if(!this.text())return;let r,i=this.padding(),a=this.fontSize(),s=this.lineHeight()*a,l=this.verticalAlign(),u=this.direction(),m=0,g=this.align(),v=this.getWidth(),y=this.letterSpacing(),x=this.fill(),b=this.textDecoration(),_=-1!==b.indexOf("underline"),w=-1!==b.indexOf("line-through");u=u===h?e.direction:u;let S=s/2,M=p;if(o.Konva._fixTextRendering){const e=this.measureSize("M");M="alphabetic",S=(e.fontBoundingBoxAscent-e.fontBoundingBoxDescent)/2+s/2}var D=0,E=0;for("rtl"===u&&e.setAttr("direction",u),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",M),e.setAttr("textAlign",f),l===p?m=(this.getHeight()-n*s-2*i)/2:"bottom"===l&&(m=this.getHeight()-n*s-2*i),e.translate(i,m+i),r=0;r<n;r++){D=0,E=0;var C,A,T=t[r],N=T.text,R=T.width,P=T.lastInParagraph;if(e.save(),"right"===g?D+=v-R-2*i:"center"===g&&(D+=(v-R-2*i)/2),_){e.save(),e.beginPath();const t=D,n=S+E+(o.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2));e.moveTo(t,n),0===(C=N.split(" ").length-1),A=g!==d||P?R:v-2*i,e.lineTo(t+Math.round(A),n),e.lineWidth=a/15;const r=this._getLinearGradient();e.strokeStyle=r||x,e.stroke(),e.restore()}if(w){e.save(),e.beginPath();const t=o.Konva._fixTextRendering?-Math.round(a/4):0;e.moveTo(D,S+E+t),0===(C=N.split(" ").length-1),A=g!==d||P?R:v-2*i,e.lineTo(D+Math.round(A),S+E+t),e.lineWidth=a/15;const n=this._getLinearGradient();e.strokeStyle=n||x,e.stroke(),e.restore()}if("rtl"===u||0===y&&g!==d)0!==y&&e.setAttr("letterSpacing","".concat(y,"px")),this._partialTextX=D,this._partialTextY=S+E,this._partialText=N,e.fillStrokeShape(this);else{C=N.split(" ").length-1;const t=c(N);for(let n=0;n<t.length;n++){const r=t[n];" "!==r||P||g!==d||(D+=(v-2*i-R)/C),this._partialTextX=D,this._partialTextY=S+E,this._partialText=r,e.fillStrokeShape(this),D+=this.measureSize(r).width+y}}e.restore(),n>1&&(S+=s)}}_hitFunc(e){const t=this.getWidth(),n=this.getHeight();e.beginPath(),e.rect(0,0,t,n),e.closePath(),e.fillStrokeShape(this)}setText(e){const t=r.Util._isString(e)?e:null===e||void 0===e?"":e+"";return this._setAttr("text",t),this}getWidth(){return this.attrs.width===u||void 0===this.attrs.width?this.getTextWidth()+2*this.padding():this.attrs.width}getHeight(){return this.attrs.height===u||void 0===this.attrs.height?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return r.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var t,n,r,i,a,o,s,l,c,u,h;let d,f=_(),p=this.fontSize();f.save(),f.font=this._getContextFont(),d=f.measureText(e),f.restore();const m=p/100;return{actualBoundingBoxAscent:null!==(t=d.actualBoundingBoxAscent)&&void 0!==t?t:71.58203125*m,actualBoundingBoxDescent:null!==(n=d.actualBoundingBoxDescent)&&void 0!==n?n:0,actualBoundingBoxLeft:null!==(r=d.actualBoundingBoxLeft)&&void 0!==r?r:-7.421875*m,actualBoundingBoxRight:null!==(i=d.actualBoundingBoxRight)&&void 0!==i?i:75.732421875*m,alphabeticBaseline:null!==(a=d.alphabeticBaseline)&&void 0!==a?a:0,emHeightAscent:null!==(o=d.emHeightAscent)&&void 0!==o?o:100*m,emHeightDescent:null!==(s=d.emHeightDescent)&&void 0!==s?s:-20*m,fontBoundingBoxAscent:null!==(l=d.fontBoundingBoxAscent)&&void 0!==l?l:91*m,fontBoundingBoxDescent:null!==(c=d.fontBoundingBoxDescent)&&void 0!==c?c:21*m,hangingBaseline:null!==(u=d.hangingBaseline)&&void 0!==u?u:72.80000305175781*m,ideographicBaseline:null!==(h=d.ideographicBaseline)&&void 0!==h?h:-21*m,width:d.width,height:p}}_getContextFont(){return this.fontStyle()+g+this.fontVariant()+g+(this.fontSize()+"px ")+this.fontFamily().split(",").map((e=>{const t=(e=e.trim()).indexOf(" ")>=0,n=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!n&&(e='"'.concat(e,'"')),e})).join(", ")}_addTextLine(e){this.align()===d&&(e=e.trim());const t=this._getTextWidth(e);return this.textArr.push({text:e,width:t,lastInParagraph:!1})}_getTextWidth(e){const t=this.letterSpacing(),n=e.length;return _().measureText(e).width+t*n}_setTextData(){let e=this.text().split("\n"),t=+this.fontSize(),n=0,r=this.lineHeight()*t,i=this.attrs.width,a=this.attrs.height,o=i!==u&&void 0!==i,s=a!==u&&void 0!==a,l=this.padding(),h=i-2*l,d=a-2*l,f=0,p=this.wrap(),m="char"!==p&&p!==v,y=this.ellipsis();this.textArr=[],_().font=this._getContextFont();const x=y?this._getTextWidth("\u2026"):0;for(let u=0,v=e.length;u<v;++u){let t=e[u],i=this._getTextWidth(t);if(o&&i>h)for(;t.length>0;){let e=0,a=c(t).length,o="",l=0;for(;e<a;){const n=e+a>>>1,i=c(t).slice(0,n+1).join(""),u=this._getTextWidth(i);(y&&s&&f+r>d?u+x:u)<=h?(e=n+1,o=i,l=u):a=n}if(!o)break;if(m){const n=c(t),r=c(o),i=n[r.length];let a;if((i===g||"-"===i)&&l<=h)a=r.length;else{const e=r.lastIndexOf(g),t=r.lastIndexOf("-");a=Math.max(e,t)+1}a>0&&(e=a,o=n.slice(0,e).join(""),l=this._getTextWidth(o))}o=o.trimRight(),this._addTextLine(o),n=Math.max(n,l),f+=r;if(this._shouldHandleEllipsis(f)){this._tryToAddEllipsisToLastLine();break}if(t=c(t).slice(e).join("").trimLeft(),t.length>0&&(i=this._getTextWidth(t),i<=h)){this._addTextLine(t),f+=r,n=Math.max(n,i);break}}else this._addTextLine(t),f+=r,n=Math.max(n,i),this._shouldHandleEllipsis(f)&&u<v-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),s&&f+r>d)break}this.textHeight=t,this.textWidth=n}_shouldHandleEllipsis(e){const t=+this.fontSize(),n=this.lineHeight()*t,r=this.attrs.height,i=r!==u&&void 0!==r,a=r-2*this.padding();return!(this.wrap()!==v)||i&&e+n>a}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,t=e!==u&&void 0!==e,n=e-2*this.padding(),r=this.ellipsis(),i=this.textArr[this.textArr.length-1];if(i&&r){if(t){this._getTextWidth(i.text+"\u2026")<n||(i.text=i.text.slice(0,i.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(i.text+"\u2026")}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=-1!==this.textDecoration().indexOf("underline")||-1!==this.textDecoration().indexOf("line-through"),t=this.hasShadow();return!(!e||!t)||super._useBufferCanvas()}}t.Text=w,w.prototype._fillFunc=function(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)},w.prototype._strokeFunc=function(e){e.setAttr("miterLimit",2),e.strokeText(this._partialText,this._partialTextX,this._partialTextY)},w.prototype.className="Text",w.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,l._registerNode)(w),i.Factory.overWriteSetter(w,"width",(0,s.getNumberOrAutoValidator)()),i.Factory.overWriteSetter(w,"height",(0,s.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(w,"direction",h),i.Factory.addGetterSetter(w,"fontFamily","Arial"),i.Factory.addGetterSetter(w,"fontSize",12,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"fontStyle",m),i.Factory.addGetterSetter(w,"fontVariant",m),i.Factory.addGetterSetter(w,"padding",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"align",f),i.Factory.addGetterSetter(w,"verticalAlign","top"),i.Factory.addGetterSetter(w,"lineHeight",1,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"wrap","word"),i.Factory.addGetterSetter(w,"ellipsis",!1,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(w,"letterSpacing",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(w,"text","",(0,s.getStringValidator)()),i.Factory.addGetterSetter(w,"textDecoration","")},3243:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Animation=void 0;const r=n(4602),i=n(7149),a=r.glob.performance&&r.glob.performance.now?function(){return r.glob.performance.now()}:function(){return(new Date).getTime()};class o{constructor(e,t){this.id=o.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:a(),frameRate:0},this.func=e,this.setLayers(t)}setLayers(e){let t=[];return e&&(t=Array.isArray(e)?e:[e]),this.layers=t,this}getLayers(){return this.layers}addLayer(e){const t=this.layers,n=t.length;for(let r=0;r<n;r++)if(t[r]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const e=o.animations,t=e.length;for(let n=0;n<t;n++)if(e[n].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=a(),o._addAnimation(this),this}stop(){return o._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const t=e.id,n=this.animations,r=n.length;for(let i=0;i<r;i++)if(n[i].id===t){this.animations.splice(i,1);break}}static _runFrames(){const e={},t=this.animations;for(let n=0;n<t.length;n++){const r=t[n],i=r.layers,o=r.func;r._updateFrameObject(a());const s=i.length;let l;if(l=!o||!1!==o.call(r,r.frame),l)for(let t=0;t<s;t++){const n=i[t];void 0!==n._id&&(e[n._id]=n)}}for(const n in e)e.hasOwnProperty(n)&&e[n].batchDraw()}static _animationLoop(){const e=o;e.animations.length?(e._runFrames(),i.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,i.Util.requestAnimFrame(this._animationLoop))}}t.Animation=o,o.animations=[],o.animIdCounter=0,o.animRunning=!1},3304:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const r=n(4602),i=n(7149),a=n(1751),o=n(1189),s=n(9910),l=n(4602),c=n(9485),u="hasShadow",h="shadowRGBA",d="patternImage",f="linearGradient",p="radialGradient";let m;function g(){return m||(m=i.Util.createCanvasElement().getContext("2d"),m)}t.shapes={};class v extends o.Node{constructor(e){let n;for(super(e);n=i.Util.getRandomColor(),!n||n in t.shapes;);this.colorKey=n,t.shapes[n]=this}getContext(){return i.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return i.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(u,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const e=g().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(e&&e.setTransform){const t=new i.Transform;t.translate(this.fillPatternX(),this.fillPatternY()),t.rotate(r.Konva.getAngle(this.fillPatternRotation())),t.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),t.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const n=t.getMatrix(),a="undefined"===typeof DOMMatrix?{a:n[0],b:n[1],c:n[2],d:n[3],e:n[4],f:n[5]}:new DOMMatrix(n);e.setTransform(a)}return e}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){const e=this.fillLinearGradientColorStops();if(e){const t=g(),n=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),i=t.createLinearGradient(n.x,n.y,r.x,r.y);for(let a=0;a<e.length;a+=2)i.addColorStop(e[a],e[a+1]);return i}}_getRadialGradient(){return this._getCache(p,this.__getRadialGradient)}__getRadialGradient(){const e=this.fillRadialGradientColorStops();if(e){const t=g(),n=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),i=t.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let a=0;a<e.length;a+=2)i.addColorStop(e[a],e[a+1]);return i}}getShadowRGBA(){return this._getCache(h,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const e=i.Util.colorToRGBA(this.shadowColor());return e?"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.shadowOpacity()||1)+")":void 0}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],(()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops())))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],(()=>this.strokeEnabled()&&this.strokeWidth()&&!(!this.stroke()&&!this.strokeLinearGradientColorStops())))}hasHitStroke(){const e=this.hitStrokeWidth();return"auto"===e?this.hasStroke():this.strokeEnabled()&&!!e}intersects(e){const t=this.getStage();if(!t)return!1;const n=t.bufferHitCanvas;n.getContext().clear(),this.drawHit(n,void 0,!0);return n.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data[3]>0}destroy(){return o.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(e){var t;if(!(null===(t=this.attrs.perfectDrawEnabled)||void 0===t||t))return!1;const n=e||this.hasFill(),r=this.hasStroke(),i=1!==this.getAbsoluteOpacity();if(n&&r&&i)return!0;const a=this.hasShadow(),o=this.shadowForStrokeEnabled();return!!(n&&r&&a&&o)}setStrokeHitEnabled(e){i.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),e?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return 0!==this.hitStrokeWidth()}getSelfRect(){const e=this.size();return{x:this._centroid?-e.width/2:0,y:this._centroid?-e.height/2:0,width:e.width,height:e.height}}getClientRect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!1,n=this.getParent();for(;n;){if(n.isCached()){t=!0;break}n=n.getParent()}const r=e.skipTransform,i=e.relativeTo||t&&this.getStage()||void 0,a=this.getSelfRect(),o=!e.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,s=a.width+o,l=a.height+o,c=!e.skipShadow&&this.hasShadow(),u=c?this.shadowOffsetX():0,h=c?this.shadowOffsetY():0,d=s+Math.abs(u),f=l+Math.abs(h),p=c&&this.shadowBlur()||0,m={width:d+2*p,height:f+2*p,x:-(o/2+p)+Math.min(u,0)+a.x,y:-(o/2+p)+Math.min(h,0)+a.y};return r?m:this._transformedRect(m,i)}drawScene(e,t,n){const r=this.getLayer();let i,a,o=e||r.getCanvas(),s=o.getContext(),l=this._getCanvasCache(),c=this.getSceneFunc(),u=this.hasShadow();const h=o.isCache,d=t===this;if(!this.isVisible()&&!d)return this;if(l){s.save();const e=this.getAbsoluteTransform(t).getMatrix();return s.transform(e[0],e[1],e[2],e[3],e[4],e[5]),this._drawCachedSceneCanvas(s),s.restore(),this}if(!c)return this;if(s.save(),this._useBufferCanvas()&&!h){i=this.getStage();const e=n||i.bufferCanvas;a=e.getContext(),a.clear(),a.save(),a._applyLineJoin(this);var f=this.getAbsoluteTransform(t).getMatrix();a.transform(f[0],f[1],f[2],f[3],f[4],f[5]),c.call(this,a,this),a.restore();const r=e.pixelRatio;u&&s._applyShadow(this),s._applyOpacity(this),s._applyGlobalCompositeOperation(this),s.drawImage(e._canvas,0,0,e.width/r,e.height/r)}else{if(s._applyLineJoin(this),!d){f=this.getAbsoluteTransform(t).getMatrix();s.transform(f[0],f[1],f[2],f[3],f[4],f[5]),s._applyOpacity(this),s._applyGlobalCompositeOperation(this)}u&&s._applyShadow(this),c.call(this,s,this)}return s.restore(),this}drawHit(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.shouldDrawHit(t,n))return this;const r=this.getLayer(),a=e||r.hitCanvas,o=a&&a.getContext(),s=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),c=l&&l.hit;if(this.colorKey||i.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),c){o.save();const e=this.getAbsoluteTransform(t).getMatrix();return o.transform(e[0],e[1],e[2],e[3],e[4],e[5]),this._drawCachedHitCanvas(o),o.restore(),this}if(!s)return this;o.save(),o._applyLineJoin(this);if(!(this===t)){const e=this.getAbsoluteTransform(t).getMatrix();o.transform(e[0],e[1],e[2],e[3],e[4],e[5])}return s.call(this,o,this),o.restore(),this}drawHitFromCache(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this._getCanvasCache(),n=this._getCachedSceneCanvas(),r=t.hit,a=r.getContext(),o=r.getWidth(),s=r.getHeight();a.clear(),a.drawImage(n._canvas,0,0,o,s);try{const t=a.getImageData(0,0,o,s),n=t.data,r=n.length,l=i.Util._hexToRgb(this.colorKey);for(let i=0;i<r;i+=4){n[i+3]>e?(n[i]=l.r,n[i+1]=l.g,n[i+2]=l.b,n[i+3]=255):n[i+3]=0}a.putImageData(t,0,0)}catch(l){i.Util.error("Unable to draw hit graph from cached scene canvas. "+l.message)}return this}hasPointerCapture(e){return c.hasPointerCapture(e,this)}setPointerCapture(e){c.setPointerCapture(e,this)}releaseCapture(e){c.releaseCapture(e,this)}}t.Shape=v,v.prototype._fillFunc=function(e){const t=this.attrs.fillRule;t?e.fill(t):e.fill()},v.prototype._strokeFunc=function(e){e.stroke()},v.prototype._fillFuncHit=function(e){const t=this.attrs.fillRule;t?e.fill(t):e.fill()},v.prototype._strokeFuncHit=function(e){e.stroke()},v.prototype._centroid=!1,v.prototype.nodeType="Shape",(0,l._registerNode)(v),v.prototype.eventListeners={},v.prototype.on.call(v.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",(function(){this._clearCache(u)})),v.prototype.on.call(v.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",(function(){this._clearCache(h)})),v.prototype.on.call(v.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",(function(){this._clearCache(d)})),v.prototype.on.call(v.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",(function(){this._clearCache(f)})),v.prototype.on.call(v.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",(function(){this._clearCache(p)})),a.Factory.addGetterSetter(v,"stroke",void 0,(0,s.getStringOrGradientValidator)()),a.Factory.addGetterSetter(v,"strokeWidth",2,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(v,"fillAfterStrokeEnabled",!1),a.Factory.addGetterSetter(v,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),a.Factory.addGetterSetter(v,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),a.Factory.addGetterSetter(v,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),a.Factory.addGetterSetter(v,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),a.Factory.addGetterSetter(v,"lineJoin"),a.Factory.addGetterSetter(v,"lineCap"),a.Factory.addGetterSetter(v,"sceneFunc"),a.Factory.addGetterSetter(v,"hitFunc"),a.Factory.addGetterSetter(v,"dash"),a.Factory.addGetterSetter(v,"dashOffset",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(v,"shadowColor",void 0,(0,s.getStringValidator)()),a.Factory.addGetterSetter(v,"shadowBlur",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(v,"shadowOpacity",1,(0,s.getNumberValidator)()),a.Factory.addComponentsGetterSetter(v,"shadowOffset",["x","y"]),a.Factory.addGetterSetter(v,"shadowOffsetX",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(v,"shadowOffsetY",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(v,"fillPatternImage"),a.Factory.addGetterSetter(v,"fill",void 0,(0,s.getStringOrGradientValidator)()),a.Factory.addGetterSetter(v,"fillPatternX",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(v,"fillPatternY",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(v,"fillLinearGradientColorStops"),a.Factory.addGetterSetter(v,"strokeLinearGradientColorStops"),a.Factory.addGetterSetter(v,"fillRadialGradientStartRadius",0),a.Factory.addGetterSetter(v,"fillRadialGradientEndRadius",0),a.Factory.addGetterSetter(v,"fillRadialGradientColorStops"),a.Factory.addGetterSetter(v,"fillPatternRepeat","repeat"),a.Factory.addGetterSetter(v,"fillEnabled",!0),a.Factory.addGetterSetter(v,"strokeEnabled",!0),a.Factory.addGetterSetter(v,"shadowEnabled",!0),a.Factory.addGetterSetter(v,"dashEnabled",!0),a.Factory.addGetterSetter(v,"strokeScaleEnabled",!0),a.Factory.addGetterSetter(v,"fillPriority","color"),a.Factory.addComponentsGetterSetter(v,"fillPatternOffset",["x","y"]),a.Factory.addGetterSetter(v,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(v,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),a.Factory.addComponentsGetterSetter(v,"fillPatternScale",["x","y"]),a.Factory.addGetterSetter(v,"fillPatternScaleX",1,(0,s.getNumberValidator)()),a.Factory.addGetterSetter(v,"fillPatternScaleY",1,(0,s.getNumberValidator)()),a.Factory.addComponentsGetterSetter(v,"fillLinearGradientStartPoint",["x","y"]),a.Factory.addComponentsGetterSetter(v,"strokeLinearGradientStartPoint",["x","y"]),a.Factory.addGetterSetter(v,"fillLinearGradientStartPointX",0),a.Factory.addGetterSetter(v,"strokeLinearGradientStartPointX",0),a.Factory.addGetterSetter(v,"fillLinearGradientStartPointY",0),a.Factory.addGetterSetter(v,"strokeLinearGradientStartPointY",0),a.Factory.addComponentsGetterSetter(v,"fillLinearGradientEndPoint",["x","y"]),a.Factory.addComponentsGetterSetter(v,"strokeLinearGradientEndPoint",["x","y"]),a.Factory.addGetterSetter(v,"fillLinearGradientEndPointX",0),a.Factory.addGetterSetter(v,"strokeLinearGradientEndPointX",0),a.Factory.addGetterSetter(v,"fillLinearGradientEndPointY",0),a.Factory.addGetterSetter(v,"strokeLinearGradientEndPointY",0),a.Factory.addComponentsGetterSetter(v,"fillRadialGradientStartPoint",["x","y"]),a.Factory.addGetterSetter(v,"fillRadialGradientStartPointX",0),a.Factory.addGetterSetter(v,"fillRadialGradientStartPointY",0),a.Factory.addComponentsGetterSetter(v,"fillRadialGradientEndPoint",["x","y"]),a.Factory.addGetterSetter(v,"fillRadialGradientEndPointX",0),a.Factory.addGetterSetter(v,"fillRadialGradientEndPointY",0),a.Factory.addGetterSetter(v,"fillPatternRotation",0),a.Factory.addGetterSetter(v,"fillRule",void 0,(0,s.getStringValidator)()),a.Factory.backCompat(v,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})},3354:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HitContext=t.SceneContext=t.Context=void 0;const r=n(7149),i=n(4602);const a=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"];class o{constructor(e){this.canvas=e,i.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){let n,i,a,o,s=this.traceArr,l=s.length,c="";for(n=0;n<l;n++)i=s[n],a=i.method,a?(o=i.args,c+=a,e?c+="()":r.Util._isArray(o[0])?c+="(["+o.join(",")+"])":(t&&(o=o.map((e=>"number"===typeof e?Math.floor(e):e))),c+="("+o.join(",")+")")):(c+=i.property,e||(c+="="+i.val)),c+=";";return c}clearTrace(){this.traceArr=[]}_trace(e){let t,n=this.traceArr;n.push(e),t=n.length,t>=100&&n.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){const t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){const t=e.getAbsoluteOpacity();1!==t&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){const t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}setAttr(e,t){this._context[e]=t}arc(e,t,n,r,i,a){this._context.arc(e,t,n,r,i,a)}arcTo(e,t,n,r,i){this._context.arcTo(e,t,n,r,i)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,n,r,i,a){this._context.bezierCurveTo(e,t,n,r,i,a)}clearRect(e,t,n,r){this._context.clearRect(e,t,n,r)}clip(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(e,t){const n=arguments;return 2===n.length?this._context.createImageData(e,t):1===n.length?this._context.createImageData(e):void 0}createLinearGradient(e,t,n,r){return this._context.createLinearGradient(e,t,n,r)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,n,r,i,a){return this._context.createRadialGradient(e,t,n,r,i,a)}drawImage(e,t,n,r,i,a,o,s,l){const c=arguments,u=this._context;3===c.length?u.drawImage(e,t,n):5===c.length?u.drawImage(e,t,n,r,i):9===c.length&&u.drawImage(e,t,n,r,i,a,o,s,l)}ellipse(e,t,n,r,i,a,o,s){this._context.ellipse(e,t,n,r,i,a,o,s)}isPointInPath(e,t,n,r){return n?this._context.isPointInPath(n,e,t,r):this._context.isPointInPath(e,t,r)}fill(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._context.fill.apply(this._context,t)}fillRect(e,t,n,r){this._context.fillRect(e,t,n,r)}strokeRect(e,t,n,r){this._context.strokeRect(e,t,n,r)}fillText(e,t,n,r){r?this._context.fillText(e,t,n,r):this._context.fillText(e,t,n)}measureText(e){return this._context.measureText(e)}getImageData(e,t,n,r){return this._context.getImageData(e,t,n,r)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,n,r){this._context.rect(e,t,n,r)}roundRect(e,t,n,r,i){this._context.roundRect(e,t,n,r,i)}putImageData(e,t,n){this._context.putImageData(e,t,n)}quadraticCurveTo(e,t,n,r){this._context.quadraticCurveTo(e,t,n,r)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,n,r,i,a){this._context.setTransform(e,t,n,r,i,a)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,n,r){this._context.strokeText(e,t,n,r)}transform(e,t,n,r,i,a){this._context.transform(e,t,n,r,i,a)}translate(e,t){this._context.translate(e,t)}_enableTrace(){let e,t,n=this,i=a.length,o=this.setAttr;const s=function(e){let i,a=n[e];n[e]=function(){return t=function(e){const t=[],n=e.length,i=r.Util;for(let r=0;r<n;r++){let n=e[r];i._isNumber(n)?n=Math.round(1e3*n)/1e3:i._isString(n)||(n+=""),t.push(n)}return t}(Array.prototype.slice.call(arguments,0)),i=a.apply(n,arguments),n._trace({method:e,args:t}),i}};for(e=0;e<i;e++)s(a[e]);n.setAttr=function(){o.apply(n,arguments);const e=arguments[0];let t=arguments[1];"shadowOffsetX"!==e&&"shadowOffsetY"!==e&&"shadowBlur"!==e||(t/=this.canvas.getPixelRatio()),n._trace({property:e,val:t})}}_applyGlobalCompositeOperation(e){const t=e.attrs.globalCompositeOperation;!t||"source-over"===t||this.setAttr("globalCompositeOperation",t)}}t.Context=o,["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"].forEach((function(e){Object.defineProperty(o.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})}));t.SceneContext=class extends o{constructor(e){let{willReadFrequently:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:t})}_fillColor(e){const t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){const t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){const t=e.fill(),n=e.getFillPriority();if(t&&"color"===n)return void this._fillColor(e);const r=e.getFillPatternImage();if(r&&"pattern"===n)return void this._fillPattern(e);const i=e.getFillLinearGradientColorStops();if(i&&"linear-gradient"===n)return void this._fillLinearGradient(e);const a=e.getFillRadialGradientColorStops();a&&"radial-gradient"===n?this._fillRadialGradient(e):t?this._fillColor(e):r?this._fillPattern(e):i?this._fillLinearGradient(e):a&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const t=e.getStrokeLinearGradientStartPoint(),n=e.getStrokeLinearGradientEndPoint(),r=e.getStrokeLinearGradientColorStops(),i=this.createLinearGradient(t.x,t.y,n.x,n.y);if(r){for(let e=0;e<r.length;e+=2)i.addColorStop(r[e],r[e+1]);this.setAttr("strokeStyle",i)}}_stroke(e){const t=e.dash(),n=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!n){this.save();const e=this.getCanvas().getPixelRatio();this.setTransform(e,0,0,e,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),n||this.restore()}}_applyShadow(e){var t,n,r;const i=null!==(t=e.getShadowRGBA())&&void 0!==t?t:"black",a=null!==(n=e.getShadowBlur())&&void 0!==n?n:5,o=null!==(r=e.getShadowOffset())&&void 0!==r?r:{x:0,y:0},s=e.getAbsoluteScale(),l=this.canvas.getPixelRatio(),c=s.x*l,u=s.y*l;this.setAttr("shadowColor",i),this.setAttr("shadowBlur",a*Math.min(Math.abs(c),Math.abs(u))),this.setAttr("shadowOffsetX",o.x*c),this.setAttr("shadowOffsetY",o.y*u)}};t.HitContext=class extends o{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const t=e.getStrokeScaleEnabled();if(!t){this.save();const e=this.getCanvas().getPixelRatio();this.setTransform(e,0,0,e,0,0)}this._applyLineCap(e);const n=e.hitStrokeWidth(),r="auto"===n?e.strokeWidth():n;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),t||this.restore()}}}},3535:(e,t,n)=>{"use strict";var r=n(2897).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Transformer=void 0;const i=n(7149),a=n(1751),o=n(1189),s=n(3304),l=n(1300),c=n(6338),u=n(4602),h=n(9910),d=n(4602),f="tr-konva",p=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map((e=>e+".".concat(f))).join(" "),m="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],v={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},y="ontouchstart"in u.Konva._global;const x=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function b(e,t,n){const i=n.x+(e.x-n.x)*Math.cos(t)-(e.y-n.y)*Math.sin(t),a=n.y+(e.x-n.x)*Math.sin(t)+(e.y-n.y)*Math.cos(t);return r(r({},e),{},{rotation:e.rotation+t,x:i,y:a})}function _(e,t){const n=function(e){return{x:e.x+e.width/2*Math.cos(e.rotation)+e.height/2*Math.sin(-e.rotation),y:e.y+e.height/2*Math.cos(e.rotation)+e.width/2*Math.sin(e.rotation)}}(e);return b(e,t,n)}let w=0;class S extends c.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(p,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return i.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return f+this._id}setNodes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._nodes&&this._nodes.length&&this.detach();const t=e.filter((e=>!e.isAncestorOf(this)||(i.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1)));this._nodes=e=t,1===e.length&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach((e=>{const t=()=>{1===this.nodes().length&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),this._transforming||this.isDragging()||this.update()};if(e._attrsAffectingSize.length){const n=e._attrsAffectingSize.map((e=>e+"Change."+this._getEventNamespace())).join(" ");e.on(n,t)}e.on(g.map((e=>e+".".concat(this._getEventNamespace()))).join(" "),t),e.on("absoluteTransformChange.".concat(this._getEventNamespace()),t),this._proxyDrag(e)})),this._resetTransformCache();return!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let t;e.on("dragstart.".concat(this._getEventNamespace()),(n=>{t=e.getAbsolutePosition(),this.isDragging()||e===this.findOne(".back")||this.startDrag(n,!1)})),e.on("dragmove.".concat(this._getEventNamespace()),(n=>{if(!t)return;const r=e.getAbsolutePosition(),i=r.x-t.x,a=r.y-t.y;this.nodes().forEach((t=>{if(t===e)return;if(t.isDragging())return;const r=t.getAbsolutePosition();t.setAbsolutePosition({x:r.x+i,y:r.y+a}),t.startDrag(n)})),t=null}))}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach((e=>{e.off("."+this._getEventNamespace())})),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(m),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(m,this.__getNodeRect)}__getNodeShape(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotation(),n=arguments.length>2?arguments[2]:void 0;const r=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),i=e.getAbsoluteScale(n),a=e.getAbsolutePosition(n),o=r.x*i.x-e.offsetX()*i.x,s=r.y*i.y-e.offsetY()*i.y,l=(u.Konva.getAngle(e.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI);return b({x:a.x+o*Math.cos(l)+s*Math.sin(-l),y:a.y+s*Math.cos(l)+o*Math.sin(l),width:r.width*i.x,height:r.height*i.y,rotation:l},-u.Konva.getAngle(t),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const e=[];this.nodes().map((t=>{const n=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),r=[{x:n.x,y:n.y},{x:n.x+n.width,y:n.y},{x:n.x+n.width,y:n.y+n.height},{x:n.x,y:n.y+n.height}],i=t.getAbsoluteTransform();r.forEach((function(t){const n=i.point(t);e.push(n)}))}));const t=new i.Transform;t.rotate(-u.Konva.getAngle(this.rotation()));let n=1/0,r=1/0,a=-1/0,o=-1/0;e.forEach((function(e){const i=t.point(e);void 0===n&&(n=a=i.x,r=o=i.y),n=Math.min(n,i.x),r=Math.min(r,i.y),a=Math.max(a,i.x),o=Math.max(o,i.y)})),t.invert();const s=t.point({x:n,y:r});return{x:s.x,y:s.y,width:a-n,height:o-r,rotation:u.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),x.forEach((e=>{this._createAnchor(e)})),this._createAnchor("rotater")}_createAnchor(e){const t=new l.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:y?10:"auto"}),n=this;t.on("mousedown touchstart",(function(e){n._handleMouseDown(e)})),t.on("dragstart",(e=>{t.stopDrag(),e.cancelBubble=!0})),t.on("dragend",(e=>{e.cancelBubble=!0})),t.on("mouseenter",(()=>{const n=u.Konva.getAngle(this.rotation()),r=this.rotateAnchorCursor(),a=function(e,t,n){if("rotater"===e)return n;t+=i.Util.degToRad(v[e]||0);const r=(i.Util.radToDeg(t)%360+360)%360;return i.Util._inRange(r,337.5,360)||i.Util._inRange(r,0,22.5)?"ns-resize":i.Util._inRange(r,22.5,67.5)?"nesw-resize":i.Util._inRange(r,67.5,112.5)?"ew-resize":i.Util._inRange(r,112.5,157.5)?"nwse-resize":i.Util._inRange(r,157.5,202.5)?"ns-resize":i.Util._inRange(r,202.5,247.5)?"nesw-resize":i.Util._inRange(r,247.5,292.5)?"ew-resize":i.Util._inRange(r,292.5,337.5)?"nwse-resize":(i.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}(e,n,r);t.getStage().content&&(t.getStage().content.style.cursor=a),this._cursorChange=!0})),t.on("mouseout",(()=>{t.getStage().content&&(t.getStage().content.style.cursor=""),this._cursorChange=!1})),this.add(t)}_createBack(){const e=new s.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(e,t){const n=t.getParent(),r=n.padding();e.beginPath(),e.rect(-r,-r,t.width()+2*r,t.height()+2*r),e.moveTo(t.width()/2,-r),n.rotateEnabled()&&n.rotateLineVisible()&&e.lineTo(t.width()/2,-n.rotateAnchorOffset()*i.Util._sign(t.height())-r),e.fillStrokeShape(t)},hitFunc:(e,t)=>{if(!this.shouldOverdrawWholeArea())return;const n=this.padding();e.beginPath(),e.rect(-n,-n,t.width()+2*n,t.height()+2*n),e.fillStrokeShape(t)}});this.add(e),this._proxyDrag(e),e.on("dragstart",(e=>{e.cancelBubble=!0})),e.on("dragmove",(e=>{e.cancelBubble=!0})),e.on("dragend",(e=>{e.cancelBubble=!0})),this.on("dragmove",(e=>{this.update()}))}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const t=this._getNodeRect(),n=t.width,r=t.height,i=Math.sqrt(Math.pow(n,2)+Math.pow(r,2));this.sin=Math.abs(r/i),this.cos=Math.abs(n/i),"undefined"!==typeof window&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const a=e.target.getAbsolutePosition(),o=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-a.x,y:o.y-a.y},w++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach((t=>{t._fire("transformstart",{evt:e.evt,target:t})}))}_handleMouseMove(e){let t,n,r;const i=this.findOne("."+this._movingAnchorName),a=i.getStage();a.setPointersPositions(e);const o=a.getPointerPosition();let s={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const l=i.getAbsolutePosition();this.anchorDragBoundFunc()&&(s=this.anchorDragBoundFunc()(l,s,e)),i.setAbsolutePosition(s);const c=i.getAbsolutePosition();if(l.x===c.x&&l.y===c.y)return;if("rotater"===this._movingAnchorName){const r=this._getNodeRect();t=i.x()-r.width/2,n=-i.y()+r.height/2;let a=Math.atan2(-n,t)+Math.PI/2;r.height<0&&(a-=Math.PI);const o=u.Konva.getAngle(this.rotation())+a,s=u.Konva.getAngle(this.rotationSnapTolerance()),l=function(e,t,n){let r=t;for(let i=0;i<e.length;i++){const a=u.Konva.getAngle(e[i]),o=Math.abs(a-t)%(2*Math.PI);Math.min(o,2*Math.PI-o)<n&&(r=a)}return r}(this.rotationSnaps(),o,s),c=_(r,l-r.rotation);return void this._fitNodesInto(c,e)}const h=this.shiftBehavior();let d;d="inverted"===h?this.keepRatio()&&!e.shiftKey:"none"===h?this.keepRatio():this.keepRatio()||e.shiftKey;var f=this.centeredScaling()||e.altKey;if("top-left"===this._movingAnchorName){if(d){var p=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(p.x-i.x(),2)+Math.pow(p.y-i.y(),2));var m=this.findOne(".top-left").x()>p.x?-1:1,g=this.findOne(".top-left").y()>p.y?-1:1;t=r*this.cos*m,n=r*this.sin*g,this.findOne(".top-left").x(p.x-t),this.findOne(".top-left").y(p.y-n)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(i.y());else if("top-right"===this._movingAnchorName){if(d){p=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(i.x()-p.x,2)+Math.pow(p.y-i.y(),2));m=this.findOne(".top-right").x()<p.x?-1:1,g=this.findOne(".top-right").y()>p.y?-1:1;t=r*this.cos*m,n=r*this.sin*g,this.findOne(".top-right").x(p.x+t),this.findOne(".top-right").y(p.y-n)}var v=i.position();this.findOne(".top-left").y(v.y),this.findOne(".bottom-right").x(v.x)}else if("middle-left"===this._movingAnchorName)this.findOne(".top-left").x(i.x());else if("middle-right"===this._movingAnchorName)this.findOne(".bottom-right").x(i.x());else if("bottom-left"===this._movingAnchorName){if(d){p=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(p.x-i.x(),2)+Math.pow(i.y()-p.y,2));m=p.x<i.x()?-1:1,g=i.y()<p.y?-1:1;t=r*this.cos*m,n=r*this.sin*g,i.x(p.x-t),i.y(p.y+n)}v=i.position(),this.findOne(".top-left").x(v.x),this.findOne(".bottom-right").y(v.y)}else if("bottom-center"===this._movingAnchorName)this.findOne(".bottom-right").y(i.y());else if("bottom-right"===this._movingAnchorName){if(d){p=f?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(i.x()-p.x,2)+Math.pow(i.y()-p.y,2));m=this.findOne(".bottom-right").x()<p.x?-1:1,g=this.findOne(".bottom-right").y()<p.y?-1:1;t=r*this.cos*m,n=r*this.sin*g,this.findOne(".bottom-right").x(p.x+t),this.findOne(".bottom-right").y(p.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(f=this.centeredScaling()||e.altKey){const e=this.findOne(".top-left"),t=this.findOne(".bottom-right"),n=e.x(),r=e.y(),i=this.getWidth()-t.x(),a=this.getHeight()-t.y();t.move({x:-n,y:-r}),e.move({x:i,y:a})}const y=this.findOne(".top-left").getAbsolutePosition();t=y.x,n=y.y;const x=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),b=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:t,y:n,width:x,height:b,rotation:u.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var t;if(this._transforming){this._transforming=!1,"undefined"!==typeof window&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();w--,this._fire("transformend",{evt:e,target:n}),null===(t=this.getLayer())||void 0===t||t.batchDraw(),n&&this._nodes.forEach((t=>{var n;t._fire("transformend",{evt:e,target:t}),null===(n=t.getLayer())||void 0===n||n.batchDraw()})),this._movingAnchorName=null}}_fitNodesInto(e,t){const n=this._getNodeRect();if(i.Util._inRange(e.width,2*-this.padding()-1,1))return void this.update();if(i.Util._inRange(e.height,2*-this.padding()-1,1))return void this.update();const r=new i.Transform;if(r.rotate(u.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const t=r.point({x:2*-this.padding(),y:0});e.x+=t.x,e.y+=t.y,e.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const t=r.point({x:2*this.padding(),y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y,e.width+=2*this.padding()}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const t=r.point({x:0,y:2*-this.padding()});e.x+=t.x,e.y+=t.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y,e.height+=2*this.padding()}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const t=r.point({x:0,y:2*this.padding()});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y,e.height+=2*this.padding()}if(this.boundBoxFunc()){const t=this.boundBoxFunc()(n,e);t?e=t:i.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const a=1e7,o=new i.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/a,n.height/a);const s=new i.Transform,l=e.width/a,c=e.height/a;!1===this.flipEnabled()?(s.translate(e.x,e.y),s.rotate(e.rotation),s.translate(e.width<0?e.width:0,e.height<0?e.height:0),s.scale(Math.abs(l),Math.abs(c))):(s.translate(e.x,e.y),s.rotate(e.rotation),s.scale(l,c));const h=s.multiply(o.invert());this._nodes.forEach((e=>{var t;const n=e.getParent().getAbsoluteTransform(),r=e.getTransform().copy();r.translate(e.offsetX(),e.offsetY());const a=new i.Transform;a.multiply(n.copy().invert()).multiply(h).multiply(n).multiply(r);const o=a.decompose();e.setAttrs(o),null===(t=e.getLayer())||void 0===t||t.batchDraw()})),this.rotation(i.Util._getRotation(e.rotation)),this._nodes.forEach((e=>{this._fire("transform",{evt:t,target:e}),e._fire("transform",{evt:t,target:e})})),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,t){this.findOne(e).setAttrs(t)}update(){var e;const t=this._getNodeRect();this.rotation(i.Util._getRotation(t.rotation));const n=t.width,r=t.height,a=this.enabledAnchors(),o=this.resizeEnabled(),s=this.padding(),l=this.anchorSize(),c=this.find("._anchor");c.forEach((e=>{e.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})})),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+s,offsetY:l/2+s,visible:o&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+s,visible:o&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-s,offsetY:l/2+s,visible:o&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:l/2+s,visible:o&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:r/2,offsetX:l/2-s,visible:o&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:l/2+s,offsetY:l/2-s,visible:o&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:r,offsetY:l/2-s,visible:o&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:r,offsetX:l/2-s,offsetY:l/2-s,visible:o&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*i.Util._sign(r)-s,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const u=this.anchorStyleFunc();u&&c.forEach((e=>{u(e)})),null===(e=this.getLayer())||void 0===e||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),c.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return o.Node.prototype.toObject.call(this)}clone(e){return o.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}t.Transformer=S,S.isTransforming=()=>w>0,S.prototype.className="Transformer",(0,d._registerNode)(S),a.Factory.addGetterSetter(S,"enabledAnchors",x,(function(e){return e instanceof Array||i.Util.warn("enabledAnchors value should be an array"),e instanceof Array&&e.forEach((function(e){-1===x.indexOf(e)&&i.Util.warn("Unknown anchor name: "+e+". Available names are: "+x.join(", "))})),e||[]})),a.Factory.addGetterSetter(S,"flipEnabled",!0,(0,h.getBooleanValidator)()),a.Factory.addGetterSetter(S,"resizeEnabled",!0),a.Factory.addGetterSetter(S,"anchorSize",10,(0,h.getNumberValidator)()),a.Factory.addGetterSetter(S,"rotateEnabled",!0),a.Factory.addGetterSetter(S,"rotateLineVisible",!0),a.Factory.addGetterSetter(S,"rotationSnaps",[]),a.Factory.addGetterSetter(S,"rotateAnchorOffset",50,(0,h.getNumberValidator)()),a.Factory.addGetterSetter(S,"rotateAnchorCursor","crosshair"),a.Factory.addGetterSetter(S,"rotationSnapTolerance",5,(0,h.getNumberValidator)()),a.Factory.addGetterSetter(S,"borderEnabled",!0),a.Factory.addGetterSetter(S,"anchorStroke","rgb(0, 161, 255)"),a.Factory.addGetterSetter(S,"anchorStrokeWidth",1,(0,h.getNumberValidator)()),a.Factory.addGetterSetter(S,"anchorFill","white"),a.Factory.addGetterSetter(S,"anchorCornerRadius",0,(0,h.getNumberValidator)()),a.Factory.addGetterSetter(S,"borderStroke","rgb(0, 161, 255)"),a.Factory.addGetterSetter(S,"borderStrokeWidth",1,(0,h.getNumberValidator)()),a.Factory.addGetterSetter(S,"borderDash"),a.Factory.addGetterSetter(S,"keepRatio",!0),a.Factory.addGetterSetter(S,"shiftBehavior","default"),a.Factory.addGetterSetter(S,"centeredScaling",!1),a.Factory.addGetterSetter(S,"ignoreStroke",!1),a.Factory.addGetterSetter(S,"padding",0,(0,h.getNumberValidator)()),a.Factory.addGetterSetter(S,"nodes"),a.Factory.addGetterSetter(S,"node"),a.Factory.addGetterSetter(S,"boundBoxFunc"),a.Factory.addGetterSetter(S,"anchorDragBoundFunc"),a.Factory.addGetterSetter(S,"anchorStyleFunc"),a.Factory.addGetterSetter(S,"shouldOverdrawWholeArea",!1),a.Factory.addGetterSetter(S,"useSingleNodeRotation",!0),a.Factory.backCompat(S,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"})},3602:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Emboss=void 0;const r=n(1751),i=n(1189),a=n(7149),o=n(9910);t.Emboss=function(e){const t=10*this.embossStrength(),n=255*this.embossWhiteLevel(),r=this.embossDirection(),i=this.embossBlend(),o=e.data,s=e.width,l=e.height,c=4*s;let u=0,h=0,d=l;switch(r){case"top-left":u=-1,h=-1;break;case"top":u=-1,h=0;break;case"top-right":u=-1,h=1;break;case"right":u=0,h=1;break;case"bottom-right":u=1,h=1;break;case"bottom":u=1,h=0;break;case"bottom-left":u=1,h=-1;break;case"left":u=0,h=-1;break;default:a.Util.error("Unknown emboss direction: "+r)}do{const e=(d-1)*c;let r=u;d+r<1&&(r=0),d+r>l&&(r=0);const a=(d-1+r)*s*4;let f=s;do{const r=e+4*(f-1);let l=h;f+l<1&&(l=0),f+l>s&&(l=0);const c=a+4*(f-1+l),u=o[r]-o[c],d=o[r+1]-o[c+1],p=o[r+2]-o[c+2];let m=u;const g=m>0?m:-m;if((d>0?d:-d)>g&&(m=d),(p>0?p:-p)>g&&(m=p),m*=t,i){const e=o[r]+m,t=o[r+1]+m,n=o[r+2]+m;o[r]=e>255?255:e<0?0:e,o[r+1]=t>255?255:t<0?0:t,o[r+2]=n>255?255:n<0?0:n}else{let e=n-m;e<0?e=0:e>255&&(e=255),o[r]=o[r+1]=o[r+2]=e}}while(--f)}while(--d)},r.Factory.addGetterSetter(i.Node,"embossStrength",.5,(0,o.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(i.Node,"embossWhiteLevel",.5,(0,o.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(i.Node,"embossDirection","top-left",void 0,r.Factory.afterSetFilter),r.Factory.addGetterSetter(i.Node,"embossBlend",!1,void 0,r.Factory.afterSetFilter)},3672:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Solarize=void 0;t.Solarize=function(e){const t=e.data,n=e.width,r=4*n;let i=e.height;do{const e=(i-1)*r;let a=n;do{const n=e+4*(a-1);let r=t[n],i=t[n+1],o=t[n+2];r>127&&(r=255-r),i>127&&(i=255-i),o>127&&(o=255-o),t[n]=r,t[n+1]=i,t[n+2]=o}while(--a)}while(--i)}},3693:(e,t,n)=>{var r=n(7736);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},3699:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RGBA=void 0;const r=n(1751),i=n(1189),a=n(9910);t.RGBA=function(e){const t=e.data,n=t.length,r=this.red(),i=this.green(),a=this.blue(),o=this.alpha();for(let s=0;s<n;s+=4){const e=1-o;t[s]=r*o+t[s]*e,t[s+1]=i*o+t[s+1]*e,t[s+2]=a*o+t[s+2]*e}},r.Factory.addGetterSetter(i.Node,"red",0,(function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)})),r.Factory.addGetterSetter(i.Node,"green",0,(function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)})),r.Factory.addGetterSetter(i.Node,"blue",0,a.RGBComponent,r.Factory.afterSetFilter),r.Factory.addGetterSetter(i.Node,"alpha",1,(function(e){return this._filterUpToDate=!1,e>1?1:e<0?0:e}))},3738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3810:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Star=void 0;const r=n(1751),i=n(3304),a=n(9910),o=n(4602);class s extends i.Shape{_sceneFunc(e){const t=this.innerRadius(),n=this.outerRadius(),r=this.numPoints();e.beginPath(),e.moveTo(0,0-n);for(let i=1;i<2*r;i++){const a=i%2===0?n:t,o=a*Math.sin(i*Math.PI/r),s=-1*a*Math.cos(i*Math.PI/r);e.lineTo(o,s)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}t.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,o._registerNode)(s),r.Factory.addGetterSetter(s,"numPoints",5,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(s,"innerRadius",0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(s,"outerRadius",0,(0,a.getNumberValidator)())},3971:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sprite=void 0;const r=n(1751),i=n(3304),a=n(3243),o=n(9910),s=n(4602);class l extends i.Shape{constructor(e){super(e),this._updated=!0,this.anim=new a.Animation((()=>{const e=this._updated;return this._updated=!1,e})),this.on("animationChange.konva",(function(){this.frameIndex(0)})),this.on("frameIndexChange.konva",(function(){this._updated=!0})),this.on("frameRateChange.konva",(function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}))}_sceneFunc(e){const t=this.animation(),n=this.frameIndex(),r=4*n,i=this.animations()[t],a=this.frameOffsets(),o=i[r+0],s=i[r+1],l=i[r+2],c=i[r+3],u=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,l,c),e.closePath(),e.fillStrokeShape(this)),u)if(a){const r=a[t],i=2*n;e.drawImage(u,o,s,l,c,r[i+0],r[i+1],l,c)}else e.drawImage(u,o,s,l,c,0,0,l,c)}_hitFunc(e){const t=this.animation(),n=this.frameIndex(),r=4*n,i=this.animations()[t],a=this.frameOffsets(),o=i[r+2],s=i[r+3];if(e.beginPath(),a){const r=a[t],i=2*n;e.rect(r[i+0],r[i+1],o,s)}else e.rect(0,0,o,s);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval((function(){e._updateIndex()}),1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),t=this.animation();e<this.animations()[t].length/4-1?this.frameIndex(e+1):this.frameIndex(0)}}t.Sprite=l,l.prototype.className="Sprite",(0,s._registerNode)(l),r.Factory.addGetterSetter(l,"animation"),r.Factory.addGetterSetter(l,"animations"),r.Factory.addGetterSetter(l,"frameOffsets"),r.Factory.addGetterSetter(l,"image"),r.Factory.addGetterSetter(l,"frameIndex",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(l,"frameRate",17,(0,o.getNumberValidator)()),r.Factory.backCompat(l,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"})},3994:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FastLayer=void 0;const r=n(7149),i=n(1416),a=n(4602);class o extends i.Layer{constructor(e){super(e),this.listening(!1),r.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}t.FastLayer=o,o.prototype.nodeType="FastLayer",(0,a._registerNode)(o)},4082:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HSL=void 0;const r=n(1751),i=n(1189),a=n(9910);r.Factory.addGetterSetter(i.Node,"hue",0,(0,a.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(i.Node,"saturation",0,(0,a.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(i.Node,"luminance",0,(0,a.getNumberValidator)(),r.Factory.afterSetFilter);t.HSL=function(e){const t=e.data,n=t.length,r=Math.pow(2,this.saturation()),i=Math.abs(this.hue()+360)%360,a=127*this.luminance(),o=1*r*Math.cos(i*Math.PI/180),s=1*r*Math.sin(i*Math.PI/180),l=.299+.701*o+.167*s,c=.587-.587*o+.33*s,u=.114-.114*o-.497*s,h=.299-.299*o-.328*s,d=.587+.413*o+.035*s,f=.114-.114*o+.293*s,p=.299-.3*o+1.25*s,m=.587-.586*o-1.05*s,g=.114+.886*o-.2*s;let v,y,x,b;for(let _=0;_<n;_+=4)v=t[_+0],y=t[_+1],x=t[_+2],b=t[_+3],t[_+0]=l*v+c*y+u*x+a,t[_+1]=h*v+d*y+f*x+a,t[_+2]=p*v+m*y+g*x+a,t[_+3]=b}},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function x(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var b=x.prototype=new y;b.constructor=x,m(b,v.prototype),b.isPureReactComponent=!0;var _=Array.isArray,w=Object.prototype.hasOwnProperty,S={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function D(e,t,r){var i,a={},o=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,i)&&!M.hasOwnProperty(i)&&(a[i]=t[i]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:s,props:a,_owner:S.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,i,a,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===a?"."+A(l,0):a,_(o)?(i="",null!=e&&(i=e.replace(C,"$&/")+"/"),T(o,t,i,"",(function(e){return e}))):null!=o&&(E(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(C,"$&/")+"/")+e)),t.push(o)),1;if(l=0,a=""===a?".":a+":",_(e))for(var c=0;c<e.length;c++){var u=a+A(s=e[c],c);l+=T(s,t,i,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=T(s=s.value,t,i,u=a+A(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function N(e,t,n){if(null==e)return e;var r=[],i=0;return T(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function R(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},F={transition:null},O={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:F,ReactCurrentOwner:S};function I(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:N,forEach:function(e,t,n){N(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=x,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=I,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),a=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)w.call(t,c)&&!M.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:a,ref:o,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=D,t.createFactory=function(e){var t=D.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=F.transition;F.transition={};try{e()}finally{F.transition=t}},t.unstable_act=I,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},4334:(e,t,n)=>{var r=n(7359),i=n(7066),a=n(9016),o=n(9538),s=n(6288),l=n(5262),c=n(2430);c.alea=r,c.xor128=i,c.xorwow=a,c.xorshift7=o,c.xor4096=s,c.tychei=l,e.exports=c},4367:(e,t,n)=>{"use strict";var r=n(2897).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const i=n(7149),a=n(1751),o=n(4598),s=n(4602),l=n(589),c=n(8727),u=n(4602),h=n(9485),d="mouseleave",f="mouseover",p="mouseenter",m="mousemove",g="mousedown",v="mouseup",y="pointermove",x="pointerdown",b="pointerup",_="pointercancel",w="pointerout",S="pointerleave",M="pointerover",D="pointerenter",E="contextmenu",C="touchstart",A="touchend",T="touchmove",N="touchcancel",R="wheel",P=[[p,"_pointerenter"],[g,"_pointerdown"],[m,"_pointermove"],[v,"_pointerup"],[d,"_pointerleave"],[C,"_pointerdown"],[T,"_pointermove"],[A,"_pointerup"],[N,"_pointercancel"],[f,"_pointerover"],[R,"_wheel"],[E,"_contextmenu"],[x,"_pointerdown"],[y,"_pointermove"],[b,"_pointerup"],[_,"_pointercancel"],["lostpointercapture","_lostpointercapture"]],F={mouse:{[w]:"mouseout",[S]:d,[M]:f,[D]:p,[y]:m,[x]:g,[b]:v,[_]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[w]:"touchout",[S]:"touchleave",[M]:"touchover",[D]:"touchenter",[y]:T,[x]:C,[b]:A,[_]:N,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[w]:w,[S]:S,[M]:M,[D]:D,[y]:y,[x]:x,[b]:b,[_]:_,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},O=e=>e.indexOf("pointer")>=0?"pointer":e.indexOf("touch")>=0?"touch":"mouse",I=e=>{const t=O(e);return"pointer"===t?s.Konva.pointerEventsEnabled&&F.pointer:"touch"===t?F.touch:"mouse"===t?F.mouse:void 0};function B(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(e.clipFunc||e.clipWidth||e.clipHeight)&&i.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),e}t.stages=[];class k extends o.Container{constructor(e){super(B(e)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",(()=>{B(this.attrs)})),this._checkVisibility()}_validateAdd(e){const t="Layer"===e.getType(),n="FastLayer"===e.getType();t||n||i.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const e=this.visible()?"":"none";this.content.style.display=e}setContainer(e){if("string"===typeof e){if("."===e.charAt(0)){const t=e.slice(1);e=document.getElementsByClassName(t)[0]}else{var t;t="#"!==e.charAt(0)?e:e.slice(1),e=document.getElementById(t)}if(!e)throw"Can not find container in document with id "+t}return this._setAttr("container",e),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),e.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const e=this.children,t=e.length;for(let n=0;n<t;n++)e[n].clear();return this}clone(e){return e||(e={}),e.container="undefined"!==typeof document&&document.createElement("div"),o.Container.prototype.clone.call(this,e)}destroy(){super.destroy();const e=this.content;e&&i.Util._isInDocument(e)&&this.container().removeChild(e);const n=t.stages.indexOf(this);return n>-1&&t.stages.splice(n,1),i.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const e=this._pointerPositions[0]||this._changedPointerPositions[0];return e?{x:e.x,y:e.y}:(i.Util.warn("Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);"),null)}_getPointerById(e){return this._pointerPositions.find((t=>t.id===e))}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(e){(e=e||{}).x=e.x||0,e.y=e.y||0,e.width=e.width||this.width(),e.height=e.height||this.height();const t=new l.SceneCanvas({width:e.width,height:e.height,pixelRatio:e.pixelRatio||1}),n=t.getContext()._context,r=this.children;return(e.x||e.y)&&n.translate(-1*e.x,-1*e.y),r.forEach((function(t){if(!t.isVisible())return;const r=t._toKonvaCanvas(e);n.drawImage(r._canvas,e.x,e.y,r.getWidth()/r.getPixelRatio(),r.getHeight()/r.getPixelRatio())})),t}getIntersection(e){if(!e)return null;const t=this.children;for(let n=t.length-1;n>=0;n--){const r=t[n].getIntersection(e);if(r)return r}return null}_resizeDOM(){const e=this.width(),t=this.height();this.content&&(this.content.style.width=e+"px",this.content.style.height=t+"px"),this.bufferCanvas.setSize(e,t),this.bufferHitCanvas.setSize(e,t),this.children.forEach((n=>{n.setSize({width:e,height:t}),n.draw()}))}add(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}super.add(e);const a=this.children.length;return a>5&&i.Util.warn("The stage has "+a+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e.setSize({width:this.width(),height:this.height()}),e.draw(),s.Konva.isBrowser&&this.content.appendChild(e.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(e){return h.hasPointerCapture(e,this)}setPointerCapture(e){h.setPointerCapture(e,this)}releaseCapture(e){h.releaseCapture(e,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&P.forEach((e=>{let[t,n]=e;this.content.addEventListener(t,(e=>{this[n](e)}),{passive:!1})}))}_pointerenter(e){this.setPointersPositions(e);const t=I(e.type);t&&this._fire(t.pointerenter,{evt:e,target:this,currentTarget:this})}_pointerover(e){this.setPointersPositions(e);const t=I(e.type);t&&this._fire(t.pointerover,{evt:e,target:this,currentTarget:this})}_getTargetShape(e){let t=this[e+"targetShape"];return t&&!t.getStage()&&(t=null),t}_pointerleave(e){const t=I(e.type),n=O(e.type);if(!t)return;this.setPointersPositions(e);const r=this._getTargetShape(n),i=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;r&&i?(r._fireAndBubble(t.pointerout,{evt:e}),r._fireAndBubble(t.pointerleave,{evt:e}),this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this[n+"targetShape"]=null):i&&(this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this._fire(t.pointerout,{evt:e,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(e){const t=I(e.type),n=O(e.type);if(!t)return;this.setPointersPositions(e);let r=!1;this._changedPointerPositions.forEach((i=>{const a=this.getIntersection(i);if(c.DD.justDragged=!1,s.Konva["_"+n+"ListenClick"]=!0,!a||!a.isListening())return void(this[n+"ClickStartShape"]=void 0);s.Konva.capturePointerEventsEnabled&&a.setPointerCapture(i.id),this[n+"ClickStartShape"]=a,a._fireAndBubble(t.pointerdown,{evt:e,pointerId:i.id}),r=!0;const o=e.type.indexOf("touch")>=0;a.preventDefault()&&e.cancelable&&o&&e.preventDefault()})),r||this._fire(t.pointerdown,{evt:e,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(e){const t=I(e.type),n=O(e.type);if(!t)return;s.Konva.isDragging()&&c.DD.node.preventDefault()&&e.cancelable&&e.preventDefault(),this.setPointersPositions(e);if(!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled))return;const i={};let a=!1;const o=this._getTargetShape(n);this._changedPointerPositions.forEach((s=>{const l=h.getCapturedShape(s.id)||this.getIntersection(s),c=s.id,u={evt:e,pointerId:c},d=o!==l;if(d&&o&&(o._fireAndBubble(t.pointerout,r({},u),l),o._fireAndBubble(t.pointerleave,r({},u),l)),l){if(i[l._id])return;i[l._id]=!0}l&&l.isListening()?(a=!0,d&&(l._fireAndBubble(t.pointerover,r({},u),o),l._fireAndBubble(t.pointerenter,r({},u),o),this[n+"targetShape"]=l),l._fireAndBubble(t.pointermove,r({},u))):o&&(this._fire(t.pointerover,{evt:e,target:this,currentTarget:this,pointerId:c}),this[n+"targetShape"]=null)})),a||this._fire(t.pointermove,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(e){const t=I(e.type),n=O(e.type);if(!t)return;this.setPointersPositions(e);const i=this[n+"ClickStartShape"],a=this[n+"ClickEndShape"],o={};let l=!1;this._changedPointerPositions.forEach((u=>{const d=h.getCapturedShape(u.id)||this.getIntersection(u);if(d){if(d.releaseCapture(u.id),o[d._id])return;o[d._id]=!0}const f=u.id,p={evt:e,pointerId:f};let m=!1;s.Konva["_"+n+"InDblClickWindow"]?(m=!0,clearTimeout(this[n+"DblTimeout"])):c.DD.justDragged||(s.Konva["_"+n+"InDblClickWindow"]=!0,clearTimeout(this[n+"DblTimeout"])),this[n+"DblTimeout"]=setTimeout((function(){s.Konva["_"+n+"InDblClickWindow"]=!1}),s.Konva.dblClickWindow),d&&d.isListening()?(l=!0,this[n+"ClickEndShape"]=d,d._fireAndBubble(t.pointerup,r({},p)),s.Konva["_"+n+"ListenClick"]&&i&&i===d&&(d._fireAndBubble(t.pointerclick,r({},p)),m&&a&&a===d&&d._fireAndBubble(t.pointerdblclick,r({},p)))):(this[n+"ClickEndShape"]=null,s.Konva["_"+n+"ListenClick"]&&this._fire(t.pointerclick,{evt:e,target:this,currentTarget:this,pointerId:f}),m&&this._fire(t.pointerdblclick,{evt:e,target:this,currentTarget:this,pointerId:f}))})),l||this._fire(t.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+n+"ListenClick"]=!1,e.cancelable&&"touch"!==n&&"pointer"!==n&&e.preventDefault()}_contextmenu(e){this.setPointersPositions(e);const t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(E,{evt:e}):this._fire(E,{evt:e,target:this,currentTarget:this})}_wheel(e){this.setPointersPositions(e);const t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(R,{evt:e}):this._fire(R,{evt:e,target:this,currentTarget:this})}_pointercancel(e){this.setPointersPositions(e);const t=h.getCapturedShape(e.pointerId)||this.getIntersection(this.getPointerPosition());t&&t._fireAndBubble(b,h.createEvent(e)),h.releaseCapture(e.pointerId)}_lostpointercapture(e){h.releaseCapture(e.pointerId)}setPointersPositions(e){const t=this._getContentPosition();let n=null,r=null;void 0!==(e=e||window.event).touches?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(e.touches,(e=>{this._pointerPositions.push({id:e.identifier,x:(e.clientX-t.left)/t.scaleX,y:(e.clientY-t.top)/t.scaleY})})),Array.prototype.forEach.call(e.changedTouches||e.touches,(e=>{this._changedPointerPositions.push({id:e.identifier,x:(e.clientX-t.left)/t.scaleX,y:(e.clientY-t.top)/t.scaleY})}))):(n=(e.clientX-t.left)/t.scaleX,r=(e.clientY-t.top)/t.scaleY,this.pointerPos={x:n,y:r},this._pointerPositions=[{x:n,y:r,id:i.Util._getFirstPointerId(e)}],this._changedPointerPositions=[{x:n,y:r,id:i.Util._getFirstPointerId(e)}])}_setPointerPosition(e){i.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(e)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const e=this.content.getBoundingClientRect();return{top:e.top,left:e.left,scaleX:e.width/this.content.clientWidth||1,scaleY:e.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new l.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new l.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const e=this.container();if(!e)throw"Stage has no container. A container is required.";e.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),e.appendChild(this.content),this._resizeDOM()}cache(){return i.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach((function(e){e.batchDraw()})),this}}t.Stage=k,k.prototype.nodeType="Stage",(0,u._registerNode)(k),a.Factory.addGetterSetter(k,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",(()=>{t.stages.forEach((e=>{e.batchDraw()}))}))},4391:(e,t,n)=>{"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4598:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Container=void 0;const r=n(1751),i=n(1189),a=n(9910);class o extends i.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const t=this.children||[],n=[];return t.forEach((function(t){e(t)&&n.push(t)})),n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach((e=>{e.parent=null,e.index=0,e.remove()})),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach((e=>{e.parent=null,e.index=0,e.destroy()})),this.children=[],this._requestDraw(),this}add(){if(0===arguments.length)return this;if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(e<0||arguments.length<=e?void 0:arguments[e]);return this}const e=arguments.length<=0?void 0:arguments[0];return e.getParent()?(e.moveTo(this),this):(this._validateAdd(e),e.index=this.getChildren().length,e.parent=this,e._clearCaches(),this.getChildren().push(e),this._fire("add",{child:e}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){const n=[];return this._descendants((r=>{const i=r._isMatch(e);return i&&n.push(r),!(!i||!t)})),n}_descendants(e){let t=!1;const n=this.getChildren();for(const r of n){if(t=e(r),t)return!0;if(r.hasChildren()&&(t=r._descendants(e),t))return!0}return!1}toObject(){const e=i.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach((t=>{e.children.push(t.toObject())})),e}isAncestorOf(e){let t=e.getParent();for(;t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){const t=i.Node.prototype.clone.call(this,e);return this.getChildren().forEach((function(e){t.add(e.clone())})),t}getAllIntersections(e){const t=[];return this.find("Shape").forEach((n=>{n.isVisible()&&n.intersects(e)&&t.push(n)})),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),this.isCached()||null===(t=this.children)||void 0===t||t.forEach((function(t){t._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;null===(e=this.children)||void 0===e||e.forEach((function(e,t){e.index=t})),this._requestDraw()}drawScene(e,t,n){const r=this.getLayer(),i=e||r&&r.getCanvas(),a=i&&i.getContext(),o=this._getCanvasCache(),s=o&&o.scene,l=i&&i.isCache;if(!this.isVisible()&&!l)return this;if(s){a.save();const e=this.getAbsoluteTransform(t).getMatrix();a.transform(e[0],e[1],e[2],e[3],e[4],e[5]),this._drawCachedSceneCanvas(a),a.restore()}else this._drawChildren("drawScene",i,t,n);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;const n=this.getLayer(),r=e||n&&n.hitCanvas,i=r&&r.getContext(),a=this._getCanvasCache();if(a&&a.hit){i.save();const e=this.getAbsoluteTransform(t).getMatrix();i.transform(e[0],e[1],e[2],e[3],e[4],e[5]),this._drawCachedHitCanvas(i),i.restore()}else this._drawChildren("drawHit",r,t);return this}_drawChildren(e,t,n,r){var i;const a=t&&t.getContext(),o=this.clipWidth(),s=this.clipHeight(),l=this.clipFunc(),c="number"===typeof o&&"number"===typeof s||l,u=n===this;if(c){a.save();const e=this.getAbsoluteTransform(n);let t,r=e.getMatrix();if(a.transform(r[0],r[1],r[2],r[3],r[4],r[5]),a.beginPath(),l)t=l.call(this,a,this);else{const e=this.clipX(),t=this.clipY();a.rect(e||0,t||0,o,s)}a.clip.apply(a,t),r=e.copy().invert().getMatrix(),a.transform(r[0],r[1],r[2],r[3],r[4],r[5])}const h=!u&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===e;h&&(a.save(),a._applyGlobalCompositeOperation(this)),null===(i=this.children)||void 0===i||i.forEach((function(i){i[e](t,n,r)})),h&&a.restore(),c&&a.restore()}getClientRect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const n=e.skipTransform,r=e.relativeTo;let i,a,o,s,l={x:1/0,y:1/0,width:0,height:0};const c=this;null===(t=this.children)||void 0===t||t.forEach((function(t){if(!t.visible())return;const n=t.getClientRect({relativeTo:c,skipShadow:e.skipShadow,skipStroke:e.skipStroke});0===n.width&&0===n.height||(void 0===i?(i=n.x,a=n.y,o=n.x+n.width,s=n.y+n.height):(i=Math.min(i,n.x),a=Math.min(a,n.y),o=Math.max(o,n.x+n.width),s=Math.max(s,n.y+n.height)))}));const u=this.find("Shape");let h=!1;for(let d=0;d<u.length;d++){if(u[d]._isVisible(this)){h=!0;break}}return l=h&&void 0!==i?{x:i,y:a,width:o-i,height:s-a}:{x:0,y:0,width:0,height:0},n?l:this._transformedRect(l,r)}}t.Container=o,r.Factory.addComponentsGetterSetter(o,"clip",["x","y","width","height"]),r.Factory.addGetterSetter(o,"clipX",void 0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(o,"clipY",void 0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(o,"clipWidth",void 0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(o,"clipHeight",void 0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(o,"clipFunc")},4602:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const r=Math.PI/180;t.glob="undefined"!==typeof n.g?n.g:"undefined"!==typeof window?window:"undefined"!==typeof WorkerGlobalScope?self:{},t.Konva={_global:t.glob,version:"9.3.20",isBrowser:"undefined"!==typeof window&&("[object Window]"==={}.toString.call(window)||"[object global]"==={}.toString.call(window)),isUnminified:/param/.test(function(e){}.toString()),dblClickWindow:400,getAngle:e=>t.Konva.angleDeg?e*r:e,enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:"undefined"!==typeof window&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:()=>t.Konva.DD.isDragging,isTransforming(){var e;return null===(e=t.Konva.Transformer)||void 0===e?void 0:e.isTransforming()},isDragReady:()=>!!t.Konva.DD.node,releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(e){t.glob.Konva=e}};t._registerNode=e=>{t.Konva[e.prototype.getClassName()]=e},t.Konva._injectGlobal(t.Konva)},4705:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function a(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{A:()=>a})},4893:e=>{e.exports=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n},e.exports.__esModule=!0,e.exports.default=e.exports},4940:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Wedge=void 0;const r=n(1751),i=n(3304),a=n(4602),o=n(9910),s=n(4602);class l extends i.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,a.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}t.Wedge=l,l.prototype.className="Wedge",l.prototype._centroid=!0,l.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(l),r.Factory.addGetterSetter(l,"radius",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(l,"angle",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(l,"clockwise",!1),r.Factory.backCompat(l,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"})},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},5053:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mask=void 0;const r=n(1751),i=n(1189),a=n(9910);function o(e,t,n){let r=4*(n*e.width+t);const i=[];return i.push(e.data[r++],e.data[r++],e.data[r++],e.data[r++]),i}function s(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}t.Mask=function(e){let t=function(e,t){const n=o(e,0,0),r=o(e,e.width-1,0),i=o(e,0,e.height-1),a=o(e,e.width-1,e.height-1),l=t||10;if(s(n,r)<l&&s(r,a)<l&&s(a,i)<l&&s(i,n)<l){const t=function(e){const t=[0,0,0];for(let n=0;n<e.length;n++)t[0]+=e[n][0],t[1]+=e[n][1],t[2]+=e[n][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}([r,n,a,i]),o=[];for(let n=0;n<e.width*e.height;n++){const r=s(t,[e.data[4*n],e.data[4*n+1],e.data[4*n+2]]);o[n]=r<l?0:255}return o}}(e,this.threshold());return t&&(t=function(e,t,n){const r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),a=Math.floor(i/2),o=[];for(let s=0;s<n;s++)for(let l=0;l<t;l++){const c=s*t+l;let u=0;for(let o=0;o<i;o++)for(let c=0;c<i;c++){const h=s+o-a,d=l+c-a;if(h>=0&&h<n&&d>=0&&d<t){const n=r[o*i+c];u+=e[h*t+d]*n}}o[c]=2040===u?255:0}return o}(t,e.width,e.height),t=function(e,t,n){const r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),a=Math.floor(i/2),o=[];for(let s=0;s<n;s++)for(let l=0;l<t;l++){const c=s*t+l;let u=0;for(let o=0;o<i;o++)for(let c=0;c<i;c++){const h=s+o-a,d=l+c-a;if(h>=0&&h<n&&d>=0&&d<t){const n=r[o*i+c];u+=e[h*t+d]*n}}o[c]=u>=1020?255:0}return o}(t,e.width,e.height),t=function(e,t,n){const r=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],i=Math.round(Math.sqrt(r.length)),a=Math.floor(i/2),o=[];for(let s=0;s<n;s++)for(let l=0;l<t;l++){const c=s*t+l;let u=0;for(let o=0;o<i;o++)for(let c=0;c<i;c++){const h=s+o-a,d=l+c-a;if(h>=0&&h<n&&d>=0&&d<t){const n=r[o*i+c];u+=e[h*t+d]*n}}o[c]=u}return o}(t,e.width,e.height),function(e,t){for(let n=0;n<e.width*e.height;n++)e.data[4*n+3]=t[n]}(e,t)),e},r.Factory.addGetterSetter(i.Node,"threshold",0,(0,a.getNumberValidator)(),r.Factory.afterSetFilter)},5191:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const r=n(8065),i=n(9144),a=n(1801),o=n(1618),s=n(9554),l=n(2941),c=n(6494),u=n(5804),h=n(7289),d=n(1300),f=n(7980),p=n(1008),m=n(3971),g=n(3810),v=n(3169),y=n(1222),x=n(3535),b=n(4940),_=n(2672),w=n(8098),S=n(5783),M=n(3602),D=n(2715),E=n(2078),C=n(4082),A=n(2544),T=n(7205),N=n(8332),R=n(5053),P=n(9195),F=n(1485),O=n(7264),I=n(1518),B=n(3699),k=n(8019),L=n(3672),U=n(1126);t.Konva=r.Konva.Util._assign(r.Konva,{Arc:i.Arc,Arrow:a.Arrow,Circle:o.Circle,Ellipse:s.Ellipse,Image:l.Image,Label:c.Label,Tag:c.Tag,Line:u.Line,Path:h.Path,Rect:d.Rect,RegularPolygon:f.RegularPolygon,Ring:p.Ring,Sprite:m.Sprite,Star:g.Star,Text:v.Text,TextPath:y.TextPath,Transformer:x.Transformer,Wedge:b.Wedge,Filters:{Blur:_.Blur,Brighten:w.Brighten,Contrast:S.Contrast,Emboss:M.Emboss,Enhance:D.Enhance,Grayscale:E.Grayscale,HSL:C.HSL,HSV:A.HSV,Invert:T.Invert,Kaleidoscope:N.Kaleidoscope,Mask:R.Mask,Noise:P.Noise,Pixelate:F.Pixelate,Posterize:O.Posterize,RGB:I.RGB,RGBA:B.RGBA,Sepia:k.Sepia,Solarize:L.Solarize,Threshold:U.Threshold}})},5242:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const r=n(7149),i=n(3243),a=n(1189),o=n(4602),s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},l=["fill","stroke","shadowColor"];let c=0;class u{constructor(e,t,n,r,i,a,o){this.prop=e,this.propFunc=t,this.begin=r,this._pos=r,this.duration=a,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=i-this.begin,this.pause()}fire(e){const t=this[e];t&&t()}setTime(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():e<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())}getTime(){return this._time}setPosition(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e}getPosition(e){return void 0===e&&(e=this._time),this.func(e,this.begin,this._change,this.duration)}play(){this.state=2,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(e){this.pause(),this._time=e,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const e=this.getTimer()-this._startTime;2===this.state?this.setTime(e):3===this.state&&this.setTime(this.duration-e)}pause(){this.state=1,this.fire("onPause")}getTimer(){return(new Date).getTime()}}class h{constructor(e){const n=this,a=e.node,l=a._id,d=e.easing||t.Easings.Linear,f=!!e.yoyo;let p,m;p="undefined"===typeof e.duration?.3:0===e.duration?.001:e.duration,this.node=a,this._id=c++;const g=a.getLayer()||(a instanceof o.Konva.Stage?a.getLayers():null);for(m in g||r.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new i.Animation((function(){n.tween.onEnterFrame()}),g),this.tween=new u(m,(function(e){n._tweenFunc(e)}),d,0,1,1e3*p,f),this._addListeners(),h.attrs[l]||(h.attrs[l]={}),h.attrs[l][this._id]||(h.attrs[l][this._id]={}),h.tweens[l]||(h.tweens[l]={}),e)void 0===s[m]&&this._addAttr(m,e[m]);this.reset(),this.onFinish=e.onFinish,this.onReset=e.onReset,this.onUpdate=e.onUpdate}_addAttr(e,t){const n=this.node,i=n._id;let a,o,s,c,u;const d=h.tweens[i][e];d&&delete h.attrs[i][d][e];let f=n.getAttr(e);if(r.Util._isArray(t))if(a=[],o=Math.max(t.length,f.length),"points"===e&&t.length!==f.length&&(t.length>f.length?(c=f,f=r.Util._prepareArrayForTween(f,t,n.closed())):(s=t,t=r.Util._prepareArrayForTween(t,f,n.closed()))),0===e.indexOf("fill"))for(let l=0;l<o;l++)if(l%2===0)a.push(t[l]-f[l]);else{const e=r.Util.colorToRGBA(f[l]);u=r.Util.colorToRGBA(t[l]),f[l]=e,a.push({r:u.r-e.r,g:u.g-e.g,b:u.b-e.b,a:u.a-e.a})}else for(let r=0;r<o;r++)a.push(t[r]-f[r]);else-1!==l.indexOf(e)?(f=r.Util.colorToRGBA(f),u=r.Util.colorToRGBA(t),a={r:u.r-f.r,g:u.g-f.g,b:u.b-f.b,a:u.a-f.a}):a=t-f;h.attrs[i][this._id][e]={start:f,diff:a,end:t,trueEnd:s,trueStart:c},h.tweens[i][e]=this._id}_tweenFunc(e){const t=this.node,n=h.attrs[t._id][this._id];let i,a,o,s,c,u,d,f;for(i in n){if(a=n[i],o=a.start,s=a.diff,f=a.end,r.Util._isArray(o))if(c=[],d=Math.max(o.length,f.length),0===i.indexOf("fill"))for(u=0;u<d;u++)u%2===0?c.push((o[u]||0)+s[u]*e):c.push("rgba("+Math.round(o[u].r+s[u].r*e)+","+Math.round(o[u].g+s[u].g*e)+","+Math.round(o[u].b+s[u].b*e)+","+(o[u].a+s[u].a*e)+")");else for(u=0;u<d;u++)c.push((o[u]||0)+s[u]*e);else c=-1!==l.indexOf(i)?"rgba("+Math.round(o.r+s.r*e)+","+Math.round(o.g+s.g*e)+","+Math.round(o.b+s.b*e)+","+(o.a+s.a*e)+")":o+s*e;t.setAttr(i,c)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const e=this.node,t=h.attrs[e._id][this._id];t.points&&t.points.trueEnd&&e.setAttr("points",t.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const e=this.node,t=h.attrs[e._id][this._id];t.points&&t.points.trueStart&&e.points(t.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(e){return this.tween.seek(1e3*e),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const e=this.node._id,t=this._id,n=h.tweens[e];this.pause();for(const r in n)delete h.tweens[e][r];delete h.attrs[e][t]}}t.Tween=h,h.attrs={},h.tweens={},a.Node.prototype.to=function(e){const t=e.onFinish;e.node=this,e.onFinish=function(){this.destroy(),t&&t()};new h(e).play()},t.Easings={BackEaseIn(e,t,n,r){const i=1.70158;return n*(e/=r)*e*((i+1)*e-i)+t},BackEaseOut(e,t,n,r){const i=1.70158;return n*((e=e/r-1)*e*((i+1)*e+i)+1)+t},BackEaseInOut(e,t,n,r){let i=1.70158;return(e/=r/2)<1?n/2*(e*e*((1+(i*=1.525))*e-i))+t:n/2*((e-=2)*e*((1+(i*=1.525))*e+i)+2)+t},ElasticEaseIn(e,t,n,r,i,a){let o=0;return 0===e?t:1===(e/=r)?t+n:(a||(a=.3*r),!i||i<Math.abs(n)?(i=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/i),-i*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*(2*Math.PI)/a)+t)},ElasticEaseOut(e,t,n,r,i,a){let o=0;return 0===e?t:1===(e/=r)?t+n:(a||(a=.3*r),!i||i<Math.abs(n)?(i=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/i),i*Math.pow(2,-10*e)*Math.sin((e*r-o)*(2*Math.PI)/a)+n+t)},ElasticEaseInOut(e,t,n,r,i,a){let o=0;return 0===e?t:2===(e/=r/2)?t+n:(a||(a=r*(.3*1.5)),!i||i<Math.abs(n)?(i=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/i),e<1?i*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*(2*Math.PI)/a)*-.5+t:i*Math.pow(2,-10*(e-=1))*Math.sin((e*r-o)*(2*Math.PI)/a)*.5+n+t)},BounceEaseOut:(e,t,n,r)=>(e/=r)<1/2.75?n*(7.5625*e*e)+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t,BounceEaseIn:(e,n,r,i)=>r-t.Easings.BounceEaseOut(i-e,0,r,i)+n,BounceEaseInOut:(e,n,r,i)=>e<i/2?.5*t.Easings.BounceEaseIn(2*e,0,r,i)+n:.5*t.Easings.BounceEaseOut(2*e-i,0,r,i)+.5*r+n,EaseIn:(e,t,n,r)=>n*(e/=r)*e+t,EaseOut:(e,t,n,r)=>-n*(e/=r)*(e-2)+t,EaseInOut:(e,t,n,r)=>(e/=r/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t,StrongEaseIn:(e,t,n,r)=>n*(e/=r)*e*e*e*e+t,StrongEaseOut:(e,t,n,r)=>n*((e=e/r-1)*e*e*e*e+1)+t,StrongEaseInOut:(e,t,n,r)=>(e/=r/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t,Linear:(e,t,n,r)=>n*e/r+t}},5262:function(e,t,n){var r;!function(e,i){function a(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new a(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.tychei=s}(0,e=n.nmd(e),n.amdD)},5422:function(e){e.exports=function(){"use strict";function e(){return!0}function t(){return!1}function n(){}const r="Argument is not a typed-function.";function i(){function a(e){return"object"===typeof e&&null!==e&&e.constructor===Object}const o=[{name:"number",test:function(e){return"number"===typeof e}},{name:"string",test:function(e){return"string"===typeof e}},{name:"boolean",test:function(e){return"boolean"===typeof e}},{name:"Function",test:function(e){return"function"===typeof e}},{name:"Array",test:Array.isArray},{name:"Date",test:function(e){return e instanceof Date}},{name:"RegExp",test:function(e){return e instanceof RegExp}},{name:"Object",test:a},{name:"null",test:function(e){return null===e}},{name:"undefined",test:function(e){return void 0===e}}],s={name:"any",test:e,isAny:!0};let l,c,u=0,h={createCount:0};function d(e){const t=l.get(e);if(t)return t;let n='Unknown type "'+e+'"';const r=e.toLowerCase();let i;for(i of c)if(i.toLowerCase()===r){n+='. Did you mean "'+i+'" ?';break}throw new TypeError(n)}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"any";const n=t?d(t).index:c.length,r=[];for(let a=0;a<e.length;++a){if(!e[a]||"string"!==typeof e[a].name||"function"!==typeof e[a].test)throw new TypeError("Object with properties {name: string, test: function} expected");const t=e[a].name;if(l.has(t))throw new TypeError('Duplicate type name "'+t+'"');r.push(t),l.set(t,{name:t,test:e[a].test,isAny:e[a].isAny,index:n+a,conversionsTo:[]})}const i=c.slice(n);c=c.slice(0,n).concat(r).concat(i);for(let a=n+r.length;a<c.length;++a)l.get(c[a]).index=a}function p(){l=new Map,c=[],u=0,f([s],!1)}function m(){let e;for(e of c)l.get(e).conversionsTo=[];u=0}function g(e){const t=c.filter((t=>{const n=l.get(t);return!n.isAny&&n.test(e)}));return t.length?t:["any"]}function v(e){return e&&"function"===typeof e&&"_typedFunctionData"in e}function y(e,t,n){if(!v(e))throw new TypeError(r);const i=n&&n.exact,a=D(Array.isArray(t)?t.join(","):t),o=_(a);if(!i||o in e.signatures){const t=e._typedFunctionData.signatureMap.get(o);if(t)return t}const s=a.length;let l,c;if(i){let t;for(t in l=[],e.signatures)l.push(e._typedFunctionData.signatureMap.get(t))}else l=e._typedFunctionData.signatures;for(let r=0;r<s;++r){const e=a[r],t=[];let n;for(n of l){const i=T(n.params,r);if(i&&(!e.restParam||i.restParam)){if(!i.hasAny){const t=M(i);if(e.types.some((e=>!t.has(e.name))))continue}t.push(n)}}if(l=t,0===l.length)break}for(c of l)if(c.params.length<=s)return c;throw new TypeError("Signature not found (signature: "+(e.name||"unnamed")+"("+_(a,", ")+"))")}function x(e,t,n){return y(e,t,n).implementation}function b(e,t){const n=d(t);if(n.test(e))return e;const r=n.conversionsTo;if(0===r.length)throw new Error("There are no conversions to "+t+" defined.");for(let i=0;i<r.length;i++)if(d(r[i].from).test(e))return r[i].convert(e);throw new Error("Cannot convert "+e+" to "+t)}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return e.map((e=>e.name)).join(t)}function w(e){const t=0===e.indexOf("..."),n=(t?e.length>3?e.slice(3):"any":e).split("|").map((e=>d(e.trim())));let r=!1,i=t?"...":"";return{types:n.map((function(e){return r=e.isAny||r,i+=e.name+"|",{name:e.name,typeIndex:e.index,test:e.test,isAny:e.isAny,conversion:null,conversionIndex:-1}})),name:i.slice(0,-1),hasAny:r,hasConversion:!1,restParam:t}}function S(e){const t=L(e.types.map((e=>e.name)));let n=e.hasAny,r=e.name;const i=t.map((function(e){const t=d(e.from);return n=t.isAny||n,r+="|"+e.from,{name:e.from,typeIndex:t.index,test:t.test,isAny:t.isAny,conversion:e,conversionIndex:e.index}}));return{types:e.types.concat(i),name:r,hasAny:n,hasConversion:i.length>0,restParam:e.restParam}}function M(e){return e.typeSet||(e.typeSet=new Set,e.types.forEach((t=>e.typeSet.add(t.name)))),e.typeSet}function D(e){const t=[];if("string"!==typeof e)throw new TypeError("Signatures must be strings");const n=e.trim();if(""===n)return t;const r=n.split(",");for(let i=0;i<r.length;++i){const e=w(r[i].trim());if(e.restParam&&i!==r.length-1)throw new SyntaxError('Unexpected rest parameter "'+r[i]+'": only allowed for the last parameter');if(0===e.types.length)return null;t.push(e)}return t}function E(e){const t=K(e);return!!t&&t.restParam}function C(t){if(t&&0!==t.types.length){if(1===t.types.length)return d(t.types[0].name).test;if(2===t.types.length){const e=d(t.types[0].name).test,n=d(t.types[1].name).test;return function(t){return e(t)||n(t)}}{const e=t.types.map((function(e){return d(e.name).test}));return function(t){for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1}}}return e}function A(e){let t,n,r;if(E(e)){t=Z(e).map(C);const n=t.length,r=C(K(e)),i=function(e){for(let t=n;t<e.length;t++)if(!r(e[t]))return!1;return!0};return function(e){for(let n=0;n<t.length;n++)if(!t[n](e[n]))return!1;return i(e)&&e.length>=n+1}}return 0===e.length?function(e){return 0===e.length}:1===e.length?(n=C(e[0]),function(e){return n(e[0])&&1===e.length}):2===e.length?(n=C(e[0]),r=C(e[1]),function(e){return n(e[0])&&r(e[1])&&2===e.length}):(t=e.map(C),function(e){for(let n=0;n<t.length;n++)if(!t[n](e[n]))return!1;return e.length===t.length})}function T(e,t){return t<e.length?e[t]:E(e)?K(e):null}function N(e,t){const n=T(e,t);return n?M(n):new Set}function R(e){return null===e.conversion||void 0===e.conversion}function P(e,t){const n=new Set;return e.forEach((e=>{const r=N(e.params,t);let i;for(i of r)n.add(i)})),n.has("any")?["any"]:Array.from(n)}function F(e,t,n){let r,i;const a=e||"unnamed";let o,s=n;for(o=0;o<t.length;o++){const e=[];if(s.forEach((n=>{const r=C(T(n.params,o));(o<n.params.length||E(n.params))&&r(t[o])&&e.push(n)})),0===e.length){if(i=P(s,o),i.length>0){const e=g(t[o]);return r=new TypeError("Unexpected type of argument in function "+a+" (expected: "+i.join(" or ")+", actual: "+e.join(" | ")+", index: "+o+")"),r.data={category:"wrongType",fn:a,index:o,actual:e,expected:i},r}}else s=e}const l=s.map((function(e){return E(e.params)?1/0:e.params.length}));if(t.length<Math.min.apply(null,l))return i=P(s,o),r=new TypeError("Too few arguments in function "+a+" (expected: "+i.join(" or ")+", index: "+t.length+")"),r.data={category:"tooFewArgs",fn:a,index:t.length,expected:i},r;const c=Math.max.apply(null,l);if(t.length>c)return r=new TypeError("Too many arguments in function "+a+" (expected: "+c+", actual: "+t.length+")"),r.data={category:"tooManyArgs",fn:a,index:t.length,expectedLength:c},r;const u=[];for(let h=0;h<t.length;++h)u.push(g(t[h]).join("|"));return r=new TypeError('Arguments of type "'+u.join(", ")+'" do not match any of the defined signatures of function '+a+"."),r.data={category:"mismatch",actual:u},r}function O(e){let t=c.length+1;for(let n=0;n<e.types.length;n++)R(e.types[n])&&(t=Math.min(t,e.types[n].typeIndex));return t}function I(e){let t=u+1;for(let n=0;n<e.types.length;n++)R(e.types[n])||(t=Math.min(t,e.types[n].conversionIndex));return t}function B(e,t){if(e.hasAny){if(!t.hasAny)return 1}else if(t.hasAny)return-1;if(e.restParam){if(!t.restParam)return 1}else if(t.restParam)return-1;if(e.hasConversion){if(!t.hasConversion)return 1}else if(t.hasConversion)return-1;const n=O(e)-O(t);if(n<0)return-1;if(n>0)return 1;const r=I(e)-I(t);return r<0?-1:r>0?1:0}function k(e,t){const n=e.params,r=t.params,i=K(n),a=K(r),o=E(n),s=E(r);if(o&&i.hasAny){if(!s||!a.hasAny)return 1}else if(s&&a.hasAny)return-1;let l,c=0,u=0;for(l of n)l.hasAny&&++c,l.hasConversion&&++u;let h=0,d=0;for(l of r)l.hasAny&&++h,l.hasConversion&&++d;if(c!==h)return c-h;if(o&&i.hasConversion){if(!s||!a.hasConversion)return 1}else if(s&&a.hasConversion)return-1;if(u!==d)return u-d;if(o){if(!s)return 1}else if(s)return-1;const f=(n.length-r.length)*(o?-1:1);if(0!==f)return f;const p=[];let m,g=0;for(let v=0;v<n.length;++v){const e=B(n[v],r[v]);p.push(e),g+=e}if(0!==g)return g;for(m of p)if(0!==m)return m;return 0}function L(e){if(0===e.length)return[];const t=e.map(d);e.length>1&&t.sort(((e,t)=>e.index-t.index));let n=t[0].conversionsTo;if(1===e.length)return n;n=n.concat([]);const r=new Set(e);for(let i=1;i<t.length;++i){let e;for(e of t[i].conversionsTo)r.has(e.from)||(n.push(e),r.add(e.from))}return n}function U(e,t){let n=t;if(e.some((e=>e.hasConversion))){const r=E(e),i=e.map(z);n=function(){const e=[],n=r?arguments.length-1:arguments.length;for(let t=0;t<n;t++)e[t]=i[t](arguments[t]);return r&&(e[n]=arguments[n].map(i[n])),t.apply(this,e)}}let r=n;if(E(e)){const t=e.length-1;r=function(){return n.apply(this,Q(arguments,0,t).concat([Q(arguments,t)]))}}return r}function z(e){let t,n,r,i;const a=[],o=[];switch(e.types.forEach((function(e){e.conversion&&(a.push(d(e.conversion.from).test),o.push(e.conversion.convert))})),o.length){case 0:return function(e){return e};case 1:return t=a[0],r=o[0],function(e){return t(e)?r(e):e};case 2:return t=a[0],n=a[1],r=o[0],i=o[1],function(e){return t(e)?r(e):n(e)?i(e):e};default:return function(e){for(let t=0;t<o.length;t++)if(a[t](e))return o[t](e);return e}}}function H(e){function t(e,n,r){if(n<e.length){const i=e[n];let a=[];if(i.restParam){const e=i.types.filter(R);e.length<i.types.length&&a.push({types:e,name:"..."+e.map((e=>e.name)).join("|"),hasAny:e.some((e=>e.isAny)),hasConversion:!1,restParam:!0}),a.push(i)}else a=i.types.map((function(e){return{types:[e],name:e.name,hasAny:e.isAny,hasConversion:e.conversion,restParam:!1}}));return $(a,(function(i){return t(e,n+1,r.concat([i]))}))}return[r]}return t(e,0,[])}function V(e,t){const n=Math.max(e.length,t.length);for(let s=0;s<n;s++){const n=N(e,s),r=N(t,s);let i,a=!1;for(i of r)if(n.has(i)){a=!0;break}if(!a)return!1}const r=e.length,i=t.length,a=E(e),o=E(t);return a?o?r===i:i>=r:o?r>=i:r===i}function G(e){return e.map((e=>ie(e)?ne(e.referToSelf.callback):re(e)?te(e.referTo.references,e.referTo.callback):e))}function q(e,t,n){const r=[];let i;for(i of e){let e=n[i];if("number"!==typeof e)throw new TypeError('No definition for referenced signature "'+i+'"');if(e=t[e],"function"!==typeof e)return!1;r.push(e)}return r}function j(e,t,n){const r=G(e),i=new Array(r.length).fill(!1);let a=!0;for(;a;){a=!1;let e=!0;for(let o=0;o<r.length;++o){if(i[o])continue;const s=r[o];if(ie(s))r[o]=s.referToSelf.callback(n),r[o].referToSelf=s.referToSelf,i[o]=!0,e=!1;else if(re(s)){const n=q(s.referTo.references,r,t);n?(r[o]=s.referTo.callback.apply(this,n),r[o].referTo=s.referTo,i[o]=!0,e=!1):a=!0}}if(e&&a)throw new SyntaxError("Circular reference detected in resolving typed.referTo")}return r}function W(e){const t=/\bthis(\(|\.signatures\b)/;Object.keys(e).forEach((n=>{const r=e[n];if(t.test(r.toString()))throw new SyntaxError("Using `this` to self-reference a function is deprecated since typed-function@3. Use typed.referTo and typed.referToSelf instead.")}))}function X(e,r){if(h.createCount++,0===Object.keys(r).length)throw new SyntaxError("No signatures provided");h.warnAgainstDeprecatedThis&&W(r);const i=[],a=[],o={},s=[];let l;for(l in r){if(!Object.prototype.hasOwnProperty.call(r,l))continue;const e=D(l);if(!e)continue;i.forEach((function(t){if(V(t,e))throw new TypeError('Conflicting signatures "'+_(t)+'" and "'+_(e)+'".')})),i.push(e);const t=a.length;a.push(r[l]);const n=e.map(S);let c;for(c of H(n)){const e=_(c);s.push({params:c,name:e,fn:t}),c.every((e=>!e.hasConversion))&&(o[e]=t)}}s.sort(k);const c=j(a,o,le);let u;for(u in o)Object.prototype.hasOwnProperty.call(o,u)&&(o[u]=c[o[u]]);const d=[],f=new Map;for(u of s)f.has(u.name)||(u.fn=c[u.fn],d.push(u),f.set(u.name,u));const p=d[0]&&d[0].params.length<=2&&!E(d[0].params),m=d[1]&&d[1].params.length<=2&&!E(d[1].params),g=d[2]&&d[2].params.length<=2&&!E(d[2].params),v=d[3]&&d[3].params.length<=2&&!E(d[3].params),y=d[4]&&d[4].params.length<=2&&!E(d[4].params),x=d[5]&&d[5].params.length<=2&&!E(d[5].params),b=p&&m&&g&&v&&y&&x;for(let t=0;t<d.length;++t)d[t].test=A(d[t].params);const w=p?C(d[0].params[0]):t,M=m?C(d[1].params[0]):t,T=g?C(d[2].params[0]):t,N=v?C(d[3].params[0]):t,R=y?C(d[4].params[0]):t,P=x?C(d[5].params[0]):t,F=p?C(d[0].params[1]):t,O=m?C(d[1].params[1]):t,I=g?C(d[2].params[1]):t,B=v?C(d[3].params[1]):t,L=y?C(d[4].params[1]):t,z=x?C(d[5].params[1]):t;for(let t=0;t<d.length;++t)d[t].implementation=U(d[t].params,d[t].fn);const G=p?d[0].implementation:n,q=m?d[1].implementation:n,X=g?d[2].implementation:n,Y=v?d[3].implementation:n,Z=y?d[4].implementation:n,K=x?d[5].implementation:n,Q=p?d[0].params.length:-1,J=m?d[1].params.length:-1,$=g?d[2].params.length:-1,ee=v?d[3].params.length:-1,te=y?d[4].params.length:-1,ne=x?d[5].params.length:-1,re=b?6:0,ie=d.length,ae=d.map((e=>e.test)),oe=d.map((e=>e.implementation)),se=function(){for(let e=re;e<ie;e++)if(ae[e](arguments))return oe[e].apply(this,arguments);return h.onMismatch(e,arguments,d)};function le(e,t){return arguments.length===Q&&w(e)&&F(t)?G.apply(this,arguments):arguments.length===J&&M(e)&&O(t)?q.apply(this,arguments):arguments.length===$&&T(e)&&I(t)?X.apply(this,arguments):arguments.length===ee&&N(e)&&B(t)?Y.apply(this,arguments):arguments.length===te&&R(e)&&L(t)?Z.apply(this,arguments):arguments.length===ne&&P(e)&&z(t)?K.apply(this,arguments):se.apply(this,arguments)}try{Object.defineProperty(le,"name",{value:e})}catch(ce){}return le.signatures=o,le._typedFunctionData={signatures:d,signatureMap:f},le}function Y(e,t,n){throw F(e,t,n)}function Z(e){return Q(e,0,e.length-1)}function K(e){return e[e.length-1]}function Q(e,t,n){return Array.prototype.slice.call(e,t,n)}function J(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return e[n]}function $(e,t){return Array.prototype.concat.apply([],e.map(t))}function ee(){const e=Z(arguments).map((e=>_(D(e)))),t=K(arguments);if("function"!==typeof t)throw new TypeError("Callback function expected as last argument");return te(e,t)}function te(e,t){return{referTo:{references:e,callback:t}}}function ne(e){if("function"!==typeof e)throw new TypeError("Callback function expected as first argument");return{referToSelf:{callback:e}}}function re(e){return e&&"object"===typeof e.referTo&&Array.isArray(e.referTo.references)&&"function"===typeof e.referTo.callback}function ie(e){return e&&"object"===typeof e.referToSelf&&"function"===typeof e.referToSelf.callback}function ae(e,t){if(!e)return t;if(t&&t!==e){const n=new Error("Function names do not match (expected: "+e+", actual: "+t+")");throw n.data={actual:t,expected:e},n}return e}function oe(e){let t;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(v(e[n])||"string"===typeof e[n].signature)&&(t=ae(t,e[n].name));return t}function se(e,t){let n;for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(n in e&&t[n]!==e[n]){const r=new Error('Signature "'+n+'" is defined twice');throw r.data={signature:n,sourceFunction:t[n],destFunction:e[n]},r}e[n]=t[n]}}p(),f(o);const le=h;function ce(e){if(!e||"string"!==typeof e.from||"string"!==typeof e.to||"function"!==typeof e.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");if(e.to===e.from)throw new SyntaxError('Illegal to define conversion from "'+e.from+'" to itself.')}return h=function(e){const t="string"===typeof e;let n=t?e:"";const r={};for(let i=t?1:0;i<arguments.length;++i){const e=arguments[i];let o,s={};if("function"===typeof e?(o=e.name,"string"===typeof e.signature?s[e.signature]=e:v(e)&&(s=e.signatures)):a(e)&&(s=e,t||(o=oe(e))),0===Object.keys(s).length){const t=new TypeError("Argument to 'typed' at index "+i+" is not a (typed) function, nor an object with signatures as keys and functions as values.");throw t.data={index:i,argument:e},t}t||(n=ae(n,o)),se(r,s)}return X(n||"",r)},h.create=i,h.createCount=le.createCount,h.onMismatch=Y,h.throwMismatchError=Y,h.createError=F,h.clear=p,h.clearConversions=m,h.addTypes=f,h._findType=d,h.referTo=ee,h.referToSelf=ne,h.convert=b,h.findSignature=y,h.find=x,h.isTypedFunction=v,h.warnAgainstDeprecatedThis=!0,h.addType=function(e,t){let n="any";!1!==t&&l.has("Object")&&(n="Object"),h.addTypes([e],n)},h.addConversion=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{override:!1};ce(e);const n=d(e.to),r=n.conversionsTo.find((t=>t.from===e.from));if(r){if(!t||!t.override)throw new Error('There is already a conversion from "'+e.from+'" to "'+n.name+'"');h.removeConversion({from:r.from,to:e.to,convert:r.convert})}n.conversionsTo.push({from:e.from,convert:e.convert,index:u++})},h.addConversions=function(e,t){e.forEach((e=>h.addConversion(e,t)))},h.removeConversion=function(e){ce(e);const t=d(e.to),n=J(t.conversionsTo,(t=>t.from===e.from));if(!n)throw new Error("Attempt to remove nonexistent conversion from "+e.from+" to "+e.to);if(n.convert!==e.convert)throw new Error("Conversion to remove does not match existing conversion");const r=t.conversionsTo.indexOf(n);t.conversionsTo.splice(r,1)},h.resolve=function(e,t){if(!v(e))throw new TypeError(r);const n=e._typedFunctionData.signatures;for(let r=0;r<n.length;++r)if(n[r].test(t))return n[r];return null},h}return i()}()},5783:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Contrast=void 0;const r=n(1751),i=n(1189),a=n(9910);t.Contrast=function(e){const t=Math.pow((this.contrast()+100)/100,2),n=e.data,r=n.length;let i=150,a=150,o=150;for(let s=0;s<r;s+=4)i=n[s],a=n[s+1],o=n[s+2],i/=255,i-=.5,i*=t,i+=.5,i*=255,a/=255,a-=.5,a*=t,a+=.5,a*=255,o/=255,o-=.5,o*=t,o+=.5,o*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,o=o<0?0:o>255?255:o,n[s]=i,n[s+1]=a,n[s+2]=o},r.Factory.addGetterSetter(i.Node,"contrast",0,(0,a.getNumberValidator)(),r.Factory.afterSetFilter)},5804:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Line=void 0;const r=n(1751),i=n(4602),a=n(3304),o=n(9910);function s(e,t,n,r,i,a,o){const s=Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2)),l=Math.sqrt(Math.pow(i-n,2)+Math.pow(a-r,2)),c=o*s/(s+l),u=o*l/(s+l);return[n-c*(i-e),r-c*(a-t),n+u*(i-e),r+u*(a-t)]}function l(e,t){const n=e.length,r=[];for(let i=2;i<n-2;i+=2){const n=s(e[i-2],e[i-1],e[i],e[i+1],e[i+2],e[i+3],t);isNaN(n[0])||(r.push(n[0]),r.push(n[1]),r.push(e[i]),r.push(e[i+1]),r.push(n[2]),r.push(n[3]))}return r}class c extends a.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",(function(){this._clearCache("tensionPoints")}))}_sceneFunc(e){let t,n,r,i=this.points(),a=i.length,o=this.tension(),s=this.closed(),l=this.bezier();if(a){if(e.beginPath(),e.moveTo(i[0],i[1]),0!==o&&a>4){for(t=this.getTensionPoints(),n=t.length,r=s?0:4,s||e.quadraticCurveTo(t[0],t[1],t[2],t[3]);r<n-2;)e.bezierCurveTo(t[r++],t[r++],t[r++],t[r++],t[r++],t[r++]);s||e.quadraticCurveTo(t[n-2],t[n-1],i[a-2],i[a-1])}else if(l)for(r=2;r<a;)e.bezierCurveTo(i[r++],i[r++],i[r++],i[r++],i[r++],i[r++]);else for(r=2;r<a;r+=2)e.lineTo(i[r],i[r+1]);s?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():l(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),t=e.length,n=this.tension(),r=s(e[t-2],e[t-1],e[0],e[1],e[2],e[3],n),i=s(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],n),a=l(e,n);return[r[2],r[3]].concat(a).concat([i[0],i[1],e[t-2],e[t-1],i[2],i[3],r[0],r[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};e=0!==this.tension()?[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:this.points();let t,n,r=e[0],i=e[0],a=e[1],o=e[1];for(let s=0;s<e.length/2;s++)t=e[2*s],n=e[2*s+1],r=Math.min(r,t),i=Math.max(i,t),a=Math.min(a,n),o=Math.max(o,n);return{x:r,y:a,width:i-r,height:o-a}}}t.Line=c,c.prototype.className="Line",c.prototype._attrsAffectingSize=["points","bezier","tension"],(0,i._registerNode)(c),r.Factory.addGetterSetter(c,"closed",!1),r.Factory.addGetterSetter(c,"bezier",!1),r.Factory.addGetterSetter(c,"tension",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(c,"points",[],(0,o.getNumberArrayValidator)())},5939:e=>{e.exports=function e(t,n){"use strict";var r,i,a=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,o=/(^[ ]*|[ ]*$)/g,s=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,c=/^0/,u=function(t){return e.insensitive&&(""+t).toLowerCase()||""+t},h=u(t).replace(o,"")||"",d=u(n).replace(o,"")||"",f=h.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),p=d.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=parseInt(h.match(l),16)||1!==f.length&&h.match(s)&&Date.parse(h),g=parseInt(d.match(l),16)||m&&d.match(s)&&Date.parse(d)||null;if(g){if(m<g)return-1;if(m>g)return 1}for(var v=0,y=Math.max(f.length,p.length);v<y;v++){if(r=!(f[v]||"").match(c)&&parseFloat(f[v])||f[v]||0,i=!(p[v]||"").match(c)&&parseFloat(p[v])||p[v]||0,isNaN(r)!==isNaN(i))return isNaN(r)?1:-1;if(typeof r!==typeof i&&(r+="",i+=""),r<i)return-1;if(r>i)return 1}return 0}},5941:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];t.getCubicArcLength=(e,r,i)=>{let a,o;const s=i/2;a=0;for(let l=0;l<20;l++)o=s*t.tValues[20][l]+s,a+=t.cValues[20][l]*n(e,r,o);return s*a};function n(e,t,n){const i=r(1,n,e),a=r(1,n,t),o=i*i+a*a;return Math.sqrt(o)}t.getQuadraticArcLength=(e,t,n)=>{void 0===n&&(n=1);const r=e[0]-2*e[1]+e[2],i=t[0]-2*t[1]+t[2],a=2*e[1]-2*e[0],o=2*t[1]-2*t[0],s=4*(r*r+i*i),l=4*(r*a+i*o),c=a*a+o*o;if(0===s)return n*Math.sqrt(Math.pow(e[2]-e[0],2)+Math.pow(t[2]-t[0],2));const u=l/(2*s),h=n+u,d=c/s-u*u,f=h*h+d>0?Math.sqrt(h*h+d):0,p=u*u+d>0?Math.sqrt(u*u+d):0,m=u+Math.sqrt(u*u+d)!==0?d*Math.log(Math.abs((h+f)/(u+p))):0;return Math.sqrt(s)/2*(h*f-u*p+m)};const r=(e,n,i)=>{const a=i.length-1;let o,s;if(0===a)return 0;if(0===e){s=0;for(let e=0;e<=a;e++)s+=t.binomialCoefficients[a][e]*Math.pow(1-n,a-e)*Math.pow(n,e)*i[e];return s}o=new Array(a);for(let t=0;t<a;t++)o[t]=a*(i[t+1]-i[t]);return r(e-1,n,o)};t.t2length=(e,t,n)=>{let r=1,i=e/t,a=(e-n(i))/t,o=0;for(;r>.001;){const s=n(i+a),l=Math.abs(e-s)/t;if(l<r)r=l,i+=a;else{const o=n(i-a),s=Math.abs(e-o)/t;s<r?(r=s,i-=a):a/=2}if(o++,o>500)break}return i}},6288:function(e,t,n){var r;!function(e,i){function a(e){var t=this;t.next=function(){var e,n,r=t.w,i=t.X,a=t.i;return t.w=r=r+1640531527|0,n=i[a+34&127],e=i[a=a+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=i[a]=n^e,t.i=a,n+(r^r>>>16)|0},function(e,t){var n,r,i,a,o,s=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),i=0,a=-32;a<l;++a)t&&(r^=t.charCodeAt((a+32)%t.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(t&&t.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;e.w=o,e.X=s,e.i=i}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.X&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.xor4096=s}(0,e=n.nmd(e),n.amdD)},6338:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Group=void 0;const r=n(7149),i=n(4598),a=n(4602);class o extends i.Container{_validateAdd(e){const t=e.getType();"Group"!==t&&"Shape"!==t&&r.Util.throw("You may only add groups and shapes to groups.")}}t.Group=o,o.prototype.nodeType="Group",(0,a._registerNode)(o)},6494:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tag=t.Label=void 0;const r=n(1751),i=n(3304),a=n(6338),o=n(9910),s=n(4602),l=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],c="up",u="right",h="down",d="left",f=l.length;class p extends a.Group{constructor(e){super(e),this.on("add.konva",(function(e){this._addListeners(e.child),this._sync()}))}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let t,n=this;const r=function(){n._sync()};for(t=0;t<f;t++)e.on(l[t]+"Change.konva",r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e,t,n,r,i,a,o,s=this.getText(),l=this.getTag();if(s&&l){switch(e=s.width(),t=s.height(),n=l.pointerDirection(),r=l.pointerWidth(),o=l.pointerHeight(),i=0,a=0,n){case c:i=e/2,a=-1*o;break;case u:i=e+r,a=t/2;break;case h:i=e/2,a=t+o;break;case d:i=-1*r,a=t/2}l.setAttrs({x:-1*i,y:-1*a,width:e,height:t}),s.setAttrs({x:-1*i,y:-1*a})}}}t.Label=p,p.prototype.className="Label",(0,s._registerNode)(p);class m extends i.Shape{_sceneFunc(e){const t=this.width(),n=this.height(),r=this.pointerDirection(),i=this.pointerWidth(),a=this.pointerHeight(),o=this.cornerRadius();let s=0,l=0,f=0,p=0;"number"===typeof o?s=l=f=p=Math.min(o,t/2,n/2):(s=Math.min(o[0]||0,t/2,n/2),l=Math.min(o[1]||0,t/2,n/2),p=Math.min(o[2]||0,t/2,n/2),f=Math.min(o[3]||0,t/2,n/2)),e.beginPath(),e.moveTo(s,0),r===c&&(e.lineTo((t-i)/2,0),e.lineTo(t/2,-1*a),e.lineTo((t+i)/2,0)),e.lineTo(t-l,0),e.arc(t-l,l,l,3*Math.PI/2,0,!1),r===u&&(e.lineTo(t,(n-a)/2),e.lineTo(t+i,n/2),e.lineTo(t,(n+a)/2)),e.lineTo(t,n-p),e.arc(t-p,n-p,p,0,Math.PI/2,!1),r===h&&(e.lineTo((t+i)/2,n),e.lineTo(t/2,n+a),e.lineTo((t-i)/2,n)),e.lineTo(f,n),e.arc(f,n-f,f,Math.PI/2,Math.PI,!1),r===d&&(e.lineTo(0,(n+a)/2),e.lineTo(-1*i,n/2),e.lineTo(0,(n-a)/2)),e.lineTo(0,s),e.arc(s,s,s,Math.PI,3*Math.PI/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,t=0,n=this.pointerWidth(),r=this.pointerHeight(),i=this.pointerDirection(),a=this.width(),o=this.height();return i===c?(t-=r,o+=r):i===h?o+=r:i===d?(e-=1.5*n,a+=n):i===u&&(a+=1.5*n),{x:e,y:t,width:a,height:o}}}t.Tag=m,m.prototype.className="Tag",(0,s._registerNode)(m),r.Factory.addGetterSetter(m,"pointerDirection","none"),r.Factory.addGetterSetter(m,"pointerWidth",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(m,"pointerHeight",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(m,"cornerRadius",0,(0,o.getNumberOrArrayOfNumbersValidator)(4))},7066:function(e,t,n){var r;!function(e,i){function a(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new a(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.xor128=s}(0,e=n.nmd(e),n.amdD)},7149:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const r=n(4602);class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[1,0,0,1,0,0];this.dirty=!1,this.m=e&&e.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new i(this.m)}copyInto(e){e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5]}point(e){const t=this.m;return{x:t[0]*e.x+t[2]*e.y+t[4],y:t[1]*e.x+t[3]*e.y+t[5]}}translate(e,t){return this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t,this}scale(e,t){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.m[0]*t+this.m[2]*n,i=this.m[1]*t+this.m[3]*n,a=this.m[0]*-n+this.m[2]*t,o=this.m[1]*-n+this.m[3]*t;return this.m[0]=r,this.m[1]=i,this.m[2]=a,this.m[3]=o,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(e,t){const n=this.m[0]+this.m[2]*t,r=this.m[1]+this.m[3]*t,i=this.m[2]+this.m[0]*e,a=this.m[3]+this.m[1]*e;return this.m[0]=n,this.m[1]=r,this.m[2]=i,this.m[3]=a,this}multiply(e){const t=this.m[0]*e.m[0]+this.m[2]*e.m[1],n=this.m[1]*e.m[0]+this.m[3]*e.m[1],r=this.m[0]*e.m[2]+this.m[2]*e.m[3],i=this.m[1]*e.m[2]+this.m[3]*e.m[3],a=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],o=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=t,this.m[1]=n,this.m[2]=r,this.m[3]=i,this.m[4]=a,this.m[5]=o,this}invert(){const e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,n=-this.m[1]*e,r=-this.m[2]*e,i=this.m[0]*e,a=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=t,this.m[1]=n,this.m[2]=r,this.m[3]=i,this.m[4]=a,this.m[5]=o,this}getMatrix(){return this.m}decompose(){const e=this.m[0],n=this.m[1],r=this.m[2],i=this.m[3],a=e*i-n*r,o={x:this.m[4],y:this.m[5],rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=e||0!=n){const t=Math.sqrt(e*e+n*n);o.rotation=n>0?Math.acos(e/t):-Math.acos(e/t),o.scaleX=t,o.scaleY=a/t,o.skewX=(e*r+n*i)/a,o.skewY=0}else if(0!=r||0!=i){const t=Math.sqrt(r*r+i*i);o.rotation=Math.PI/2-(i>0?Math.acos(-r/t):-Math.acos(r/t)),o.scaleX=a/t,o.scaleY=t,o.skewX=0,o.skewY=(e*r+n*i)/a}return o.rotation=t.Util._getRotation(o.rotation),o}}t.Transform=i;const a=Math.PI/180,o=180/Math.PI,s="Konva error: ",l={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},c=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let u=[];const h="undefined"!==typeof requestAnimationFrame&&requestAnimationFrame||function(e){setTimeout(e,60)};t.Util={_isElement:e=>!(!e||1!=e.nodeType),_isFunction:e=>!!(e&&e.constructor&&e.call&&e.apply),_isPlainObject:e=>!!e&&e.constructor===Object,_isArray:e=>"[object Array]"===Object.prototype.toString.call(e),_isNumber:e=>"[object Number]"===Object.prototype.toString.call(e)&&!isNaN(e)&&isFinite(e),_isString:e=>"[object String]"===Object.prototype.toString.call(e),_isBoolean:e=>"[object Boolean]"===Object.prototype.toString.call(e),isObject:e=>e instanceof Object,isValidSelector(e){if("string"!==typeof e)return!1;const t=e[0];return"#"===t||"."===t||t===t.toUpperCase()},_sign:e=>0===e||e>0?1:-1,requestAnimFrame(e){u.push(e),1===u.length&&h((function(){const e=u;u=[],e.forEach((function(e){e()}))}))},createCanvasElement(){const e=document.createElement("canvas");try{e.style=e.style||{}}catch(t){}return e},createImageElement:()=>document.createElement("img"),_isInDocument(e){for(;e=e.parentNode;)if(e==document)return!0;return!1},_urlToImage(e,n){const r=t.Util.createImageElement();r.onload=function(){n(r)},r.src=e},_rgbToHex:(e,t,n)=>((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1),_hexToRgb(e){e=e.replace("#","");const t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},getRandomColor(){let e=(16777215*Math.random()|0).toString(16);for(;e.length<6;)e="0"+e;return"#"+e},getRGB(e){let t;return e in l?(t=l[e],{r:t[0],g:t[1],b:t[2]}):"#"===e[0]?this._hexToRgb(e.substring(1)):"rgb("===e.substr(0,4)?(t=c.exec(e.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA:e=>(e=e||"black",t.Util._namedColorToRBA(e)||t.Util._hex3ColorToRGBA(e)||t.Util._hex4ColorToRGBA(e)||t.Util._hex6ColorToRGBA(e)||t.Util._hex8ColorToRGBA(e)||t.Util._rgbColorToRGBA(e)||t.Util._rgbaColorToRGBA(e)||t.Util._hslColorToRGBA(e)),_namedColorToRBA(e){const t=l[e.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(e){if(0===e.indexOf("rgb(")){const t=(e=e.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(e){if(0===e.indexOf("rgba(")){const t=(e=e.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map(((e,t)=>"%"===e.slice(-1)?3===t?parseInt(e)/100:parseInt(e)/100*255:Number(e)));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(e){if("#"===e[0]&&9===e.length)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:parseInt(e.slice(7,9),16)/255}},_hex6ColorToRGBA(e){if("#"===e[0]&&7===e.length)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:1}},_hex4ColorToRGBA(e){if("#"===e[0]&&5===e.length)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:parseInt(e[4]+e[4],16)/255}},_hex3ColorToRGBA(e){if("#"===e[0]&&4===e.length)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:1}},_hslColorToRGBA(e){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(e)){const[t,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e),r=Number(n[0])/360,i=Number(n[1])/100,a=Number(n[2])/100;let o,s,l;if(0===i)return l=255*a,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};o=a<.5?a*(1+i):a+i-a*i;const c=2*a-o,u=[0,0,0];for(let e=0;e<3;e++)s=r+1/3*-(e-1),s<0&&s++,s>1&&s--,l=6*s<1?c+6*(o-c)*s:2*s<1?o:3*s<2?c+(o-c)*(2/3-s)*6:c,u[e]=255*l;return{r:Math.round(u[0]),g:Math.round(u[1]),b:Math.round(u[2]),a:1}}},haveIntersection:(e,t)=>!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y),cloneObject(e){const t={};for(const n in e)this._isPlainObject(e[n])?t[n]=this.cloneObject(e[n]):this._isArray(e[n])?t[n]=this.cloneArray(e[n]):t[n]=e[n];return t},cloneArray:e=>e.slice(0),degToRad:e=>e*a,radToDeg:e=>e*o,_degToRad:e=>(t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(e)),_radToDeg:e=>(t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(e)),_getRotation:e=>r.Konva.angleDeg?t.Util.radToDeg(e):e,_capitalize:e=>e.charAt(0).toUpperCase()+e.slice(1),throw(e){throw new Error(s+e)},error(e){console.error(s+e)},warn(e){r.Konva.showWarnings&&console.warn("Konva warning: "+e)},each(e,t){for(const n in e)t(n,e[n])},_inRange:(e,t,n)=>t<=e&&e<n,_getProjectionToSegment(e,t,n,r,i,a){let o,s,l;const c=(e-n)*(e-n)+(t-r)*(t-r);if(0==c)o=e,s=t,l=(i-n)*(i-n)+(a-r)*(a-r);else{const u=((i-e)*(n-e)+(a-t)*(r-t))/c;u<0?(o=e,s=t,l=(e-i)*(e-i)+(t-a)*(t-a)):u>1?(o=n,s=r,l=(n-i)*(n-i)+(r-a)*(r-a)):(o=e+u*(n-e),s=t+u*(r-t),l=(o-i)*(o-i)+(s-a)*(s-a))}return[o,s,l]},_getProjectionToLine(e,n,r){const i=t.Util.cloneObject(e);let a=Number.MAX_VALUE;return n.forEach((function(o,s){if(!r&&s===n.length-1)return;const l=n[(s+1)%n.length],c=t.Util._getProjectionToSegment(o.x,o.y,l.x,l.y,e.x,e.y),u=c[0],h=c[1],d=c[2];d<a&&(i.x=u,i.y=h,a=d)})),i},_prepareArrayForTween(e,n,r){const i=[],a=[];if(e.length>n.length){const t=n;n=e,e=t}for(let t=0;t<e.length;t+=2)i.push({x:e[t],y:e[t+1]});for(let t=0;t<n.length;t+=2)a.push({x:n[t],y:n[t+1]});const o=[];return a.forEach((function(e){const n=t.Util._getProjectionToLine(e,i,r);o.push(n.x),o.push(n.y)})),o},_prepareToStringify(e){let n;e.visitedByCircularReferenceRemoval=!0;for(const r in e)if(e.hasOwnProperty(r)&&e[r]&&"object"==typeof e[r])if(n=Object.getOwnPropertyDescriptor(e,r),e[r].visitedByCircularReferenceRemoval||t.Util._isElement(e[r])){if(!n.configurable)return null;delete e[r]}else if(null===t.Util._prepareToStringify(e[r])){if(!n.configurable)return null;delete e[r]}return delete e.visitedByCircularReferenceRemoval,e},_assign(e,t){for(const n in t)e[n]=t[n];return e},_getFirstPointerId:e=>e.touches?e.changedTouches[0].identifier:e.pointerId||999,releaseCanvas(){if(r.Konva.releaseCanvasOnDestroy){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>{e.width=0,e.height=0}))}},drawRoundedRectPath(e,t,n,r){let i=0,a=0,o=0,s=0;"number"===typeof r?i=a=o=s=Math.min(r,t/2,n/2):(i=Math.min(r[0]||0,t/2,n/2),a=Math.min(r[1]||0,t/2,n/2),s=Math.min(r[2]||0,t/2,n/2),o=Math.min(r[3]||0,t/2,n/2)),e.moveTo(i,0),e.lineTo(t-a,0),e.arc(t-a,a,a,3*Math.PI/2,0,!1),e.lineTo(t,n-s),e.arc(t-s,n-s,s,0,Math.PI/2,!1),e.lineTo(o,n),e.arc(o,n-o,o,Math.PI/2,Math.PI,!1),e.lineTo(0,i),e.arc(i,i,i,Math.PI,3*Math.PI/2,!1)}}},7205:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Invert=void 0;t.Invert=function(e){const t=e.data,n=t.length;for(let r=0;r<n;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2]}},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,n))c<i&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<i&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function _(e){if(g=!1,b(e),!m)if(null!==r(c))m=!0,F(w);else{var t=r(u);null!==t&&O(_,t.startTime-e)}}function w(e,n){m=!1,g&&(g=!1,y(E),E=-1),p=!0;var a=f;try{for(b(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!T());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var s=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?d.callback=s:d===r(c)&&i(c),b(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&O(_,h.startTime-n),l=!1}return l}finally{d=null,f=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,M=!1,D=null,E=-1,C=5,A=-1;function T(){return!(t.unstable_now()-A<C)}function N(){if(null!==D){var e=t.unstable_now();A=e;var n=!0;try{n=D(!0,e)}finally{n?S():(M=!1,D=null)}}else M=!1}if("function"===typeof x)S=function(){x(N)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,P=R.port2;R.port1.onmessage=N,S=function(){P.postMessage(null)}}else S=function(){v(N,0)};function F(e){D=e,M||(M=!0,S())}function O(e,n){E=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,F(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(g?(y(E),E=-1):g=!0,O(_,a-o))):(e.sortIndex=s,n(c,e),m||p||(m=!0,F(w))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},7264:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Posterize=void 0;const r=n(1751),i=n(1189),a=n(9910);t.Posterize=function(e){const t=Math.round(254*this.levels())+1,n=e.data,r=n.length,i=255/t;for(let a=0;a<r;a+=1)n[a]=Math.floor(n[a]/i)*i},r.Factory.addGetterSetter(i.Node,"levels",.5,(0,a.getNumberValidator)(),r.Factory.afterSetFilter)},7289:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Path=void 0;const r=n(1751),i=n(3304),a=n(4602),o=n(5941);class s extends i.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",(function(){this._readDataAttribute()}))}_readDataAttribute(){this.dataArray=s.parsePathData(this.data()),this.pathLength=s.getPathLength(this.dataArray)}_sceneFunc(e){const t=this.dataArray;e.beginPath();let n=!1;for(let p=0;p<t.length;p++){const m=t[p].command,g=t[p].points;switch(m){case"L":e.lineTo(g[0],g[1]);break;case"M":e.moveTo(g[0],g[1]);break;case"C":e.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5]);break;case"Q":e.quadraticCurveTo(g[0],g[1],g[2],g[3]);break;case"A":var r=g[0],i=g[1],a=g[2],o=g[3],s=g[4],l=g[5],c=g[6],u=g[7],h=a>o?a:o,d=a>o?1:a/o,f=a>o?o/a:1;e.translate(r,i),e.rotate(c),e.scale(d,f),e.arc(0,0,h,s,s+l,1-u),e.scale(1/d,1/f),e.rotate(-c),e.translate(-r,-i);break;case"z":n=!0,e.closePath()}}n||this.hasFill()?e.fillStrokeShape(this):e.strokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach((function(t){if("A"===t.command){const n=t.points[4],r=t.points[5],i=t.points[4]+r;let a=Math.PI/180;if(Math.abs(n-i)<a&&(a=Math.abs(n-i)),r<0)for(let o=n-a;o>i;o-=a){const n=s.getPointOnEllipticalArc(t.points[0],t.points[1],t.points[2],t.points[3],o,0);e.push(n.x,n.y)}else for(let o=n+a;o<i;o+=a){const n=s.getPointOnEllipticalArc(t.points[0],t.points[1],t.points[2],t.points[3],o,0);e.push(n.x,n.y)}}else if("C"===t.command)for(let n=0;n<=1;n+=.01){const r=s.getPointOnCubicBezier(n,t.start.x,t.start.y,t.points[0],t.points[1],t.points[2],t.points[3],t.points[4],t.points[5]);e.push(r.x,r.y)}else e=e.concat(t.points)}));let t,n,r=e[0],i=e[0],a=e[1],o=e[1];for(let s=0;s<e.length/2;s++)t=e[2*s],n=e[2*s+1],isNaN(t)||(r=Math.min(r,t),i=Math.max(i,t)),isNaN(n)||(a=Math.min(a,n),o=Math.max(o,n));return{x:r,y:a,width:i-r,height:o-a}}getLength(){return this.pathLength}getPointAtLength(e){return s.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,t,n,r){return Math.sqrt((n-e)*(n-e)+(r-t)*(r-t))}static getPathLength(e){let t=0;for(let n=0;n<e.length;++n)t+=e[n].pathLength;return t}static getPointAtLengthOfDataArray(e,t){let n,r=0,i=t.length;if(!i)return null;for(;r<i&&e>t[r].pathLength;)e-=t[r].pathLength,++r;if(r===i)return n=t[r-1].points.slice(-2),{x:n[0],y:n[1]};if(e<.01)return n=t[r].points.slice(0,2),{x:n[0],y:n[1]};const a=t[r],l=a.points;switch(a.command){case"L":return s.getPointOnLine(e,a.start.x,a.start.y,l[0],l[1]);case"C":return s.getPointOnCubicBezier((0,o.t2length)(e,s.getPathLength(t),(e=>(0,o.getCubicArcLength)([a.start.x,l[0],l[2],l[4]],[a.start.y,l[1],l[3],l[5]],e))),a.start.x,a.start.y,l[0],l[1],l[2],l[3],l[4],l[5]);case"Q":return s.getPointOnQuadraticBezier((0,o.t2length)(e,s.getPathLength(t),(e=>(0,o.getQuadraticArcLength)([a.start.x,l[0],l[2]],[a.start.y,l[1],l[3]],e))),a.start.x,a.start.y,l[0],l[1],l[2],l[3]);case"A":var c=l[0],u=l[1],h=l[2],d=l[3],f=l[4],p=l[5],m=l[6];return f+=p*e/a.pathLength,s.getPointOnEllipticalArc(c,u,h,d,f,m)}return null}static getPointOnLine(e,t,n,r,i,a,o){a=null!==a&&void 0!==a?a:t,o=null!==o&&void 0!==o?o:n;const s=this.getLineLength(t,n,r,i);if(s<1e-10)return{x:t,y:n};if(r===t)return{x:a,y:o+(i>n?e:-e)};const l=(i-n)/(r-t),c=Math.sqrt(e*e/(1+l*l))*(r<t?-1:1),u=l*c;if(Math.abs(o-n-l*(a-t))<1e-10)return{x:a+c,y:o+u};const h=((a-t)*(r-t)+(o-n)*(i-n))/(s*s),d=t+h*(r-t),f=n+h*(i-n),p=this.getLineLength(a,o,d,f),m=Math.sqrt(e*e-p*p),g=Math.sqrt(m*m/(1+l*l))*(r<t?-1:1);return{x:d+g,y:f+l*g}}static getPointOnCubicBezier(e,t,n,r,i,a,o,s,l){function c(e){return e*e*e}function u(e){return 3*e*e*(1-e)}function h(e){return 3*e*(1-e)*(1-e)}function d(e){return(1-e)*(1-e)*(1-e)}return{x:s*c(e)+a*u(e)+r*h(e)+t*d(e),y:l*c(e)+o*u(e)+i*h(e)+n*d(e)}}static getPointOnQuadraticBezier(e,t,n,r,i,a,o){function s(e){return e*e}function l(e){return 2*e*(1-e)}function c(e){return(1-e)*(1-e)}return{x:a*s(e)+r*l(e)+t*c(e),y:o*s(e)+i*l(e)+n*c(e)}}static getPointOnEllipticalArc(e,t,n,r,i,a){const o=Math.cos(a),s=Math.sin(a),l=n*Math.cos(i),c=r*Math.sin(i);return{x:e+(l*o-c*s),y:t+(l*s+c*o)}}static parsePathData(e){if(!e)return[];let t=e;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(var r=0;r<n.length;r++)t=t.replace(new RegExp(n[r],"g"),"|"+n[r]);const i=t.split("|"),a=[],o=[];let s=0,l=0;const c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let u;for(r=1;r<i.length;r++){let e=i[r],t=e.charAt(0);for(e=e.slice(1),o.length=0;u=c.exec(e);)o.push(u[0]);const n=[];for(let r=0,i=o.length;r<i;r++){if("00"===o[r]){n.push(0,0);continue}const e=parseFloat(o[r]);isNaN(e)?n.push(0):n.push(e)}for(;n.length>0&&!isNaN(n[0]);){let e="",r=[];const i=s,o=l;var h,d,f,p,m,g,v,y,x,b;switch(t){case"l":s+=n.shift(),l+=n.shift(),e="L",r.push(s,l);break;case"L":s=n.shift(),l=n.shift(),r.push(s,l);break;case"m":var _=n.shift(),w=n.shift();if(s+=_,l+=w,e="M",a.length>2&&"z"===a[a.length-1].command)for(let e=a.length-2;e>=0;e--)if("M"===a[e].command){s=a[e].points[0]+_,l=a[e].points[1]+w;break}r.push(s,l),t="l";break;case"M":s=n.shift(),l=n.shift(),e="M",r.push(s,l),t="L";break;case"h":s+=n.shift(),e="L",r.push(s,l);break;case"H":s=n.shift(),e="L",r.push(s,l);break;case"v":l+=n.shift(),e="L",r.push(s,l);break;case"V":l=n.shift(),e="L",r.push(s,l);break;case"C":r.push(n.shift(),n.shift(),n.shift(),n.shift()),s=n.shift(),l=n.shift(),r.push(s,l);break;case"c":r.push(s+n.shift(),l+n.shift(),s+n.shift(),l+n.shift()),s+=n.shift(),l+=n.shift(),e="C",r.push(s,l);break;case"S":d=s,f=l,"C"===(h=a[a.length-1]).command&&(d=s+(s-h.points[2]),f=l+(l-h.points[3])),r.push(d,f,n.shift(),n.shift()),s=n.shift(),l=n.shift(),e="C",r.push(s,l);break;case"s":d=s,f=l,"C"===(h=a[a.length-1]).command&&(d=s+(s-h.points[2]),f=l+(l-h.points[3])),r.push(d,f,s+n.shift(),l+n.shift()),s+=n.shift(),l+=n.shift(),e="C",r.push(s,l);break;case"Q":r.push(n.shift(),n.shift()),s=n.shift(),l=n.shift(),r.push(s,l);break;case"q":r.push(s+n.shift(),l+n.shift()),s+=n.shift(),l+=n.shift(),e="Q",r.push(s,l);break;case"T":d=s,f=l,"Q"===(h=a[a.length-1]).command&&(d=s+(s-h.points[0]),f=l+(l-h.points[1])),s=n.shift(),l=n.shift(),e="Q",r.push(d,f,s,l);break;case"t":d=s,f=l,"Q"===(h=a[a.length-1]).command&&(d=s+(s-h.points[0]),f=l+(l-h.points[1])),s+=n.shift(),l+=n.shift(),e="Q",r.push(d,f,s,l);break;case"A":p=n.shift(),m=n.shift(),g=n.shift(),v=n.shift(),y=n.shift(),x=s,b=l,s=n.shift(),l=n.shift(),e="A",r=this.convertEndpointToCenterParameterization(x,b,s,l,v,y,p,m,g);break;case"a":p=n.shift(),m=n.shift(),g=n.shift(),v=n.shift(),y=n.shift(),x=s,b=l,s+=n.shift(),l+=n.shift(),e="A",r=this.convertEndpointToCenterParameterization(x,b,s,l,v,y,p,m,g)}a.push({command:e||t,points:r,start:{x:i,y:o},pathLength:this.calcLength(i,o,e||t,r)})}"z"!==t&&"Z"!==t||a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(e,t,n,r){let i,a,l,c;const u=s;switch(n){case"L":return u.getLineLength(e,t,r[0],r[1]);case"C":return(0,o.getCubicArcLength)([e,r[0],r[2],r[4]],[t,r[1],r[3],r[5]],1);case"Q":return(0,o.getQuadraticArcLength)([e,r[0],r[2]],[t,r[1],r[3]],1);case"A":i=0;var h=r[4],d=r[5],f=r[4]+d,p=Math.PI/180;if(Math.abs(h-f)<p&&(p=Math.abs(h-f)),a=u.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],h,0),d<0)for(c=h-p;c>f;c-=p)l=u.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],c,0),i+=u.getLineLength(a.x,a.y,l.x,l.y),a=l;else for(c=h+p;c<f;c+=p)l=u.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],c,0),i+=u.getLineLength(a.x,a.y,l.x,l.y),a=l;return l=u.getPointOnEllipticalArc(r[0],r[1],r[2],r[3],f,0),i+=u.getLineLength(a.x,a.y,l.x,l.y),i}return 0}static convertEndpointToCenterParameterization(e,t,n,r,i,a,o,s,l){const c=l*(Math.PI/180),u=Math.cos(c)*(e-n)/2+Math.sin(c)*(t-r)/2,h=-1*Math.sin(c)*(e-n)/2+Math.cos(c)*(t-r)/2,d=u*u/(o*o)+h*h/(s*s);d>1&&(o*=Math.sqrt(d),s*=Math.sqrt(d));let f=Math.sqrt((o*o*(s*s)-o*o*(h*h)-s*s*(u*u))/(o*o*(h*h)+s*s*(u*u)));i===a&&(f*=-1),isNaN(f)&&(f=0);const p=f*o*h/s,m=f*-s*u/o,g=(e+n)/2+Math.cos(c)*p-Math.sin(c)*m,v=(t+r)/2+Math.sin(c)*p+Math.cos(c)*m,y=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},x=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(y(e)*y(t))},b=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(x(e,t))},_=b([1,0],[(u-p)/o,(h-m)/s]),w=[(u-p)/o,(h-m)/s],S=[(-1*u-p)/o,(-1*h-m)/s];let M=b(w,S);return x(w,S)<=-1&&(M=Math.PI),x(w,S)>=1&&(M=0),0===a&&M>0&&(M-=2*Math.PI),1===a&&M<0&&(M+=2*Math.PI),[g,v,o,s,_,M,c,a]}}t.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,a._registerNode)(s),r.Factory.addGetterSetter(s,"data")},7359:function(e,t,n){var r;!function(e,i){function a(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new a(e),r=t&&t.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.alea=s}(0,e=n.nmd(e),n.amdD)},7736:(e,t,n)=>{var r=n(3738).default,i=n(9045);e.exports=function(e){var t=i(e,"string");return"symbol"==r(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},7980:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegularPolygon=void 0;const r=n(1751),i=n(3304),a=n(9910),o=n(4602);class s extends i.Shape{_sceneFunc(e){const t=this._getPoints();e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let n=1;n<t.length;n++)e.lineTo(t[n].x,t[n].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,t=this.attrs.radius||0,n=[];for(let r=0;r<e;r++)n.push({x:t*Math.sin(2*r*Math.PI/e),y:-1*t*Math.cos(2*r*Math.PI/e)});return n}getSelfRect(){const e=this._getPoints();let t=e[0].x,n=e[0].y,r=e[0].x,i=e[0].y;return e.forEach((e=>{t=Math.min(t,e.x),n=Math.max(n,e.x),r=Math.min(r,e.y),i=Math.max(i,e.y)})),{x:t,y:r,width:n-t,height:i-r}}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}t.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,o._registerNode)(s),r.Factory.addGetterSetter(s,"radius",0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(s,"sides",0,(0,a.getNumberValidator)())},8019:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sepia=void 0;t.Sepia=function(e){const t=e.data,n=t.length;for(let r=0;r<n;r+=4){const e=t[r+0],n=t[r+1],i=t[r+2];t[r+0]=Math.min(255,.393*e+.769*n+.189*i),t[r+1]=Math.min(255,.349*e+.686*n+.168*i),t[r+2]=Math.min(255,.272*e+.534*n+.131*i)}}},8065:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const r=n(4602),i=n(7149),a=n(1189),o=n(4598),s=n(4367),l=n(1416),c=n(3994),u=n(6338),h=n(8727),d=n(3304),f=n(3243),p=n(5242),m=n(3354),g=n(589);t.Konva=i.Util._assign(r.Konva,{Util:i.Util,Transform:i.Transform,Node:a.Node,Container:o.Container,Stage:s.Stage,stages:s.stages,Layer:l.Layer,FastLayer:c.FastLayer,Group:u.Group,DD:h.DD,Shape:d.Shape,shapes:d.shapes,Animation:f.Animation,Tween:p.Tween,Easings:p.Easings,Context:m.Context,Canvas:g.Canvas}),t.default=t.Konva},8098:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Brighten=void 0;const r=n(1751),i=n(1189),a=n(9910);t.Brighten=function(e){const t=255*this.brightness(),n=e.data,r=n.length;for(let i=0;i<r;i+=4)n[i]+=t,n[i+1]+=t,n[i+2]+=t},r.Factory.addGetterSetter(i.Node,"brightness",0,(0,a.getNumberValidator)(),r.Factory.afterSetFilter)},8332:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Kaleidoscope=void 0;const r=n(1751),i=n(1189),a=n(7149),o=n(9910);t.Kaleidoscope=function(e){const t=e.width,n=e.height;let r,i,o,s,l,c,u,h,d,f,p=Math.round(this.kaleidoscopePower());const m=Math.round(this.kaleidoscopeAngle()),g=Math.floor(t*(m%360)/360);if(p<1)return;const v=a.Util.createCanvasElement();v.width=t,v.height=n;const y=v.getContext("2d").getImageData(0,0,t,n);a.Util.releaseCanvas(v),function(e,t,n){const r=e.data,i=t.data,a=e.width,o=e.height,s=n.polarCenterX||a/2,l=n.polarCenterY||o/2;let c=Math.sqrt(s*s+l*l),u=a-s,h=o-l;const d=Math.sqrt(u*u+h*h);c=d>c?d:c;const f=o,p=a,m=360/p*Math.PI/180;for(let g=0;g<p;g+=1){const e=Math.sin(g*m),t=Math.cos(g*m);for(let n=0;n<f;n+=1){u=Math.floor(s+c*n/f*t),h=Math.floor(l+c*n/f*e);let o=4*(h*a+u);const d=r[o+0],p=r[o+1],m=r[o+2],v=r[o+3];o=4*(g+n*a),i[o+0]=d,i[o+1]=p,i[o+2]=m,i[o+3]=v}}}(e,y,{polarCenterX:t/2,polarCenterY:n/2});let x=t/Math.pow(2,p);for(;x<=8;)x*=2,p-=1;x=Math.ceil(x);let b=x,_=0,w=b,S=1;for(g+x>t&&(_=b,w=0,S=-1),i=0;i<n;i+=1)for(r=_;r!==w;r+=S)o=Math.round(r+g)%t,d=4*(t*i+o),l=y.data[d+0],c=y.data[d+1],u=y.data[d+2],h=y.data[d+3],f=4*(t*i+r),y.data[f+0]=l,y.data[f+1]=c,y.data[f+2]=u,y.data[f+3]=h;for(i=0;i<n;i+=1)for(b=Math.floor(x),s=0;s<p;s+=1){for(r=0;r<b+1;r+=1)d=4*(t*i+r),l=y.data[d+0],c=y.data[d+1],u=y.data[d+2],h=y.data[d+3],f=4*(t*i+2*b-r-1),y.data[f+0]=l,y.data[f+1]=c,y.data[f+2]=u,y.data[f+3]=h;b*=2}!function(e,t,n){const r=e.data,i=t.data,a=e.width,o=e.height,s=n.polarCenterX||a/2,l=n.polarCenterY||o/2;let c=Math.sqrt(s*s+l*l),u=a-s,h=o-l;const d=Math.sqrt(u*u+h*h);c=d>c?d:c;const f=o,p=a,m=n.polarRotation||0;let g,v;for(u=0;u<a;u+=1)for(h=0;h<o;h+=1){const e=u-s,t=h-l,n=Math.sqrt(e*e+t*t)*f/c;let o=(180*Math.atan2(t,e)/Math.PI+360+m)%360;o=o*p/360,g=Math.floor(o),v=Math.floor(n);let d=4*(v*a+g);const y=r[d+0],x=r[d+1],b=r[d+2],_=r[d+3];d=4*(h*a+u),i[d+0]=y,i[d+1]=x,i[d+2]=b,i[d+3]=_}}(y,e,{polarRotation:0})},r.Factory.addGetterSetter(i.Node,"kaleidoscopePower",2,(0,o.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(i.Node,"kaleidoscopeAngle",0,(0,o.getNumberValidator)(),r.Factory.afterSetFilter)},8727:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const r=n(4602),i=n(7149);t.DD={get isDragging(){let e=!1;return t.DD._dragElements.forEach((t=>{"dragging"===t.dragStatus&&(e=!0)})),e},justDragged:!1,get node(){let e;return t.DD._dragElements.forEach((t=>{e=t.node})),e},_dragElements:new Map,_drag(e){const n=[];t.DD._dragElements.forEach(((t,r)=>{const{node:a}=t,o=a.getStage();o.setPointersPositions(e),void 0===t.pointerId&&(t.pointerId=i.Util._getFirstPointerId(e));const s=o._changedPointerPositions.find((e=>e.id===t.pointerId));if(s){if("dragging"!==t.dragStatus){const n=a.dragDistance();if(Math.max(Math.abs(s.x-t.startPointerPos.x),Math.abs(s.y-t.startPointerPos.y))<n)return;if(a.startDrag({evt:e}),!a.isDragging())return}a._setDragPosition(e,t),n.push(a)}})),n.forEach((t=>{t.fire("dragmove",{type:"dragmove",target:t,evt:e},!0)}))},_endDragBefore(e){const n=[];t.DD._dragElements.forEach((i=>{const{node:a}=i,o=a.getStage();e&&o.setPointersPositions(e);if(!o._changedPointerPositions.find((e=>e.id===i.pointerId)))return;"dragging"!==i.dragStatus&&"stopped"!==i.dragStatus||(t.DD.justDragged=!0,r.Konva._mouseListenClick=!1,r.Konva._touchListenClick=!1,r.Konva._pointerListenClick=!1,i.dragStatus="stopped");const s=i.node.getLayer()||i.node instanceof r.Konva.Stage&&i.node;s&&-1===n.indexOf(s)&&n.push(s)})),n.forEach((e=>{e.draw()}))},_endDragAfter(e){t.DD._dragElements.forEach(((n,r)=>{"stopped"===n.dragStatus&&n.node.fire("dragend",{type:"dragend",target:n.node,evt:e},!0),"dragging"!==n.dragStatus&&t.DD._dragElements.delete(r)}))}},r.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},9016:function(e,t,n){var r;!function(e,i){function a(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new a(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.xorwow=s}(0,e=n.nmd(e),n.amdD)},9045:(e,t,n)=>{var r=n(3738).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9144:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Arc=void 0;const r=n(1751),i=n(3304),a=n(4602),o=n(9910),s=n(4602);class l extends i.Shape{_sceneFunc(e){const t=a.Konva.getAngle(this.angle()),n=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,n),e.arc(0,0,this.innerRadius(),t,0,!n),e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),t=this.outerRadius(),n=this.clockwise(),r=a.Konva.getAngle(n?360-this.angle():this.angle()),i=Math.cos(Math.min(r,Math.PI)),o=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),s=Math.sin(Math.min(r,Math.PI/2)),l=i*(i>0?e:t),c=o*(o>0?e:t),u=s*(s>0?t:e);return{x:l,y:n?-1*u:c,width:1*t-l,height:u-c}}}t.Arc=l,l.prototype._centroid=!0,l.prototype.className="Arc",l.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(l),r.Factory.addGetterSetter(l,"innerRadius",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(l,"outerRadius",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(l,"angle",0,(0,o.getNumberValidator)()),r.Factory.addGetterSetter(l,"clockwise",!1,(0,o.getBooleanValidator)())},9195:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Noise=void 0;const r=n(1751),i=n(1189),a=n(9910);t.Noise=function(e){const t=255*this.noise(),n=e.data,r=n.length,i=t/2;for(let a=0;a<r;a+=4)n[a+0]+=i-2*i*Math.random(),n[a+1]+=i-2*i*Math.random(),n[a+2]+=i-2*i*Math.random()},r.Factory.addGetterSetter(i.Node,"noise",.2,(0,a.getNumberValidator)(),r.Factory.afterSetFilter)},9379:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(4705);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},9408:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ACESFilmicToneMapping:()=>r.FV,AddEquation:()=>r.gO9,AddOperation:()=>r.XrR,AdditiveAnimationBlendMode:()=>r.DAe,AdditiveBlending:()=>r.EZo,AgXToneMapping:()=>r.LAk,AlphaFormat:()=>r.wrO,AlwaysCompare:()=>r.FFZ,AlwaysDepth:()=>r.lGu,AlwaysStencilFunc:()=>r.sKt,AmbientLight:()=>r.$p8,AnimationAction:()=>r.pPE,AnimationClip:()=>r.tz3,AnimationLoader:()=>r.kEx,AnimationMixer:()=>r.Iw4,AnimationObjectGroup:()=>r.P5j,AnimationUtils:()=>r.AKb,ArcCurve:()=>r.ibB,ArrayCamera:()=>r.nZQ,ArrowHelper:()=>r.E0M,AttachedBindMode:()=>r.BER,Audio:()=>r.fP5,AudioAnalyser:()=>r.CwR,AudioContext:()=>r.UtX,AudioListener:()=>r.Pf$,AudioLoader:()=>r.Am1,AxesHelper:()=>r.IzY,BackSide:()=>r.hsX,BasicDepthPacking:()=>r.Rkk,BasicShadowMap:()=>r.bTm,BatchedMesh:()=>r.$Ed,Bone:()=>r.$Kf,BooleanKeyframeTrack:()=>r.YOZ,Box2:()=>r.UtB,Box3:()=>r.NRn,Box3Helper:()=>r.BND,BoxGeometry:()=>r.iNn,BoxHelper:()=>r.IWo,BufferAttribute:()=>r.THS,BufferGeometry:()=>r.LoY,BufferGeometryLoader:()=>r.SUR,ByteType:()=>r.tJf,Cache:()=>r.l2R,Camera:()=>r.i7d,CameraHelper:()=>r.WTh,CanvasTexture:()=>r.GOR,CapsuleGeometry:()=>r.qU7,CatmullRomCurve3:()=>r.B6O,CineonToneMapping:()=>r.nNL,CircleGeometry:()=>r.tcD,ClampToEdgeWrapping:()=>r.ghU,Clock:()=>r.zD7,Color:()=>r.Q1f,ColorKeyframeTrack:()=>r.T6I,ColorManagement:()=>r.ppV,CompressedArrayTexture:()=>r.iOZ,CompressedCubeTexture:()=>r.c5h,CompressedTexture:()=>r.FvD,CompressedTextureLoader:()=>r.YRT,ConeGeometry:()=>r.qFE,ConstantAlphaFactor:()=>r.e0p,ConstantColorFactor:()=>r.RrE,Controls:()=>r.H2z,CubeCamera:()=>r.F1T,CubeReflectionMapping:()=>r.hy7,CubeRefractionMapping:()=>r.xFO,CubeTexture:()=>r.b4q,CubeTextureLoader:()=>r.ScU,CubeUVReflectionMapping:()=>r.Om,CubicBezierCurve:()=>r.Z0B,CubicBezierCurve3:()=>r.s0K,CubicInterpolant:()=>r.Pdi,CullFaceBack:()=>r.Vb5,CullFaceFront:()=>r.Jnc,CullFaceFrontBack:()=>r.ywQ,CullFaceNone:()=>r.WNZ,Curve:()=>r.Ipv,CurvePath:()=>r.jGm,CustomBlending:()=>r.bCz,CustomToneMapping:()=>r.g7M,CylinderGeometry:()=>r.Ho_,Cylindrical:()=>r.hjs,Data3DTexture:()=>r.dYF,DataArrayTexture:()=>r.rFo,DataTexture:()=>r.GYF,DataTextureLoader:()=>r.BRH,DataUtils:()=>r.GxU,DecrementStencilOp:()=>r.ROr,DecrementWrapStencilOp:()=>r.fJr,DefaultLoadingManager:()=>r.h_9,DepthArrayTexture:()=>r.S7T,DepthFormat:()=>r.zdS,DepthStencilFormat:()=>r.dcC,DepthTexture:()=>r.VCu,DetachedBindMode:()=>r.Fvi,DirectionalLight:()=>r.ZyN,DirectionalLightHelper:()=>r.PFK,DiscreteInterpolant:()=>r.Yhb,DodecahedronGeometry:()=>r.nEu,DoubleSide:()=>r.$EB,DstAlphaFactor:()=>r.hdd,DstColorFactor:()=>r.wn6,DynamicCopyUsage:()=>r.MOq,DynamicDrawUsage:()=>r.Vnu,DynamicReadUsage:()=>r.hIf,EdgesGeometry:()=>r.TDQ,EllipseCurve:()=>r.S20,EqualCompare:()=>r.kO0,EqualDepth:()=>r.U3G,EqualStencilFunc:()=>r.jsO,EquirectangularReflectionMapping:()=>r.wfO,EquirectangularRefractionMapping:()=>r.uV5,Euler:()=>r.O9p,EventDispatcher:()=>r.Qev,ExtrudeGeometry:()=>r.QCA,FileLoader:()=>r.Y9S,Float16BufferAttribute:()=>r.Oax,Float32BufferAttribute:()=>r.qtW,FloatType:()=>r.RQf,Fog:()=>r.jUj,FogExp2:()=>r.cRK,FramebufferTexture:()=>r.Pem,FrontSide:()=>r.hB5,Frustum:()=>r.PPD,FrustumArray:()=>r.uf3,GLBufferAttribute:()=>r.oh6,GLSL1:()=>r.Wyr,GLSL3:()=>r.Wdf,GreaterCompare:()=>r.eoi,GreaterDepth:()=>r.K52,GreaterEqualCompare:()=>r.gWB,GreaterEqualDepth:()=>r.Gwm,GreaterEqualStencilFunc:()=>r.TMh,GreaterStencilFunc:()=>r.RcT,GridHelper:()=>r.fTw,Group:()=>r.YJl,HalfFloatType:()=>r.ix0,HemisphereLight:()=>r.dth,HemisphereLightHelper:()=>r.R1W,IcosahedronGeometry:()=>r.WBB,ImageBitmapLoader:()=>r.Kzg,ImageLoader:()=>r.$NF,ImageUtils:()=>r.HgN,IncrementStencilOp:()=>r.HLH,IncrementWrapStencilOp:()=>r.Ru$,InstancedBufferAttribute:()=>r.uWO,InstancedBufferGeometry:()=>r.CmU,InstancedInterleavedBuffer:()=>r.LuO,InstancedMesh:()=>r.ZLX,Int16BufferAttribute:()=>r.Hrb,Int32BufferAttribute:()=>r.vmz,Int8BufferAttribute:()=>r.wvS,IntType:()=>r.Yuy,InterleavedBuffer:()=>r.eB$,InterleavedBufferAttribute:()=>r.eHs,Interpolant:()=>r.lGw,InterpolateDiscrete:()=>r.ljd,InterpolateLinear:()=>r.PJ3,InterpolateSmooth:()=>r.EQC,InterpolationSamplingMode:()=>r.TM5,InterpolationSamplingType:()=>r.G4u,InvertStencilOp:()=>r.oVO,KeepStencilOp:()=>r.VVr,KeyframeTrack:()=>r.UJ6,LOD:()=>r.UpK,LatheGeometry:()=>r.nzx,Layers:()=>r.zgK,LessCompare:()=>r.vim,LessDepth:()=>r.brA,LessEqualCompare:()=>r.TiK,LessEqualDepth:()=>r.xSv,LessEqualStencilFunc:()=>r.CR7,LessStencilFunc:()=>r.kYr,Light:()=>r.veJ,LightProbe:()=>r.FZo,Line:()=>r.N1A,Line3:()=>r.cZY,LineBasicMaterial:()=>r.mrM,LineCurve:()=>r.GZZ,LineCurve3:()=>r.VnP,LineDashedMaterial:()=>r.Fvt,LineLoop:()=>r.FCc,LineSegments:()=>r.DXC,LinearFilter:()=>r.k6q,LinearInterpolant:()=>r.ezk,LinearMipMapLinearFilter:()=>r.NZq,LinearMipMapNearestFilter:()=>r.iUH,LinearMipmapLinearFilter:()=>r.$_I,LinearMipmapNearestFilter:()=>r.kRr,LinearSRGBColorSpace:()=>r.Zr2,LinearToneMapping:()=>r.kyO,LinearTransfer:()=>r.VxR,Loader:()=>r.aHM,LoaderUtils:()=>r.r6x,LoadingManager:()=>r.KPJ,LoopOnce:()=>r.G3T,LoopPingPong:()=>r.lc7,LoopRepeat:()=>r.aMy,MOUSE:()=>r.kBv,Material:()=>r.imn,MaterialLoader:()=>r.jut,MathUtils:()=>r.cj9,Matrix2:()=>r.k_V,Matrix3:()=>r.dwI,Matrix4:()=>r.kn4,MaxEquation:()=>r.$ei,Mesh:()=>r.eaF,MeshBasicMaterial:()=>r.V9B,MeshDepthMaterial:()=>r.CSG,MeshDistanceMaterial:()=>r.aVO,MeshLambertMaterial:()=>r.G_z,MeshMatcapMaterial:()=>r.FNr,MeshNormalMaterial:()=>r.qBx,MeshPhongMaterial:()=>r.tXL,MeshPhysicalMaterial:()=>r.uSd,MeshStandardMaterial:()=>r._4j,MeshToonMaterial:()=>r.Df,MinEquation:()=>r.znC,MirroredRepeatWrapping:()=>r.kTW,MixOperation:()=>r.KRh,MultiplyBlending:()=>r.EdD,MultiplyOperation:()=>r.caT,NearestFilter:()=>r.hxR,NearestMipMapLinearFilter:()=>r.a$r,NearestMipMapNearestFilter:()=>r.$O9,NearestMipmapLinearFilter:()=>r.Cfg,NearestMipmapNearestFilter:()=>r.pHI,NeutralToneMapping:()=>r.aJ8,NeverCompare:()=>r.amv,NeverDepth:()=>r.eHc,NeverStencilFunc:()=>r.HPb,NoBlending:()=>r.XIg,NoColorSpace:()=>r.jf0,NoToneMapping:()=>r.y_p,NormalAnimationBlendMode:()=>r.Ke9,NormalBlending:()=>r.NTi,NotEqualCompare:()=>r.jzd,NotEqualDepth:()=>r.bw0,NotEqualStencilFunc:()=>r.klZ,NumberKeyframeTrack:()=>r.Hit,Object3D:()=>r.B69,ObjectLoader:()=>r.XTe,ObjectSpaceNormalMap:()=>r.vyJ,OctahedronGeometry:()=>r.Ufg,OneFactor:()=>r.qad,OneMinusConstantAlphaFactor:()=>r.ov9,OneMinusConstantColorFactor:()=>r.$Yl,OneMinusDstAlphaFactor:()=>r.Nt7,OneMinusDstColorFactor:()=>r.aEY,OneMinusSrcAlphaFactor:()=>r.OuU,OneMinusSrcColorFactor:()=>r.LiQ,OrthographicCamera:()=>r.qUd,PCFShadowMap:()=>r.QP0,PCFSoftShadowMap:()=>r.Wk7,PMREMGenerator:()=>N,Path:()=>r.wAk,PerspectiveCamera:()=>r.ubm,Plane:()=>r.Zcv,PlaneGeometry:()=>r.bdM,PlaneHelper:()=>r.ZM4,PointLight:()=>r.HiM,PointLightHelper:()=>r.F1l,Points:()=>r.ONl,PointsMaterial:()=>r.BH$,PolarGridHelper:()=>r.hzE,PolyhedronGeometry:()=>r.pFK,PositionalAudio:()=>r.xZx,PropertyBinding:()=>r.Nwf,PropertyMixer:()=>r.N2s,QuadraticBezierCurve:()=>r.dAo,QuadraticBezierCurve3:()=>r.CV9,Quaternion:()=>r.PTz,QuaternionKeyframeTrack:()=>r.MBL,QuaternionLinearInterpolant:()=>r.GBG,RED_GREEN_RGTC2_Format:()=>r.HO_,RED_RGTC1_Format:()=>r.Kef,REVISION:()=>r.sPf,RGBADepthPacking:()=>r.N5j,RGBAFormat:()=>r.GWd,RGBAIntegerFormat:()=>r.c90,RGBA_ASTC_10x10_Format:()=>r.y3Z,RGBA_ASTC_10x5_Format:()=>r.uB5,RGBA_ASTC_10x6_Format:()=>r.lyL,RGBA_ASTC_10x8_Format:()=>r.bC7,RGBA_ASTC_12x10_Format:()=>r.ojs,RGBA_ASTC_12x12_Format:()=>r.S$4,RGBA_ASTC_4x4_Format:()=>r.qa3,RGBA_ASTC_5x4_Format:()=>r.B_h,RGBA_ASTC_5x5_Format:()=>r.czI,RGBA_ASTC_6x5_Format:()=>r.rSH,RGBA_ASTC_6x6_Format:()=>r.Qrf,RGBA_ASTC_8x5_Format:()=>r.psI,RGBA_ASTC_8x6_Format:()=>r.a5J,RGBA_ASTC_8x8_Format:()=>r._QJ,RGBA_BPTC_Format:()=>r.Fn,RGBA_ETC2_EAC_Format:()=>r.KDk,RGBA_PVRTC_2BPPV1_Format:()=>r.pBf,RGBA_PVRTC_4BPPV1_Format:()=>r.HXV,RGBA_S3TC_DXT1_Format:()=>r.Nz6,RGBA_S3TC_DXT3_Format:()=>r.jR7,RGBA_S3TC_DXT5_Format:()=>r.BXX,RGBDepthPacking:()=>r.wTz,RGBFormat:()=>r.HIg,RGBIntegerFormat:()=>r.VGF,RGB_BPTC_SIGNED_Format:()=>r.H23,RGB_BPTC_UNSIGNED_Format:()=>r.W9U,RGB_ETC1_Format:()=>r.CVz,RGB_ETC2_Format:()=>r.Riy,RGB_PVRTC_2BPPV1_Format:()=>r.kTp,RGB_PVRTC_4BPPV1_Format:()=>r.k6Q,RGB_S3TC_DXT1_Format:()=>r.IE4,RGDepthPacking:()=>r.k8v,RGFormat:()=>r.paN,RGIntegerFormat:()=>r.TkQ,RawShaderMaterial:()=>r.D$Q,Ray:()=>r.RlV,Raycaster:()=>r.tBo,RectAreaLight:()=>r.ure,RedFormat:()=>r.VT0,RedIntegerFormat:()=>r.ZQM,ReinhardToneMapping:()=>r.Mjd,RenderTarget:()=>r.O0B,RenderTarget3D:()=>r.XMJ,RenderTargetArray:()=>r.rrX,RepeatWrapping:()=>r.GJx,ReplaceStencilOp:()=>r.kG0,ReverseSubtractEquation:()=>r.nST,RingGeometry:()=>r.rKP,SIGNED_RED_GREEN_RGTC2_Format:()=>r.CWW,SIGNED_RED_RGTC1_Format:()=>r.XG_,SRGBColorSpace:()=>r.er$,SRGBTransfer:()=>r.KLL,Scene:()=>r.Z58,ShaderChunk:()=>o,ShaderLib:()=>l,ShaderMaterial:()=>r.BKk,ShadowMaterial:()=>r.q2,Shape:()=>r.ypk,ShapeGeometry:()=>r.MSw,ShapePath:()=>r.Ld9,ShapeUtils:()=>r.xJ6,ShortType:()=>r.fBL,Skeleton:()=>r.EAD,SkeletonHelper:()=>r._xc,SkinnedMesh:()=>r.I46,Source:()=>r.kLi,Sphere:()=>r.iyt,SphereGeometry:()=>r.Gu$,Spherical:()=>r.YHV,SphericalHarmonics3:()=>r.xOk,SplineCurve:()=>r.xfg,SpotLight:()=>r.nCl,SpotLightHelper:()=>r.Fpm,Sprite:()=>r.kxk,SpriteMaterial:()=>r.RoJ,SrcAlphaFactor:()=>r.ie2,SrcAlphaSaturateFactor:()=>r.hgQ,SrcColorFactor:()=>r.f4X,StaticCopyUsage:()=>r.Hrq,StaticDrawUsage:()=>r.agE,StaticReadUsage:()=>r.uXQ,StereoCamera:()=>r.keZ,StreamCopyUsage:()=>r.rOG,StreamDrawUsage:()=>r.Ktl,StreamReadUsage:()=>r.uov,StringKeyframeTrack:()=>r.hZF,SubtractEquation:()=>r.FXf,SubtractiveBlending:()=>r.Kwu,TOUCH:()=>r.wtR,TangentSpaceNormalMap:()=>r.bI3,TetrahedronGeometry:()=>r.Zpd,Texture:()=>r.gPd,TextureLoader:()=>r.Tap,TextureUtils:()=>r.Vwu,TimestampQuery:()=>r.v9J,TorusGeometry:()=>r.O3Y,TorusKnotGeometry:()=>r.UPV,Triangle:()=>r.lMl,TriangleFanDrawMode:()=>r.rYR,TriangleStripDrawMode:()=>r.O49,TrianglesDrawMode:()=>r.RJ4,TubeGeometry:()=>r.j6,UVMapping:()=>r.UTZ,Uint16BufferAttribute:()=>r.A$4,Uint32BufferAttribute:()=>r.MW4,Uint8BufferAttribute:()=>r.baL,Uint8ClampedBufferAttribute:()=>r.fc6,Uniform:()=>r.nc$,UniformsGroup:()=>r.dzP,UniformsLib:()=>s,UniformsUtils:()=>r.LlO,UnsignedByteType:()=>r.OUM,UnsignedInt248Type:()=>r.V3x,UnsignedInt5999Type:()=>r.Dmk,UnsignedIntType:()=>r.bkx,UnsignedShort4444Type:()=>r.Wew,UnsignedShort5551Type:()=>r.gJ2,UnsignedShortType:()=>r.cHt,VSMShadowMap:()=>r.RyA,Vector2:()=>r.I9Y,Vector3:()=>r.Pq0,Vector4:()=>r.IUQ,VectorKeyframeTrack:()=>r.RiT,VideoFrameTexture:()=>r.SYV,VideoTexture:()=>r.Nv2,WebGL3DRenderTarget:()=>r.ALV,WebGLArrayRenderTarget:()=>r.y9J,WebGLCoordinateSystem:()=>r.TdN,WebGLCubeRenderTarget:()=>r.o6l,WebGLRenderTarget:()=>r.nWS,WebGLRenderer:()=>Ut,WebGLUtils:()=>Pt,WebGPUCoordinateSystem:()=>r.i7u,WebXRController:()=>r.R3r,WireframeGeometry:()=>r.XJ7,WrapAroundEnding:()=>r.dhZ,ZeroCurvatureEnding:()=>r.rQf,ZeroFactor:()=>r.ojh,ZeroSlopeEnding:()=>r.h2z,ZeroStencilOp:()=>r.kqe,createCanvasElement:()=>r.lPF});var r=n(9435);function i(){let e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function a(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const i=t.get(n);if(void 0===i)t.set(n,function(t,n){const r=t.array,i=t.usage,a=r.byteLength,o=e.createBuffer();let s;if(e.bindBuffer(n,o),e.bufferData(n,r,i),t.onUploadCallback(),r instanceof Float32Array)s=e.FLOAT;else if(r instanceof Uint16Array)s=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(r instanceof Int16Array)s=e.SHORT;else if(r instanceof Uint32Array)s=e.UNSIGNED_INT;else if(r instanceof Int32Array)s=e.INT;else if(r instanceof Int8Array)s=e.BYTE;else if(r instanceof Uint8Array)s=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);s=e.UNSIGNED_BYTE}return{buffer:o,type:s,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:a}}(n,r));else if(i.version<n.version){if(i.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,r){const i=n.array,a=n.updateRanges;if(e.bindBuffer(r,t),0===a.length)e.bufferSubData(r,0,i);else{a.sort(((e,t)=>e.start-t.start));let t=0;for(let e=1;e<a.length;e++){const n=a[t],r=a[e];r.start<=n.start+n.count+1?n.count=Math.max(n.count,r.start+r.count-n.start):(++t,a[t]=r)}a.length=t+1;for(let n=0,o=a.length;n<o;n++){const t=a[n];e.bufferSubData(r,t.start*i.BYTES_PER_ELEMENT,i,t.start,t.count)}n.clearUpdateRanges()}n.onUploadCallback()}(i.buffer,n,r),i.version=n.version}}}}const o={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},s={common:{diffuse:{value:new r.Q1f(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new r.dwI},alphaMap:{value:null},alphaMapTransform:{value:new r.dwI},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new r.dwI}},envmap:{envMap:{value:null},envMapRotation:{value:new r.dwI},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new r.dwI}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new r.dwI}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new r.dwI},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new r.dwI},normalScale:{value:new r.I9Y(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new r.dwI},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new r.dwI}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new r.dwI}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new r.dwI}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new r.Q1f(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new r.Q1f(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new r.dwI},alphaTest:{value:0},uvTransform:{value:new r.dwI}},sprite:{diffuse:{value:new r.Q1f(16777215)},opacity:{value:1},center:{value:new r.I9Y(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new r.dwI},alphaMap:{value:null},alphaMapTransform:{value:new r.dwI},alphaTest:{value:0}}},l={basic:{uniforms:(0,r.Iit)([s.common,s.specularmap,s.envmap,s.aomap,s.lightmap,s.fog]),vertexShader:o.meshbasic_vert,fragmentShader:o.meshbasic_frag},lambert:{uniforms:(0,r.Iit)([s.common,s.specularmap,s.envmap,s.aomap,s.lightmap,s.emissivemap,s.bumpmap,s.normalmap,s.displacementmap,s.fog,s.lights,{emissive:{value:new r.Q1f(0)}}]),vertexShader:o.meshlambert_vert,fragmentShader:o.meshlambert_frag},phong:{uniforms:(0,r.Iit)([s.common,s.specularmap,s.envmap,s.aomap,s.lightmap,s.emissivemap,s.bumpmap,s.normalmap,s.displacementmap,s.fog,s.lights,{emissive:{value:new r.Q1f(0)},specular:{value:new r.Q1f(1118481)},shininess:{value:30}}]),vertexShader:o.meshphong_vert,fragmentShader:o.meshphong_frag},standard:{uniforms:(0,r.Iit)([s.common,s.envmap,s.aomap,s.lightmap,s.emissivemap,s.bumpmap,s.normalmap,s.displacementmap,s.roughnessmap,s.metalnessmap,s.fog,s.lights,{emissive:{value:new r.Q1f(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:o.meshphysical_vert,fragmentShader:o.meshphysical_frag},toon:{uniforms:(0,r.Iit)([s.common,s.aomap,s.lightmap,s.emissivemap,s.bumpmap,s.normalmap,s.displacementmap,s.gradientmap,s.fog,s.lights,{emissive:{value:new r.Q1f(0)}}]),vertexShader:o.meshtoon_vert,fragmentShader:o.meshtoon_frag},matcap:{uniforms:(0,r.Iit)([s.common,s.bumpmap,s.normalmap,s.displacementmap,s.fog,{matcap:{value:null}}]),vertexShader:o.meshmatcap_vert,fragmentShader:o.meshmatcap_frag},points:{uniforms:(0,r.Iit)([s.points,s.fog]),vertexShader:o.points_vert,fragmentShader:o.points_frag},dashed:{uniforms:(0,r.Iit)([s.common,s.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:o.linedashed_vert,fragmentShader:o.linedashed_frag},depth:{uniforms:(0,r.Iit)([s.common,s.displacementmap]),vertexShader:o.depth_vert,fragmentShader:o.depth_frag},normal:{uniforms:(0,r.Iit)([s.common,s.bumpmap,s.normalmap,s.displacementmap,{opacity:{value:1}}]),vertexShader:o.meshnormal_vert,fragmentShader:o.meshnormal_frag},sprite:{uniforms:(0,r.Iit)([s.sprite,s.fog]),vertexShader:o.sprite_vert,fragmentShader:o.sprite_frag},background:{uniforms:{uvTransform:{value:new r.dwI},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:o.background_vert,fragmentShader:o.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new r.dwI}},vertexShader:o.backgroundCube_vert,fragmentShader:o.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:o.cube_vert,fragmentShader:o.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:o.equirect_vert,fragmentShader:o.equirect_frag},distanceRGBA:{uniforms:(0,r.Iit)([s.common,s.displacementmap,{referencePosition:{value:new r.Pq0},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:o.distanceRGBA_vert,fragmentShader:o.distanceRGBA_frag},shadow:{uniforms:(0,r.Iit)([s.lights,s.fog,{color:{value:new r.Q1f(0)},opacity:{value:1}}]),vertexShader:o.shadow_vert,fragmentShader:o.shadow_frag}};l.physical={uniforms:(0,r.Iit)([l.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new r.dwI},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new r.dwI},clearcoatNormalScale:{value:new r.I9Y(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new r.dwI},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new r.dwI},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new r.dwI},sheen:{value:0},sheenColor:{value:new r.Q1f(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new r.dwI},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new r.dwI},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new r.dwI},transmissionSamplerSize:{value:new r.I9Y},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new r.dwI},attenuationDistance:{value:0},attenuationColor:{value:new r.Q1f(0)},specularColor:{value:new r.Q1f(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new r.dwI},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new r.dwI},anisotropyVector:{value:new r.I9Y},anisotropyMap:{value:null},anisotropyMapTransform:{value:new r.dwI}}]),vertexShader:o.meshphysical_vert,fragmentShader:o.meshphysical_frag};const c={r:0,b:0,g:0},u=new r.O9p,h=new r.kn4;function d(e,t,n,i,a,o,s){const d=new r.Q1f(0);let f,p,m=!0===o?0:1,g=null,v=0,y=null;function x(e){let r=!0===e.isScene?e.background:null;if(r&&r.isTexture){r=(e.backgroundBlurriness>0?n:t).get(r)}return r}function b(t,n){t.getRGB(c,(0,r._Ut)(e)),i.buffers.color.setClear(c.r,c.g,c.b,n,s)}return{getClearColor:function(){return d},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;d.set(e),m=t,b(d,m)},getClearAlpha:function(){return m},setClearAlpha:function(e){m=e,b(d,m)},render:function(t){let n=!1;const r=x(t);null===r?b(d,m):r&&r.isColor&&(b(r,1),n=!0);const a=e.xr.getEnvironmentBlendMode();"additive"===a?i.buffers.color.setClear(0,0,0,1,s):"alpha-blend"===a&&i.buffers.color.setClear(0,0,0,0,s),(e.autoClear||n)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const i=x(n);i&&(i.isCubeTexture||i.mapping===r.Om)?(void 0===p&&(p=new r.eaF(new r.iNn(1,1,1),new r.BKk({name:"BackgroundCubeMaterial",uniforms:(0,r.lxW)(l.backgroundCube.uniforms),vertexShader:l.backgroundCube.vertexShader,fragmentShader:l.backgroundCube.fragmentShader,side:r.hsX,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(p)),u.copy(n.backgroundRotation),u.x*=-1,u.y*=-1,u.z*=-1,i.isCubeTexture&&!1===i.isRenderTargetTexture&&(u.y*=-1,u.z*=-1),p.material.uniforms.envMap.value=i,p.material.uniforms.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,p.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,p.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,p.material.uniforms.backgroundRotation.value.setFromMatrix4(h.makeRotationFromEuler(u)),p.material.toneMapped=r.ppV.getTransfer(i.colorSpace)!==r.KLL,g===i&&v===i.version&&y===e.toneMapping||(p.material.needsUpdate=!0,g=i,v=i.version,y=e.toneMapping),p.layers.enableAll(),t.unshift(p,p.geometry,p.material,0,0,null)):i&&i.isTexture&&(void 0===f&&(f=new r.eaF(new r.bdM(2,2),new r.BKk({name:"BackgroundMaterial",uniforms:(0,r.lxW)(l.background.uniforms),vertexShader:l.background.vertexShader,fragmentShader:l.background.fragmentShader,side:r.hB5,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),f.geometry.deleteAttribute("normal"),Object.defineProperty(f.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(f)),f.material.uniforms.t2D.value=i,f.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,f.material.toneMapped=r.ppV.getTransfer(i.colorSpace)!==r.KLL,!0===i.matrixAutoUpdate&&i.updateMatrix(),f.material.uniforms.uvTransform.value.copy(i.matrix),g===i&&v===i.version&&y===e.toneMapping||(f.material.needsUpdate=!0,g=i,v=i.version,y=e.toneMapping),f.layers.enableAll(),t.unshift(f,f.geometry,f.material,0,0,null))},dispose:function(){void 0!==p&&(p.geometry.dispose(),p.material.dispose(),p=void 0),void 0!==f&&(f.geometry.dispose(),f.material.dispose(),f=void 0)}}}function f(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),i={},a=u(null);let o=a,s=!1;function l(t){return e.bindVertexArray(t)}function c(t){return e.deleteVertexArray(t)}function u(e){const t=[],r=[],i=[];for(let a=0;a<n;a++)t[a]=0,r[a]=0,i[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:i,object:e,attributes:{},index:null}}function h(){const e=o.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function d(e){f(e,0)}function f(t,n){const r=o.newAttributes,i=o.enabledAttributes,a=o.attributeDivisors;r[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1),a[t]!==n&&(e.vertexAttribDivisor(t,n),a[t]=n)}function p(){const t=o.newAttributes,n=o.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function m(t,n,r,i,a,o,s){!0===s?e.vertexAttribIPointer(t,n,r,a,o):e.vertexAttribPointer(t,n,r,i,a,o)}function g(){v(),s=!0,o!==a&&(o=a,l(o.object))}function v(){a.geometry=null,a.program=null,a.wireframe=!1}return{setup:function(n,a,c,g,v){let y=!1;const x=function(t,n,r){const a=!0===r.wireframe;let o=i[t.id];void 0===o&&(o={},i[t.id]=o);let s=o[n.id];void 0===s&&(s={},o[n.id]=s);let l=s[a];void 0===l&&(l=u(e.createVertexArray()),s[a]=l);return l}(g,c,a);o!==x&&(o=x,l(o.object)),y=function(e,t,n,r){const i=o.attributes,a=t.attributes;let s=0;const l=n.getAttributes();for(const o in l){if(l[o].location>=0){const t=i[o];let n=a[o];if(void 0===n&&("instanceMatrix"===o&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===o&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;s++}}return o.attributesNum!==s||o.index!==r}(n,g,c,v),y&&function(e,t,n,r){const i={},a=t.attributes;let s=0;const l=n.getAttributes();for(const o in l){if(l[o].location>=0){let t=a[o];void 0===t&&("instanceMatrix"===o&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===o&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),i[o]=n,s++}}o.attributes=i,o.attributesNum=s,o.index=r}(n,g,c,v),null!==v&&t.update(v,e.ELEMENT_ARRAY_BUFFER),(y||s)&&(s=!1,function(n,i,a,o){h();const s=o.attributes,l=a.getAttributes(),c=i.defaultAttributeValues;for(const u in l){const i=l[u];if(i.location>=0){let a=s[u];if(void 0===a&&("instanceMatrix"===u&&n.instanceMatrix&&(a=n.instanceMatrix),"instanceColor"===u&&n.instanceColor&&(a=n.instanceColor)),void 0!==a){const s=a.normalized,l=a.itemSize,c=t.get(a);if(void 0===c)continue;const u=c.buffer,h=c.type,p=c.bytesPerElement,g=h===e.INT||h===e.UNSIGNED_INT||a.gpuType===r.Yuy;if(a.isInterleavedBufferAttribute){const t=a.data,r=t.stride,c=a.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)f(i.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<i.locationSize;e++)d(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,u);for(let e=0;e<i.locationSize;e++)m(i.location+e,l/i.locationSize,h,s,r*p,(c+l/i.locationSize*e)*p,g)}else{if(a.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)f(i.location+e,a.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=a.meshPerAttribute*a.count)}else for(let e=0;e<i.locationSize;e++)d(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,u);for(let e=0;e<i.locationSize;e++)m(i.location+e,l/i.locationSize,h,s,l*p,l/i.locationSize*e*p,g)}}else if(void 0!==c){const t=c[u];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(i.location,t);break;case 3:e.vertexAttrib3fv(i.location,t);break;case 4:e.vertexAttrib4fv(i.location,t);break;default:e.vertexAttrib1fv(i.location,t)}}}}p()}(n,a,c,g),null!==v&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(v).buffer))},reset:g,resetDefaultState:v,dispose:function(){g();for(const e in i){const t=i[e];for(const e in t){const n=t[e];for(const e in n)c(n[e].object),delete n[e];delete t[e]}delete i[e]}},releaseStatesOfGeometry:function(e){if(void 0===i[e.id])return;const t=i[e.id];for(const n in t){const e=t[n];for(const t in e)c(e[t].object),delete e[t];delete t[n]}delete i[e.id]},releaseStatesOfProgram:function(e){for(const t in i){const n=i[t];if(void 0===n[e.id])continue;const r=n[e.id];for(const e in r)c(r[e].object),delete r[e];delete n[e.id]}},initAttributes:h,enableAttribute:d,disableUnusedAttributes:p}}function p(e,t,n){let r;function i(t,i,a){0!==a&&(e.drawArraysInstanced(r,t,i,a),n.update(i,r,a))}this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=i,this.renderMultiDraw=function(e,i,a){if(0===a)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,e,0,i,0,a);let o=0;for(let t=0;t<a;t++)o+=i[t];n.update(o,r,1)},this.renderMultiDrawInstances=function(e,a,o,s){if(0===o)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)i(e[t],a[t],s[t]);else{l.multiDrawArraysInstancedWEBGL(r,e,0,a,0,s,0,o);let t=0;for(let e=0;e<o;e++)t+=a[e]*s[e];n.update(t,r,1)}}}function m(e,t,n,i){let a;function o(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let s=void 0!==n.precision?n.precision:"highp";const l=o(s);l!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",l,"instead."),s=l);const c=!0===n.logarithmicDepthBuffer,u=!0===n.reverseDepthBuffer&&t.has("EXT_clip_control"),h=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==a)return a;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");a=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a},getMaxPrecision:o,textureFormatReadable:function(t){return t===r.GWd||i.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const a=n===r.ix0&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==r.OUM&&i.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==r.RQf&&!a)},precision:s,logarithmicDepthBuffer:c,reverseDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:d>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function g(e){const t=this;let n=null,i=0,a=!1,o=!1;const s=new r.Zcv,l=new r.dwI,c={value:null,needsUpdate:!1};function u(e,n,r,i){const a=null!==e?e.length:0;let o=null;if(0!==a){if(o=c.value,!0!==i||null===o){const t=r+4*a,i=n.matrixWorldInverse;l.getNormalMatrix(i),(null===o||o.length<t)&&(o=new Float32Array(t));for(let n=0,c=r;n!==a;++n,c+=4)s.copy(e[n]).applyMatrix4(i,l),s.normal.toArray(o,c),o[c+3]=s.constant}c.value=o,c.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,o}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==i||a;return a=t,i=e.length,n},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(e,t){n=u(e,t,0)},this.setState=function(r,s,l){const h=r.clippingPlanes,d=r.clipIntersection,f=r.clipShadows,p=e.get(r);if(!a||null===h||0===h.length||o&&!f)o?u(null):function(){c.value!==n&&(c.value=n,c.needsUpdate=i>0);t.numPlanes=i,t.numIntersection=0}();else{const e=o?0:i,t=4*e;let r=p.clippingState||null;c.value=r,r=u(h,s,t,l);for(let i=0;i!==t;++i)r[i]=n[i];p.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function v(e){let t=new WeakMap;function n(e,t){return t===r.wfO?e.mapping=r.hy7:t===r.uV5&&(e.mapping=r.xFO),e}function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(a){if(a&&a.isTexture){const o=a.mapping;if(o===r.wfO||o===r.uV5){if(t.has(a)){return n(t.get(a).texture,a.mapping)}{const o=a.image;if(o&&o.height>0){const s=new r.o6l(o.height);return s.fromEquirectangularTexture(e,a),t.set(a,s),a.addEventListener("dispose",i),n(s.texture,a.mapping)}return null}}}return a},dispose:function(){t=new WeakMap}}}const y=[.125,.215,.35,.446,.526,.582],x=20,b=new r.qUd,_=new r.Q1f;let w=null,S=0,M=0,D=!1;const E=(1+Math.sqrt(5))/2,C=1/E,A=[new r.Pq0(-E,C,0),new r.Pq0(E,C,0),new r.Pq0(-C,0,E),new r.Pq0(C,0,E),new r.Pq0(0,E,-C),new r.Pq0(0,E,C),new r.Pq0(-1,1,-1),new r.Pq0(1,1,-1),new r.Pq0(-1,1,1),new r.Pq0(1,1,1)],T=new r.Pq0;class N{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{size:a=256,position:o=T}=i;w=this._renderer.getRenderTarget(),S=this._renderer.getActiveCubeFace(),M=this._renderer.getActiveMipmapLevel(),D=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s,o),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=O(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=F(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(w,S,M),this._renderer.xr.enabled=D,e.scissorTest=!1,P(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===r.hy7||e.mapping===r.xFO?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),w=this._renderer.getRenderTarget(),S=this._renderer.getActiveCubeFace(),M=this._renderer.getActiveMipmapLevel(),D=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:r.k6q,minFilter:r.k6q,generateMipmaps:!1,type:r.ix0,format:r.GWd,colorSpace:r.Zr2,depthBuffer:!1},i=R(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=R(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],i=[];let a=e;const o=e-4+1+y.length;for(let s=0;s<o;s++){const o=Math.pow(2,a);n.push(o);let l=1/o;s>e-4?l=y[s-e+4-1]:0===s&&(l=0),i.push(l);const c=1/(o-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,m=3,g=2,v=1,x=new Float32Array(m*p*f),b=new Float32Array(g*p*f),_=new Float32Array(v*p*f);for(let e=0;e<f;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];x.set(r,m*p*e),b.set(d,g*p*e);const i=[e,e,e,e,e,e];_.set(i,v*p*e)}const w=new r.LoY;w.setAttribute("position",new r.THS(x,m)),w.setAttribute("uv",new r.THS(b,g)),w.setAttribute("faceIndex",new r.THS(_,v)),t.push(w),a>4&&a--}return{lodPlanes:t,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(e,t,n){const i=new Float32Array(x),a=new r.Pq0(0,1,0),o=new r.BKk({name:"SphericalGaussianBlur",defines:{n:x,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:r.XIg,depthTest:!1,depthWrite:!1});return o}(i,e,t)}return i}_compileMaterial(e){const t=new r.eaF(this._lodPlanes[0],e);this._renderer.compile(t,b)}_sceneToCubeUV(e,t,n,i,a){const o=new r.ubm(90,1,t,n),s=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],c=this._renderer,u=c.autoClear,h=c.toneMapping;c.getClearColor(_),c.toneMapping=r.y_p,c.autoClear=!1;const d=new r.V9B({name:"PMREM.Background",side:r.hsX,depthWrite:!1,depthTest:!1}),f=new r.eaF(new r.iNn,d);let p=!1;const m=e.background;m?m.isColor&&(d.color.copy(m),e.background=null,p=!0):(d.color.copy(_),p=!0);for(let r=0;r<6;r++){const t=r%3;0===t?(o.up.set(0,s[r],0),o.position.set(a.x,a.y,a.z),o.lookAt(a.x+l[r],a.y,a.z)):1===t?(o.up.set(0,0,s[r]),o.position.set(a.x,a.y,a.z),o.lookAt(a.x,a.y+l[r],a.z)):(o.up.set(0,s[r],0),o.position.set(a.x,a.y,a.z),o.lookAt(a.x,a.y,a.z+l[r]));const n=this._cubeSize;P(i,t*n,r>2?n:0,n,n),c.setRenderTarget(i),p&&c.render(f,o),c.render(e,o)}f.geometry.dispose(),f.material.dispose(),c.toneMapping=h,c.autoClear=u,e.background=m}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===r.hy7||e.mapping===r.xFO;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=O()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=F());const a=i?this._cubemapMaterial:this._equirectMaterial,o=new r.eaF(this._lodPlanes[0],a);a.uniforms.envMap.value=e;const s=this._cubeSize;P(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(o,b)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let i=1;i<r;i++){const t=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),n=A[(r-i-1)%A.length];this._blur(e,i-1,i,t,n)}t.autoClear=n}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,i,a,o,s){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const u=new r.eaF(this._lodPlanes[i],c),h=c.uniforms,d=this._sizeLods[n]-1,f=isFinite(a)?Math.PI/(2*d):2*Math.PI/39,p=a/f,m=isFinite(a)?1+Math.floor(3*p):x;m>x&&console.warn("sigmaRadians, ".concat(a,", is too large and will clip, as it requested ").concat(m," samples when the maximum is set to ").concat(x));const g=[];let v=0;for(let r=0;r<x;++r){const e=r/p,t=Math.exp(-e*e/2);g.push(t),0===r?v+=t:r<m&&(v+=2*t)}for(let r=0;r<g.length;r++)g[r]=g[r]/v;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=g,h.latitudinal.value="latitudinal"===o,s&&(h.poleAxis.value=s);const{_lodMax:y}=this;h.dTheta.value=f,h.mipInt.value=y-n;const _=this._sizeLods[i];P(t,3*_*(i>y-4?i-y+4:0),4*(this._cubeSize-_),3*_,2*_),l.setRenderTarget(t),l.render(u,b)}}function R(e,t,n){const i=new r.nWS(e,t,n);return i.texture.mapping=r.Om,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function P(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function F(){return new r.BKk({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:r.XIg,depthTest:!1,depthWrite:!1})}function O(){return new r.BKk({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:r.XIg,depthTest:!1,depthWrite:!1})}function I(e){let t=new WeakMap,n=null;function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(a){if(a&&a.isTexture){const o=a.mapping,s=o===r.wfO||o===r.uV5,l=o===r.hy7||o===r.xFO;if(s||l){let r=t.get(a);const o=void 0!==r?r.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==o)return null===n&&(n=new N(e)),r=s?n.fromEquirectangular(a,r):n.fromCubemap(a,r),r.texture.pmremVersion=a.pmremVersion,t.set(a,r),r.texture;if(void 0!==r)return r.texture;{const o=a.image;return s&&o&&o.height>0||l&&o&&function(e){let t=0;const n=6;for(let r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(o)?(null===n&&(n=new N(e)),r=s?n.fromEquirectangular(a):n.fromCubemap(a),r.texture.pmremVersion=a.pmremVersion,t.set(a,r),a.addEventListener("dispose",i),r.texture):null}}}return a},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function B(e){const t={};function n(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&(0,r.mcG)("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function k(e,t,n,i){const a={},o=new WeakMap;function s(e){const r=e.target;null!==r.index&&t.remove(r.index);for(const n in r.attributes)t.remove(r.attributes[n]);r.removeEventListener("dispose",s),delete a[r.id];const l=o.get(r);l&&(t.remove(l),o.delete(r)),i.releaseStatesOfGeometry(r),!0===r.isInstancedBufferGeometry&&delete r._maxInstanceCount,n.memory.geometries--}function l(e){const n=[],i=e.index,a=e.attributes.position;let s=0;if(null!==i){const e=i.array;s=i.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],a=e[t+2];n.push(r,i,i,a,a,r)}}else{if(void 0===a)return;{const e=a.array;s=a.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}}const l=new((0,r.AQS)(n)?r.MW4:r.A$4)(n,1);l.version=s;const c=o.get(e);c&&t.remove(c),o.set(e,l)}return{get:function(e,t){return!0===a[t.id]||(t.addEventListener("dispose",s),a[t.id]=!0,n.memory.geometries++),t},update:function(n){const r=n.attributes;for(const i in r)t.update(r[i],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){const t=o.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&l(e)}else l(e);return o.get(e)}}}function L(e,t,n){let r,i,a;function o(t,o,s){0!==s&&(e.drawElementsInstanced(r,o,i,t*a,s),n.update(o,r,s))}this.setMode=function(e){r=e},this.setIndex=function(e){i=e.type,a=e.bytesPerElement},this.render=function(t,o){e.drawElements(r,o,i,t*a),n.update(o,r,1)},this.renderInstances=o,this.renderMultiDraw=function(e,a,o){if(0===o)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,a,0,i,e,0,o);let s=0;for(let t=0;t<o;t++)s+=a[t];n.update(s,r,1)},this.renderMultiDrawInstances=function(e,s,l,c){if(0===l)return;const u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)o(e[t]/a,s[t],c[t]);else{u.multiDrawElementsInstancedWEBGL(r,s,0,i,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=s[e]*c[e];n.update(t,r,1)}}}function U(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function z(e,t,n){const i=new WeakMap,a=new r.IUQ;return{update:function(o,s,l){const c=o.morphTargetInfluences,u=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,h=void 0!==u?u.length:0;let d=i.get(s);if(void 0===d||d.count!==h){void 0!==d&&d.texture.dispose();const f=void 0!==s.morphAttributes.position,p=void 0!==s.morphAttributes.normal,m=void 0!==s.morphAttributes.color,g=s.morphAttributes.position||[],v=s.morphAttributes.normal||[],y=s.morphAttributes.color||[];let x=0;!0===f&&(x=1),!0===p&&(x=2),!0===m&&(x=3);let b=s.attributes.position.count*x,_=1;b>t.maxTextureSize&&(_=Math.ceil(b/t.maxTextureSize),b=t.maxTextureSize);const w=new Float32Array(b*_*4*h),S=new r.rFo(w,b,_,h);S.type=r.RQf,S.needsUpdate=!0;const M=4*x;for(let E=0;E<h;E++){const C=g[E],A=v[E],T=y[E],N=b*_*4*E;for(let R=0;R<C.count;R++){const P=R*M;!0===f&&(a.fromBufferAttribute(C,R),w[N+P+0]=a.x,w[N+P+1]=a.y,w[N+P+2]=a.z,w[N+P+3]=0),!0===p&&(a.fromBufferAttribute(A,R),w[N+P+4]=a.x,w[N+P+5]=a.y,w[N+P+6]=a.z,w[N+P+7]=0),!0===m&&(a.fromBufferAttribute(T,R),w[N+P+8]=a.x,w[N+P+9]=a.y,w[N+P+10]=a.z,w[N+P+11]=4===T.itemSize?a.w:1)}}function D(){S.dispose(),i.delete(s),s.removeEventListener("dispose",D)}d={count:h,texture:S,size:new r.I9Y(b,_)},i.set(s,d),s.addEventListener("dispose",D)}if(!0===o.isInstancedMesh&&null!==o.morphTexture)l.getUniforms().setValue(e,"morphTexture",o.morphTexture,n);else{let F=0;for(let I=0;I<c.length;I++)F+=c[I];const O=s.morphTargetsRelative?1:1-F;l.getUniforms().setValue(e,"morphTargetBaseInfluence",O),l.getUniforms().setValue(e,"morphTargetInfluences",c)}l.getUniforms().setValue(e,"morphTargetsTexture",d.texture,n),l.getUniforms().setValue(e,"morphTargetsTextureSize",d.size)}}}function H(e,t,n,r){let i=new WeakMap;function a(e){const t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){const s=r.render.frame,l=o.geometry,c=t.get(o,l);if(i.get(c)!==s&&(t.update(c),i.set(c,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",a)&&o.addEventListener("dispose",a),i.get(o)!==s&&(n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER),i.set(o,s))),o.isSkinnedMesh){const e=o.skeleton;i.get(e)!==s&&(e.update(),i.set(e,s))}return c},dispose:function(){i=new WeakMap}}}const V=new r.gPd,G=new r.VCu(1,1),q=new r.rFo,j=new r.dYF,W=new r.b4q,X=[],Y=[],Z=new Float32Array(16),K=new Float32Array(9),Q=new Float32Array(4);function J(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let a=X[i];if(void 0===a&&(a=new Float32Array(i),X[i]=a),0!==t){r.toArray(a,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(a,i)}return a}function $(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function ee(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function te(e,t){let n=Y[t];void 0===n&&(n=new Int32Array(t),Y[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function ne(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function re(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if($(n,t))return;e.uniform2fv(this.addr,t),ee(n,t)}}function ie(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if($(n,t))return;e.uniform3fv(this.addr,t),ee(n,t)}}function ae(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if($(n,t))return;e.uniform4fv(this.addr,t),ee(n,t)}}function oe(e,t){const n=this.cache,r=t.elements;if(void 0===r){if($(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),ee(n,t)}else{if($(n,r))return;Q.set(r),e.uniformMatrix2fv(this.addr,!1,Q),ee(n,r)}}function se(e,t){const n=this.cache,r=t.elements;if(void 0===r){if($(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),ee(n,t)}else{if($(n,r))return;K.set(r),e.uniformMatrix3fv(this.addr,!1,K),ee(n,r)}}function le(e,t){const n=this.cache,r=t.elements;if(void 0===r){if($(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),ee(n,t)}else{if($(n,r))return;Z.set(r),e.uniformMatrix4fv(this.addr,!1,Z),ee(n,r)}}function ce(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function ue(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if($(n,t))return;e.uniform2iv(this.addr,t),ee(n,t)}}function he(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if($(n,t))return;e.uniform3iv(this.addr,t),ee(n,t)}}function de(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if($(n,t))return;e.uniform4iv(this.addr,t),ee(n,t)}}function fe(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function pe(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if($(n,t))return;e.uniform2uiv(this.addr,t),ee(n,t)}}function me(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if($(n,t))return;e.uniform3uiv(this.addr,t),ee(n,t)}}function ge(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if($(n,t))return;e.uniform4uiv(this.addr,t),ee(n,t)}}function ve(e,t,n){const i=this.cache,a=n.allocateTextureUnit();let o;i[0]!==a&&(e.uniform1i(this.addr,a),i[0]=a),this.type===e.SAMPLER_2D_SHADOW?(G.compareFunction=r.TiK,o=G):o=V,n.setTexture2D(t||o,a)}function ye(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||j,i)}function xe(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||W,i)}function be(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||q,i)}function _e(e,t){e.uniform1fv(this.addr,t)}function we(e,t){const n=J(t,this.size,2);e.uniform2fv(this.addr,n)}function Se(e,t){const n=J(t,this.size,3);e.uniform3fv(this.addr,n)}function Me(e,t){const n=J(t,this.size,4);e.uniform4fv(this.addr,n)}function De(e,t){const n=J(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Ee(e,t){const n=J(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Ce(e,t){const n=J(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Ae(e,t){e.uniform1iv(this.addr,t)}function Te(e,t){e.uniform2iv(this.addr,t)}function Ne(e,t){e.uniform3iv(this.addr,t)}function Re(e,t){e.uniform4iv(this.addr,t)}function Pe(e,t){e.uniform1uiv(this.addr,t)}function Fe(e,t){e.uniform2uiv(this.addr,t)}function Oe(e,t){e.uniform3uiv(this.addr,t)}function Ie(e,t){e.uniform4uiv(this.addr,t)}function Be(e,t,n){const r=this.cache,i=t.length,a=te(n,i);$(r,a)||(e.uniform1iv(this.addr,a),ee(r,a));for(let o=0;o!==i;++o)n.setTexture2D(t[o]||V,a[o])}function ke(e,t,n){const r=this.cache,i=t.length,a=te(n,i);$(r,a)||(e.uniform1iv(this.addr,a),ee(r,a));for(let o=0;o!==i;++o)n.setTexture3D(t[o]||j,a[o])}function Le(e,t,n){const r=this.cache,i=t.length,a=te(n,i);$(r,a)||(e.uniform1iv(this.addr,a),ee(r,a));for(let o=0;o!==i;++o)n.setTextureCube(t[o]||W,a[o])}function Ue(e,t,n){const r=this.cache,i=t.length,a=te(n,i);$(r,a)||(e.uniform1iv(this.addr,a),ee(r,a));for(let o=0;o!==i;++o)n.setTexture2DArray(t[o]||q,a[o])}class ze{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return ne;case 35664:return re;case 35665:return ie;case 35666:return ae;case 35674:return oe;case 35675:return se;case 35676:return le;case 5124:case 35670:return ce;case 35667:case 35671:return ue;case 35668:case 35672:return he;case 35669:case 35673:return de;case 5125:return fe;case 36294:return pe;case 36295:return me;case 36296:return ge;case 35678:case 36198:case 36298:case 36306:case 35682:return ve;case 35679:case 36299:case 36307:return ye;case 35680:case 36300:case 36308:case 36293:return xe;case 36289:case 36303:case 36311:case 36292:return be}}(t.type)}}class He{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return _e;case 35664:return we;case 35665:return Se;case 35666:return Me;case 35674:return De;case 35675:return Ee;case 35676:return Ce;case 5124:case 35670:return Ae;case 35667:case 35671:return Te;case 35668:case 35672:return Ne;case 35669:case 35673:return Re;case 5125:return Pe;case 36294:return Fe;case 36295:return Oe;case 36296:return Ie;case 35678:case 36198:case 36298:case 36306:case 35682:return Be;case 35679:case 36299:case 36307:return ke;case 35680:case 36300:case 36308:case 36293:return Le;case 36289:case 36303:case 36311:case 36292:return Ue}}(t.type)}}class Ve{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,a=r.length;i!==a;++i){const a=r[i];a.setValue(e,t[a.id],n)}}}const Ge=/(\w+)(\])?(\[|\.)?/g;function qe(e,t){e.seq.push(t),e.map[t.id]=t}function je(e,t,n){const r=e.name,i=r.length;for(Ge.lastIndex=0;;){const a=Ge.exec(r),o=Ge.lastIndex;let s=a[1];const l="]"===a[2],c=a[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===i){qe(n,void 0===c?new ze(s,e,t):new He(s,e,t));break}{let e=n.map[s];void 0===e&&(e=new Ve(s),qe(n,e)),n=e}}}class We{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);je(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){const a=t[i],o=n[a.id];!1!==o.needsUpdate&&a.setValue(e,o.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n}}function Xe(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}let Ye=0;const Ze=new r.dwI;function Ke(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const r=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let o=i;o<a;o++){const e=o+1;r.push("".concat(e===t?">":" "," ").concat(e,": ").concat(n[o]))}return r.join("\n")}(e.getShaderSource(t),r)}return i}function Qe(e,t){const n=function(e){r.ppV._getMatrix(Ze,r.ppV.workingColorSpace,e);const t="mat3( ".concat(Ze.elements.map((e=>e.toFixed(4)))," )");switch(r.ppV.getTransfer(e)){case r.VxR:return[t,"LinearTransferOETF"];case r.KLL:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return["vec4 ".concat(e,"( vec4 value ) {"),"\treturn ".concat(n[1],"( vec4( value.rgb * ").concat(n[0],", value.a ) );"),"}"].join("\n")}function Je(e,t){let n;switch(t){case r.kyO:n="Linear";break;case r.Mjd:n="Reinhard";break;case r.nNL:n="Cineon";break;case r.FV:n="ACESFilmic";break;case r.LAk:n="AgX";break;case r.aJ8:n="Neutral";break;case r.g7M:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const $e=new r.Pq0;function et(){r.ppV.getLuminanceCoefficients($e);const e=$e.x.toFixed(4),t=$e.y.toFixed(4),n=$e.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","\tconst vec3 weights = vec3( ".concat(e,", ").concat(t,", ").concat(n," );"),"\treturn dot( weights, rgb );","}"].join("\n")}function tt(e){return""!==e}function nt(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function rt(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const it=/^[ \t]*#include +<([\w\d./]+)>/gm;function at(e){return e.replace(it,st)}const ot=new Map;function st(e,t){let n=o[t];if(void 0===n){const e=ot.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=o[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return at(n)}const lt=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ct(e){return e.replace(lt,ut)}function ut(e,t,n,r){let i="";for(let a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function ht(e){let t="precision ".concat(e.precision," float;\n\tprecision ").concat(e.precision," int;\n\tprecision ").concat(e.precision," sampler2D;\n\tprecision ").concat(e.precision," samplerCube;\n\tprecision ").concat(e.precision," sampler3D;\n\tprecision ").concat(e.precision," sampler2DArray;\n\tprecision ").concat(e.precision," sampler2DShadow;\n\tprecision ").concat(e.precision," samplerCubeShadow;\n\tprecision ").concat(e.precision," sampler2DArrayShadow;\n\tprecision ").concat(e.precision," isampler2D;\n\tprecision ").concat(e.precision," isampler3D;\n\tprecision ").concat(e.precision," isamplerCube;\n\tprecision ").concat(e.precision," isampler2DArray;\n\tprecision ").concat(e.precision," usampler2D;\n\tprecision ").concat(e.precision," usampler3D;\n\tprecision ").concat(e.precision," usamplerCube;\n\tprecision ").concat(e.precision," usampler2DArray;\n\t");return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function dt(e,t,n,i){const a=e.getContext(),s=n.defines;let l=n.vertexShader,c=n.fragmentShader;const u=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===r.QP0?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===r.Wk7?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===r.RyA&&(t="SHADOWMAP_TYPE_VSM"),t}(n),h=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case r.hy7:case r.xFO:t="ENVMAP_TYPE_CUBE";break;case r.Om:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),d=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===r.xFO&&(t="ENVMAP_MODE_REFRACTION");return t}(n),f=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case r.caT:t="ENVMAP_BLENDING_MULTIPLY";break;case r.KRh:t="ENVMAP_BLENDING_MIX";break;case r.XrR:t="ENVMAP_BLENDING_ADD"}return t}(n),p=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),m=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(tt).join("\n")}(n),g=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(s),v=a.createProgram();let y,x,b=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g].filter(tt).join("\n"),y.length>0&&(y+="\n"),x=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g].filter(tt).join("\n"),x.length>0&&(x+="\n")):(y=[ht(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(tt).join("\n"),x=[ht(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+d:"",n.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==r.y_p?"#define TONE_MAPPING":"",n.toneMapping!==r.y_p?o.tonemapping_pars_fragment:"",n.toneMapping!==r.y_p?Je("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",o.colorspace_pars_fragment,Qe("linearToOutputTexel",n.outputColorSpace),et(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(tt).join("\n")),l=at(l),l=nt(l,n),l=rt(l,n),c=at(c),c=nt(c,n),c=rt(c,n),l=ct(l),c=ct(c),!0!==n.isRawShaderMaterial&&(b="#version 300 es\n",y=[m,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+y,x=["#define varying in",n.glslVersion===r.Wdf?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===r.Wdf?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+x);const _=b+y+l,w=b+x+c,S=Xe(a,a.VERTEX_SHADER,_),M=Xe(a,a.FRAGMENT_SHADER,w);function D(t){if(e.debug.checkShaderErrors){const n=a.getProgramInfoLog(v).trim(),r=a.getShaderInfoLog(S).trim(),i=a.getShaderInfoLog(M).trim();let o=!0,s=!0;if(!1===a.getProgramParameter(v,a.LINK_STATUS))if(o=!1,"function"===typeof e.debug.onShaderError)e.debug.onShaderError(a,v,S,M);else{const e=Ke(a,S,"vertex"),r=Ke(a,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(v,a.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+n+"\n"+e+"\n"+r)}else""!==n?console.warn("THREE.WebGLProgram: Program Info Log:",n):""!==r&&""!==i||(s=!1);s&&(t.diagnostics={runnable:o,programLog:n,vertexShader:{log:r,prefix:y},fragmentShader:{log:i,prefix:x}})}a.deleteShader(S),a.deleteShader(M),E=new We(a,v),C=function(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),a=r.name;let o=1;r.type===e.FLOAT_MAT2&&(o=2),r.type===e.FLOAT_MAT3&&(o=3),r.type===e.FLOAT_MAT4&&(o=4),n[a]={type:r.type,location:e.getAttribLocation(t,a),locationSize:o}}return n}(a,v)}let E,C;a.attachShader(v,S),a.attachShader(v,M),void 0!==n.index0AttributeName?a.bindAttribLocation(v,0,n.index0AttributeName):!0===n.morphTargets&&a.bindAttribLocation(v,0,"position"),a.linkProgram(v),this.getUniforms=function(){return void 0===E&&D(this),E},this.getAttributes=function(){return void 0===C&&D(this),C};let A=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===A&&(A=a.getProgramParameter(v,37297)),A},this.destroy=function(){i.releaseStatesOfProgram(this),a.deleteProgram(v),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Ye++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=S,this.fragmentShader=M,this}let ft=0;class pt{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new mt(e),t.set(e,n)),n}}class mt{constructor(e){this.id=ft++,this.code=e,this.usedTimes=0}}function gt(e,t,n,i,a,o,s){const c=new r.zgK,u=new pt,h=new Set,d=[],f=a.logarithmicDepthBuffer,p=a.vertexTextures;let m=a.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(e){return h.add(e),0===e?"uv":"uv".concat(e)}return{getParameters:function(o,c,d,y,x){const b=y.fog,_=x.geometry,w=o.isMeshStandardMaterial?y.environment:null,S=(o.isMeshStandardMaterial?n:t).get(o.envMap||w),M=S&&S.mapping===r.Om?S.image.height:null,D=g[o.type];null!==o.precision&&(m=a.getMaxPrecision(o.precision),m!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",m,"instead."));const E=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,C=void 0!==E?E.length:0;let A,T,N,R,P=0;if(void 0!==_.morphAttributes.position&&(P=1),void 0!==_.morphAttributes.normal&&(P=2),void 0!==_.morphAttributes.color&&(P=3),D){const e=l[D];A=e.vertexShader,T=e.fragmentShader}else A=o.vertexShader,T=o.fragmentShader,u.update(o),N=u.getVertexShaderID(o),R=u.getFragmentShaderID(o);const F=e.getRenderTarget(),O=e.state.buffers.depth.getReversed(),I=!0===x.isInstancedMesh,B=!0===x.isBatchedMesh,k=!!o.map,L=!!o.matcap,U=!!S,z=!!o.aoMap,H=!!o.lightMap,V=!!o.bumpMap,G=!!o.normalMap,q=!!o.displacementMap,j=!!o.emissiveMap,W=!!o.metalnessMap,X=!!o.roughnessMap,Y=o.anisotropy>0,Z=o.clearcoat>0,K=o.dispersion>0,Q=o.iridescence>0,J=o.sheen>0,$=o.transmission>0,ee=Y&&!!o.anisotropyMap,te=Z&&!!o.clearcoatMap,ne=Z&&!!o.clearcoatNormalMap,re=Z&&!!o.clearcoatRoughnessMap,ie=Q&&!!o.iridescenceMap,ae=Q&&!!o.iridescenceThicknessMap,oe=J&&!!o.sheenColorMap,se=J&&!!o.sheenRoughnessMap,le=!!o.specularMap,ce=!!o.specularColorMap,ue=!!o.specularIntensityMap,he=$&&!!o.transmissionMap,de=$&&!!o.thicknessMap,fe=!!o.gradientMap,pe=!!o.alphaMap,me=o.alphaTest>0,ge=!!o.alphaHash,ve=!!o.extensions;let ye=r.y_p;o.toneMapped&&(null!==F&&!0!==F.isXRRenderTarget||(ye=e.toneMapping));const xe={shaderID:D,shaderType:o.type,shaderName:o.name,vertexShader:A,fragmentShader:T,defines:o.defines,customVertexShaderID:N,customFragmentShaderID:R,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:m,batching:B,batchingColor:B&&null!==x._colorsTexture,instancing:I,instancingColor:I&&null!==x.instanceColor,instancingMorph:I&&null!==x.morphTexture,supportsVertexTextures:p,outputColorSpace:null===F?e.outputColorSpace:!0===F.isXRRenderTarget?F.texture.colorSpace:r.Zr2,alphaToCoverage:!!o.alphaToCoverage,map:k,matcap:L,envMap:U,envMapMode:U&&S.mapping,envMapCubeUVHeight:M,aoMap:z,lightMap:H,bumpMap:V,normalMap:G,displacementMap:p&&q,emissiveMap:j,normalMapObjectSpace:G&&o.normalMapType===r.vyJ,normalMapTangentSpace:G&&o.normalMapType===r.bI3,metalnessMap:W,roughnessMap:X,anisotropy:Y,anisotropyMap:ee,clearcoat:Z,clearcoatMap:te,clearcoatNormalMap:ne,clearcoatRoughnessMap:re,dispersion:K,iridescence:Q,iridescenceMap:ie,iridescenceThicknessMap:ae,sheen:J,sheenColorMap:oe,sheenRoughnessMap:se,specularMap:le,specularColorMap:ce,specularIntensityMap:ue,transmission:$,transmissionMap:he,thicknessMap:de,gradientMap:fe,opaque:!1===o.transparent&&o.blending===r.NTi&&!1===o.alphaToCoverage,alphaMap:pe,alphaTest:me,alphaHash:ge,combine:o.combine,mapUv:k&&v(o.map.channel),aoMapUv:z&&v(o.aoMap.channel),lightMapUv:H&&v(o.lightMap.channel),bumpMapUv:V&&v(o.bumpMap.channel),normalMapUv:G&&v(o.normalMap.channel),displacementMapUv:q&&v(o.displacementMap.channel),emissiveMapUv:j&&v(o.emissiveMap.channel),metalnessMapUv:W&&v(o.metalnessMap.channel),roughnessMapUv:X&&v(o.roughnessMap.channel),anisotropyMapUv:ee&&v(o.anisotropyMap.channel),clearcoatMapUv:te&&v(o.clearcoatMap.channel),clearcoatNormalMapUv:ne&&v(o.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:re&&v(o.clearcoatRoughnessMap.channel),iridescenceMapUv:ie&&v(o.iridescenceMap.channel),iridescenceThicknessMapUv:ae&&v(o.iridescenceThicknessMap.channel),sheenColorMapUv:oe&&v(o.sheenColorMap.channel),sheenRoughnessMapUv:se&&v(o.sheenRoughnessMap.channel),specularMapUv:le&&v(o.specularMap.channel),specularColorMapUv:ce&&v(o.specularColorMap.channel),specularIntensityMapUv:ue&&v(o.specularIntensityMap.channel),transmissionMapUv:he&&v(o.transmissionMap.channel),thicknessMapUv:de&&v(o.thicknessMap.channel),alphaMapUv:pe&&v(o.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(G||Y),vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,pointsUvs:!0===x.isPoints&&!!_.attributes.uv&&(k||pe),fog:!!b,useFog:!0===o.fog,fogExp2:!!b&&b.isFogExp2,flatShading:!0===o.flatShading,sizeAttenuation:!0===o.sizeAttenuation,logarithmicDepthBuffer:f,reverseDepthBuffer:O,skinning:!0===x.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:C,morphTextureStride:P,numDirLights:c.directional.length,numPointLights:c.point.length,numSpotLights:c.spot.length,numSpotLightMaps:c.spotLightMap.length,numRectAreaLights:c.rectArea.length,numHemiLights:c.hemi.length,numDirLightShadows:c.directionalShadowMap.length,numPointLightShadows:c.pointShadowMap.length,numSpotLightShadows:c.spotShadowMap.length,numSpotLightShadowsWithMaps:c.numSpotLightShadowsWithMaps,numLightProbes:c.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:o.dithering,shadowMapEnabled:e.shadowMap.enabled&&d.length>0,shadowMapType:e.shadowMap.type,toneMapping:ye,decodeVideoTexture:k&&!0===o.map.isVideoTexture&&r.ppV.getTransfer(o.map.colorSpace)===r.KLL,decodeVideoTextureEmissive:j&&!0===o.emissiveMap.isVideoTexture&&r.ppV.getTransfer(o.emissiveMap.colorSpace)===r.KLL,premultipliedAlpha:o.premultipliedAlpha,doubleSided:o.side===r.$EB,flipSided:o.side===r.hsX,useDepthPacking:o.depthPacking>=0,depthPacking:o.depthPacking||0,index0AttributeName:o.index0AttributeName,extensionClipCullDistance:ve&&!0===o.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ve&&!0===o.extensions.multiDraw||B)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:o.customProgramCacheKey()};return xe.vertexUv1s=h.has(1),xe.vertexUv2s=h.has(2),xe.vertexUv3s=h.has(3),h.clear(),xe},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){c.disableAll(),t.supportsVertexTextures&&c.enable(0);t.instancing&&c.enable(1);t.instancingColor&&c.enable(2);t.instancingMorph&&c.enable(3);t.matcap&&c.enable(4);t.envMap&&c.enable(5);t.normalMapObjectSpace&&c.enable(6);t.normalMapTangentSpace&&c.enable(7);t.clearcoat&&c.enable(8);t.iridescence&&c.enable(9);t.alphaTest&&c.enable(10);t.vertexColors&&c.enable(11);t.vertexAlphas&&c.enable(12);t.vertexUv1s&&c.enable(13);t.vertexUv2s&&c.enable(14);t.vertexUv3s&&c.enable(15);t.vertexTangents&&c.enable(16);t.anisotropy&&c.enable(17);t.alphaHash&&c.enable(18);t.batching&&c.enable(19);t.dispersion&&c.enable(20);t.batchingColor&&c.enable(21);e.push(c.mask),c.disableAll(),t.fog&&c.enable(0);t.useFog&&c.enable(1);t.flatShading&&c.enable(2);t.logarithmicDepthBuffer&&c.enable(3);t.reverseDepthBuffer&&c.enable(4);t.skinning&&c.enable(5);t.morphTargets&&c.enable(6);t.morphNormals&&c.enable(7);t.morphColors&&c.enable(8);t.premultipliedAlpha&&c.enable(9);t.shadowMapEnabled&&c.enable(10);t.doubleSided&&c.enable(11);t.flipSided&&c.enable(12);t.useDepthPacking&&c.enable(13);t.dithering&&c.enable(14);t.transmission&&c.enable(15);t.sheen&&c.enable(16);t.opaque&&c.enable(17);t.pointsUvs&&c.enable(18);t.decodeVideoTexture&&c.enable(19);t.decodeVideoTextureEmissive&&c.enable(20);t.alphaToCoverage&&c.enable(21);e.push(c.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=g[e.type];let n;if(t){const e=l[t];n=r.LlO.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r;for(let e=0,i=d.length;e<i;e++){const t=d[e];if(t.cacheKey===n){r=t,++r.usedTimes;break}}return void 0===r&&(r=new dt(e,n,t,o),d.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){const t=d.indexOf(e);d[t]=d[d.length-1],d.pop(),e.destroy()}},releaseShaderCache:function(e){u.remove(e)},programs:d,dispose:function(){u.dispose()}}}function vt(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function yt(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function xt(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function bt(){const e=[];let t=0;const n=[],r=[],i=[];function a(n,r,i,a,o,s){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:o,group:s},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=o,l.group=s),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,o,s,l,c){const u=a(e,t,o,s,l,c);o.transmission>0?r.push(u):!0===o.transparent?i.push(u):n.push(u)},unshift:function(e,t,o,s,l,c){const u=a(e,t,o,s,l,c);o.transmission>0?r.unshift(u):!0===o.transparent?i.unshift(u):n.unshift(u)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||yt),r.length>1&&r.sort(t||xt),i.length>1&&i.sort(t||xt)}}}function _t(){let e=new WeakMap;return{get:function(t,n){const r=e.get(t);let i;return void 0===r?(i=new bt,e.set(t,[i])):n>=r.length?(i=new bt,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function wt(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new r.Pq0,color:new r.Q1f};break;case"SpotLight":n={position:new r.Pq0,direction:new r.Pq0,color:new r.Q1f,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new r.Pq0,color:new r.Q1f,distance:0,decay:0};break;case"HemisphereLight":n={direction:new r.Pq0,skyColor:new r.Q1f,groundColor:new r.Q1f};break;case"RectAreaLight":n={color:new r.Q1f,position:new r.Pq0,halfWidth:new r.Pq0,halfHeight:new r.Pq0}}return e[t.id]=n,n}}}let St=0;function Mt(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Dt(e){const t=new wt,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new r.I9Y};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new r.I9Y,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let s=0;s<9;s++)i.probe.push(new r.Pq0);const a=new r.Pq0,o=new r.kn4,l=new r.kn4;return{setup:function(r){let a=0,o=0,l=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let c=0,u=0,h=0,d=0,f=0,p=0,m=0,g=0,v=0,y=0,x=0;r.sort(Mt);for(let e=0,s=r.length;e<s;e++){const s=r[e],b=s.color,_=s.intensity,w=s.distance,S=s.shadow&&s.shadow.map?s.shadow.map.texture:null;if(s.isAmbientLight)a+=b.r*_,o+=b.g*_,l+=b.b*_;else if(s.isLightProbe){for(let e=0;e<9;e++)i.probe[e].addScaledVector(s.sh.coefficients[e],_);x++}else if(s.isDirectionalLight){const e=t.get(s);if(e.color.copy(s.color).multiplyScalar(s.intensity),s.castShadow){const e=s.shadow,t=n.get(s);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,i.directionalShadow[c]=t,i.directionalShadowMap[c]=S,i.directionalShadowMatrix[c]=s.shadow.matrix,p++}i.directional[c]=e,c++}else if(s.isSpotLight){const e=t.get(s);e.position.setFromMatrixPosition(s.matrixWorld),e.color.copy(b).multiplyScalar(_),e.distance=w,e.coneCos=Math.cos(s.angle),e.penumbraCos=Math.cos(s.angle*(1-s.penumbra)),e.decay=s.decay,i.spot[h]=e;const r=s.shadow;if(s.map&&(i.spotLightMap[v]=s.map,v++,r.updateMatrices(s),s.castShadow&&y++),i.spotLightMatrix[h]=r.matrix,s.castShadow){const e=n.get(s);e.shadowIntensity=r.intensity,e.shadowBias=r.bias,e.shadowNormalBias=r.normalBias,e.shadowRadius=r.radius,e.shadowMapSize=r.mapSize,i.spotShadow[h]=e,i.spotShadowMap[h]=S,g++}h++}else if(s.isRectAreaLight){const e=t.get(s);e.color.copy(b).multiplyScalar(_),e.halfWidth.set(.5*s.width,0,0),e.halfHeight.set(0,.5*s.height,0),i.rectArea[d]=e,d++}else if(s.isPointLight){const e=t.get(s);if(e.color.copy(s.color).multiplyScalar(s.intensity),e.distance=s.distance,e.decay=s.decay,s.castShadow){const e=s.shadow,t=n.get(s);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,i.pointShadow[u]=t,i.pointShadowMap[u]=S,i.pointShadowMatrix[u]=s.shadow.matrix,m++}i.point[u]=e,u++}else if(s.isHemisphereLight){const e=t.get(s);e.skyColor.copy(s.color).multiplyScalar(_),e.groundColor.copy(s.groundColor).multiplyScalar(_),i.hemi[f]=e,f++}}d>0&&(!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=s.LTC_FLOAT_1,i.rectAreaLTC2=s.LTC_FLOAT_2):(i.rectAreaLTC1=s.LTC_HALF_1,i.rectAreaLTC2=s.LTC_HALF_2)),i.ambient[0]=a,i.ambient[1]=o,i.ambient[2]=l;const b=i.hash;b.directionalLength===c&&b.pointLength===u&&b.spotLength===h&&b.rectAreaLength===d&&b.hemiLength===f&&b.numDirectionalShadows===p&&b.numPointShadows===m&&b.numSpotShadows===g&&b.numSpotMaps===v&&b.numLightProbes===x||(i.directional.length=c,i.spot.length=h,i.rectArea.length=d,i.point.length=u,i.hemi.length=f,i.directionalShadow.length=p,i.directionalShadowMap.length=p,i.pointShadow.length=m,i.pointShadowMap.length=m,i.spotShadow.length=g,i.spotShadowMap.length=g,i.directionalShadowMatrix.length=p,i.pointShadowMatrix.length=m,i.spotLightMatrix.length=g+v-y,i.spotLightMap.length=v,i.numSpotLightShadowsWithMaps=y,i.numLightProbes=x,b.directionalLength=c,b.pointLength=u,b.spotLength=h,b.rectAreaLength=d,b.hemiLength=f,b.numDirectionalShadows=p,b.numPointShadows=m,b.numSpotShadows=g,b.numSpotMaps=v,b.numLightProbes=x,i.version=St++)},setupView:function(e,t){let n=0,r=0,s=0,c=0,u=0;const h=t.matrixWorldInverse;for(let d=0,f=e.length;d<f;d++){const t=e[d];if(t.isDirectionalLight){const e=i.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),a.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(h),n++}else if(t.isSpotLight){const e=i.spot[s];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(t.matrixWorld),a.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(h),s++}else if(t.isRectAreaLight){const e=i.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),l.identity(),o.copy(t.matrixWorld),o.premultiply(h),l.extractRotation(o),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(l),e.halfHeight.applyMatrix4(l),c++}else if(t.isPointLight){const e=i.point[r];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),r++}else if(t.isHemisphereLight){const e=i.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(h),u++}}},state:i}}function Et(e){const t=new Dt(e),n=[],r=[];const i={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){i.camera=e,n.length=0,r.length=0},state:i,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function Ct(e){let t=new WeakMap;return{get:function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=t.get(n);let a;return void 0===i?(a=new Et(e),t.set(n,[a])):r>=i.length?(a=new Et(e),i.push(a)):a=i[r],a},dispose:function(){t=new WeakMap}}}function At(e,t,n){let i=new r.PPD;const a=new r.I9Y,o=new r.I9Y,s=new r.IUQ,l=new r.CSG({depthPacking:r.N5j}),c=new r.aVO,u={},h=n.maxTextureSize,d={[r.hB5]:r.hsX,[r.hsX]:r.hB5,[r.$EB]:r.$EB},f=new r.BKk({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new r.I9Y},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=f.clone();p.defines.HORIZONTAL_PASS=1;const m=new r.LoY;m.setAttribute("position",new r.THS(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new r.eaF(m,f),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=r.QP0;let y=this.type;function x(n,i){const o=t.update(g);f.defines.VSM_SAMPLES!==n.blurSamples&&(f.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,f.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new r.nWS(a.x,a.y)),f.uniforms.shadow_pass.value=n.map.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,o,f,g,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,o,p,g,null)}function b(t,n,i,a){let o=null;const s=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==s)o=s;else if(o=!0===i.isPointLight?c:l,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const e=o.uuid,t=n.uuid;let r=u[e];void 0===r&&(r={},u[e]=r);let i=r[t];void 0===i&&(i=o.clone(),r[t]=i,n.addEventListener("dispose",w)),o=i}if(o.visible=n.visible,o.wireframe=n.wireframe,a===r.RyA?o.side=null!==n.shadowSide?n.shadowSide:n.side:o.side=null!==n.shadowSide?n.shadowSide:d[n.side],o.alphaMap=n.alphaMap,o.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,o.map=n.map,o.clipShadows=n.clipShadows,o.clippingPlanes=n.clippingPlanes,o.clipIntersection=n.clipIntersection,o.displacementMap=n.displacementMap,o.displacementScale=n.displacementScale,o.displacementBias=n.displacementBias,o.wireframeLinewidth=n.wireframeLinewidth,o.linewidth=n.linewidth,!0===i.isPointLight&&!0===o.isMeshDistanceMaterial){e.properties.get(o).light=i}return o}function _(n,a,o,s,l){if(!1===n.visible)return;if(n.layers.test(a.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&l===r.RyA)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const r=t.update(n),i=n.material;if(Array.isArray(i)){const t=r.groups;for(let c=0,u=t.length;c<u;c++){const u=t[c],h=i[u.materialIndex];if(h&&h.visible){const t=b(n,h,s,l);n.onBeforeShadow(e,n,a,o,r,t,u),e.renderBufferDirect(o,null,r,t,n,u),n.onAfterShadow(e,n,a,o,r,t,u)}}}else if(i.visible){const t=b(n,i,s,l);n.onBeforeShadow(e,n,a,o,r,t,null),e.renderBufferDirect(o,null,r,t,n,null),n.onAfterShadow(e,n,a,o,r,t,null)}}const c=n.children;for(let e=0,t=c.length;e<t;e++)_(c[e],a,o,s,l)}function w(e){e.target.removeEventListener("dispose",w);for(const t in u){const n=u[t],r=e.target.uuid;if(r in n){n[r].dispose(),delete n[r]}}}this.render=function(t,n,l){if(!1===v.enabled)return;if(!1===v.autoUpdate&&!1===v.needsUpdate)return;if(0===t.length)return;const c=e.getRenderTarget(),u=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),f=e.state;f.setBlending(r.XIg),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);const p=y!==r.RyA&&this.type===r.RyA,m=y===r.RyA&&this.type!==r.RyA;for(let g=0,v=t.length;g<v;g++){const c=t[g],u=c.shadow;if(void 0===u){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===u.autoUpdate&&!1===u.needsUpdate)continue;a.copy(u.mapSize);const d=u.getFrameExtents();if(a.multiply(d),o.copy(u.mapSize),(a.x>h||a.y>h)&&(a.x>h&&(o.x=Math.floor(h/d.x),a.x=o.x*d.x,u.mapSize.x=o.x),a.y>h&&(o.y=Math.floor(h/d.y),a.y=o.y*d.y,u.mapSize.y=o.y)),null===u.map||!0===p||!0===m){const e=this.type!==r.RyA?{minFilter:r.hxR,magFilter:r.hxR}:{};null!==u.map&&u.map.dispose(),u.map=new r.nWS(a.x,a.y,e),u.map.texture.name=c.name+".shadowMap",u.camera.updateProjectionMatrix()}e.setRenderTarget(u.map),e.clear();const v=u.getViewportCount();for(let e=0;e<v;e++){const t=u.getViewport(e);s.set(o.x*t.x,o.y*t.y,o.x*t.z,o.y*t.w),f.viewport(s),u.updateMatrices(c,e),i=u.getFrustum(),_(n,l,u.camera,c,this.type)}!0!==u.isPointLightShadow&&this.type===r.RyA&&x(u,l),u.needsUpdate=!1}y=this.type,v.needsUpdate=!1,e.setRenderTarget(c,u,d)}}const Tt={[r.eHc]:r.lGu,[r.brA]:r.K52,[r.U3G]:r.bw0,[r.xSv]:r.Gwm,[r.lGu]:r.eHc,[r.K52]:r.brA,[r.bw0]:r.U3G,[r.Gwm]:r.xSv};function Nt(e,t){const n=new function(){let t=!1;const n=new r.IUQ;let i=null;const a=new r.IUQ(0,0,0,0);return{setMask:function(n){i===n||t||(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,r,i,o,s){!0===s&&(t*=o,r*=o,i*=o),n.set(t,r,i,o),!1===a.equals(n)&&(e.clearColor(t,r,i,o),a.copy(n))},reset:function(){t=!1,i=null,a.set(-1,0,0,0)}}},i=new function(){let n=!1,i=!1,a=null,o=null,s=null;return{setReversed:function(e){if(i!==e){const n=t.get("EXT_clip_control");e?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),i=e;const r=s;s=null,this.setClear(r)}},getReversed:function(){return i},setTest:function(t){t?H(e.DEPTH_TEST):V(e.DEPTH_TEST)},setMask:function(t){a===t||n||(e.depthMask(t),a=t)},setFunc:function(t){if(i&&(t=Tt[t]),o!==t){switch(t){case r.eHc:e.depthFunc(e.NEVER);break;case r.lGu:e.depthFunc(e.ALWAYS);break;case r.brA:e.depthFunc(e.LESS);break;case r.xSv:e.depthFunc(e.LEQUAL);break;case r.U3G:e.depthFunc(e.EQUAL);break;case r.Gwm:e.depthFunc(e.GEQUAL);break;case r.K52:e.depthFunc(e.GREATER);break;case r.bw0:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}o=t}},setLocked:function(e){n=e},setClear:function(t){s!==t&&(i&&(t=1-t),e.clearDepth(t),s=t)},reset:function(){n=!1,a=null,o=null,s=null,i=!1}}},a=new function(){let t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,c=null;return{setTest:function(n){t||(n?H(e.STENCIL_TEST):V(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&l===r||(e.stencilOp(t,n,r),o=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,c=null}}},o=new WeakMap,s=new WeakMap;let l={},c={},u=new WeakMap,h=[],d=null,f=!1,p=null,m=null,g=null,v=null,y=null,x=null,b=null,_=new r.Q1f(0,0,0),w=0,S=!1,M=null,D=null,E=null,C=null,A=null;const T=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let N=!1,R=0;const P=e.getParameter(e.VERSION);-1!==P.indexOf("WebGL")?(R=parseFloat(/^WebGL (\d)/.exec(P)[1]),N=R>=1):-1!==P.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL ES (\d)/.exec(P)[1]),N=R>=2);let F=null,O={};const I=e.getParameter(e.SCISSOR_BOX),B=e.getParameter(e.VIEWPORT),k=(new r.IUQ).fromArray(I),L=(new r.IUQ).fromArray(B);function U(t,n,r,i){const a=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let s=0;s<r;s++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,a):e.texImage2D(n+s,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a);return o}const z={};function H(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function V(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}z[e.TEXTURE_2D]=U(e.TEXTURE_2D,e.TEXTURE_2D,1),z[e.TEXTURE_CUBE_MAP]=U(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),z[e.TEXTURE_2D_ARRAY]=U(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),z[e.TEXTURE_3D]=U(e.TEXTURE_3D,e.TEXTURE_3D,1,1),n.setClear(0,0,0,1),i.setClear(1),a.setClear(0),H(e.DEPTH_TEST),i.setFunc(r.xSv),W(!1),X(r.Vb5),H(e.CULL_FACE),j(r.XIg);const G={[r.gO9]:e.FUNC_ADD,[r.FXf]:e.FUNC_SUBTRACT,[r.nST]:e.FUNC_REVERSE_SUBTRACT};G[r.znC]=e.MIN,G[r.$ei]=e.MAX;const q={[r.ojh]:e.ZERO,[r.qad]:e.ONE,[r.f4X]:e.SRC_COLOR,[r.ie2]:e.SRC_ALPHA,[r.hgQ]:e.SRC_ALPHA_SATURATE,[r.wn6]:e.DST_COLOR,[r.hdd]:e.DST_ALPHA,[r.LiQ]:e.ONE_MINUS_SRC_COLOR,[r.OuU]:e.ONE_MINUS_SRC_ALPHA,[r.aEY]:e.ONE_MINUS_DST_COLOR,[r.Nt7]:e.ONE_MINUS_DST_ALPHA,[r.RrE]:e.CONSTANT_COLOR,[r.$Yl]:e.ONE_MINUS_CONSTANT_COLOR,[r.e0p]:e.CONSTANT_ALPHA,[r.ov9]:e.ONE_MINUS_CONSTANT_ALPHA};function j(t,n,i,a,o,s,l,c,u,h){if(t!==r.XIg){if(!1===f&&(H(e.BLEND),f=!0),t===r.bCz)o=o||n,s=s||i,l=l||a,n===m&&o===y||(e.blendEquationSeparate(G[n],G[o]),m=n,y=o),i===g&&a===v&&s===x&&l===b||(e.blendFuncSeparate(q[i],q[a],q[s],q[l]),g=i,v=a,x=s,b=l),!1!==c.equals(_)&&u===w||(e.blendColor(c.r,c.g,c.b,u),_.copy(c),w=u),p=t,S=!1;else if(t!==p||h!==S){if(m===r.gO9&&y===r.gO9||(e.blendEquation(e.FUNC_ADD),m=r.gO9,y=r.gO9),h)switch(t){case r.NTi:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case r.EZo:e.blendFunc(e.ONE,e.ONE);break;case r.Kwu:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case r.EdD:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case r.NTi:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case r.EZo:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case r.Kwu:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case r.EdD:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}g=null,v=null,x=null,b=null,_.set(0,0,0),w=0,p=t,S=h}}else!0===f&&(V(e.BLEND),f=!1)}function W(t){M!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),M=t)}function X(t){t!==r.WNZ?(H(e.CULL_FACE),t!==D&&(t===r.Vb5?e.cullFace(e.BACK):t===r.Jnc?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):V(e.CULL_FACE),D=t}function Y(t,n,r){t?(H(e.POLYGON_OFFSET_FILL),C===n&&A===r||(e.polygonOffset(n,r),C=n,A=r)):V(e.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:i,stencil:a},enable:H,disable:V,bindFramebuffer:function(t,n){return c[t]!==n&&(e.bindFramebuffer(t,n),c[t]=n,t===e.DRAW_FRAMEBUFFER&&(c[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(c[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let r=h,i=!1;if(t){r=u.get(n),void 0===r&&(r=[],u.set(n,r));const a=t.textures;if(r.length!==a.length||r[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=a.length;t<n;t++)r[t]=e.COLOR_ATTACHMENT0+t;r.length=a.length,i=!0}}else r[0]!==e.BACK&&(r[0]=e.BACK,i=!0);i&&e.drawBuffers(r)},useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:j,setMaterial:function(t,o){t.side===r.$EB?V(e.CULL_FACE):H(e.CULL_FACE);let s=t.side===r.hsX;o&&(s=!s),W(s),t.blending===r.NTi&&!1===t.transparent?j(r.XIg):j(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),i.setFunc(t.depthFunc),i.setTest(t.depthTest),i.setMask(t.depthWrite),n.setMask(t.colorWrite);const l=t.stencilWrite;a.setTest(l),l&&(a.setMask(t.stencilWriteMask),a.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Y(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?H(e.SAMPLE_ALPHA_TO_COVERAGE):V(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:W,setCullFace:X,setLineWidth:function(t){t!==E&&(N&&e.lineWidth(t),E=t)},setPolygonOffset:Y,setScissorTest:function(t){t?H(e.SCISSOR_TEST):V(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+T-1),F!==t&&(e.activeTexture(t),F=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===F?e.TEXTURE0+T-1:F);let i=O[r];void 0===i&&(i={type:void 0,texture:void 0},O[r]=i),i.type===t&&i.texture===n||(F!==r&&(e.activeTexture(r),F=r),e.bindTexture(t,n||z[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=O[F];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{e.compressedTexImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,n){let r=s.get(n);void 0===r&&(r=new WeakMap,s.set(n,r));let i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){const r=s.get(n).get(t);o.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),o.set(n,r))},texStorage2D:function(){try{e.texStorage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D(...arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===k.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),k.copy(t))},viewport:function(t){!1===L.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),L.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),i.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),l={},F=null,O={},c={},u=new WeakMap,h=[],d=null,f=!1,p=null,m=null,g=null,v=null,y=null,x=null,b=null,_=new r.Q1f(0,0,0),w=0,S=!1,M=null,D=null,E=null,C=null,A=null,k.set(0,0,e.canvas.width,e.canvas.height),L.set(0,0,e.canvas.width,e.canvas.height),n.reset(),i.reset(),a.reset()}}}function Rt(e,t,n,i,a,o,s){const l=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,c="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),u=new r.I9Y,h=new WeakMap;let d;const f=new WeakMap;let p=!1;try{p="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(q){}function m(e,t){return p?new OffscreenCanvas(e,t):(0,r.qq$)("canvas")}function g(e,t,n){let r=1;const i=G(e);if((i.width>n||i.height>n)&&(r=n/Math.max(i.width,i.height)),r<1){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(r*i.width),a=Math.floor(r*i.height);void 0===d&&(d=m(n,a));const o=t?m(n,a):d;o.width=n,o.height=a;return o.getContext("2d").drawImage(e,0,0,n,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+n+"x"+a+")."),o}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+")."),e}return e}function v(e){return e.generateMipmaps}function y(t){e.generateMipmap(t)}function x(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function b(n,i,a,o){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let l=i;if(i===e.RED&&(a===e.FLOAT&&(l=e.R32F),a===e.HALF_FLOAT&&(l=e.R16F),a===e.UNSIGNED_BYTE&&(l=e.R8)),i===e.RED_INTEGER&&(a===e.UNSIGNED_BYTE&&(l=e.R8UI),a===e.UNSIGNED_SHORT&&(l=e.R16UI),a===e.UNSIGNED_INT&&(l=e.R32UI),a===e.BYTE&&(l=e.R8I),a===e.SHORT&&(l=e.R16I),a===e.INT&&(l=e.R32I)),i===e.RG&&(a===e.FLOAT&&(l=e.RG32F),a===e.HALF_FLOAT&&(l=e.RG16F),a===e.UNSIGNED_BYTE&&(l=e.RG8)),i===e.RG_INTEGER&&(a===e.UNSIGNED_BYTE&&(l=e.RG8UI),a===e.UNSIGNED_SHORT&&(l=e.RG16UI),a===e.UNSIGNED_INT&&(l=e.RG32UI),a===e.BYTE&&(l=e.RG8I),a===e.SHORT&&(l=e.RG16I),a===e.INT&&(l=e.RG32I)),i===e.RGB_INTEGER&&(a===e.UNSIGNED_BYTE&&(l=e.RGB8UI),a===e.UNSIGNED_SHORT&&(l=e.RGB16UI),a===e.UNSIGNED_INT&&(l=e.RGB32UI),a===e.BYTE&&(l=e.RGB8I),a===e.SHORT&&(l=e.RGB16I),a===e.INT&&(l=e.RGB32I)),i===e.RGBA_INTEGER&&(a===e.UNSIGNED_BYTE&&(l=e.RGBA8UI),a===e.UNSIGNED_SHORT&&(l=e.RGBA16UI),a===e.UNSIGNED_INT&&(l=e.RGBA32UI),a===e.BYTE&&(l=e.RGBA8I),a===e.SHORT&&(l=e.RGBA16I),a===e.INT&&(l=e.RGBA32I)),i===e.RGB&&a===e.UNSIGNED_INT_5_9_9_9_REV&&(l=e.RGB9_E5),i===e.RGBA){const t=s?r.VxR:r.ppV.getTransfer(o);a===e.FLOAT&&(l=e.RGBA32F),a===e.HALF_FLOAT&&(l=e.RGBA16F),a===e.UNSIGNED_BYTE&&(l=t===r.KLL?e.SRGB8_ALPHA8:e.RGBA8),a===e.UNSIGNED_SHORT_4_4_4_4&&(l=e.RGBA4),a===e.UNSIGNED_SHORT_5_5_5_1&&(l=e.RGB5_A1)}return l!==e.R16F&&l!==e.R32F&&l!==e.RG16F&&l!==e.RG32F&&l!==e.RGBA16F&&l!==e.RGBA32F||t.get("EXT_color_buffer_float"),l}function _(t,n){let i;return t?null===n||n===r.bkx||n===r.V3x?i=e.DEPTH24_STENCIL8:n===r.RQf?i=e.DEPTH32F_STENCIL8:n===r.cHt&&(i=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===r.bkx||n===r.V3x?i=e.DEPTH_COMPONENT24:n===r.RQf?i=e.DEPTH_COMPONENT32F:n===r.cHt&&(i=e.DEPTH_COMPONENT16),i}function w(e,t){return!0===v(e)||e.isFramebufferTexture&&e.minFilter!==r.hxR&&e.minFilter!==r.k6q?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function S(e){const t=e.target;t.removeEventListener("dispose",S),function(e){const t=i.get(e);if(void 0===t.__webglInit)return;const n=e.source,r=f.get(n);if(r){const i=r[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&D(e),0===Object.keys(r).length&&f.delete(n)}i.remove(e)}(t),t.isVideoTexture&&h.delete(t)}function M(t){const n=t.target;n.removeEventListener("dispose",M),function(t){const n=i.get(t);t.depthTexture&&(t.depthTexture.dispose(),i.remove(t.depthTexture));if(t.isWebGLCubeRenderTarget)for(let i=0;i<6;i++){if(Array.isArray(n.__webglFramebuffer[i]))for(let t=0;t<n.__webglFramebuffer[i].length;t++)e.deleteFramebuffer(n.__webglFramebuffer[i][t]);else e.deleteFramebuffer(n.__webglFramebuffer[i]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[i])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const r=t.textures;for(let a=0,o=r.length;a<o;a++){const t=i.get(r[a]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),s.memory.textures--),i.remove(r[a])}i.remove(t)}(n)}function D(t){const n=i.get(t);e.deleteTexture(n.__webglTexture);const r=t.source;delete f.get(r)[n.__cacheKey],s.memory.textures--}let E=0;function C(t,r){const a=i.get(t);if(t.isVideoTexture&&function(e){const t=s.render.frame;h.get(e)!==t&&(h.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version){const e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void F(a,t,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+r)}const A={[r.GJx]:e.REPEAT,[r.ghU]:e.CLAMP_TO_EDGE,[r.kTW]:e.MIRRORED_REPEAT},T={[r.hxR]:e.NEAREST,[r.pHI]:e.NEAREST_MIPMAP_NEAREST,[r.Cfg]:e.NEAREST_MIPMAP_LINEAR,[r.k6q]:e.LINEAR,[r.kRr]:e.LINEAR_MIPMAP_NEAREST,[r.$_I]:e.LINEAR_MIPMAP_LINEAR},N={[r.amv]:e.NEVER,[r.FFZ]:e.ALWAYS,[r.vim]:e.LESS,[r.TiK]:e.LEQUAL,[r.kO0]:e.EQUAL,[r.gWB]:e.GEQUAL,[r.eoi]:e.GREATER,[r.jzd]:e.NOTEQUAL};function R(n,o){if(o.type!==r.RQf||!1!==t.has("OES_texture_float_linear")||o.magFilter!==r.k6q&&o.magFilter!==r.kRr&&o.magFilter!==r.Cfg&&o.magFilter!==r.$_I&&o.minFilter!==r.k6q&&o.minFilter!==r.kRr&&o.minFilter!==r.Cfg&&o.minFilter!==r.$_I||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,A[o.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,A[o.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,A[o.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,T[o.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,T[o.minFilter]),o.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,N[o.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(o.magFilter===r.hxR)return;if(o.minFilter!==r.Cfg&&o.minFilter!==r.$_I)return;if(o.type===r.RQf&&!1===t.has("OES_texture_float_linear"))return;if(o.anisotropy>1||i.get(o).__currentAnisotropy){const r=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,a.getMaxAnisotropy())),i.get(o).__currentAnisotropy=o.anisotropy}}}function P(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",S));const i=n.source;let a=f.get(i);void 0===a&&(a={},f.set(i,a));const o=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(o!==t.__cacheKey){void 0===a[o]&&(a[o]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,r=!0),a[o].usedTimes++;const i=a[t.__cacheKey];void 0!==i&&(a[t.__cacheKey].usedTimes--,0===i.usedTimes&&D(n)),t.__cacheKey=o,t.__webglTexture=a[o].texture}return r}function F(t,s,l){let c=e.TEXTURE_2D;(s.isDataArrayTexture||s.isCompressedArrayTexture)&&(c=e.TEXTURE_2D_ARRAY),s.isData3DTexture&&(c=e.TEXTURE_3D);const u=P(t,s),h=s.source;n.bindTexture(c,t.__webglTexture,e.TEXTURE0+l);const d=i.get(h);if(h.version!==d.__version||!0===u){n.activeTexture(e.TEXTURE0+l);const t=r.ppV.getPrimaries(r.ppV.workingColorSpace),i=s.colorSpace===r.jf0?null:r.ppV.getPrimaries(s.colorSpace),f=s.colorSpace===r.jf0||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,f);let p=g(s.image,!1,a.maxTextureSize);p=V(s,p);const m=o.convert(s.format,s.colorSpace),x=o.convert(s.type);let S,M=b(s.internalFormat,m,x,s.colorSpace,s.isVideoTexture);R(c,s);const D=s.mipmaps,E=!0!==s.isVideoTexture,C=void 0===d.__version||!0===u,A=h.dataReady,T=w(s,p);if(s.isDepthTexture)M=_(s.format===r.dcC,s.type),C&&(E?n.texStorage2D(e.TEXTURE_2D,1,M,p.width,p.height):n.texImage2D(e.TEXTURE_2D,0,M,p.width,p.height,0,m,x,null));else if(s.isDataTexture)if(D.length>0){E&&C&&n.texStorage2D(e.TEXTURE_2D,T,M,D[0].width,D[0].height);for(let t=0,r=D.length;t<r;t++)S=D[t],E?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,m,x,S.data):n.texImage2D(e.TEXTURE_2D,t,M,S.width,S.height,0,m,x,S.data);s.generateMipmaps=!1}else E?(C&&n.texStorage2D(e.TEXTURE_2D,T,M,p.width,p.height),A&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,p.width,p.height,m,x,p.data)):n.texImage2D(e.TEXTURE_2D,0,M,p.width,p.height,0,m,x,p.data);else if(s.isCompressedTexture)if(s.isCompressedArrayTexture){E&&C&&n.texStorage3D(e.TEXTURE_2D_ARRAY,T,M,D[0].width,D[0].height,p.depth);for(let t=0,i=D.length;t<i;t++)if(S=D[t],s.format!==r.GWd)if(null!==m)if(E){if(A)if(s.layerUpdates.size>0){const i=(0,r.Nex)(S.width,S.height,s.format,s.type);for(const r of s.layerUpdates){const a=S.data.subarray(r*i/S.data.BYTES_PER_ELEMENT,(r+1)*i/S.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,r,S.width,S.height,1,m,a)}s.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,p.depth,m,S.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,M,S.width,S.height,p.depth,0,S.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else E?A&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,S.width,S.height,p.depth,m,x,S.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,M,S.width,S.height,p.depth,0,m,x,S.data)}else{E&&C&&n.texStorage2D(e.TEXTURE_2D,T,M,D[0].width,D[0].height);for(let t=0,i=D.length;t<i;t++)S=D[t],s.format!==r.GWd?null!==m?E?A&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,m,S.data):n.compressedTexImage2D(e.TEXTURE_2D,t,M,S.width,S.height,0,S.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,S.width,S.height,m,x,S.data):n.texImage2D(e.TEXTURE_2D,t,M,S.width,S.height,0,m,x,S.data)}else if(s.isDataArrayTexture)if(E){if(C&&n.texStorage3D(e.TEXTURE_2D_ARRAY,T,M,p.width,p.height,p.depth),A)if(s.layerUpdates.size>0){const t=(0,r.Nex)(p.width,p.height,s.format,s.type);for(const r of s.layerUpdates){const i=p.data.subarray(r*t/p.data.BYTES_PER_ELEMENT,(r+1)*t/p.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,r,p.width,p.height,1,m,x,i)}s.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,m,x,p.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,M,p.width,p.height,p.depth,0,m,x,p.data);else if(s.isData3DTexture)E?(C&&n.texStorage3D(e.TEXTURE_3D,T,M,p.width,p.height,p.depth),A&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,m,x,p.data)):n.texImage3D(e.TEXTURE_3D,0,M,p.width,p.height,p.depth,0,m,x,p.data);else if(s.isFramebufferTexture){if(C)if(E)n.texStorage2D(e.TEXTURE_2D,T,M,p.width,p.height);else{let t=p.width,r=p.height;for(let i=0;i<T;i++)n.texImage2D(e.TEXTURE_2D,i,M,t,r,0,m,x,null),t>>=1,r>>=1}}else if(D.length>0){if(E&&C){const t=G(D[0]);n.texStorage2D(e.TEXTURE_2D,T,M,t.width,t.height)}for(let t=0,r=D.length;t<r;t++)S=D[t],E?A&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,m,x,S):n.texImage2D(e.TEXTURE_2D,t,M,m,x,S);s.generateMipmaps=!1}else if(E){if(C){const t=G(p);n.texStorage2D(e.TEXTURE_2D,T,M,t.width,t.height)}A&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,m,x,p)}else n.texImage2D(e.TEXTURE_2D,0,M,m,x,p);v(s)&&y(c),d.__version=h.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}function O(t,r,a,s,c,u){const h=o.convert(a.format,a.colorSpace),d=o.convert(a.type),f=b(a.internalFormat,h,d,a.colorSpace),p=i.get(r),m=i.get(a);if(m.__renderTarget=r,!p.__hasExternalTextures){const t=Math.max(1,r.width>>u),i=Math.max(1,r.height>>u);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,u,f,t,i,r.depth,0,h,d,null):n.texImage2D(c,u,f,t,i,0,h,d,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),H(r)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,s,c,m.__webglTexture,0,z(r)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,s,c,m.__webglTexture,u),n.bindFramebuffer(e.FRAMEBUFFER,null)}function I(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const i=n.depthTexture,a=i&&i.isDepthTexture?i.type:null,o=_(n.stencilBuffer,a),s=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=z(n);H(n)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,o,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,o,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,o,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,s,e.RENDERBUFFER,t)}else{const t=n.textures;for(let i=0;i<t.length;i++){const a=t[i],s=o.convert(a.format,a.colorSpace),c=o.convert(a.type),u=b(a.internalFormat,s,c,a.colorSpace),h=z(n);r&&!1===H(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,h,u,n.width,n.height):H(n)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,h,u,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,u,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function B(t,a){if(a&&a.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!a.depthTexture||!a.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const o=i.get(a.depthTexture);o.__renderTarget=a,o.__webglTexture&&a.depthTexture.image.width===a.width&&a.depthTexture.image.height===a.height||(a.depthTexture.image.width=a.width,a.depthTexture.image.height=a.height,a.depthTexture.needsUpdate=!0),C(a.depthTexture,0);const s=o.__webglTexture,c=z(a);if(a.depthTexture.format===r.zdS)H(a)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,c):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else{if(a.depthTexture.format!==r.dcC)throw new Error("Unknown depthTexture format");H(a)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,c):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0)}}function k(t){const r=i.get(t),a=!0===t.isWebGLCubeRenderTarget;if(r.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(r.__depthDisposeCallback&&r.__depthDisposeCallback(),e){const t=()=>{delete r.__boundDepthTexture,delete r.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),r.__depthDisposeCallback=t}r.__boundDepthTexture=e}if(t.depthTexture&&!r.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");const e=t.texture.mipmaps;e&&e.length>0?B(r.__webglFramebuffer[0],t):B(r.__webglFramebuffer,t)}else if(a){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)if(n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[i]),void 0===r.__webglDepthbuffer[i])r.__webglDepthbuffer[i]=e.createRenderbuffer(),I(r.__webglDepthbuffer[i],t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,a=r.__webglDepthbuffer[i];e.bindRenderbuffer(e.RENDERBUFFER,a),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,a)}}else{const i=t.texture.mipmaps;if(i&&i.length>0?n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[0]):n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),void 0===r.__webglDepthbuffer)r.__webglDepthbuffer=e.createRenderbuffer(),I(r.__webglDepthbuffer,t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,i=r.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,i),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,i)}}n.bindFramebuffer(e.FRAMEBUFFER,null)}const L=[],U=[];function z(e){return Math.min(a.maxSamples,e.samples)}function H(e){const n=i.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function V(e,t){const n=e.colorSpace,i=e.format,a=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==r.Zr2&&n!==r.jf0&&(r.ppV.getTransfer(n)===r.KLL?i===r.GWd&&a===r.OUM||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),t}function G(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement?(u.width=e.naturalWidth||e.width,u.height=e.naturalHeight||e.height):"undefined"!==typeof VideoFrame&&e instanceof VideoFrame?(u.width=e.displayWidth,u.height=e.displayHeight):(u.width=e.width,u.height=e.height),u}this.allocateTextureUnit=function(){const e=E;return e>=a.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+a.maxTextures),E+=1,e},this.resetTextureUnits=function(){E=0},this.setTexture2D=C,this.setTexture2DArray=function(t,r){const a=i.get(t);t.version>0&&a.__version!==t.version?F(a,t,r):n.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+r)},this.setTexture3D=function(t,r){const a=i.get(t);t.version>0&&a.__version!==t.version?F(a,t,r):n.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+r)},this.setTextureCube=function(t,s){const l=i.get(t);t.version>0&&l.__version!==t.version?function(t,s,l){if(6!==s.image.length)return;const c=P(t,s),u=s.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+l);const h=i.get(u);if(u.version!==h.__version||!0===c){n.activeTexture(e.TEXTURE0+l);const t=r.ppV.getPrimaries(r.ppV.workingColorSpace),i=s.colorSpace===r.jf0?null:r.ppV.getPrimaries(s.colorSpace),d=s.colorSpace===r.jf0||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);const f=s.isCompressedTexture||s.image[0].isCompressedTexture,p=s.image[0]&&s.image[0].isDataTexture,m=[];for(let e=0;e<6;e++)m[e]=f||p?p?s.image[e].image:s.image[e]:g(s.image[e],!0,a.maxCubemapSize),m[e]=V(s,m[e]);const x=m[0],_=o.convert(s.format,s.colorSpace),S=o.convert(s.type),M=b(s.internalFormat,_,S,s.colorSpace),D=!0!==s.isVideoTexture,E=void 0===h.__version||!0===c,C=u.dataReady;let A,T=w(s,x);if(R(e.TEXTURE_CUBE_MAP,s),f){D&&E&&n.texStorage2D(e.TEXTURE_CUBE_MAP,T,M,x.width,x.height);for(let t=0;t<6;t++){A=m[t].mipmaps;for(let i=0;i<A.length;i++){const a=A[i];s.format!==r.GWd?null!==_?D?C&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,a.width,a.height,_,a.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,M,a.width,a.height,0,a.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):D?C&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,a.width,a.height,_,S,a.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,M,a.width,a.height,0,_,S,a.data)}}}else{if(A=s.mipmaps,D&&E){A.length>0&&T++;const t=G(m[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,T,M,t.width,t.height)}for(let t=0;t<6;t++)if(p){D?C&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,m[t].width,m[t].height,_,S,m[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,M,m[t].width,m[t].height,0,_,S,m[t].data);for(let r=0;r<A.length;r++){const i=A[r].image[t].image;D?C&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,i.width,i.height,_,S,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,M,i.width,i.height,0,_,S,i.data)}}else{D?C&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,_,S,m[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,M,_,S,m[t]);for(let r=0;r<A.length;r++){const i=A[r];D?C&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,_,S,i.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,M,_,S,i.image[t])}}}v(s)&&y(e.TEXTURE_CUBE_MAP),h.__version=u.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}(l,t,s):n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture,e.TEXTURE0+s)},this.rebindTextures=function(t,n,r){const a=i.get(t);void 0!==n&&O(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==r&&k(t)},this.setupRenderTarget=function(t){const r=t.texture,a=i.get(t),l=i.get(r);t.addEventListener("dispose",M);const c=t.textures,u=!0===t.isWebGLCubeRenderTarget,h=c.length>1;if(h||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=r.version,s.memory.textures++),u){a.__webglFramebuffer=[];for(let t=0;t<6;t++)if(r.mipmaps&&r.mipmaps.length>0){a.__webglFramebuffer[t]=[];for(let n=0;n<r.mipmaps.length;n++)a.__webglFramebuffer[t][n]=e.createFramebuffer()}else a.__webglFramebuffer[t]=e.createFramebuffer()}else{if(r.mipmaps&&r.mipmaps.length>0){a.__webglFramebuffer=[];for(let t=0;t<r.mipmaps.length;t++)a.__webglFramebuffer[t]=e.createFramebuffer()}else a.__webglFramebuffer=e.createFramebuffer();if(h)for(let t=0,n=c.length;t<n;t++){const n=i.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),s.memory.textures++)}if(t.samples>0&&!1===H(t)){a.__webglMultisampledFramebuffer=e.createFramebuffer(),a.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,a.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const r=c[n];a.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,a.__webglColorRenderbuffer[n]);const i=o.convert(r.format,r.colorSpace),s=o.convert(r.type),l=b(r.internalFormat,i,s,r.colorSpace,!0===t.isXRRenderTarget),u=z(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,a.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(a.__webglDepthRenderbuffer=e.createRenderbuffer(),I(a.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),R(e.TEXTURE_CUBE_MAP,r);for(let n=0;n<6;n++)if(r.mipmaps&&r.mipmaps.length>0)for(let i=0;i<r.mipmaps.length;i++)O(a.__webglFramebuffer[n][i],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i);else O(a.__webglFramebuffer[n],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);v(r)&&y(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(let r=0,o=c.length;r<o;r++){const o=c[r],s=i.get(o);n.bindTexture(e.TEXTURE_2D,s.__webglTexture),R(e.TEXTURE_2D,o),O(a.__webglFramebuffer,t,o,e.COLOR_ATTACHMENT0+r,e.TEXTURE_2D,0),v(o)&&y(e.TEXTURE_2D)}n.unbindTexture()}else{let i=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(i=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(i,l.__webglTexture),R(i,r),r.mipmaps&&r.mipmaps.length>0)for(let n=0;n<r.mipmaps.length;n++)O(a.__webglFramebuffer[n],t,r,e.COLOR_ATTACHMENT0,i,n);else O(a.__webglFramebuffer,t,r,e.COLOR_ATTACHMENT0,i,0);v(r)&&y(i),n.unbindTexture()}t.depthBuffer&&k(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let r=0,a=t.length;r<a;r++){const a=t[r];if(v(a)){const t=x(e),r=i.get(a).__webglTexture;n.bindTexture(t,r),y(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===H(t)){const r=t.textures,a=t.width,o=t.height;let s=e.COLOR_BUFFER_BIT;const l=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=i.get(t),h=r.length>1;if(h)for(let t=0;t<r.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer);const d=t.texture.mipmaps;d&&d.length>0?n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer[0]):n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<r.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(s|=e.STENCIL_BUFFER_BIT)),h){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const t=i.get(r[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,a,o,0,0,a,o,s,e.NEAREST),!0===c&&(L.length=0,U.length=0,L.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(L.push(l),U.push(l),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,U)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,L))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),h)for(let t=0;t<r.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const a=i.get(r[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,a,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&c){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=k,this.setupFrameBufferTexture=O,this.useMultisampledRTT=H}function Pt(e,t){return{convert:function(n){let i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.jf0;const o=r.ppV.getTransfer(a);if(n===r.OUM)return e.UNSIGNED_BYTE;if(n===r.Wew)return e.UNSIGNED_SHORT_4_4_4_4;if(n===r.gJ2)return e.UNSIGNED_SHORT_5_5_5_1;if(n===r.Dmk)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===r.tJf)return e.BYTE;if(n===r.fBL)return e.SHORT;if(n===r.cHt)return e.UNSIGNED_SHORT;if(n===r.Yuy)return e.INT;if(n===r.bkx)return e.UNSIGNED_INT;if(n===r.RQf)return e.FLOAT;if(n===r.ix0)return e.HALF_FLOAT;if(n===r.wrO)return e.ALPHA;if(n===r.HIg)return e.RGB;if(n===r.GWd)return e.RGBA;if(n===r.zdS)return e.DEPTH_COMPONENT;if(n===r.dcC)return e.DEPTH_STENCIL;if(n===r.VT0)return e.RED;if(n===r.ZQM)return e.RED_INTEGER;if(n===r.paN)return e.RG;if(n===r.TkQ)return e.RG_INTEGER;if(n===r.c90)return e.RGBA_INTEGER;if(n===r.IE4||n===r.Nz6||n===r.jR7||n===r.BXX)if(o===r.KLL){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===r.IE4)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===r.Nz6)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===r.jR7)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===r.BXX)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===r.IE4)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===r.Nz6)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===r.jR7)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===r.BXX)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===r.k6Q||n===r.kTp||n===r.HXV||n===r.pBf){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===r.k6Q)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===r.kTp)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===r.HXV)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===r.pBf)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===r.CVz||n===r.Riy||n===r.KDk){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===r.CVz||n===r.Riy)return o===r.KLL?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===r.KDk)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===r.qa3||n===r.B_h||n===r.czI||n===r.rSH||n===r.Qrf||n===r.psI||n===r.a5J||n===r._QJ||n===r.uB5||n===r.lyL||n===r.bC7||n===r.y3Z||n===r.ojs||n===r.S$4){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===r.qa3)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===r.B_h)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===r.czI)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===r.rSH)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===r.Qrf)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===r.psI)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===r.a5J)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===r._QJ)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===r.uB5)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===r.lyL)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===r.bC7)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===r.y3Z)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===r.ojs)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===r.S$4)return o===r.KLL?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===r.Fn||n===r.H23||n===r.W9U){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(n===r.Fn)return o===r.KLL?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===r.H23)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===r.W9U)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===r.Kef||n===r.XG_||n===r.HO_||n===r.CWW){if(i=t.get("EXT_texture_compression_rgtc"),null===i)return null;if(n===r.Fn)return i.COMPRESSED_RED_RGTC1_EXT;if(n===r.XG_)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===r.HO_)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===r.CWW)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===r.V3x?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class Ft{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(null===this.texture){const i=new r.gPd;e.properties.get(i).__webglTexture=t.texture,t.depthNear===n.depthNear&&t.depthFar===n.depthFar||(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new r.BKk({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new r.eaF(new r.bdM(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Ot extends r.Qev{constructor(e,t){super();const n=this;let a=null,o=1,s=null,l="local-floor",c=1,u=null,h=null,d=null,f=null,p=null,m=null;const g=new Ft,v=t.getContextAttributes();let y=null,x=null;const b=[],_=[],w=new r.I9Y;let S=null;const M=new r.ubm;M.viewport=new r.IUQ;const D=new r.ubm;D.viewport=new r.IUQ;const E=[M,D],C=new r.nZQ;let A=null,T=null;function N(e){const t=_.indexOf(e.inputSource);if(-1===t)return;const n=b[t];void 0!==n&&(n.update(e.inputSource,e.frame,u||s),n.dispatchEvent({type:e.type,data:e.inputSource}))}function R(){a.removeEventListener("select",N),a.removeEventListener("selectstart",N),a.removeEventListener("selectend",N),a.removeEventListener("squeeze",N),a.removeEventListener("squeezestart",N),a.removeEventListener("squeezeend",N),a.removeEventListener("end",R),a.removeEventListener("inputsourceschange",P);for(let e=0;e<b.length;e++){const t=_[e];null!==t&&(_[e]=null,b[e].disconnect(t))}A=null,T=null,g.reset(),e.setRenderTarget(y),p=null,f=null,d=null,a=null,x=null,k.stop(),n.isPresenting=!1,e.setPixelRatio(S),e.setSize(w.width,w.height,!1),n.dispatchEvent({type:"sessionend"})}function P(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=_.indexOf(n);r>=0&&(_[r]=null,b[r].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=_.indexOf(n);if(-1===r){for(let e=0;e<b.length;e++){if(e>=_.length){_.push(n),r=e;break}if(null===_[e]){_[e]=n,r=e;break}}if(-1===r)break}const i=b[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=b[e];return void 0===t&&(t=new r.R3r,b[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=b[e];return void 0===t&&(t=new r.R3r,b[e]=t),t.getGripSpace()},this.getHand=function(e){let t=b[e];return void 0===t&&(t=new r.R3r,b[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){l=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||s},this.setReferenceSpace=function(e){u=e},this.getBaseLayer=function(){return null!==f?f:p},this.getBinding=function(){return d},this.getFrame=function(){return m},this.getSession=function(){return a},this.setSession=async function(i){if(a=i,null!==a){y=e.getRenderTarget(),a.addEventListener("select",N),a.addEventListener("selectstart",N),a.addEventListener("selectend",N),a.addEventListener("squeeze",N),a.addEventListener("squeezestart",N),a.addEventListener("squeezeend",N),a.addEventListener("end",R),a.addEventListener("inputsourceschange",P),!0!==v.xrCompatible&&await t.makeXRCompatible(),S=e.getPixelRatio(),e.getSize(w);if("undefined"!==typeof XRWebGLBinding&&"createProjectionLayer"in XRWebGLBinding.prototype){let n=null,i=null,s=null;v.depth&&(s=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=v.stencil?r.dcC:r.zdS,i=v.stencil?r.V3x:r.bkx);const l={colorFormat:t.RGBA8,depthFormat:s,scaleFactor:o};d=new XRWebGLBinding(a,t),f=d.createProjectionLayer(l),a.updateRenderState({layers:[f]}),e.setPixelRatio(1),e.setSize(f.textureWidth,f.textureHeight,!1),x=new r.nWS(f.textureWidth,f.textureHeight,{format:r.GWd,type:r.OUM,depthTexture:new r.VCu(f.textureWidth,f.textureHeight,i,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:!1===f.ignoreDepthValues,resolveStencilBuffer:!1===f.ignoreDepthValues})}else{const n={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:o};p=new XRWebGLLayer(a,t,n),a.updateRenderState({baseLayer:p}),e.setPixelRatio(1),e.setSize(p.framebufferWidth,p.framebufferHeight,!1),x=new r.nWS(p.framebufferWidth,p.framebufferHeight,{format:r.GWd,type:r.OUM,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil,resolveDepthBuffer:!1===p.ignoreDepthValues,resolveStencilBuffer:!1===p.ignoreDepthValues})}x.isXRRenderTarget=!0,this.setFoveation(c),u=null,s=await a.requestReferenceSpace(l),k.setContext(a),k.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==a)return a.environmentBlendMode},this.getDepthTexture=function(){return g.getDepthTexture()};const F=new r.Pq0,O=new r.Pq0;function I(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===a)return;let t=e.near,n=e.far;null!==g.texture&&(g.depthNear>0&&(t=g.depthNear),g.depthFar>0&&(n=g.depthFar)),C.near=D.near=M.near=t,C.far=D.far=M.far=n,A===C.near&&T===C.far||(a.updateRenderState({depthNear:C.near,depthFar:C.far}),A=C.near,T=C.far),M.layers.mask=2|e.layers.mask,D.layers.mask=4|e.layers.mask,C.layers.mask=M.layers.mask|D.layers.mask;const i=e.parent,o=C.cameras;I(C,i);for(let r=0;r<o.length;r++)I(o[r],i);2===o.length?function(e,t,n){F.setFromMatrixPosition(t.matrixWorld),O.setFromMatrixPosition(n.matrixWorld);const r=F.distanceTo(O),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(a[8]+1)/a[0],d=o*u,f=o*h,p=r/(-u+h),m=p*-u;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=o+p,n=s+p,i=d-m,a=f+(r-m),u=l*s/n*t,h=c*s/n*t;e.projectionMatrix.makePerspective(i,a,u,h,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(C,M,D):C.projectionMatrix.copy(M.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*r.a55*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,C,i)},this.getCamera=function(){return C},this.getFoveation=function(){if(null!==f||null!==p)return c},this.setFoveation=function(e){c=e,null!==f&&(f.fixedFoveation=e),null!==p&&void 0!==p.fixedFoveation&&(p.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==g.texture},this.getDepthSensingMesh=function(){return g.getMesh(C)};let B=null;const k=new i;k.setAnimationLoop((function(t,i){if(h=i.getViewerPose(u||s),m=i,null!==h){const t=h.views;null!==p&&(e.setRenderTargetFramebuffer(x,p.framebuffer),e.setRenderTarget(x));let n=!1;t.length!==C.cameras.length&&(C.cameras.length=0,n=!0);for(let a=0;a<t.length;a++){const i=t[a];let o=null;if(null!==p)o=p.getViewport(i);else{const t=d.getViewSubImage(f,i);o=t.viewport,0===a&&(e.setRenderTargetTextures(x,t.colorTexture,t.depthStencilTexture),e.setRenderTarget(x))}let s=E[a];void 0===s&&(s=new r.ubm,s.layers.enable(a),s.viewport=new r.IUQ,E[a]=s),s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.quaternion,s.scale),s.projectionMatrix.fromArray(i.projectionMatrix),s.projectionMatrixInverse.copy(s.projectionMatrix).invert(),s.viewport.set(o.x,o.y,o.width,o.height),0===a&&(C.matrix.copy(s.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),!0===n&&C.cameras.push(s)}const i=a.enabledFeatures;if(i&&i.includes("depth-sensing")&&"gpu-optimized"==a.depthUsage&&d){const n=d.getDepthInformation(t[0]);n&&n.isValid&&n.texture&&g.init(e,n,a.renderState)}}for(let e=0;e<b.length;e++){const t=_[e],n=b[e];null!==t&&void 0!==n&&n.update(t,i,u||s)}B&&B(t,i),i.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:i}),m=null})),this.setAnimationLoop=function(e){B=e},this.dispose=function(){}}}const It=new r.O9p,Bt=new r.kn4;function kt(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function i(e,i){e.opacity.value=i.opacity,i.color&&e.diffuse.value.copy(i.color),i.emissive&&e.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(e.map.value=i.map,n(i.map,e.mapTransform)),i.alphaMap&&(e.alphaMap.value=i.alphaMap,n(i.alphaMap,e.alphaMapTransform)),i.bumpMap&&(e.bumpMap.value=i.bumpMap,n(i.bumpMap,e.bumpMapTransform),e.bumpScale.value=i.bumpScale,i.side===r.hsX&&(e.bumpScale.value*=-1)),i.normalMap&&(e.normalMap.value=i.normalMap,n(i.normalMap,e.normalMapTransform),e.normalScale.value.copy(i.normalScale),i.side===r.hsX&&e.normalScale.value.negate()),i.displacementMap&&(e.displacementMap.value=i.displacementMap,n(i.displacementMap,e.displacementMapTransform),e.displacementScale.value=i.displacementScale,e.displacementBias.value=i.displacementBias),i.emissiveMap&&(e.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,e.emissiveMapTransform)),i.specularMap&&(e.specularMap.value=i.specularMap,n(i.specularMap,e.specularMapTransform)),i.alphaTest>0&&(e.alphaTest.value=i.alphaTest);const a=t.get(i),o=a.envMap,s=a.envMapRotation;o&&(e.envMap.value=o,It.copy(s),It.x*=-1,It.y*=-1,It.z*=-1,o.isCubeTexture&&!1===o.isRenderTargetTexture&&(It.y*=-1,It.z*=-1),e.envMapRotation.value.setFromMatrix4(Bt.makeRotationFromEuler(It)),e.flipEnvMap.value=o.isCubeTexture&&!1===o.isRenderTargetTexture?-1:1,e.reflectivity.value=i.reflectivity,e.ior.value=i.ior,e.refractionRatio.value=i.refractionRatio),i.lightMap&&(e.lightMap.value=i.lightMap,e.lightMapIntensity.value=i.lightMapIntensity,n(i.lightMap,e.lightMapTransform)),i.aoMap&&(e.aoMap.value=i.aoMap,e.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,(0,r._Ut)(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,a,o,s,l){a.isMeshBasicMaterial||a.isMeshLambertMaterial?i(e,a):a.isMeshToonMaterial?(i(e,a),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,a)):a.isMeshPhongMaterial?(i(e,a),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,a)):a.isMeshStandardMaterial?(i(e,a),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,a),a.isMeshPhysicalMaterial&&function(e,t,i){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===r.hsX&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=i.texture,e.transmissionSamplerSize.value.set(i.width,i.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,a,l)):a.isMeshMatcapMaterial?(i(e,a),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,a)):a.isMeshDepthMaterial?i(e,a):a.isMeshDistanceMaterial?(i(e,a),function(e,n){const r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,a)):a.isMeshNormalMaterial?i(e,a):a.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,a),a.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,a)):a.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,a,o,s):a.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,a):a.isShadowMaterial?(e.color.value.copy(a.color),e.opacity.value=a.opacity):a.isShaderMaterial&&(a.uniformsNeedUpdate=!1)}}}function Lt(e,t,n,r){let i={},a={},o=[];const s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,r){const i=e.value,a=t+"_"+n;if(void 0===r[a])return r[a]="number"===typeof i||"boolean"===typeof i?i:i.clone(),!0;{const e=r[a];if("number"===typeof i||"boolean"===typeof i){if(e!==i)return r[a]=i,!0}else if(!1===e.equals(i))return e.copy(i),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"===typeof e||"boolean"===typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){const n=t.target;n.removeEventListener("dispose",u);const r=o.indexOf(n.__bindingPointIndex);o.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,h){let d=i[n.id];void 0===d&&(!function(e){const t=e.uniforms;let n=0;const r=16;for(let a=0,o=t.length;a<o;a++){const e=Array.isArray(t[a])?t[a]:[t[a]];for(let t=0,i=e.length;t<i;t++){const i=e[t],a=Array.isArray(i.value)?i.value:[i.value];for(let e=0,t=a.length;e<t;e++){const t=c(a[e]),o=n%r,s=o%t.boundary,l=o+s;n+=s,0!==l&&r-l<t.storage&&(n+=r-l),i.__data=new Float32Array(t.storage/Float32Array.BYTES_PER_ELEMENT),i.__offset=n,n+=t.storage}}}const i=n%r;i>0&&(n+=r-i);e.__size=n,e.__cache={}}(n),d=function(t){const n=function(){for(let e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const r=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=d,n.addEventListener("dispose",u));const f=h.program;r.updateUBOMapping(n,f);const p=t.render.frame;a[n.id]!==p&&(!function(t){const n=i[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let i=0,o=r.length;i<o;i++){const t=Array.isArray(r[i])?r[i]:[r[i]];for(let n=0,r=t.length;n<r;n++){const r=t[n];if(!0===l(r,i,n,a)){const t=r.__offset,n=Array.isArray(r.value)?r.value:[r.value];let i=0;for(let a=0;a<n.length;a++){const o=n[a],s=c(o);"number"===typeof o||"boolean"===typeof o?(r.__data[0]=o,e.bufferSubData(e.UNIFORM_BUFFER,t+i,r.__data)):o.isMatrix3?(r.__data[0]=o.elements[0],r.__data[1]=o.elements[1],r.__data[2]=o.elements[2],r.__data[3]=0,r.__data[4]=o.elements[3],r.__data[5]=o.elements[4],r.__data[6]=o.elements[5],r.__data[7]=0,r.__data[8]=o.elements[6],r.__data[9]=o.elements[7],r.__data[10]=o.elements[8],r.__data[11]=0):(o.toArray(r.__data,i),i+=s.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,r.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),a[n.id]=p)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);o=[],i={},a={}}}}class Ut{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{canvas:t=(0,r.lPF)(),context:n=null,depth:o=!0,stencil:s=!1,alpha:l=!1,antialias:c=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:h=!1,powerPreference:y="default",failIfMajorPerformanceCaveat:x=!1,reverseDepthBuffer:b=!1}=e;let _;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!==typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");_=n.getContextAttributes().alpha}else _=l;const w=new Uint32Array(4),S=new Int32Array(4);let M=null,D=null;const E=[],C=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=r.y_p,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const A=this;let T=!1;this._outputColorSpace=r.er$;let N=0,R=0,P=null,F=-1,O=null;const V=new r.IUQ,G=new r.IUQ;let q=null;const j=new r.Q1f(0);let W=0,X=t.width,Y=t.height,Z=1,K=null,Q=null;const J=new r.IUQ(0,0,X,Y),$=new r.IUQ(0,0,X,Y);let ee=!1;const te=new r.PPD;let ne=!1,re=!1;const ie=new r.kn4,ae=new r.kn4,oe=new r.Pq0,se=new r.IUQ,le={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ce=!1;function ue(){return null===P?Z:1}let he,de,fe,pe,me,ge,ve,ye,xe,be,_e,we,Se,Me,De,Ee,Ce,Ae,Te,Ne,Re,Pe,Fe,Oe,Ie=n;function Be(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:o,stencil:s,antialias:c,premultipliedAlpha:u,preserveDrawingBuffer:h,powerPreference:y,failIfMajorPerformanceCaveat:x};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(r.sPf)),t.addEventListener("webglcontextlost",Ue,!1),t.addEventListener("webglcontextrestored",ze,!1),t.addEventListener("webglcontextcreationerror",He,!1),null===Ie){const t="webgl2";if(Ie=Be(t,e),null===Ie)throw Be(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ot){throw console.error("THREE.WebGLRenderer: "+ot.message),ot}function ke(){he=new B(Ie),he.init(),Pe=new Pt(Ie,he),de=new m(Ie,he,e,Pe),fe=new Nt(Ie,he),de.reverseDepthBuffer&&b&&fe.buffers.depth.setReversed(!0),pe=new U(Ie),me=new vt,ge=new Rt(Ie,he,fe,me,de,Pe,pe),ve=new v(A),ye=new I(A),xe=new a(Ie),Fe=new f(Ie,xe),be=new k(Ie,xe,pe,Fe),_e=new H(Ie,be,xe,pe),Te=new z(Ie,de,ge),Ee=new g(me),we=new gt(A,ve,ye,he,de,Fe,Ee),Se=new kt(A,me),Me=new _t,De=new Ct(he),Ae=new d(A,ve,ye,fe,_e,_,u),Ce=new At(A,_e,de),Oe=new Lt(Ie,pe,de,fe),Ne=new p(Ie,he,pe),Re=new L(Ie,he,pe),pe.programs=we.programs,A.capabilities=de,A.extensions=he,A.properties=me,A.renderLists=Me,A.shadowMap=Ce,A.state=fe,A.info=pe}ke();const Le=new Ot(A,Ie);function Ue(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function ze(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;const e=pe.autoReset,t=Ce.enabled,n=Ce.autoUpdate,r=Ce.needsUpdate,i=Ce.type;ke(),pe.autoReset=e,Ce.enabled=t,Ce.autoUpdate=n,Ce.needsUpdate=r,Ce.type=i}function He(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Ve(e){const t=e.target;t.removeEventListener("dispose",Ve),function(e){(function(e){const t=me.get(e).programs;void 0!==t&&(t.forEach((function(e){we.releaseProgram(e)})),e.isShaderMaterial&&we.releaseShaderCache(e))})(e),me.remove(e)}(t)}function Ge(e,t,n){!0===e.transparent&&e.side===r.$EB&&!1===e.forceSinglePass?(e.side=r.hsX,e.needsUpdate=!0,et(e,t,n),e.side=r.hB5,e.needsUpdate=!0,et(e,t,n),e.side=r.$EB):et(e,t,n)}this.xr=Le,this.getContext=function(){return Ie},this.getContextAttributes=function(){return Ie.getContextAttributes()},this.forceContextLoss=function(){const e=he.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=he.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return Z},this.setPixelRatio=function(e){void 0!==e&&(Z=e,this.setSize(X,Y,!1))},this.getSize=function(e){return e.set(X,Y)},this.setSize=function(e,n){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Le.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(X=e,Y=n,t.width=Math.floor(e*Z),t.height=Math.floor(n*Z),!0===r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(X*Z,Y*Z).floor()},this.setDrawingBufferSize=function(e,n,r){X=e,Y=n,Z=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(V)},this.getViewport=function(e){return e.copy(J)},this.setViewport=function(e,t,n,r){e.isVector4?J.set(e.x,e.y,e.z,e.w):J.set(e,t,n,r),fe.viewport(V.copy(J).multiplyScalar(Z).round())},this.getScissor=function(e){return e.copy($)},this.setScissor=function(e,t,n,r){e.isVector4?$.set(e.x,e.y,e.z,e.w):$.set(e,t,n,r),fe.scissor(G.copy($).multiplyScalar(Z).round())},this.getScissorTest=function(){return ee},this.setScissorTest=function(e){fe.setScissorTest(ee=e)},this.setOpaqueSort=function(e){K=e},this.setTransparentSort=function(e){Q=e},this.getClearColor=function(e){return e.copy(Ae.getClearColor())},this.setClearColor=function(){Ae.setClearColor(...arguments)},this.getClearAlpha=function(){return Ae.getClearAlpha()},this.setClearAlpha=function(){Ae.setClearAlpha(...arguments)},this.clear=function(){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){let e=!1;if(null!==P){const t=P.texture.format;e=t===r.c90||t===r.TkQ||t===r.ZQM}if(e){const e=P.texture.type,t=e===r.OUM||e===r.bkx||e===r.cHt||e===r.V3x||e===r.Wew||e===r.gJ2,n=Ae.getClearColor(),i=Ae.getClearAlpha(),a=n.r,o=n.g,s=n.b;t?(w[0]=a,w[1]=o,w[2]=s,w[3]=i,Ie.clearBufferuiv(Ie.COLOR,0,w)):(S[0]=a,S[1]=o,S[2]=s,S[3]=i,Ie.clearBufferiv(Ie.COLOR,0,S))}else n|=Ie.COLOR_BUFFER_BIT}e&&(n|=Ie.DEPTH_BUFFER_BIT),t&&(n|=Ie.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ie.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ue,!1),t.removeEventListener("webglcontextrestored",ze,!1),t.removeEventListener("webglcontextcreationerror",He,!1),Ae.dispose(),Me.dispose(),De.dispose(),me.dispose(),ve.dispose(),ye.dispose(),_e.dispose(),Fe.dispose(),Oe.dispose(),we.dispose(),Le.dispose(),Le.removeEventListener("sessionstart",je),Le.removeEventListener("sessionend",Xe),Ye.stop()},this.renderBufferDirect=function(e,t,n,i,a,o){null===t&&(t=le);const s=a.isMesh&&a.matrixWorld.determinant()<0,l=function(e,t,n,i,a){!0!==t.isScene&&(t=le);ge.resetTextureUnits();const o=t.fog,s=i.isMeshStandardMaterial?t.environment:null,l=null===P?A.outputColorSpace:!0===P.isXRRenderTarget?P.texture.colorSpace:r.Zr2,c=(i.isMeshStandardMaterial?ye:ve).get(i.envMap||s),u=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,h=!!n.attributes.tangent&&(!!i.normalMap||i.anisotropy>0),d=!!n.morphAttributes.position,f=!!n.morphAttributes.normal,p=!!n.morphAttributes.color;let m=r.y_p;i.toneMapped&&(null!==P&&!0!==P.isXRRenderTarget||(m=A.toneMapping));const g=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==g?g.length:0,y=me.get(i),x=D.state.lights;if(!0===ne&&(!0===re||e!==O)){const t=e===O&&i.id===F;Ee.setState(i,e,t)}let b=!1;i.version===y.__version?y.needsLights&&y.lightsStateVersion!==x.state.version||y.outputColorSpace!==l||a.isBatchedMesh&&!1===y.batching?b=!0:a.isBatchedMesh||!0!==y.batching?a.isBatchedMesh&&!0===y.batchingColor&&null===a.colorTexture||a.isBatchedMesh&&!1===y.batchingColor&&null!==a.colorTexture||a.isInstancedMesh&&!1===y.instancing?b=!0:a.isInstancedMesh||!0!==y.instancing?a.isSkinnedMesh&&!1===y.skinning?b=!0:a.isSkinnedMesh||!0!==y.skinning?a.isInstancedMesh&&!0===y.instancingColor&&null===a.instanceColor||a.isInstancedMesh&&!1===y.instancingColor&&null!==a.instanceColor||a.isInstancedMesh&&!0===y.instancingMorph&&null===a.morphTexture||a.isInstancedMesh&&!1===y.instancingMorph&&null!==a.morphTexture||y.envMap!==c||!0===i.fog&&y.fog!==o?b=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===Ee.numPlanes&&y.numIntersection===Ee.numIntersection?(y.vertexAlphas!==u||y.vertexTangents!==h||y.morphTargets!==d||y.morphNormals!==f||y.morphColors!==p||y.toneMapping!==m||y.morphTargetsCount!==v)&&(b=!0):b=!0:b=!0:b=!0:b=!0:(b=!0,y.__version=i.version);let _=y.currentProgram;!0===b&&(_=et(i,t,a));let w=!1,S=!1,M=!1;const E=_.getUniforms(),C=y.uniforms;fe.useProgram(_.program)&&(w=!0,S=!0,M=!0);i.id!==F&&(F=i.id,S=!0);if(w||O!==e){fe.buffers.depth.getReversed()?(ie.copy(e.projectionMatrix),(0,r.xiE)(ie),(0,r.Mmk)(ie),E.setValue(Ie,"projectionMatrix",ie)):E.setValue(Ie,"projectionMatrix",e.projectionMatrix),E.setValue(Ie,"viewMatrix",e.matrixWorldInverse);const t=E.map.cameraPosition;void 0!==t&&t.setValue(Ie,oe.setFromMatrixPosition(e.matrixWorld)),de.logarithmicDepthBuffer&&E.setValue(Ie,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&E.setValue(Ie,"isOrthographic",!0===e.isOrthographicCamera),O!==e&&(O=e,S=!0,M=!0)}if(a.isSkinnedMesh){E.setOptional(Ie,a,"bindMatrix"),E.setOptional(Ie,a,"bindMatrixInverse");const e=a.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),E.setValue(Ie,"boneTexture",e.boneTexture,ge))}a.isBatchedMesh&&(E.setOptional(Ie,a,"batchingTexture"),E.setValue(Ie,"batchingTexture",a._matricesTexture,ge),E.setOptional(Ie,a,"batchingIdTexture"),E.setValue(Ie,"batchingIdTexture",a._indirectTexture,ge),E.setOptional(Ie,a,"batchingColorTexture"),null!==a._colorsTexture&&E.setValue(Ie,"batchingColorTexture",a._colorsTexture,ge));const T=n.morphAttributes;void 0===T.position&&void 0===T.normal&&void 0===T.color||Te.update(a,n,_);(S||y.receiveShadow!==a.receiveShadow)&&(y.receiveShadow=a.receiveShadow,E.setValue(Ie,"receiveShadow",a.receiveShadow));i.isMeshGouraudMaterial&&null!==i.envMap&&(C.envMap.value=c,C.flipEnvMap.value=c.isCubeTexture&&!1===c.isRenderTargetTexture?-1:1);i.isMeshStandardMaterial&&null===i.envMap&&null!==t.environment&&(C.envMapIntensity.value=t.environmentIntensity);S&&(E.setValue(Ie,"toneMappingExposure",A.toneMappingExposure),y.needsLights&&(R=M,(N=C).ambientLightColor.needsUpdate=R,N.lightProbe.needsUpdate=R,N.directionalLights.needsUpdate=R,N.directionalLightShadows.needsUpdate=R,N.pointLights.needsUpdate=R,N.pointLightShadows.needsUpdate=R,N.spotLights.needsUpdate=R,N.spotLightShadows.needsUpdate=R,N.rectAreaLights.needsUpdate=R,N.hemisphereLights.needsUpdate=R),o&&!0===i.fog&&Se.refreshFogUniforms(C,o),Se.refreshMaterialUniforms(C,i,Z,Y,D.state.transmissionRenderTarget[e.id]),We.upload(Ie,tt(y),C,ge));var N,R;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(We.upload(Ie,tt(y),C,ge),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&E.setValue(Ie,"center",a.center);if(E.setValue(Ie,"modelViewMatrix",a.modelViewMatrix),E.setValue(Ie,"normalMatrix",a.normalMatrix),E.setValue(Ie,"modelMatrix",a.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial){const e=i.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];Oe.update(n,_),Oe.bind(n,_)}}return _}(e,t,n,i,a);fe.setMaterial(i,s);let c=n.index,u=1;if(!0===i.wireframe){if(c=be.getWireframeAttribute(n),void 0===c)return;u=2}const h=n.drawRange,d=n.attributes.position;let f=h.start*u,p=(h.start+h.count)*u;null!==o&&(f=Math.max(f,o.start*u),p=Math.min(p,(o.start+o.count)*u)),null!==c?(f=Math.max(f,0),p=Math.min(p,c.count)):void 0!==d&&null!==d&&(f=Math.max(f,0),p=Math.min(p,d.count));const m=p-f;if(m<0||m===1/0)return;let g;Fe.setup(a,i,l,n,c);let v=Ne;if(null!==c&&(g=xe.get(c),v=Re,v.setIndex(g)),a.isMesh)!0===i.wireframe?(fe.setLineWidth(i.wireframeLinewidth*ue()),v.setMode(Ie.LINES)):v.setMode(Ie.TRIANGLES);else if(a.isLine){let e=i.linewidth;void 0===e&&(e=1),fe.setLineWidth(e*ue()),a.isLineSegments?v.setMode(Ie.LINES):a.isLineLoop?v.setMode(Ie.LINE_LOOP):v.setMode(Ie.LINE_STRIP)}else a.isPoints?v.setMode(Ie.POINTS):a.isSprite&&v.setMode(Ie.TRIANGLES);if(a.isBatchedMesh)if(null!==a._multiDrawInstances)(0,r.mcG)("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),v.renderMultiDrawInstances(a._multiDrawStarts,a._multiDrawCounts,a._multiDrawCount,a._multiDrawInstances);else if(he.get("WEBGL_multi_draw"))v.renderMultiDraw(a._multiDrawStarts,a._multiDrawCounts,a._multiDrawCount);else{const e=a._multiDrawStarts,t=a._multiDrawCounts,n=a._multiDrawCount,r=c?xe.get(c).bytesPerElement:1,o=me.get(i).currentProgram.getUniforms();for(let i=0;i<n;i++)o.setValue(Ie,"_gl_DrawID",i),v.render(e[i]/r,t[i])}else if(a.isInstancedMesh)v.renderInstances(f,m,a.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);v.renderInstances(f,m,t)}else v.render(f,m)},this.compile=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=e),D=De.get(n),D.init(t),C.push(D),n.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(D.pushLight(e),e.castShadow&&D.pushShadow(e))})),e!==n&&e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(D.pushLight(e),e.castShadow&&D.pushShadow(e))})),D.setupLights();const r=new Set;return e.traverse((function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];Ge(a,n,e),r.add(a)}else Ge(t,n,e),r.add(t)})),D=C.pop(),r},this.compileAsync=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=this.compile(e,t,n);return new Promise((t=>{function n(){r.forEach((function(e){me.get(e).currentProgram.isReady()&&r.delete(e)})),0!==r.size?setTimeout(n,10):t(e)}null!==he.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)}))};let qe=null;function je(){Ye.stop()}function Xe(){Ye.start()}const Ye=new i;function Ze(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)D.pushLight(e),e.castShadow&&D.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||te.intersectsSprite(e)){r&&se.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ae);const t=_e.update(e),i=e.material;i.visible&&M.push(e,t,i,n,se.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||te.intersectsObject(e))){const t=_e.update(e),i=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),se.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),se.copy(t.boundingSphere.center)),se.applyMatrix4(e.matrixWorld).applyMatrix4(ae)),Array.isArray(i)){const r=t.groups;for(let a=0,o=r.length;a<o;a++){const o=r[a],s=i[o.materialIndex];s&&s.visible&&M.push(e,t,s,n,se.z,o)}}else i.visible&&M.push(e,t,i,n,se.z,null)}const i=e.children;for(let a=0,o=i.length;a<o;a++)Ze(i[a],t,n,r)}function Ke(e,t,n,r){const i=e.opaque,a=e.transmissive,o=e.transparent;D.setupLightsView(n),!0===ne&&Ee.setGlobalState(A.clippingPlanes,n),r&&fe.viewport(V.copy(r)),i.length>0&&Je(i,t,n),a.length>0&&Je(a,t,n),o.length>0&&Je(o,t,n),fe.buffers.depth.setTest(!0),fe.buffers.depth.setMask(!0),fe.buffers.color.setMask(!0),fe.setPolygonOffset(!1)}function Qe(e,t,n,i){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===D.state.transmissionRenderTarget[i.id]&&(D.state.transmissionRenderTarget[i.id]=new r.nWS(1,1,{generateMipmaps:!0,type:he.has("EXT_color_buffer_half_float")||he.has("EXT_color_buffer_float")?r.ix0:r.OUM,minFilter:r.$_I,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:r.ppV.workingColorSpace}));const a=D.state.transmissionRenderTarget[i.id],o=i.viewport||V;a.setSize(o.z*A.transmissionResolutionScale,o.w*A.transmissionResolutionScale);const l=A.getRenderTarget();A.setRenderTarget(a),A.getClearColor(j),W=A.getClearAlpha(),W<1&&A.setClearColor(16777215,.5),A.clear(),ce&&Ae.render(n);const c=A.toneMapping;A.toneMapping=r.y_p;const u=i.viewport;if(void 0!==i.viewport&&(i.viewport=void 0),D.setupLightsView(i),!0===ne&&Ee.setGlobalState(A.clippingPlanes,i),Je(e,n,i),ge.updateMultisampleRenderTarget(a),ge.updateRenderTargetMipmap(a),!1===he.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let a=0,o=t.length;a<o;a++){const o=t[a],s=o.object,l=o.geometry,c=o.material,u=o.group;if(c.side===r.$EB&&s.layers.test(i.layers)){const t=c.side;c.side=r.hsX,c.needsUpdate=!0,$e(s,n,i,l,c,u),c.side=t,c.needsUpdate=!0,e=!0}}!0===e&&(ge.updateMultisampleRenderTarget(a),ge.updateRenderTargetMipmap(a))}A.setRenderTarget(l),A.setClearColor(j,W),void 0!==u&&(i.viewport=u),A.toneMapping=c}function Je(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,a=e.length;i<a;i++){const a=e[i],o=a.object,s=a.geometry,l=a.group;let c=a.material;!0===c.allowOverride&&null!==r&&(c=r),o.layers.test(n.layers)&&$e(o,t,n,s,c,l)}}function $e(e,t,n,i,a,o){e.onBeforeRender(A,t,n,i,a,o),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),a.onBeforeRender(A,t,n,i,e,o),!0===a.transparent&&a.side===r.$EB&&!1===a.forceSinglePass?(a.side=r.hsX,a.needsUpdate=!0,A.renderBufferDirect(n,t,i,a,e,o),a.side=r.hB5,a.needsUpdate=!0,A.renderBufferDirect(n,t,i,a,e,o),a.side=r.$EB):A.renderBufferDirect(n,t,i,a,e,o),e.onAfterRender(A,t,n,i,a,o)}function et(e,t,n){!0!==t.isScene&&(t=le);const r=me.get(e),i=D.state.lights,a=D.state.shadowsArray,o=i.state.version,s=we.getParameters(e,i.state,a,t,n),l=we.getProgramCacheKey(s);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?ye:ve).get(e.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",Ve),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===o)return nt(e,s),u}else s.uniforms=we.getUniforms(e),e.onBeforeCompile(s,A),u=we.acquireProgram(s,l),c.set(l,u),r.uniforms=s.uniforms;const h=r.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=Ee.uniform),nt(e,s),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=o,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=u,r.uniformsList=null,u}function tt(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=We.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function nt(e,t){const n=me.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Ye.setAnimationLoop((function(e){qe&&qe(e)})),"undefined"!==typeof self&&Ye.setContext(self),this.setAnimationLoop=function(e){qe=e,Le.setAnimationLoop(e),null===e?Ye.stop():Ye.start()},Le.addEventListener("sessionstart",je),Le.addEventListener("sessionend",Xe),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===T)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Le.enabled&&!0===Le.isPresenting&&(!0===Le.cameraAutoUpdate&&Le.updateCamera(t),t=Le.getCamera()),!0===e.isScene&&e.onBeforeRender(A,e,t,P),D=De.get(e,C.length),D.init(t),C.push(D),ae.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),te.setFromProjectionMatrix(ae),re=this.localClippingEnabled,ne=Ee.init(this.clippingPlanes,re),M=Me.get(e,E.length),M.init(),E.push(M),!0===Le.enabled&&!0===Le.isPresenting){const e=A.xr.getDepthSensingMesh();null!==e&&Ze(e,t,-1/0,A.sortObjects)}Ze(e,t,0,A.sortObjects),M.finish(),!0===A.sortObjects&&M.sort(K,Q),ce=!1===Le.enabled||!1===Le.isPresenting||!1===Le.hasDepthSensing(),ce&&Ae.addToRenderList(M,e),this.info.render.frame++,!0===ne&&Ee.beginShadows();const n=D.state.shadowsArray;Ce.render(n,e,t),!0===ne&&Ee.endShadows(),!0===this.info.autoReset&&this.info.reset();const r=M.opaque,i=M.transmissive;if(D.setupLights(),t.isArrayCamera){const n=t.cameras;if(i.length>0)for(let t=0,a=n.length;t<a;t++){Qe(r,i,e,n[t])}ce&&Ae.render(e);for(let t=0,r=n.length;t<r;t++){const r=n[t];Ke(M,e,r,r.viewport)}}else i.length>0&&Qe(r,i,e,t),ce&&Ae.render(e),Ke(M,e,t);null!==P&&0===R&&(ge.updateMultisampleRenderTarget(P),ge.updateRenderTargetMipmap(P)),!0===e.isScene&&e.onAfterRender(A,e,t),Fe.resetDefaultState(),F=-1,O=null,C.pop(),C.length>0?(D=C[C.length-1],!0===ne&&Ee.setGlobalState(A.clippingPlanes,D.state.camera)):D=null,E.pop(),M=E.length>0?E[E.length-1]:null},this.getActiveCubeFace=function(){return N},this.getActiveMipmapLevel=function(){return R},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(e,t,n){const r=me.get(e);r.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===r.__autoAllocateDepthBuffer&&(r.__useRenderToTexture=!1),me.get(e.texture).__webglTexture=t,me.get(e.depthTexture).__webglTexture=r.__autoAllocateDepthBuffer?void 0:n,r.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){const n=me.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t};const rt=Ie.createFramebuffer();this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;P=e,N=t,R=n;let r=!0,i=null,a=!1,o=!1;if(e){const s=me.get(e);if(void 0!==s.__useDefaultFramebuffer)fe.bindFramebuffer(Ie.FRAMEBUFFER,null),r=!1;else if(void 0===s.__webglFramebuffer)ge.setupRenderTarget(e);else if(s.__hasExternalTextures)ge.rebindTextures(e,me.get(e.texture).__webglTexture,me.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(s.__boundDepthTexture!==t){if(null!==t&&me.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ge.setupDepthRenderbuffer(e)}}const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(o=!0);const c=me.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=Array.isArray(c[t])?c[t][n]:c[t],a=!0):i=e.samples>0&&!1===ge.useMultisampledRTT(e)?me.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,V.copy(e.viewport),G.copy(e.scissor),q=e.scissorTest}else V.copy(J).multiplyScalar(Z).floor(),G.copy($).multiplyScalar(Z).floor(),q=ee;0!==n&&(i=rt);if(fe.bindFramebuffer(Ie.FRAMEBUFFER,i)&&r&&fe.drawBuffers(e,i),fe.viewport(V),fe.scissor(G),fe.setScissorTest(q),a){const r=me.get(e.texture);Ie.framebufferTexture2D(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,Ie.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,n)}else if(o){const r=me.get(e.texture),i=t;Ie.framebufferTextureLayer(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,r.__webglTexture,n,i)}else if(null!==e&&0!==n){const t=me.get(e.texture);Ie.framebufferTexture2D(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,Ie.TEXTURE_2D,t.__webglTexture,n)}F=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=me.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){fe.bindFramebuffer(Ie.FRAMEBUFFER,s);try{const o=e.texture,s=o.format,l=o.type;if(!de.textureFormatReadable(s))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!de.textureTypeReadable(l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&Ie.readPixels(t,n,r,i,Pe.convert(s),Pe.convert(l),a)}finally{const e=null!==P?me.get(P).__webglFramebuffer:null;fe.bindFramebuffer(Ie.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,i,a,o,s){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=me.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(l=l[s]),l){if(t>=0&&t<=e.width-i&&n>=0&&n<=e.height-a){fe.bindFramebuffer(Ie.FRAMEBUFFER,l);const s=e.texture,c=s.format,u=s.type;if(!de.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!de.textureTypeReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const h=Ie.createBuffer();Ie.bindBuffer(Ie.PIXEL_PACK_BUFFER,h),Ie.bufferData(Ie.PIXEL_PACK_BUFFER,o.byteLength,Ie.STREAM_READ),Ie.readPixels(t,n,i,a,Pe.convert(c),Pe.convert(u),0);const d=null!==P?me.get(P).__webglFramebuffer:null;fe.bindFramebuffer(Ie.FRAMEBUFFER,d);const f=Ie.fenceSync(Ie.SYNC_GPU_COMMANDS_COMPLETE,0);return Ie.flush(),await(0,r.jej)(Ie,f,4),Ie.bindBuffer(Ie.PIXEL_PACK_BUFFER,h),Ie.getBufferSubData(Ie.PIXEL_PACK_BUFFER,0,o),Ie.deleteBuffer(h),Ie.deleteSync(f),o}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),a=Math.floor(e.image.height*r),o=null!==t?t.x:0,s=null!==t?t.y:0;ge.setTexture2D(e,0),Ie.copyTexSubImage2D(Ie.TEXTURE_2D,n,0,0,o,s,i,a),fe.unbindTexture()};const it=Ie.createFramebuffer(),at=Ie.createFramebuffer();this.copyTextureToTexture=function(e,t){let n,i,a,o,s,l,c,u,h,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===m&&(0!==p?((0,r.mcG)("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),m=p,p=0):m=0);const g=e.isCompressedTexture?e.mipmaps[m]:e.image;if(null!==d)n=d.max.x-d.min.x,i=d.max.y-d.min.y,a=d.isBox3?d.max.z-d.min.z:1,o=d.min.x,s=d.min.y,l=d.isBox3?d.min.z:0;else{const t=Math.pow(2,-p);n=Math.floor(g.width*t),i=Math.floor(g.height*t),a=e.isDataArrayTexture?g.depth:e.isData3DTexture?Math.floor(g.depth*t):1,o=0,s=0,l=0}null!==f?(c=f.x,u=f.y,h=f.z):(c=0,u=0,h=0);const v=Pe.convert(t.format),y=Pe.convert(t.type);let x;t.isData3DTexture?(ge.setTexture3D(t,0),x=Ie.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(ge.setTexture2DArray(t,0),x=Ie.TEXTURE_2D_ARRAY):(ge.setTexture2D(t,0),x=Ie.TEXTURE_2D),Ie.pixelStorei(Ie.UNPACK_FLIP_Y_WEBGL,t.flipY),Ie.pixelStorei(Ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Ie.pixelStorei(Ie.UNPACK_ALIGNMENT,t.unpackAlignment);const b=Ie.getParameter(Ie.UNPACK_ROW_LENGTH),_=Ie.getParameter(Ie.UNPACK_IMAGE_HEIGHT),w=Ie.getParameter(Ie.UNPACK_SKIP_PIXELS),S=Ie.getParameter(Ie.UNPACK_SKIP_ROWS),M=Ie.getParameter(Ie.UNPACK_SKIP_IMAGES);Ie.pixelStorei(Ie.UNPACK_ROW_LENGTH,g.width),Ie.pixelStorei(Ie.UNPACK_IMAGE_HEIGHT,g.height),Ie.pixelStorei(Ie.UNPACK_SKIP_PIXELS,o),Ie.pixelStorei(Ie.UNPACK_SKIP_ROWS,s),Ie.pixelStorei(Ie.UNPACK_SKIP_IMAGES,l);const D=e.isDataArrayTexture||e.isData3DTexture,E=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const r=me.get(e),d=me.get(t),f=me.get(r.__renderTarget),g=me.get(d.__renderTarget);fe.bindFramebuffer(Ie.READ_FRAMEBUFFER,f.__webglFramebuffer),fe.bindFramebuffer(Ie.DRAW_FRAMEBUFFER,g.__webglFramebuffer);for(let v=0;v<a;v++)D&&(Ie.framebufferTextureLayer(Ie.READ_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,me.get(e).__webglTexture,p,l+v),Ie.framebufferTextureLayer(Ie.DRAW_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,me.get(t).__webglTexture,m,h+v)),Ie.blitFramebuffer(o,s,n,i,c,u,n,i,Ie.DEPTH_BUFFER_BIT,Ie.NEAREST);fe.bindFramebuffer(Ie.READ_FRAMEBUFFER,null),fe.bindFramebuffer(Ie.DRAW_FRAMEBUFFER,null)}else if(0!==p||e.isRenderTargetTexture||me.has(e)){const r=me.get(e),d=me.get(t);fe.bindFramebuffer(Ie.READ_FRAMEBUFFER,it),fe.bindFramebuffer(Ie.DRAW_FRAMEBUFFER,at);for(let e=0;e<a;e++)D?Ie.framebufferTextureLayer(Ie.READ_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,r.__webglTexture,p,l+e):Ie.framebufferTexture2D(Ie.READ_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,Ie.TEXTURE_2D,r.__webglTexture,p),E?Ie.framebufferTextureLayer(Ie.DRAW_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,d.__webglTexture,m,h+e):Ie.framebufferTexture2D(Ie.DRAW_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,Ie.TEXTURE_2D,d.__webglTexture,m),0!==p?Ie.blitFramebuffer(o,s,n,i,c,u,n,i,Ie.COLOR_BUFFER_BIT,Ie.NEAREST):E?Ie.copyTexSubImage3D(x,m,c,u,h+e,o,s,n,i):Ie.copyTexSubImage2D(x,m,c,u,o,s,n,i);fe.bindFramebuffer(Ie.READ_FRAMEBUFFER,null),fe.bindFramebuffer(Ie.DRAW_FRAMEBUFFER,null)}else E?e.isDataTexture||e.isData3DTexture?Ie.texSubImage3D(x,m,c,u,h,n,i,a,v,y,g.data):t.isCompressedArrayTexture?Ie.compressedTexSubImage3D(x,m,c,u,h,n,i,a,v,g.data):Ie.texSubImage3D(x,m,c,u,h,n,i,a,v,y,g):e.isDataTexture?Ie.texSubImage2D(Ie.TEXTURE_2D,m,c,u,n,i,v,y,g.data):e.isCompressedTexture?Ie.compressedTexSubImage2D(Ie.TEXTURE_2D,m,c,u,g.width,g.height,v,g.data):Ie.texSubImage2D(Ie.TEXTURE_2D,m,c,u,n,i,v,y,g);Ie.pixelStorei(Ie.UNPACK_ROW_LENGTH,b),Ie.pixelStorei(Ie.UNPACK_IMAGE_HEIGHT,_),Ie.pixelStorei(Ie.UNPACK_SKIP_PIXELS,w),Ie.pixelStorei(Ie.UNPACK_SKIP_ROWS,S),Ie.pixelStorei(Ie.UNPACK_SKIP_IMAGES,M),0===m&&t.generateMipmaps&&Ie.generateMipmap(x),fe.unbindTexture()},this.copyTextureToTexture3D=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return(0,r.mcG)('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(e,t,n,i,a)},this.initRenderTarget=function(e){void 0===me.get(e).__webglFramebuffer&&ge.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?ge.setTextureCube(e,0):e.isData3DTexture?ge.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?ge.setTexture2DArray(e,0):ge.setTexture2D(e,0),fe.unbindTexture()},this.resetState=function(){N=0,R=0,P=null,fe.reset(),Fe.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return r.TdN}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=r.ppV._getDrawingBufferColorSpace(e),t.unpackColorSpace=r.ppV._getUnpackColorSpace()}}},9435:(e,t,n)=>{"use strict";n.d(t,{$EB:()=>v,$Ed:()=>Is,$Kf:()=>Xo,$NF:()=>Du,$O9:()=>we,$Yl:()=>H,$_I:()=>Ae,$ei:()=>A,$p8:()=>ju,A$4:()=>_a,AKb:()=>tu,ALV:()=>Fr,AQS:()=>ir,Am1:()=>oh,B69:()=>Li,B6O:()=>Rl,BER:()=>ce,BH$:()=>Ks,BKk:()=>Ja,BND:()=>Cd,BRH:()=>Cu,BXX:()=>nt,B_h:()=>ht,CR7:()=>pn,CSG:()=>Wc,CV9:()=>zl,CVz:()=>st,CWW:()=>Nt,Cfg:()=>Se,CmU:()=>Qu,CwR:()=>Dh,D$Q:()=>Uc,DAe:()=>Ht,DXC:()=>Ys,Df:()=>Gc,Dmk:()=>He,E0M:()=>Pd,EAD:()=>Qo,EQC:()=>Bt,EZo:()=>b,EdD:()=>w,F1T:()=>ao,F1l:()=>ud,FCc:()=>Zs,FFZ:()=>En,FNr:()=>Yc,FV:()=>ae,FXf:()=>D,FZo:()=>Yu,Fn:()=>Mt,Fpm:()=>id,FvD:()=>ol,Fvi:()=>ue,Fvt:()=>Zc,G3T:()=>Rt,G4u:()=>Hn,GBG:()=>uu,GJx:()=>ve,GOR:()=>cl,GWd:()=>qe,GYF:()=>Yo,GZZ:()=>kl,G_z:()=>jc,Gu$:()=>Nc,Gwm:()=>Z,GxU:()=>da,H23:()=>Dt,H2z:()=>Id,HIg:()=>Ge,HLH:()=>on,HO_:()=>Tt,HPb:()=>hn,HXV:()=>at,HgN:()=>_r,HiM:()=>Hu,Hit:()=>cu,Ho_:()=>pl,Hrb:()=>ba,Hrq:()=>Fn,I46:()=>Wo,I9Y:()=>tr,IE4:()=>$e,IUQ:()=>Cr,IWo:()=>Ed,Iit:()=>Za,Ipv:()=>Sl,Iw4:()=>kh,IzY:()=>Fd,Jnc:()=>c,K52:()=>K,KDk:()=>ct,KLL:()=>tn,KPJ:()=>vu,KRh:()=>$,Ke9:()=>zt,Kef:()=>Ct,Ktl:()=>Tn,Kwu:()=>_,Kzg:()=>rh,LAk:()=>se,Ld9:()=>Od,LiQ:()=>P,LlO:()=>Qa,LoY:()=>Fa,LuO:()=>Gh,MBL:()=>hu,MOq:()=>On,MSw:()=>Tc,MW4:()=>Sa,Mjd:()=>re,Mmk:()=>fr,N1A:()=>qs,N2s:()=>Eh,N5j:()=>Wt,NRn:()=>Lr,NTi:()=>x,NZq:()=>Te,Nex:()=>Bd,Nt7:()=>B,Nv2:()=>rl,Nwf:()=>Fh,Nz6:()=>et,O0B:()=>Ar,O3Y:()=>Pc,O49:()=>Gt,O9p:()=>_i,ONl:()=>tl,OUM:()=>Ne,Oax:()=>Ma,Om:()=>ge,OuU:()=>O,P5j:()=>Oh,PFK:()=>bd,PJ3:()=>It,PPD:()=>fs,PTz:()=>Or,Pdi:()=>ru,Pem:()=>al,Pf$:()=>yh,Pq0:()=>Ir,Q1f:()=>ra,QCA:()=>wc,QP0:()=>d,Qev:()=>Gn,Qrf:()=>pt,R1W:()=>pd,R3r:()=>uo,RJ4:()=>Vt,ROr:()=>sn,RQf:()=>Be,RcT:()=>mn,RiT:()=>fu,Riy:()=>lt,Rkk:()=>jt,RlV:()=>ui,RoJ:()=>yo,RrE:()=>z,Ru$:()=>ln,RyA:()=>p,S$4:()=>St,S20:()=>Ml,S7T:()=>hl,SUR:()=>Ju,SYV:()=>il,ScU:()=>Eu,T6I:()=>lu,TDQ:()=>wl,THS:()=>ga,TM5:()=>Vn,TMh:()=>vn,Tap:()=>Au,TdN:()=>Ln,TiK:()=>wn,TkQ:()=>Ke,U3G:()=>Y,UJ6:()=>ou,UPV:()=>Fc,UTZ:()=>he,Ufg:()=>Ec,UpK:()=>Bo,UtB:()=>$h,UtX:()=>ah,V3x:()=>ze,V9B:()=>sa,VCu:()=>ul,VGF:()=>Qe,VT0:()=>Xe,VVr:()=>rn,Vb5:()=>l,VnP:()=>Ll,Vnu:()=>An,Vwu:()=>kd,VxR:()=>en,W9U:()=>Et,WBB:()=>Mc,WNZ:()=>s,WTh:()=>Sd,Wdf:()=>kn,Wew:()=>Le,Wk7:()=>f,Wyr:()=>Bn,XG_:()=>At,XIg:()=>y,XJ7:()=>Ic,XMJ:()=>Lh,XTe:()=>$u,XrR:()=>ee,Y9S:()=>wu,YHV:()=>Zh,YJl:()=>lo,YOZ:()=>su,YRT:()=>Mu,Yhb:()=>au,Yuy:()=>Oe,Z0B:()=>Il,Z58:()=>po,ZLX:()=>os,ZM4:()=>Ad,ZQM:()=>Ye,Zcv:()=>us,Zpd:()=>Rc,Zr2:()=>$t,ZyN:()=>qu,_4j:()=>zc,_QJ:()=>vt,_Ut:()=>Ka,_xc:()=>ld,a$r:()=>Me,a55:()=>Xn,a5J:()=>gt,aEY:()=>L,aHM:()=>xu,aJ8:()=>le,aMy:()=>Pt,aVO:()=>Xc,agE:()=>Cn,amv:()=>xn,b4q:()=>oo,bC7:()=>bt,bCz:()=>S,bI3:()=>Zt,bTm:()=>h,baL:()=>ya,bdM:()=>Cc,bkx:()=>Ie,brA:()=>W,bw0:()=>Q,c5h:()=>ll,c90:()=>Je,cHt:()=>Fe,cRK:()=>ho,cZY:()=>nd,caT:()=>J,cj9:()=>er,czI:()=>dt,dAo:()=>Ul,dYF:()=>Pr,dcC:()=>We,dhZ:()=>Ut,dth:()=>Nu,dwI:()=>nr,dzP:()=>Vh,e0p:()=>V,eB$:()=>mo,eHc:()=>q,eHs:()=>vo,eaF:()=>ja,eoi:()=>Sn,er$:()=>Jt,ezk:()=>iu,f4X:()=>R,fBL:()=>Pe,fJr:()=>cn,fP5:()=>xh,fTw:()=>md,fc6:()=>xa,g7M:()=>oe,gJ2:()=>Ue,gO9:()=>M,gPd:()=>Er,gWB:()=>Dn,ghU:()=>ye,h2z:()=>Lt,hB5:()=>m,hIf:()=>Rn,hZF:()=>du,h_9:()=>yu,hdd:()=>I,hgQ:()=>U,hjs:()=>Kh,hsX:()=>g,hxR:()=>be,hy7:()=>de,hzE:()=>gd,i7d:()=>$a,i7u:()=>Un,iNn:()=>Xa,iOZ:()=>sl,iUH:()=>Ce,ibB:()=>Dl,ie2:()=>F,imn:()=>oa,ix0:()=>ke,iyt:()=>ni,j6:()=>Oc,jGm:()=>Gl,jR7:()=>tt,jUj:()=>fo,jej:()=>hr,jf0:()=>Qt,jsO:()=>fn,jut:()=>Zu,jzd:()=>Mn,k6Q:()=>rt,k6q:()=>De,k8v:()=>Yt,kBv:()=>a,kEx:()=>Su,kG0:()=>an,kLi:()=>Sr,kO0:()=>_n,kRr:()=>Ee,kTW:()=>xe,kTp:()=>it,kYr:()=>dn,k_V:()=>Qh,keZ:()=>uh,klZ:()=>gn,kn4:()=>hi,kqe:()=>nn,kxk:()=>Po,kyO:()=>ne,l2R:()=>gu,lGu:()=>j,lGw:()=>nu,lMl:()=>Ji,lPF:()=>lr,lc7:()=>Ft,ljd:()=>Ot,lxW:()=>Ya,lyL:()=>xt,mcG:()=>ur,mrM:()=>Bs,nCl:()=>Bu,nEu:()=>vl,nNL:()=>ie,nST:()=>E,nWS:()=>Tr,nZQ:()=>hh,nc$:()=>zh,nzx:()=>Dc,o6l:()=>so,oVO:()=>un,oh6:()=>qh,ojh:()=>T,ojs:()=>wt,ov9:()=>G,pBf:()=>ot,pFK:()=>gl,pHI:()=>_e,pPE:()=>Ih,paN:()=>Ze,ppV:()=>vr,psI:()=>mt,q2:()=>Lc,qBx:()=>qc,qFE:()=>ml,qU7:()=>dl,qUd:()=>Vu,qa3:()=>ut,qad:()=>N,qq$:()=>sr,qtW:()=>Da,r6x:()=>Ku,rFo:()=>Nr,rKP:()=>Ac,rOG:()=>In,rQf:()=>kt,rSH:()=>ft,rYR:()=>qt,rrX:()=>Uh,s0K:()=>Bl,sKt:()=>yn,sPf:()=>i,tBo:()=>Wh,tJf:()=>Re,tXL:()=>Vc,tcD:()=>fl,tz3:()=>pu,uB5:()=>yt,uSd:()=>Hc,uV5:()=>me,uWO:()=>Jo,uXQ:()=>Nn,ubm:()=>ro,uf3:()=>gs,uov:()=>Pn,ure:()=>Wu,v9J:()=>zn,veJ:()=>Tu,vim:()=>bn,vmz:()=>wa,vyJ:()=>Kt,wAk:()=>ql,wTz:()=>Xt,wfO:()=>pe,wn6:()=>k,wrO:()=>Ve,wtR:()=>o,wvS:()=>va,xFO:()=>fe,xJ6:()=>xc,xOk:()=>Xu,xSv:()=>X,xZx:()=>Mh,xfg:()=>Hl,xiE:()=>dr,y3Z:()=>_t,y9J:()=>Rr,y_p:()=>te,ypk:()=>jl,ywQ:()=>u,zD7:()=>dh,zdS:()=>je,zgK:()=>wi,znC:()=>C});var r=n(9379);const i="176",a={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},o={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},s=0,l=1,c=2,u=3,h=0,d=1,f=2,p=3,m=0,g=1,v=2,y=0,x=1,b=2,_=3,w=4,S=5,M=100,D=101,E=102,C=103,A=104,T=200,N=201,R=202,P=203,F=204,O=205,I=206,B=207,k=208,L=209,U=210,z=211,H=212,V=213,G=214,q=0,j=1,W=2,X=3,Y=4,Z=5,K=6,Q=7,J=0,$=1,ee=2,te=0,ne=1,re=2,ie=3,ae=4,oe=5,se=6,le=7,ce="attached",ue="detached",he=300,de=301,fe=302,pe=303,me=304,ge=306,ve=1e3,ye=1001,xe=1002,be=1003,_e=1004,we=1004,Se=1005,Me=1005,De=1006,Ee=1007,Ce=1007,Ae=1008,Te=1008,Ne=1009,Re=1010,Pe=1011,Fe=1012,Oe=1013,Ie=1014,Be=1015,ke=1016,Le=1017,Ue=1018,ze=1020,He=35902,Ve=1021,Ge=1022,qe=1023,je=1026,We=1027,Xe=1028,Ye=1029,Ze=1030,Ke=1031,Qe=1032,Je=1033,$e=33776,et=33777,tt=33778,nt=33779,rt=35840,it=35841,at=35842,ot=35843,st=36196,lt=37492,ct=37496,ut=37808,ht=37809,dt=37810,ft=37811,pt=37812,mt=37813,gt=37814,vt=37815,yt=37816,xt=37817,bt=37818,_t=37819,wt=37820,St=37821,Mt=36492,Dt=36494,Et=36495,Ct=36283,At=36284,Tt=36285,Nt=36286,Rt=2200,Pt=2201,Ft=2202,Ot=2300,It=2301,Bt=2302,kt=2400,Lt=2401,Ut=2402,zt=2500,Ht=2501,Vt=0,Gt=1,qt=2,jt=3200,Wt=3201,Xt=3202,Yt=3203,Zt=0,Kt=1,Qt="",Jt="srgb",$t="srgb-linear",en="linear",tn="srgb",nn=0,rn=7680,an=7681,on=7682,sn=7683,ln=34055,cn=34056,un=5386,hn=512,dn=513,fn=514,pn=515,mn=516,gn=517,vn=518,yn=519,xn=512,bn=513,_n=514,wn=515,Sn=516,Mn=517,Dn=518,En=519,Cn=35044,An=35048,Tn=35040,Nn=35045,Rn=35049,Pn=35041,Fn=35046,On=35050,In=35042,Bn="100",kn="300 es",Ln=2e3,Un=2001,zn={COMPUTE:"compute",RENDER:"render"},Hn={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},Vn={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FLAT_FIRST:"flat first",FLAT_EITHER:"flat either"};class Gn{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n&&(void 0!==n[e]&&-1!==n[e].indexOf(t))}removeEventListener(e,t){const n=this._listeners;if(void 0===n)return;const r=n[e];if(void 0!==r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const n=t[e.type];if(void 0!==n){e.target=this;const t=n.slice(0);for(let n=0,r=t.length;n<r;n++)t[n].call(this,e);e.target=null}}}const qn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let jn=1234567;const Wn=Math.PI/180,Xn=180/Math.PI;function Yn(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(qn[255&e]+qn[e>>8&255]+qn[e>>16&255]+qn[e>>24&255]+"-"+qn[255&t]+qn[t>>8&255]+"-"+qn[t>>16&15|64]+qn[t>>24&255]+"-"+qn[63&n|128]+qn[n>>8&255]+"-"+qn[n>>16&255]+qn[n>>24&255]+qn[255&r]+qn[r>>8&255]+qn[r>>16&255]+qn[r>>24&255]).toLowerCase()}function Zn(e,t,n){return Math.max(t,Math.min(n,e))}function Kn(e,t){return(e%t+t)%t}function Qn(e,t,n){return(1-n)*e+n*t}function Jn(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function $n(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const er={DEG2RAD:Wn,RAD2DEG:Xn,generateUUID:Yn,clamp:Zn,euclideanModulo:Kn,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Qn,damp:function(e,t,n,r){return Qn(e,t,1-Math.exp(-n*r))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(Kn(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(jn=e);let t=jn+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*Wn},radToDeg:function(e){return e*Xn},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){const a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),c=a((t+r)/2),u=o((t+r)/2),h=a((t-r)/2),d=o((t-r)/2),f=a((r-t)/2),p=o((r-t)/2);switch(i){case"XYX":e.set(s*u,l*h,l*d,s*c);break;case"YZY":e.set(l*d,s*u,l*h,s*c);break;case"ZXZ":e.set(l*h,l*d,s*u,s*c);break;case"XZX":e.set(s*u,l*p,l*f,s*c);break;case"YXY":e.set(l*f,s*u,l*p,s*c);break;case"ZYZ":e.set(l*p,l*f,s*u,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:$n,denormalize:Jn};class tr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;tr.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Zn(this.x,e.x,t.x),this.y=Zn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Zn(this.x,e,t),this.y=Zn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Zn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Zn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class nr{constructor(e,t,n,r,i,a,o,s,l){nr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,a,o,s,l)}set(e,t,n,r,i,a,o,s,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=o,c[3]=t,c[4]=i,c[5]=s,c[6]=n,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],x=r[7],b=r[2],_=r[5],w=r[8];return i[0]=a*p+o*v+s*b,i[3]=a*m+o*y+s*_,i[6]=a*g+o*x+s*w,i[1]=l*p+c*v+u*b,i[4]=l*m+c*y+u*_,i[7]=l*g+c*x+u*w,i[2]=h*p+d*v+f*b,i[5]=h*m+d*y+f*_,i[8]=h*g+d*x+f*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*a*c-t*o*l-n*i*c+n*o*s+r*i*l-r*a*s}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=c*a-o*l,h=o*s-c*i,d=l*i-a*s,f=t*u+n*h+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return e[0]=u*p,e[1]=(r*l-c*n)*p,e[2]=(o*n-r*a)*p,e[3]=h*p,e[4]=(c*t-r*s)*p,e[5]=(r*i-o*t)*p,e[6]=d*p,e[7]=(n*s-l*t)*p,e[8]=(a*t-n*i)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,o){const s=Math.cos(i),l=Math.sin(i);return this.set(n*s,n*l,-n*(s*a+l*o)+a+e,-r*l,r*s,-r*(-l*a+s*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(rr.makeScale(e,t)),this}rotate(e){return this.premultiply(rr.makeRotation(-e)),this}translate(e,t){return this.premultiply(rr.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const rr=new nr;function ir(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}const ar={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function or(e,t){return new ar[e](t)}function sr(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function lr(){const e=sr("canvas");return e.style.display="block",e}const cr={};function ur(e){e in cr||(cr[e]=!0,console.warn(e))}function hr(e,t,n){return new Promise((function(r,i){setTimeout((function a(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:i();break;case e.TIMEOUT_EXPIRED:setTimeout(a,n);break;default:r()}}),n)}))}function dr(e){const t=e.elements;t[2]=.5*t[2]+.5*t[3],t[6]=.5*t[6]+.5*t[7],t[10]=.5*t[10]+.5*t[11],t[14]=.5*t[14]+.5*t[15]}function fr(e){const t=e.elements;-1===t[11]?(t[10]=-t[10]-1,t[14]=-t[14]):(t[10]=-t[10],t[14]=1-t[14])}const pr=(new nr).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),mr=(new nr).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function gr(){const e={enabled:!0,workingColorSpace:$t,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===tn&&(e.r=yr(e.r),e.g=yr(e.g),e.b=yr(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===tn&&(e.r=xr(e.r),e.g=xr(e.g),e.b=xr(e.b)),e):e},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===Qt?en:this.spaces[e].transfer},getLuminanceCoefficients:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.workingColorSpace;return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.workingColorSpace;return this.spaces[e].workingColorSpaceConfig.unpackColorSpace}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return e.define({[$t]:{primaries:t,whitePoint:r,transfer:en,toXYZ:pr,fromXYZ:mr,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Jt},outputColorSpaceConfig:{drawingBufferColorSpace:Jt}},[Jt]:{primaries:t,whitePoint:r,transfer:tn,toXYZ:pr,fromXYZ:mr,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Jt}}}),e}const vr=gr();function yr(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function xr(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let br;class _r{static getDataURL(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===br&&(br=sr("canvas")),br.width=e.width,br.height=e.height;const n=br.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=br}return t.toDataURL(n)}static sRGBToLinear(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const t=sr("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*yr(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*yr(t[e]/255)):t[e]=yr(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let wr=0;class Sr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:wr++}),this.uuid=Yn(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(Mr(r[t].image)):e.push(Mr(r[t]))}else e=Mr(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function Mr(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?_r.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Dr=0;class Er extends Gn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Er.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Er.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ye,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ye,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:De,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ae,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:qe,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Ne,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Er.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:Qt;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Dr++}),this.uuid=Yn(),this.name="",this.source=new Sr(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=s,this.offset=new tr(0,0),this.repeat=new tr(1,1),this.center=new tr(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new nr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==he)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ve:e.x=e.x-Math.floor(e.x);break;case ye:e.x=e.x<0?0:1;break;case xe:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ve:e.y=e.y-Math.floor(e.y);break;case ye:e.y=e.y<0?0:1;break;case xe:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}Er.DEFAULT_IMAGE=null,Er.DEFAULT_MAPPING=he,Er.DEFAULT_ANISOTROPY=1;class Cr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Cr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const a=.01,o=.1,s=e.elements,l=s[0],c=s[4],u=s[8],h=s[1],d=s[5],f=s[9],p=s[2],m=s[6],g=s[10];if(Math.abs(c-h)<a&&Math.abs(u-p)<a&&Math.abs(f-m)<a){if(Math.abs(c+h)<o&&Math.abs(u+p)<o&&Math.abs(f+m)<o&&Math.abs(l+d+g-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,s=(d+1)/2,v=(g+1)/2,y=(c+h)/4,x=(u+p)/4,b=(f+m)/4;return e>s&&e>v?e<a?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=y/n,i=x/n):s>v?s<a?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(s),n=y/r,i=b/r):v<a?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=x/i,r=b/i),this.set(n,r,i,t),this}let v=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(u-p)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Zn(this.x,e.x,t.x),this.y=Zn(this.y,e.y,t.y),this.z=Zn(this.z,e.z,t.z),this.w=Zn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Zn(this.x,e,t),this.y=Zn(this.y,e,t),this.z=Zn(this.z,e,t),this.w=Zn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Zn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ar extends Gn{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth?n.depth:1,this.scissor=new Cr(0,0,e,t),this.scissorTest=!1,this.viewport=new Cr(0,0,e,t);const r={width:e,height:t,depth:this.depth};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:De,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},n);const i=new Er(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);i.flipY=!1,i.generateMipmaps=n.generateMipmaps,i.internalFormat=n.internalFormat,this.textures=[];const a=n.count;for(let o=0;o<a;o++)this.textures[o]=i.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const n=Object.assign({},e.textures[t].image);this.textures[t].source=new Sr(n)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Tr extends Ar{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.isWebGLRenderTarget=!0}}class Nr extends Er{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=be,this.minFilter=be,this.wrapR=ye,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Rr extends Tr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Nr(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Pr extends Er{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=be,this.minFilter=be,this.wrapR=ye,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Fr extends Tr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Pr(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Or{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,a,o){let s=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=i[a+0],d=i[a+1],f=i[a+2],p=i[a+3];if(0===o)return e[t+0]=s,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===o)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=p);if(u!==p||s!==h||l!==d||c!==f){let e=1-o;const t=s*h+l*d+c*f+u*p,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const i=Math.sqrt(r),a=Math.atan2(i,t*n);e=Math.sin(e*a)/i,o=Math.sin(o*a)/i}const i=o*n;if(s=s*e+h*i,l=l*e+d*i,c=c*e+f*i,u=u*e+p*i,e===1-o){const e=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=e,l*=e,c*=e,u*=e}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,i,a){const o=n[r],s=n[r+1],l=n[r+2],c=n[r+3],u=i[a],h=i[a+1],d=i[a+2],f=i[a+3];return e[t]=o*f+c*u+s*d-l*h,e[t+1]=s*f+c*h+l*u-o*d,e[t+2]=l*f+c*d+o*h-s*u,e[t+3]=c*f-o*u-s*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e._x,r=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,l=o(n/2),c=o(r/2),u=o(i/2),h=s(n/2),d=s(r/2),f=s(i/2);switch(a){case"XYZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"YXZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"ZXY":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"ZYX":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"YZX":this._x=h*c*u+l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u-h*d*f;break;case"XZY":this._x=h*c*u-l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],l=t[2],c=t[6],u=t[10],h=n+o+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-s)*e,this._y=(i-l)*e,this._z=(a-r)*e}else if(n>o&&n>u){const e=2*Math.sqrt(1+n-o-u);this._w=(c-s)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(i+l)/e}else if(o>u){const e=2*Math.sqrt(1+o-n-u);this._w=(i-l)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(s+c)/e}else{const e=2*Math.sqrt(1+u-n-o);this._w=(a-r)/e,this._x=(i+l)/e,this._y=(s+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Zn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,l=t._z,c=t._w;return this._x=n*c+a*o+r*l-i*s,this._y=r*c+a*s+i*o-n*l,this._z=i*c+a*l+n*s-r*o,this._w=a*c-n*o-r*s-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,i=this._z,a=this._w;let o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;const s=1-o*o;if(s<=Number.EPSILON){const e=1-t;return this._w=e*a+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this}const l=Math.sqrt(s),c=Math.atan2(l,o),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=a*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ir{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Ir.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(kr.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(kr.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,l=2*(a*r-o*n),c=2*(o*t-i*r),u=2*(i*n-a*t);return this.x=t+s*l+a*u-o*c,this.y=n+s*c+o*l-i*u,this.z=r+s*u+i*c-a*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Zn(this.x,e.x,t.x),this.y=Zn(this.y,e.y,t.y),this.z=Zn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Zn(this.x,e,t),this.y=Zn(this.y,e,t),this.z=Zn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Zn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Br.copy(this).projectOnVector(e),this.sub(Br)}reflect(e){return this.sub(Br.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Zn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Br=new Ir,kr=new Or;class Lr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ir(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(zr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(zr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=zr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(let t=0,n=r.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,zr):zr.fromBufferAttribute(r,t),zr.applyMatrix4(e.matrixWorld),this.expandByPoint(zr);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Hr.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Hr.copy(n.boundingBox)),Hr.applyMatrix4(e.matrixWorld),this.union(Hr)}const r=e.children;for(let i=0,a=r.length;i<a;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,zr),zr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Yr),Zr.subVectors(this.max,Yr),Vr.subVectors(e.a,Yr),Gr.subVectors(e.b,Yr),qr.subVectors(e.c,Yr),jr.subVectors(Gr,Vr),Wr.subVectors(qr,Gr),Xr.subVectors(Vr,qr);let t=[0,-jr.z,jr.y,0,-Wr.z,Wr.y,0,-Xr.z,Xr.y,jr.z,0,-jr.x,Wr.z,0,-Wr.x,Xr.z,0,-Xr.x,-jr.y,jr.x,0,-Wr.y,Wr.x,0,-Xr.y,Xr.x,0];return!!Jr(t,Vr,Gr,qr,Zr)&&(t=[1,0,0,0,1,0,0,0,1],!!Jr(t,Vr,Gr,qr,Zr)&&(Kr.crossVectors(jr,Wr),t=[Kr.x,Kr.y,Kr.z],Jr(t,Vr,Gr,qr,Zr)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,zr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(zr).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Ur[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ur[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ur[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ur[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ur[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ur[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ur[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ur[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ur)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ur=[new Ir,new Ir,new Ir,new Ir,new Ir,new Ir,new Ir,new Ir],zr=new Ir,Hr=new Lr,Vr=new Ir,Gr=new Ir,qr=new Ir,jr=new Ir,Wr=new Ir,Xr=new Ir,Yr=new Ir,Zr=new Ir,Kr=new Ir,Qr=new Ir;function Jr(e,t,n,r,i){for(let a=0,o=e.length-3;a<=o;a+=3){Qr.fromArray(e,a);const o=i.x*Math.abs(Qr.x)+i.y*Math.abs(Qr.y)+i.z*Math.abs(Qr.z),s=t.dot(Qr),l=n.dot(Qr),c=r.dot(Qr);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>o)return!1}return!0}const $r=new Lr,ei=new Ir,ti=new Ir;class ni{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ir,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):$r.setFromPoints(e).getCenter(n);let r=0;for(let i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ei.subVectors(e,this.center);const t=ei.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(ei,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(ti.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ei.copy(e.center).add(ti)),this.expandByPoint(ei.copy(e.center).sub(ti))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const ri=new Ir,ii=new Ir,ai=new Ir,oi=new Ir,si=new Ir,li=new Ir,ci=new Ir;class ui{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ir,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ri)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ri.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ri.copy(this.origin).addScaledVector(this.direction,t),ri.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){ii.copy(e).add(t).multiplyScalar(.5),ai.copy(t).sub(e).normalize(),oi.copy(this.origin).sub(ii);const i=.5*e.distanceTo(t),a=-this.direction.dot(ai),o=oi.dot(this.direction),s=-oi.dot(ai),l=oi.lengthSq(),c=Math.abs(1-a*a);let u,h,d,f;if(c>0)if(u=a*s-o,h=a*o-s,f=i*c,u>=0)if(h>=-f)if(h<=f){const e=1/c;u*=e,h*=e,d=u*(u+a*h+2*o)+h*(a*u+h+2*s)+l}else h=i,u=Math.max(0,-(a*h+o)),d=-u*u+h*(h+2*s)+l;else h=-i,u=Math.max(0,-(a*h+o)),d=-u*u+h*(h+2*s)+l;else h<=-f?(u=Math.max(0,-(-a*i+o)),h=u>0?-i:Math.min(Math.max(-i,-s),i),d=-u*u+h*(h+2*s)+l):h<=f?(u=0,h=Math.min(Math.max(-i,-s),i),d=h*(h+2*s)+l):(u=Math.max(0,-(a*i+o)),h=u>0?i:Math.min(Math.max(-i,-s),i),d=-u*u+h*(h+2*s)+l);else h=a>0?-i:i,u=Math.max(0,-(a*h+o)),d=-u*u+h*(h+2*s)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(ii).addScaledVector(ai,h),d}intersectSphere(e,t){ri.subVectors(e.center,this.origin);const n=ri.dot(this.direction),r=ri.dot(ri)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),o=n-a,s=n+a;return s<0?null:o<0?this.at(s,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,o,s;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),c>=0?(i=(e.min.y-h.y)*c,a=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,a=(e.min.y-h.y)*c),n>a||i>r?null:((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),u>=0?(o=(e.min.z-h.z)*u,s=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,s=(e.min.z-h.z)*u),n>s||o>r?null:((o>n||n!==n)&&(n=o),(s<r||r!==r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,ri)}intersectTriangle(e,t,n,r,i){si.subVectors(t,e),li.subVectors(n,e),ci.crossVectors(si,li);let a,o=this.direction.dot(ci);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}oi.subVectors(this.origin,e);const s=a*this.direction.dot(li.crossVectors(oi,li));if(s<0)return null;const l=a*this.direction.dot(si.cross(oi));if(l<0)return null;if(s+l>o)return null;const c=-a*oi.dot(ci);return c<0?null:this.at(c/o,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class hi{constructor(e,t,n,r,i,a,o,s,l,c,u,h,d,f,p,m){hi.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,a,o,s,l,c,u,h,d,f,p,m)}set(e,t,n,r,i,a,o,s,l,c,u,h,d,f,p,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new hi).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/di.setFromMatrixColumn(e,0).length(),i=1/di.setFromMatrixColumn(e,1).length(),a=1/di.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){const e=a*c,n=a*u,r=o*c,i=o*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=n+r*l,t[5]=e-i*l,t[9]=-o*s,t[2]=i-e*l,t[6]=r+n*l,t[10]=a*s}else if("YXZ"===e.order){const e=s*c,n=s*u,r=l*c,i=l*u;t[0]=e+i*o,t[4]=r*o-n,t[8]=a*l,t[1]=a*u,t[5]=a*c,t[9]=-o,t[2]=n*o-r,t[6]=i+e*o,t[10]=a*s}else if("ZXY"===e.order){const e=s*c,n=s*u,r=l*c,i=l*u;t[0]=e-i*o,t[4]=-a*u,t[8]=r+n*o,t[1]=n+r*o,t[5]=a*c,t[9]=i-e*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){const e=a*c,n=a*u,r=o*c,i=o*u;t[0]=s*c,t[4]=r*l-n,t[8]=e*l+i,t[1]=s*u,t[5]=i*l+e,t[9]=n*l-r,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){const e=a*s,n=a*l,r=o*s,i=o*l;t[0]=s*c,t[4]=i-e*u,t[8]=r*u+n,t[1]=u,t[5]=a*c,t[9]=-o*c,t[2]=-l*c,t[6]=n*u+r,t[10]=e-i*u}else if("XZY"===e.order){const e=a*s,n=a*l,r=o*s,i=o*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=a*c,t[9]=n*u-r,t[2]=r*u-n,t[6]=o*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(pi,e,mi)}lookAt(e,t,n){const r=this.elements;return yi.subVectors(e,t),0===yi.lengthSq()&&(yi.z=1),yi.normalize(),gi.crossVectors(n,yi),0===gi.lengthSq()&&(1===Math.abs(n.z)?yi.x+=1e-4:yi.z+=1e-4,yi.normalize(),gi.crossVectors(n,yi)),gi.normalize(),vi.crossVectors(yi,gi),r[0]=gi.x,r[4]=vi.x,r[8]=yi.x,r[1]=gi.y,r[5]=vi.y,r[9]=yi.y,r[2]=gi.z,r[6]=vi.z,r[10]=yi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],x=n[11],b=n[15],_=r[0],w=r[4],S=r[8],M=r[12],D=r[1],E=r[5],C=r[9],A=r[13],T=r[2],N=r[6],R=r[10],P=r[14],F=r[3],O=r[7],I=r[11],B=r[15];return i[0]=a*_+o*D+s*T+l*F,i[4]=a*w+o*E+s*N+l*O,i[8]=a*S+o*C+s*R+l*I,i[12]=a*M+o*A+s*P+l*B,i[1]=c*_+u*D+h*T+d*F,i[5]=c*w+u*E+h*N+d*O,i[9]=c*S+u*C+h*R+d*I,i[13]=c*M+u*A+h*P+d*B,i[2]=f*_+p*D+m*T+g*F,i[6]=f*w+p*E+m*N+g*O,i[10]=f*S+p*C+m*R+g*I,i[14]=f*M+p*A+m*P+g*B,i[3]=v*_+y*D+x*T+b*F,i[7]=v*w+y*E+x*N+b*O,i[11]=v*S+y*C+x*R+b*I,i[15]=v*M+y*A+x*P+b*B,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+i*s*u-r*l*u-i*o*h+n*l*h+r*o*d-n*s*d)+e[7]*(+t*s*d-t*l*h+i*a*h-r*a*d+r*l*c-i*s*c)+e[11]*(+t*l*u-t*o*d-i*a*u+n*a*d+i*o*c-n*l*c)+e[15]*(-r*o*c-t*s*u+t*o*h+r*a*u-n*a*h+n*s*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=u*m*l-p*h*l+p*s*d-o*m*d-u*s*g+o*h*g,y=f*h*l-c*m*l-f*s*d+a*m*d+c*s*g-a*h*g,x=c*p*l-f*u*l+f*o*d-a*p*d-c*o*g+a*u*g,b=f*u*s-c*p*s-f*o*h+a*p*h+c*o*m-a*u*m,_=t*v+n*y+r*x+i*b;if(0===_)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/_;return e[0]=v*w,e[1]=(p*h*i-u*m*i-p*r*d+n*m*d+u*r*g-n*h*g)*w,e[2]=(o*m*i-p*s*i+p*r*l-n*m*l-o*r*g+n*s*g)*w,e[3]=(u*s*i-o*h*i-u*r*l+n*h*l+o*r*d-n*s*d)*w,e[4]=y*w,e[5]=(c*m*i-f*h*i+f*r*d-t*m*d-c*r*g+t*h*g)*w,e[6]=(f*s*i-a*m*i-f*r*l+t*m*l+a*r*g-t*s*g)*w,e[7]=(a*h*i-c*s*i+c*r*l-t*h*l-a*r*d+t*s*d)*w,e[8]=x*w,e[9]=(f*u*i-c*p*i-f*n*d+t*p*d+c*n*g-t*u*g)*w,e[10]=(a*p*i-f*o*i+f*n*l-t*p*l-a*n*g+t*o*g)*w,e[11]=(c*o*i-a*u*i-c*n*l+t*u*l+a*n*d-t*o*d)*w,e[12]=b*w,e[13]=(c*p*r-f*u*r+f*n*h-t*p*h-c*n*m+t*u*m)*w,e[14]=(f*o*r-a*p*r-f*n*s+t*p*s+a*n*m-t*o*m)*w,e[15]=(a*u*r-c*o*r+c*n*s-t*u*s-a*n*h+t*o*h)*w,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,l=i*a,c=i*o;return this.set(l*a+n,l*o-r*s,l*s+r*o,0,l*o+r*s,c*o+n,c*s-r*a,0,l*s-r*o,c*s+r*a,i*s*s+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,l=i+i,c=a+a,u=o+o,h=i*l,d=i*c,f=i*u,p=a*c,m=a*u,g=o*u,v=s*l,y=s*c,x=s*u,b=n.x,_=n.y,w=n.z;return r[0]=(1-(p+g))*b,r[1]=(d+x)*b,r[2]=(f-y)*b,r[3]=0,r[4]=(d-x)*_,r[5]=(1-(h+g))*_,r[6]=(m+v)*_,r[7]=0,r[8]=(f+y)*w,r[9]=(m-v)*w,r[10]=(1-(h+p))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=di.set(r[0],r[1],r[2]).length();const a=di.set(r[4],r[5],r[6]).length(),o=di.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],fi.copy(this);const s=1/i,l=1/a,c=1/o;return fi.elements[0]*=s,fi.elements[1]*=s,fi.elements[2]*=s,fi.elements[4]*=l,fi.elements[5]*=l,fi.elements[6]*=l,fi.elements[8]*=c,fi.elements[9]*=c,fi.elements[10]*=c,t.setFromRotationMatrix(fi),n.x=i,n.y=a,n.z=o,this}makePerspective(e,t,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ln;const s=this.elements,l=2*i/(t-e),c=2*i/(n-r),u=(t+e)/(t-e),h=(n+r)/(n-r);let d,f;if(o===Ln)d=-(a+i)/(a-i),f=-2*a*i/(a-i);else{if(o!==Un)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);d=-a/(a-i),f=-a*i/(a-i)}return s[0]=l,s[4]=0,s[8]=u,s[12]=0,s[1]=0,s[5]=c,s[9]=h,s[13]=0,s[2]=0,s[6]=0,s[10]=d,s[14]=f,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(e,t,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ln;const s=this.elements,l=1/(t-e),c=1/(n-r),u=1/(a-i),h=(t+e)*l,d=(n+r)*c;let f,p;if(o===Ln)f=(a+i)*u,p=-2*u;else{if(o!==Un)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);f=i*u,p=-1*u}return s[0]=2*l,s[4]=0,s[8]=0,s[12]=-h,s[1]=0,s[5]=2*c,s[9]=0,s[13]=-d,s[2]=0,s[6]=0,s[10]=p,s[14]=-f,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const di=new Ir,fi=new hi,pi=new Ir(0,0,0),mi=new Ir(1,1,1),gi=new Ir,vi=new Ir,yi=new Ir,xi=new hi,bi=new Or;class _i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_i.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=e.elements,i=r[0],a=r[4],o=r[8],s=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(Zn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Zn(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(Zn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-Zn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(Zn(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Zn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return xi.makeRotationFromQuaternion(e),this.setFromRotationMatrix(xi,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return bi.setFromEuler(this),this.setFromQuaternion(bi,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}_i.DEFAULT_ORDER="XYZ";class wi{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}}let Si=0;const Mi=new Ir,Di=new Or,Ei=new hi,Ci=new Ir,Ai=new Ir,Ti=new Ir,Ni=new Or,Ri=new Ir(1,0,0),Pi=new Ir(0,1,0),Fi=new Ir(0,0,1),Oi={type:"added"},Ii={type:"removed"},Bi={type:"childadded",child:null},ki={type:"childremoved",child:null};class Li extends Gn{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Si++}),this.uuid=Yn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Li.DEFAULT_UP.clone();const e=new Ir,t=new _i,n=new Or,r=new Ir(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new hi},normalMatrix:{value:new nr}}),this.matrix=new hi,this.matrixWorld=new hi,this.matrixAutoUpdate=Li.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Li.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new wi,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Di.setFromAxisAngle(e,t),this.quaternion.multiply(Di),this}rotateOnWorldAxis(e,t){return Di.setFromAxisAngle(e,t),this.quaternion.premultiply(Di),this}rotateX(e){return this.rotateOnAxis(Ri,e)}rotateY(e){return this.rotateOnAxis(Pi,e)}rotateZ(e){return this.rotateOnAxis(Fi,e)}translateOnAxis(e,t){return Mi.copy(e).applyQuaternion(this.quaternion),this.position.add(Mi.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Ri,e)}translateY(e){return this.translateOnAxis(Pi,e)}translateZ(e){return this.translateOnAxis(Fi,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ei.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Ci.copy(e):Ci.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Ai.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ei.lookAt(Ai,Ci,this.up):Ei.lookAt(Ci,Ai,this.up),this.quaternion.setFromRotationMatrix(Ei),r&&(Ei.extractRotation(r.matrixWorld),Di.setFromRotationMatrix(Ei),this.quaternion.premultiply(Di.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Oi),Bi.child=e,this.dispatchEvent(Bi),Bi.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ii),ki.child=e,this.dispatchEvent(ki),ki.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ei.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Ei.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ei),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Oi),Bi.child=e,this.dispatchEvent(Bi),Bi.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getObjectsByProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ai,e,Ti),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ai,Ni,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){t[n].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};function a(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map((e=>(0,r.A)((0,r.A)({},e),{},{boundingBox:e.boundingBox?{min:e.boundingBox.min.toArray(),max:e.boundingBox.max.toArray()}:void 0,boundingSphere:e.boundingSphere?{radius:e.boundingSphere.radius,center:e.boundingSphere.center.toArray()}:void 0}))),i.instanceInfo=this._instanceInfo.map((e=>(0,r.A)({},e))),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),null!==this._colorsTexture&&(i.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(i.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),null!==this.boundingBox&&(i.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];a(e.shapes,r)}else a(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(a(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(a(e.materials,this.material[n]));i.material=t}else i.material=a(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];i.animations.push(a(e.animations,n))}}if(t){const t=o(e.geometries),r=o(e.materials),i=o(e.textures),a=o(e.images),s=o(e.shapes),l=o(e.skeletons),c=o(e.animations),u=o(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),a.length>0&&(n.images=a),s.length>0&&(n.shapes=s),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=i,n;function o(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}Li.DEFAULT_UP=new Ir(0,1,0),Li.DEFAULT_MATRIX_AUTO_UPDATE=!0,Li.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ui=new Ir,zi=new Ir,Hi=new Ir,Vi=new Ir,Gi=new Ir,qi=new Ir,ji=new Ir,Wi=new Ir,Xi=new Ir,Yi=new Ir,Zi=new Cr,Ki=new Cr,Qi=new Cr;class Ji{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ir,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ir;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Ui.subVectors(e,t),r.cross(Ui);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){Ui.subVectors(r,t),zi.subVectors(n,t),Hi.subVectors(e,t);const a=Ui.dot(Ui),o=Ui.dot(zi),s=Ui.dot(Hi),l=zi.dot(zi),c=zi.dot(Hi),u=a*l-o*o;if(0===u)return i.set(0,0,0),null;const h=1/u,d=(l*s-o*c)*h,f=(a*c-o*s)*h;return i.set(1-d-f,f,d)}static containsPoint(e,t,n,r){return null!==this.getBarycoord(e,t,n,r,Vi)&&(Vi.x>=0&&Vi.y>=0&&Vi.x+Vi.y<=1)}static getInterpolation(e,t,n,r,i,a,o,s){return null===this.getBarycoord(e,t,n,r,Vi)?(s.x=0,s.y=0,"z"in s&&(s.z=0),"w"in s&&(s.w=0),null):(s.setScalar(0),s.addScaledVector(i,Vi.x),s.addScaledVector(a,Vi.y),s.addScaledVector(o,Vi.z),s)}static getInterpolatedAttribute(e,t,n,r,i,a){return Zi.setScalar(0),Ki.setScalar(0),Qi.setScalar(0),Zi.fromBufferAttribute(e,t),Ki.fromBufferAttribute(e,n),Qi.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(Zi,i.x),a.addScaledVector(Ki,i.y),a.addScaledVector(Qi,i.z),a}static isFrontFacing(e,t,n,r){return Ui.subVectors(n,t),zi.subVectors(e,t),Ui.cross(zi).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ui.subVectors(this.c,this.b),zi.subVectors(this.a,this.b),.5*Ui.cross(zi).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ji.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Ji.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return Ji.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return Ji.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ji.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let a,o;Gi.subVectors(r,n),qi.subVectors(i,n),Wi.subVectors(e,n);const s=Gi.dot(Wi),l=qi.dot(Wi);if(s<=0&&l<=0)return t.copy(n);Xi.subVectors(e,r);const c=Gi.dot(Xi),u=qi.dot(Xi);if(c>=0&&u<=c)return t.copy(r);const h=s*u-c*l;if(h<=0&&s>=0&&c<=0)return a=s/(s-c),t.copy(n).addScaledVector(Gi,a);Yi.subVectors(e,i);const d=Gi.dot(Yi),f=qi.dot(Yi);if(f>=0&&d<=f)return t.copy(i);const p=d*l-s*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),t.copy(n).addScaledVector(qi,o);const m=c*f-d*u;if(m<=0&&u-c>=0&&d-f>=0)return ji.subVectors(i,r),o=(u-c)/(u-c+(d-f)),t.copy(r).addScaledVector(ji,o);const g=1/(m+p+h);return a=p*g,o=h*g,t.copy(n).addScaledVector(Gi,a).addScaledVector(qi,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const $i={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ea={h:0,s:0,l:0},ta={h:0,s:0,l:0};function na(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class ra{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jt;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,vr.toWorkingColorSpace(this,t),this}setRGB(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vr.workingColorSpace;return this.r=e,this.g=t,this.b=n,vr.toWorkingColorSpace(this,r),this}setHSL(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vr.workingColorSpace;if(e=Kn(e,1),t=Zn(t,0,1),n=Zn(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=na(i,r,e+1/3),this.g=na(i,r,e),this.b=na(i,r,e-1/3)}return vr.toWorkingColorSpace(this,r),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jt;function r(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const a=t[1],o=t[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,n);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,n);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=t[1],i=r.length;if(3===i)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,n);if(6===i)return this.setHex(parseInt(r,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jt;const n=$i[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=yr(e.r),this.g=yr(e.g),this.b=yr(e.b),this}copyLinearToSRGB(e){return this.r=xr(e.r),this.g=xr(e.g),this.b=xr(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jt;return vr.fromWorkingColorSpace(ia.copy(this),e),65536*Math.round(Zn(255*ia.r,0,255))+256*Math.round(Zn(255*ia.g,0,255))+Math.round(Zn(255*ia.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jt;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vr.workingColorSpace;vr.fromWorkingColorSpace(ia.copy(this),t);const n=ia.r,r=ia.g,i=ia.b,a=Math.max(n,r,i),o=Math.min(n,r,i);let s,l;const c=(o+a)/2;if(o===a)s=0,l=0;else{const e=a-o;switch(l=c<=.5?e/(a+o):e/(2-a-o),a){case n:s=(r-i)/e+(r<i?6:0);break;case r:s=(i-n)/e+2;break;case i:s=(n-r)/e+4}s/=6}return e.h=s,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vr.workingColorSpace;return vr.fromWorkingColorSpace(ia.copy(this),t),e.r=ia.r,e.g=ia.g,e.b=ia.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jt;vr.fromWorkingColorSpace(ia.copy(this),e);const t=ia.r,n=ia.g,r=ia.b;return e!==Jt?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*r),")")}offsetHSL(e,t,n){return this.getHSL(ea),this.setHSL(ea.h+e,ea.s+t,ea.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(ea),e.getHSL(ta);const n=Qn(ea.h,ta.h,t),r=Qn(ea.s,ta.s,t),i=Qn(ea.l,ta.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ia=new ra;ra.NAMES=$i;let aa=0;class oa extends Gn{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:aa++}),this.uuid=Yn(),this.name="",this.type="Material",this.blending=x,this.side=m,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=F,this.blendDst=O,this.blendEquation=M,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ra(0,0,0),this.blendAlpha=0,this.depthFunc=X,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=yn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=rn,this.stencilZFail=rn,this.stencilZPass=rn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."));continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==x&&(n.blending=this.blending),this.side!==m&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==F&&(n.blendSrc=this.blendSrc),this.blendDst!==O&&(n.blendDst=this.blendDst),this.blendEquation!==M&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==X&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==yn&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==rn&&(n.stencilFail=this.stencilFail),this.stencilZFail!==rn&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==rn&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class sa extends oa{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ra(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new _i,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const la=ca();function ca(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(r[l]=0,r[256|l]=32768,i[l]=24,i[256|l]=24):e<-14?(r[l]=1024>>-e-14,r[256|l]=1024>>-e-14|32768,i[l]=-e-1,i[256|l]=-e-1):e<=15?(r[l]=e+15<<10,r[256|l]=e+15<<10|32768,i[l]=13,i[256|l]=13):e<128?(r[l]=31744,r[256|l]=64512,i[l]=24,i[256|l]=24):(r[l]=31744,r[256|l]=64512,i[l]=13,i[256|l]=13)}const a=new Uint32Array(2048),o=new Uint32Array(64),s=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,a[l]=e|t}for(let l=1024;l<2048;++l)a[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(s[l]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:a,exponentTable:o,offsetTable:s}}function ua(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=Zn(e,-65504,65504),la.floatView[0]=e;const t=la.uint32View[0],n=t>>23&511;return la.baseTable[n]+((8388607&t)>>la.shiftTable[n])}function ha(e){const t=e>>10;return la.uint32View[0]=la.mantissaTable[la.offsetTable[t]+(1023&e)]+la.exponentTable[t],la.floatView[0]}class da{static toHalfFloat(e){return ua(e)}static fromHalfFloat(e){return ha(e)}}const fa=new Ir,pa=new tr;let ma=0;class ga{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:ma++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=Cn,this.updateRanges=[],this.gpuType=Be,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)pa.fromBufferAttribute(this,t),pa.applyMatrix3(e),this.setXY(t,pa.x,pa.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)fa.fromBufferAttribute(this,t),fa.applyMatrix3(e),this.setXYZ(t,fa.x,fa.y,fa.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)fa.fromBufferAttribute(this,t),fa.applyMatrix4(e),this.setXYZ(t,fa.x,fa.y,fa.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)fa.fromBufferAttribute(this,t),fa.applyNormalMatrix(e),this.setXYZ(t,fa.x,fa.y,fa.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)fa.fromBufferAttribute(this,t),fa.transformDirection(e),this.setXYZ(t,fa.x,fa.y,fa.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Jn(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=$n(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Jn(t,this.array)),t}setX(e,t){return this.normalized&&(t=$n(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Jn(t,this.array)),t}setY(e,t){return this.normalized&&(t=$n(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Jn(t,this.array)),t}setZ(e,t){return this.normalized&&(t=$n(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Jn(t,this.array)),t}setW(e,t){return this.normalized&&(t=$n(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=$n(t,this.array),n=$n(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=$n(t,this.array),n=$n(n,this.array),r=$n(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=$n(t,this.array),n=$n(n,this.array),r=$n(r,this.array),i=$n(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Cn&&(e.usage=this.usage),e}}class va extends ga{constructor(e,t,n){super(new Int8Array(e),t,n)}}class ya extends ga{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class xa extends ga{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class ba extends ga{constructor(e,t,n){super(new Int16Array(e),t,n)}}class _a extends ga{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class wa extends ga{constructor(e,t,n){super(new Int32Array(e),t,n)}}class Sa extends ga{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Ma extends ga{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=ha(this.array[e*this.itemSize]);return this.normalized&&(t=Jn(t,this.array)),t}setX(e,t){return this.normalized&&(t=$n(t,this.array)),this.array[e*this.itemSize]=ua(t),this}getY(e){let t=ha(this.array[e*this.itemSize+1]);return this.normalized&&(t=Jn(t,this.array)),t}setY(e,t){return this.normalized&&(t=$n(t,this.array)),this.array[e*this.itemSize+1]=ua(t),this}getZ(e){let t=ha(this.array[e*this.itemSize+2]);return this.normalized&&(t=Jn(t,this.array)),t}setZ(e,t){return this.normalized&&(t=$n(t,this.array)),this.array[e*this.itemSize+2]=ua(t),this}getW(e){let t=ha(this.array[e*this.itemSize+3]);return this.normalized&&(t=Jn(t,this.array)),t}setW(e,t){return this.normalized&&(t=$n(t,this.array)),this.array[e*this.itemSize+3]=ua(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=$n(t,this.array),n=$n(n,this.array)),this.array[e+0]=ua(t),this.array[e+1]=ua(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=$n(t,this.array),n=$n(n,this.array),r=$n(r,this.array)),this.array[e+0]=ua(t),this.array[e+1]=ua(n),this.array[e+2]=ua(r),this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=$n(t,this.array),n=$n(n,this.array),r=$n(r,this.array),i=$n(i,this.array)),this.array[e+0]=ua(t),this.array[e+1]=ua(n),this.array[e+2]=ua(r),this.array[e+3]=ua(i),this}}class Da extends ga{constructor(e,t,n){super(new Float32Array(e),t,n)}}let Ea=0;const Ca=new hi,Aa=new Li,Ta=new Ir,Na=new Lr,Ra=new Lr,Pa=new Ir;class Fa extends Gn{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Ea++}),this.uuid=Yn(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(ir(e)?Sa:_a)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new nr).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ca.makeRotationFromQuaternion(e),this.applyMatrix4(Ca),this}rotateX(e){return Ca.makeRotationX(e),this.applyMatrix4(Ca),this}rotateY(e){return Ca.makeRotationY(e),this.applyMatrix4(Ca),this}rotateZ(e){return Ca.makeRotationZ(e),this.applyMatrix4(Ca),this}translate(e,t,n){return Ca.makeTranslation(e,t,n),this.applyMatrix4(Ca),this}scale(e,t,n){return Ca.makeScale(e,t,n),this.applyMatrix4(Ca),this}lookAt(e){return Aa.lookAt(e),Aa.updateMatrix(),this.applyMatrix4(Aa.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ta).negate(),this.translate(Ta.x,Ta.y,Ta.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}this.setAttribute("position",new Da(t,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const n=e[r];t.setXYZ(r,n.x,n.y,n.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Lr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new Ir(-1/0,-1/0,-1/0),new Ir(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const e=t[n];Na.setFromBufferAttribute(e),this.morphTargetsRelative?(Pa.addVectors(this.boundingBox.min,Na.min),this.boundingBox.expandByPoint(Pa),Pa.addVectors(this.boundingBox.max,Na.max),this.boundingBox.expandByPoint(Pa)):(this.boundingBox.expandByPoint(Na.min),this.boundingBox.expandByPoint(Na.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ni);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new Ir,1/0);if(e){const n=this.boundingSphere.center;if(Na.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){const n=t[e];Ra.setFromBufferAttribute(n),this.morphTargetsRelative?(Pa.addVectors(Na.min,Ra.min),Na.expandByPoint(Pa),Pa.addVectors(Na.max,Ra.max),Na.expandByPoint(Pa)):(Na.expandByPoint(Ra.min),Na.expandByPoint(Ra.max))}Na.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)Pa.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(Pa));if(t)for(let i=0,a=t.length;i<a;i++){const a=t[i],o=this.morphTargetsRelative;for(let t=0,i=a.count;t<i;t++)Pa.fromBufferAttribute(a,t),o&&(Ta.fromBufferAttribute(e,t),Pa.add(Ta)),r=Math.max(r,n.distanceToSquared(Pa))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,r=t.normal,i=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new ga(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),o=[],s=[];for(let S=0;S<n.count;S++)o[S]=new Ir,s[S]=new Ir;const l=new Ir,c=new Ir,u=new Ir,h=new tr,d=new tr,f=new tr,p=new Ir,m=new Ir;function g(e,t,r){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),u.fromBufferAttribute(n,r),h.fromBufferAttribute(i,e),d.fromBufferAttribute(i,t),f.fromBufferAttribute(i,r),c.sub(l),u.sub(l),d.sub(h),f.sub(h);const a=1/(d.x*f.y-f.x*d.y);isFinite(a)&&(p.copy(c).multiplyScalar(f.y).addScaledVector(u,-d.y).multiplyScalar(a),m.copy(u).multiplyScalar(d.x).addScaledVector(c,-f.x).multiplyScalar(a),o[e].add(p),o[t].add(p),o[r].add(p),s[e].add(m),s[t].add(m),s[r].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let S=0,M=v.length;S<M;++S){const t=v[S],n=t.start;for(let r=n,i=n+t.count;r<i;r+=3)g(e.getX(r+0),e.getX(r+1),e.getX(r+2))}const y=new Ir,x=new Ir,b=new Ir,_=new Ir;function w(e){b.fromBufferAttribute(r,e),_.copy(b);const t=o[e];y.copy(t),y.sub(b.multiplyScalar(b.dot(t))).normalize(),x.crossVectors(_,t);const n=x.dot(s[e])<0?-1:1;a.setXYZW(e,y.x,y.y,y.z,n)}for(let S=0,M=v.length;S<M;++S){const t=v[S],n=t.start;for(let r=n,i=n+t.count;r<i;r+=3)w(e.getX(r+0)),w(e.getX(r+1)),w(e.getX(r+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new ga(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new Ir,i=new Ir,a=new Ir,o=new Ir,s=new Ir,l=new Ir,c=new Ir,u=new Ir;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),f=e.getX(h+1),p=e.getX(h+2);r.fromBufferAttribute(t,d),i.fromBufferAttribute(t,f),a.fromBufferAttribute(t,p),c.subVectors(a,i),u.subVectors(r,i),c.cross(u),o.fromBufferAttribute(n,d),s.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),o.add(c),s.add(c),l.add(c),n.setXYZ(d,o.x,o.y,o.z),n.setXYZ(f,s.x,s.y,s.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),c.subVectors(a,i),u.subVectors(r,i),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Pa.fromBufferAttribute(e,t),Pa.normalize(),e.setXYZ(t,Pa.x,Pa.y,Pa.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r);let o=0,s=0;for(let l=0,c=t.length;l<c;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(let e=0;e<r;e++)a[s++]=n[o++]}return new ga(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Fa,n=this.index.array,r=this.attributes;for(const o in r){const i=e(r[o],n);t.setAttribute(o,i)}const i=this.morphAttributes;for(const o in i){const r=[],a=i[o];for(let t=0,i=a.length;t<i;t++){const i=e(a[t],n);r.push(i)}t.morphAttributes[o]=r}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,s=a.length;o<s;o++){const e=a[o];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const s in n){const t=n[s];e.data.attributes[s]=t.toJSON(e.data)}const r={};let i=!1;for(const s in this.morphAttributes){const t=this.morphAttributes[s],n=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];n.push(i.toJSON(e.data))}n.length>0&&(r[s]=n,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone());const r=e.attributes;for(const l in r){const e=r[l];this.setAttribute(l,e.clone(t))}const i=e.morphAttributes;for(const l in i){const e=[],n=i[l];for(let r=0,i=n.length;r<i;r++)e.push(n[r].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let l=0,c=a.length;l<c;l++){const e=a[l];this.addGroup(e.start,e.count,e.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const s=e.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Oa=new hi,Ia=new ui,Ba=new ni,ka=new Ir,La=new Ir,Ua=new Ir,za=new Ir,Ha=new Ir,Va=new Ir,Ga=new Ir,qa=new Ir;class ja extends Li{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Fa,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new sa;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(i&&o){Va.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=o[n],s=i[n];0!==r&&(Ha.fromBufferAttribute(s,e),a?Va.addScaledVector(Ha,r):Va.addScaledVector(Ha.sub(t),r))}t.add(Va)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),Ba.copy(n.boundingSphere),Ba.applyMatrix4(i),Ia.copy(e.ray).recast(e.near),!1===Ba.containsPoint(Ia.origin)){if(null===Ia.intersectSphere(Ba,ka))return;if(Ia.origin.distanceToSquared(ka)>(e.far-e.near)**2)return}Oa.copy(i).invert(),Ia.copy(e.ray).applyMatrix4(Oa),null!==n.boundingBox&&!1===Ia.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,Ia)}}_computeIntersections(e,t,n){let r;const i=this.geometry,a=this.material,o=i.index,s=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv1,u=i.attributes.normal,h=i.groups,d=i.drawRange;if(null!==o)if(Array.isArray(a))for(let f=0,p=h.length;f<p;f++){const i=h[f],s=a[i.materialIndex];for(let a=Math.max(i.start,d.start),h=Math.min(o.count,Math.min(i.start+i.count,d.start+d.count));a<h;a+=3){r=Wa(this,s,e,n,l,c,u,o.getX(a),o.getX(a+1),o.getX(a+2)),r&&(r.faceIndex=Math.floor(a/3),r.face.materialIndex=i.materialIndex,t.push(r))}}else{for(let i=Math.max(0,d.start),s=Math.min(o.count,d.start+d.count);i<s;i+=3){r=Wa(this,a,e,n,l,c,u,o.getX(i),o.getX(i+1),o.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}else if(void 0!==s)if(Array.isArray(a))for(let f=0,p=h.length;f<p;f++){const i=h[f],o=a[i.materialIndex];for(let a=Math.max(i.start,d.start),h=Math.min(s.count,Math.min(i.start+i.count,d.start+d.count));a<h;a+=3){r=Wa(this,o,e,n,l,c,u,a,a+1,a+2),r&&(r.faceIndex=Math.floor(a/3),r.face.materialIndex=i.materialIndex,t.push(r))}}else{for(let i=Math.max(0,d.start),o=Math.min(s.count,d.start+d.count);i<o;i+=3){r=Wa(this,a,e,n,l,c,u,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}}}function Wa(e,t,n,r,i,a,o,s,l,c){e.getVertexPosition(s,La),e.getVertexPosition(l,Ua),e.getVertexPosition(c,za);const u=function(e,t,n,r,i,a,o,s){let l;if(l=t.side===g?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,t.side===m,s),null===l)return null;qa.copy(s),qa.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(qa);return c<n.near||c>n.far?null:{distance:c,point:qa.clone(),object:e}}(e,t,n,r,La,Ua,za,Ga);if(u){const e=new Ir;Ji.getBarycoord(Ga,La,Ua,za,e),i&&(u.uv=Ji.getInterpolatedAttribute(i,s,l,c,e,new tr)),a&&(u.uv1=Ji.getInterpolatedAttribute(a,s,l,c,e,new tr)),o&&(u.normal=Ji.getInterpolatedAttribute(o,s,l,c,e,new Ir),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const t={a:s,b:l,c:c,normal:new Ir,materialIndex:0};Ji.getNormal(La,Ua,za,t.normal),u.face=t,u.barycoord=e}return u}class Xa extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const o=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const s=[],l=[],c=[],u=[];let h=0,d=0;function f(e,t,n,r,i,a,f,p,m,g,v){const y=a/m,x=f/g,b=a/2,_=f/2,w=p/2,S=m+1,M=g+1;let D=0,E=0;const C=new Ir;for(let o=0;o<M;o++){const a=o*x-_;for(let s=0;s<S;s++){const h=s*y-b;C[e]=h*r,C[t]=a*i,C[n]=w,l.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[n]=p>0?1:-1,c.push(C.x,C.y,C.z),u.push(s/m),u.push(1-o/g),D+=1}}for(let o=0;o<g;o++)for(let e=0;e<m;e++){const t=h+e+S*o,n=h+e+S*(o+1),r=h+(e+1)+S*(o+1),i=h+(e+1)+S*o;s.push(t,n,i),s.push(n,r,i),E+=6}o.addGroup(d,E,v),d+=E,h+=D}f("z","y","x",-1,-1,n,t,e,a,i,0),f("z","y","x",1,-1,n,t,-e,a,i,1),f("x","z","y",1,1,e,n,t,r,a,2),f("x","z","y",1,-1,e,n,-t,r,a,3),f("x","y","z",1,-1,e,t,n,r,i,4),f("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new Da(l,3)),this.setAttribute("normal",new Da(c,3)),this.setAttribute("uv",new Da(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xa(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ya(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function Za(e){const t={};for(let n=0;n<e.length;n++){const r=Ya(e[n]);for(const e in r)t[e]=r[e]}return t}function Ka(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:vr.workingColorSpace}const Qa={clone:Ya,merge:Za};class Ja extends oa{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ya(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class $a extends Li{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new hi,this.projectionMatrix=new hi,this.projectionMatrixInverse=new hi,this.coordinateSystem=Ln}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const eo=new Ir,to=new tr,no=new tr;class ro extends $a{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Xn*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Wn*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Xn*Math.atan(Math.tan(.5*Wn*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){eo.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(eo.x,eo.y).multiplyScalar(-e/eo.z),eo.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(eo.x,eo.y).multiplyScalar(-e/eo.z)}getViewSize(e,t){return this.getViewBounds(e,to,no),t.subVectors(no,to)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Wn*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const a=this.view;if(null!==this.view&&this.view.enabled){const e=a.fullWidth,o=a.fullHeight;i+=a.offsetX*r/e,t-=a.offsetY*n/o,r*=a.width/e,n*=a.height/o}const o=this.filmOffset;0!==o&&(i+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const io=-90;class ao extends Li{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new ro(io,1,e,t);r.layers=this.layers,this.add(r);const i=new ro(io,1,e,t);i.layers=this.layers,this.add(i);const a=new ro(io,1,e,t);a.layers=this.layers,this.add(a);const o=new ro(io,1,e,t);o.layers=this.layers,this.add(o);const s=new ro(io,1,e,t);s.layers=this.layers,this.add(s);const l=new ro(io,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,a,o,s]=t;for(const l of t)this.remove(l);if(e===Ln)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),s.up.set(0,1,0),s.lookAt(0,0,-1);else{if(e!==Un)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),s.up.set(0,-1,0),s.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,a,o,s,l,c]=this.children,u=e.getRenderTarget(),h=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,o),e.setRenderTarget(n,3,r),e.render(t,s),e.setRenderTarget(n,4,r),e.render(t,l),n.texture.generateMipmaps=p,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(u,h,d),e.xr.enabled=f,n.texture.needsPMREMUpdate=!0}}class oo extends Er{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:de,arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0,arguments.length>9?arguments[9]:void 0),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class so extends Tr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new oo(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:De}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new Xa(5,5,5),o=new Ja({name:"CubemapFromEquirect",uniforms:Ya(n),vertexShader:r,fragmentShader:i,side:g,blending:y});o.uniforms.tEquirect.value=t;const s=new ja(a,o),l=t.minFilter;t.minFilter===Ae&&(t.minFilter=De);return new ao(1,10,this).update(e,s),t.minFilter=l,s.geometry.dispose(),s.material.dispose(),this}clear(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}class lo extends Li{constructor(){super(),this.isGroup=!0,this.type="Group"}}const co={type:"move"};class uo{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new lo,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new lo,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ir,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ir),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new lo,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ir,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ir),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null;const o=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){a=!0;for(const a of e.hand.values()){const e=t.getJointPose(a,n),r=this._getHandJoint(l,a);null!==e&&(r.matrix.fromArray(e.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.matrixWorldNeedsUpdate=!0,r.jointRadius=e.radius),r.visible=null!==e}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],o=r.position.distanceTo(i.position),s=.02,c=.005;l.inputState.pinching&&o>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1));null!==o&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(co)))}return null!==o&&(o.visible=null!==r),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==a),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new lo;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class ho{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;this.isFogExp2=!0,this.name="",this.color=new ra(e),this.density=t}clone(){return new ho(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class fo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new ra(e),this.near=t,this.far=n}clone(){return new fo(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class po extends Li{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new _i,this.environmentIntensity=1,this.environmentRotation=new _i,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class mo{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Cn,this.updateRanges=[],this.version=0,this.uuid=Yn()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Yn()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Yn()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const go=new Ir;class vo{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)go.fromBufferAttribute(this,t),go.applyMatrix4(e),this.setXYZ(t,go.x,go.y,go.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)go.fromBufferAttribute(this,t),go.applyNormalMatrix(e),this.setXYZ(t,go.x,go.y,go.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)go.fromBufferAttribute(this,t),go.transformDirection(e),this.setXYZ(t,go.x,go.y,go.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Jn(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=$n(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=$n(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=$n(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=$n(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=$n(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Jn(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Jn(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Jn(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Jn(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=$n(t,this.array),n=$n(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=$n(t,this.array),n=$n(n,this.array),r=$n(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=$n(t,this.array),n=$n(n,this.array),r=$n(r,this.array),i=$n(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new ga(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new vo(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class yo extends oa{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ra(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let xo;const bo=new Ir,_o=new Ir,wo=new Ir,So=new tr,Mo=new tr,Do=new hi,Eo=new Ir,Co=new Ir,Ao=new Ir,To=new tr,No=new tr,Ro=new tr;class Po extends Li{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new yo;if(super(),this.isSprite=!0,this.type="Sprite",void 0===xo){xo=new Fa;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new mo(e,5);xo.setIndex([0,1,2,0,2,3]),xo.setAttribute("position",new vo(t,3,0,!1)),xo.setAttribute("uv",new vo(t,2,3,!1))}this.geometry=xo,this.material=e,this.center=new tr(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_o.setFromMatrixScale(this.matrixWorld),Do.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),wo.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&_o.multiplyScalar(-wo.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const a=this.center;Fo(Eo.set(-.5,-.5,0),wo,a,_o,r,i),Fo(Co.set(.5,-.5,0),wo,a,_o,r,i),Fo(Ao.set(.5,.5,0),wo,a,_o,r,i),To.set(0,0),No.set(1,0),Ro.set(1,1);let o=e.ray.intersectTriangle(Eo,Co,Ao,!1,bo);if(null===o&&(Fo(Co.set(-.5,.5,0),wo,a,_o,r,i),No.set(0,1),o=e.ray.intersectTriangle(Eo,Ao,Co,!1,bo),null===o))return;const s=e.ray.origin.distanceTo(bo);s<e.near||s>e.far||t.push({distance:s,point:bo.clone(),uv:Ji.getInterpolation(bo,Eo,Co,Ao,To,No,Ro,new tr),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function Fo(e,t,n,r,i,a){So.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(Mo.x=a*So.x-i*So.y,Mo.y=i*So.x+a*So.y):Mo.copy(So),e.copy(t),e.x+=Mo.x,e.y+=Mo.y,e.applyMatrix4(Do)}const Oo=new Ir,Io=new Ir;class Bo extends Li{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const e=t[n];this.addLevel(e.object.clone(),e.distance,e.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t=Math.abs(t);const r=this.levels;let i;for(i=0;i<r.length&&!(t<r[i].distance);i++);return r.splice(i,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const e=t.splice(n,1);return this.remove(e[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Oo.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(Oo);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Oo.setFromMatrixPosition(e.matrixWorld),Io.setFromMatrixPosition(this.matrixWorld);const n=Oo.distanceTo(Io)/e.zoom;let r,i;for(t[0].object.visible=!0,r=1,i=t.length;r<i;r++){let e=t[r].distance;if(t[r].object.visible&&(e-=e*t[r].hysteresis),!(n>=e))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<i;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,i=n.length;r<i;r++){const e=n[r];t.object.levels.push({object:e.object.uuid,distance:e.distance,hysteresis:e.hysteresis})}return t}}const ko=new Ir,Lo=new Cr,Uo=new Cr,zo=new Ir,Ho=new hi,Vo=new Ir,Go=new ni,qo=new hi,jo=new ui;class Wo extends ja{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=ce,this.bindMatrix=new hi,this.bindMatrixInverse=new hi,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Lr),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Vo),this.boundingBox.expandByPoint(Vo)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new ni),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Vo),this.boundingSphere.expandByPoint(Vo)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),Go.copy(this.boundingSphere),Go.applyMatrix4(r),!1!==e.ray.intersectsSphere(Go)&&(qo.copy(r).invert(),jo.copy(e.ray).applyMatrix4(qo),null!==this.boundingBox&&!1===jo.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,jo)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Cr,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===ce?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===ue?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;Lo.fromBufferAttribute(r.attributes.skinIndex,e),Uo.fromBufferAttribute(r.attributes.skinWeight,e),ko.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const e=Uo.getComponent(i);if(0!==e){const r=Lo.getComponent(i);Ho.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),t.addScaledVector(zo.copy(ko).applyMatrix4(Ho),e)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Xo extends Li{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Yo extends Er{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:be,arguments.length>9&&void 0!==arguments[9]?arguments[9]:be,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Zo=new hi,Ko=new hi;class Qo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=Yn(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new hi)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new hi;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,a=e.length;i<a;i++){const r=e[i]?e[i].matrixWorld:Ko;Zo.multiplyMatrices(r,t[i]),Zo.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}clone(){return new Qo(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Yo(t,e,e,qe,Be);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const r=e.bones[n];let i=t[r];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),i=new Xo),this.bones.push(i),this.boneInverses.push((new hi).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const i=t[r];e.bones.push(i.uuid);const a=n[r];e.boneInverses.push(a.toArray())}return e}}class Jo extends ga{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const $o=new hi,es=new hi,ts=[],ns=new Lr,rs=new hi,is=new ja,as=new ni;class os extends ja{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Jo(new Float32Array(16*n),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,rs)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Lr),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,$o),ns.copy(e.boundingBox).applyMatrix4($o),this.boundingBox.union(ns)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new ni),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,$o),as.copy(e.boundingSphere).applyMatrix4($o),this.boundingSphere.union(as)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,i=e*(n.length+1)+1;for(let a=0;a<n.length;a++)n[a]=r[i+a]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(is.geometry=this.geometry,is.material=this.material,void 0!==is.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),as.copy(this.boundingSphere),as.applyMatrix4(n),!1!==e.ray.intersectsSphere(as)))for(let i=0;i<r;i++){this.getMatrixAt(i,$o),es.multiplyMatrices(n,$o),is.matrixWorld=es,is.raycast(e,ts);for(let e=0,n=ts.length;e<n;e++){const n=ts[e];n.instanceId=i,n.object=this,t.push(n)}ts.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Jo(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;null===this.morphTexture&&(this.morphTexture=new Yo(new Float32Array(r*this.count),r,this.count,Xe,Be));const i=this.morphTexture.source.data.data;let a=0;for(let l=0;l<n.length;l++)a+=n[l];const o=this.geometry.morphTargetsRelative?1:1-a,s=r*e;i[s]=o,i.set(n,s+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}}const ss=new Ir,ls=new Ir,cs=new nr;class us{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ir(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=ss.subVectors(n,t).cross(ls.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(ss),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||cs.getNormalMatrix(e),r=this.coplanarPoint(ss).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const hs=new ni,ds=new Ir;class fs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new us,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new us,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new us,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new us,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new us,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new us;this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ln;const n=this.planes,r=e.elements,i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],c=r[5],u=r[6],h=r[7],d=r[8],f=r[9],p=r[10],m=r[11],g=r[12],v=r[13],y=r[14],x=r[15];if(n[0].setComponents(s-i,h-l,m-d,x-g).normalize(),n[1].setComponents(s+i,h+l,m+d,x+g).normalize(),n[2].setComponents(s+a,h+c,m+f,x+v).normalize(),n[3].setComponents(s-a,h-c,m-f,x-v).normalize(),n[4].setComponents(s-o,h-u,m-p,x-y).normalize(),t===Ln)n[5].setComponents(s+o,h+u,m+p,x+y).normalize();else{if(t!==Un)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(o,u,p,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),hs.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),hs.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(hs)}intersectsSprite(e){return hs.center.set(0,0,0),hs.radius=.7071067811865476,hs.applyMatrix4(e.matrixWorld),this.intersectsSphere(hs)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(ds.x=r.normal.x>0?e.max.x:e.min.x,ds.y=r.normal.y>0?e.max.y:e.min.y,ds.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(ds)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}const ps=new hi,ms=new fs;class gs{constructor(){this.coordinateSystem=Ln}intersectsObject(e,t){if(!t.isArrayCamera||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(ps.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ms.setFromProjectionMatrix(ps,this.coordinateSystem),ms.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(ps.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ms.setFromProjectionMatrix(ps,this.coordinateSystem),ms.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(ps.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ms.setFromProjectionMatrix(ps,this.coordinateSystem),ms.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(ps.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ms.setFromProjectionMatrix(ps,this.coordinateSystem),ms.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(ps.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),ms.setFromProjectionMatrix(ps,this.coordinateSystem),ms.containsPoint(e))return!0}return!1}clone(){return new gs}}function vs(e,t){return e-t}function ys(e,t){return e.z-t.z}function xs(e,t){return t.z-e.z}class bs{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){const i=this.pool,a=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1,index:-1});const o=i[this.index];a.push(o),this.index++,o.start=e,o.count=t,o.z=n,o.index=r}reset(){this.list.length=0,this.index=0}}const _s=new hi,ws=new ra(1,1,1),Ss=new fs,Ms=new gs,Ds=new Lr,Es=new ni,Cs=new Ir,As=new Ir,Ts=new Ir,Ns=new bs,Rs=new ja,Ps=[];function Fs(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor){const i=e.count;for(let a=0;a<i;a++)for(let i=0;i<r;i++)t.setComponent(a+n,i,e.getComponent(a,i))}else t.array.set(e.array,n*r);t.needsUpdate=!0}function Os(e,t){if(e.constructor!==t.constructor){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++)t[r]=e[r]}else{const n=Math.min(e.length,t.length);t.set(new e.constructor(e.buffer,0,n))}}class Is extends ja{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*t,r=arguments.length>3?arguments[3]:void 0;super(new Fa,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(4*this._maxInstanceCount);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Yo(t,e,e,qe,Be);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Yo(t,e,e,Ye,Ie);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Yo(t,e,e,qe,Be);n.colorSpace=vr.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(!1===this._geometryInitialized){for(const r in e.attributes){const i=e.getAttribute(r),{array:a,itemSize:o,normalized:s}=i,l=new a.constructor(n*o),c=new ga(l,o,s);t.setAttribute(r,c)}if(null!==e.getIndex()){const e=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new ga(e,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(Boolean(e.getIndex())!==Boolean(t.getIndex()))throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error('THREE.BatchedMesh: Added geometry missing "'.concat(n,'". All geometries must have consistent attributes.'));const r=e.getAttribute(n),i=t.getAttribute(n);if(r.itemSize!==i.itemSize||r.normalized!==i.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error("THREE.BatchedMesh: Invalid instanceId ".concat(e,". Instance is either out of range or has been deleted."))}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error("THREE.BatchedMesh: Invalid geometryId ".concat(e,". Geometry is either out of range or has been deleted."))}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Lr);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(!1===t[n].active)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,_s),this.getBoundingBoxAt(r,Ds).applyMatrix4(_s),e.union(Ds)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new ni);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(!1===t[n].active)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,_s),this.getBoundingSphereAt(r,Es).applyMatrix4(_s),e.union(Es)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&0===this._availableInstanceIds.length)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const t={visible:!0,active:!0,geometryIndex:e};let n=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(vs),n=this._availableInstanceIds.shift(),this._instanceInfo[n]=t):(n=this._instanceInfo.length,this._instanceInfo.push(t));const r=this._matricesTexture;_s.identity().toArray(r.image.data,16*n),r.needsUpdate=!0;const i=this._colorsTexture;return i&&(ws.toArray(i.image.data,4*n),i.needsUpdate=!0),this._visibilityChanged=!0,n}addGeometry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},i=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=-1===t?e.getAttribute("position").count:t;const a=e.getIndex();if(null!==a&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=-1===n?a.count:n),-1!==r.indexStart&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let o;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(vs),o=this._availableGeometryIds.shift(),i[o]=r):(o=this._geometryCount,this._geometryCount++,i.push(r)),this.setGeometryAt(o,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,o}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=null!==n.getIndex(),i=n.getIndex(),a=t.getIndex(),o=this._geometryInfo[e];if(r&&a.count>o.reservedIndexCount||t.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const s=o.vertexStart,l=o.reservedVertexCount;o.vertexCount=t.getAttribute("position").count;for(const c in n.attributes){const e=t.getAttribute(c),r=n.getAttribute(c);Fs(e,r,s);const i=e.itemSize;for(let t=e.count,n=l;t<n;t++){const e=s+t;for(let t=0;t<i;t++)r.setComponent(e,t,0)}r.needsUpdate=!0,r.addUpdateRange(s*i,l*i)}if(r){const e=o.indexStart,n=o.reservedIndexCount;o.indexCount=t.getIndex().count;for(let t=0;t<a.count;t++)i.setX(e+t,s+a.getX(t));for(let t=a.count,r=n;t<r;t++)i.setX(e+t,s);i.needsUpdate=!0,i.addUpdateRange(e,o.reservedIndexCount)}return o.start=r?o.indexStart:o.vertexStart,o.count=r?o.indexCount:o.vertexCount,o.boundingBox=null,null!==t.boundingBox&&(o.boundingBox=t.boundingBox.clone()),o.boundingSphere=null,null!==t.boundingSphere&&(o.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||!1===t[e].active)return this;const n=this._instanceInfo;for(let r=0,i=n.length;r<i;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,r=n.map(((e,t)=>t)).sort(((e,t)=>n[e].vertexStart-n[t].vertexStart)),i=this.geometry;for(let a=0,o=n.length;a<o;a++){const o=r[a],s=n[o];if(!1!==s.active){if(null!==i.index){if(s.indexStart!==t){const{indexStart:n,vertexStart:r,reservedIndexCount:a}=s,o=i.index,l=o.array,c=e-r;for(let e=n;e<n+a;e++)l[e]=l[e]+c;o.array.copyWithin(t,n,n+a),o.addUpdateRange(t,a),s.indexStart=t}t+=s.reservedIndexCount}if(s.vertexStart!==e){const{vertexStart:t,reservedVertexCount:n}=s,r=i.attributes;for(const i in r){const a=r[i],{array:o,itemSize:s}=a;o.copyWithin(e*s,t*s,(t+n)*s),a.addUpdateRange(e*s,n*s)}s.vertexStart=e}e+=s.reservedVertexCount,s.start=i.index?s.indexStart:s.vertexStart,this._nextIndexStart=i.index?s.indexStart+s.reservedIndexCount:0,this._nextVertexStart=s.vertexStart+s.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(null===r.boundingBox){const e=new Lr,t=n.index,i=n.attributes.position;for(let n=r.start,a=r.start+r.count;n<a;n++){let r=n;t&&(r=t.getX(r)),e.expandByPoint(Cs.fromBufferAttribute(i,r))}r.boundingBox=e}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(null===r.boundingSphere){const t=new ni;this.getBoundingBoxAt(e,Ds),Ds.getCenter(t.center);const i=n.index,a=n.attributes.position;let o=0;for(let e=r.start,n=r.start+r.count;e<n;e++){let n=e;i&&(n=i.getX(n)),Cs.fromBufferAttribute(a,n),o=Math.max(o,t.center.distanceToSquared(Cs))}t.radius=Math.sqrt(o),r.boundingSphere=t}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,16*e),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,16*e)}setColorAt(e,t){return this.validateInstanceId(e),null===this._colorsTexture&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,4*e),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,4*e)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t||(this._instanceInfo[e].visible=t,this._visibilityChanged=!0),this}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(vs);t[t.length-1]===n.length;)n.pop(),t.pop();if(e<n.length)throw new Error("BatchedMesh: Instance ids outside the range ".concat(e," are being used. Cannot shrink instance count."));const r=new Int32Array(e),i=new Int32Array(e);Os(this._multiDrawCounts,r),Os(this._multiDrawStarts,i),this._multiDrawCounts=r,this._multiDrawStarts=i,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,s=this._colorsTexture;a.dispose(),this._initIndirectTexture(),Os(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),Os(o.image.data,this._matricesTexture.image.data),s&&(s.dispose(),this._initColorsTexture(),Os(s.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter((e=>e.active));if(Math.max(...n.map((e=>e.vertexStart+e.reservedVertexCount)))>e)throw new Error("BatchedMesh: Geometry vertex values are being used outside the range ".concat(t,". Cannot shrink further."));if(this.geometry.index){if(Math.max(...n.map((e=>e.indexStart+e.reservedIndexCount)))>t)throw new Error("BatchedMesh: Geometry index values are being used outside the range ".concat(t,". Cannot shrink further."))}const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Fa,this._initializeGeometry(r));const i=this.geometry;r.index&&Os(r.index.array,i.index.array);for(const a in r.attributes)Os(r.attributes[a].array,i.attributes[a].array)}raycast(e,t){const n=this._instanceInfo,r=this._geometryInfo,i=this.matrixWorld,a=this.geometry;Rs.material=this.material,Rs.geometry.index=a.index,Rs.geometry.attributes=a.attributes,null===Rs.geometry.boundingBox&&(Rs.geometry.boundingBox=new Lr),null===Rs.geometry.boundingSphere&&(Rs.geometry.boundingSphere=new ni);for(let o=0,s=n.length;o<s;o++){if(!n[o].visible||!n[o].active)continue;const a=n[o].geometryIndex,s=r[a];Rs.geometry.setDrawRange(s.start,s.count),this.getMatrixAt(o,Rs.matrixWorld).premultiply(i),this.getBoundingBoxAt(a,Rs.geometry.boundingBox),this.getBoundingSphereAt(a,Rs.geometry.boundingSphere),Rs.raycast(e,Ps);for(let e=0,n=Ps.length;e<n;e++){const n=Ps[e];n.object=this,n.batchId=o,t.push(n)}Ps.length=0}Rs.material=null,Rs.geometry.index=null,Rs.geometry.attributes={},Rs.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map((e=>(0,r.A)((0,r.A)({},e),{},{boundingBox:null!==e.boundingBox?e.boundingBox.clone():null,boundingSphere:null!==e.boundingSphere?e.boundingSphere.clone():null}))),this._instanceInfo=e._instanceInfo.map((e=>(0,r.A)({},e))),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),null!==this._colorsTexture&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,r,i){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),o=null===a?1:a.array.BYTES_PER_ELEMENT,s=this._instanceInfo,l=this._multiDrawStarts,c=this._multiDrawCounts,u=this._geometryInfo,h=this.perObjectFrustumCulled,d=this._indirectTexture,f=d.image.data,p=n.isArrayCamera?Ms:Ss;h&&!n.isArrayCamera&&(_s.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),Ss.setFromProjectionMatrix(_s,e.coordinateSystem));let m=0;if(this.sortObjects){_s.copy(this.matrixWorld).invert(),Cs.setFromMatrixPosition(n.matrixWorld).applyMatrix4(_s),As.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(_s);for(let r=0,i=s.length;r<i;r++)if(s[r].visible&&s[r].active){const e=s[r].geometryIndex;this.getMatrixAt(r,_s),this.getBoundingSphereAt(e,Es).applyMatrix4(_s);let t=!1;if(h&&(t=!p.intersectsSphere(Es,n)),!t){const t=u[e],n=Ts.subVectors(Es.center,Cs).dot(As);Ns.push(t.start,t.count,n,r)}}const e=Ns.list,t=this.customSort;null===t?e.sort(i.transparent?xs:ys):t.call(this,e,n);for(let n=0,r=e.length;n<r;n++){const t=e[n];l[m]=t.start*o,c[m]=t.count,f[m]=t.index,m++}Ns.reset()}else for(let g=0,v=s.length;g<v;g++)if(s[g].visible&&s[g].active){const e=s[g].geometryIndex;let t=!1;if(h&&(this.getMatrixAt(g,_s),this.getBoundingSphereAt(e,Es).applyMatrix4(_s),t=!p.intersectsSphere(Es,n)),!t){const t=u[e];l[m]=t.start*o,c[m]=t.count,f[m]=g,m++}}d.needsUpdate=!0,this._multiDrawCount=m,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,i,a){this.onBeforeRender(e,null,r,i,a)}}class Bs extends oa{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ra(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const ks=new Ir,Ls=new Ir,Us=new hi,zs=new ui,Hs=new ni,Vs=new Ir,Gs=new Ir;class qs extends Li{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Fa,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Bs;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)ks.fromBufferAttribute(t,e-1),Ls.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=ks.distanceTo(Ls);e.setAttribute("lineDistance",new Da(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Hs.copy(n.boundingSphere),Hs.applyMatrix4(r),Hs.radius+=i,!1===e.ray.intersectsSphere(Hs))return;Us.copy(r).invert(),zs.copy(e.ray).applyMatrix4(Us);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=this.isLineSegments?2:1,c=n.index,u=n.attributes.position;if(null!==c){const n=Math.max(0,a.start),r=Math.min(c.count,a.start+a.count);for(let i=n,a=r-1;i<a;i+=l){const n=c.getX(i),r=c.getX(i+1),a=js(this,e,zs,s,n,r,i);a&&t.push(a)}if(this.isLineLoop){const i=c.getX(r-1),a=c.getX(n),o=js(this,e,zs,s,i,a,r-1);o&&t.push(o)}}else{const n=Math.max(0,a.start),r=Math.min(u.count,a.start+a.count);for(let i=n,a=r-1;i<a;i+=l){const n=js(this,e,zs,s,i,i+1,i);n&&t.push(n)}if(this.isLineLoop){const i=js(this,e,zs,s,r-1,n,r-1);i&&t.push(i)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function js(e,t,n,r,i,a,o){const s=e.geometry.attributes.position;ks.fromBufferAttribute(s,i),Ls.fromBufferAttribute(s,a);if(n.distanceSqToSegment(ks,Ls,Vs,Gs)>r)return;Vs.applyMatrix4(e.matrixWorld);const l=t.ray.origin.distanceTo(Vs);return l<t.near||l>t.far?void 0:{distance:l,point:Gs.clone().applyMatrix4(e.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:e}}const Ws=new Ir,Xs=new Ir;class Ys extends qs{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)Ws.fromBufferAttribute(t,e),Xs.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+Ws.distanceTo(Xs);e.setAttribute("lineDistance",new Da(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Zs extends qs{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Ks extends oa{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ra(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Qs=new hi,Js=new ui,$s=new ni,el=new Ir;class tl extends Li{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Fa,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ks;super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),$s.copy(n.boundingSphere),$s.applyMatrix4(r),$s.radius+=i,!1===e.ray.intersectsSphere($s))return;Qs.copy(r).invert(),Js.copy(e.ray).applyMatrix4(Qs);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,a.start),i=Math.min(l.count,a.start+a.count);n<i;n++){const i=l.getX(n);el.fromBufferAttribute(c,i),nl(el,i,s,r,e,t,this)}}else{for(let n=Math.max(0,a.start),i=Math.min(c.count,a.start+a.count);n<i;n++)el.fromBufferAttribute(c,n),nl(el,n,s,r,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function nl(e,t,n,r,i,a,o){const s=Js.distanceSqToPoint(e);if(s<n){const n=new Ir;Js.closestPointToPoint(e,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(s),point:n,index:t,face:null,faceIndex:null,barycoord:null,object:o})}}class rl extends Er{constructor(e,t,n,r){super(e,t,n,r,arguments.length>4&&void 0!==arguments[4]?arguments[4]:De,arguments.length>5&&void 0!==arguments[5]?arguments[5]:De,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0),this.isVideoTexture=!0,this.generateMipmaps=!1;const i=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){i.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class il extends rl{constructor(e,t,n,r,i,a,o,s){super({},e,t,n,r,i,a,o,s),this.isVideoFrameTexture=!0}update(){}clone(){return(new this.constructor).copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class al extends Er{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=be,this.minFilter=be,this.generateMipmaps=!1,this.needsUpdate=!0}}class ol extends Er{constructor(e,t,n,r,i,a,o,s,l,c,u,h){super(null,a,o,s,l,c,r,i,u,h),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class sl extends ol{constructor(e,t,n,r,i,a){super(e,t,n,i,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=ye,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class ll extends ol{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,de),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class cl extends Er{constructor(e,t,n,r,i,a,o,s,l){super(e,t,n,r,i,a,o,s,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class ul extends Er{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ie,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:be,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:be,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:je;if(c!==je&&c!==We)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,r,i,a,o,s,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Sr(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class hl extends ul{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isDepthArrayTexture=!0,this.image={width:e,height:t,depth:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class dl extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r,heightSegments:i},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),r=Math.max(3,Math.floor(r)),i=Math.max(1,Math.floor(i));const a=[],o=[],s=[],l=[],c=t/2,u=Math.PI/2*e,h=t,d=2*u+h,f=2*n+i,p=r+1,m=new Ir,g=new Ir;for(let v=0;v<=f;v++){let y=0,x=0,b=0,_=0;if(v<=n){const t=v/n,r=t*Math.PI/2;x=-c-e*Math.cos(r),b=e*Math.sin(r),_=-e*Math.cos(r),y=t*u}else if(v<=n+i){const r=(v-n)/i;x=r*t-c,b=e,_=0,y=u+r*h}else{const t=(v-n-i)/n,r=t*Math.PI/2;x=c+e*Math.sin(r),b=e*Math.cos(r),_=e*Math.sin(r),y=u+h+t*u}const w=Math.max(0,Math.min(1,y/d));let S=0;0===v?S=.5/r:v===f&&(S=-.5/r);for(let e=0;e<=r;e++){const t=e/r,n=t*Math.PI*2,i=Math.sin(n),a=Math.cos(n);g.x=-b*a,g.y=x,g.z=b*i,o.push(g.x,g.y,g.z),m.set(-b*a,_,b*i),m.normalize(),s.push(m.x,m.y,m.z),l.push(t+S,w)}if(v>0){const e=(v-1)*p;for(let t=0;t<r;t++){const n=e+t,r=e+t+1,i=v*p+t,o=v*p+t+1;a.push(n,r,i),a.push(r,o,i)}}}this.setIndex(a),this.setAttribute("position",new Da(o,3)),this.setAttribute("normal",new Da(s,3)),this.setAttribute("uv",new Da(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dl(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class fl extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const i=[],a=[],o=[],s=[],l=new Ir,c=new tr;a.push(0,0,0),o.push(0,0,1),s.push(.5,.5);for(let u=0,h=3;u<=t;u++,h+=3){const i=n+u/t*r;l.x=e*Math.cos(i),l.y=e*Math.sin(i),a.push(l.x,l.y,l.z),o.push(0,0,1),c.x=(a[h]/e+1)/2,c.y=(a[h+1]/e+1)/2,s.push(c.x,c.y)}for(let u=1;u<=t;u++)i.push(u,u+1,0);this.setIndex(i),this.setAttribute("position",new Da(a,3)),this.setAttribute("normal",new Da(o,3)),this.setAttribute("uv",new Da(s,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fl(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class pl extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};const l=this;r=Math.floor(r),i=Math.floor(i);const c=[],u=[],h=[],d=[];let f=0;const p=[],m=n/2;let g=0;function v(n){const i=f,a=new tr,p=new Ir;let v=0;const y=!0===n?e:t,x=!0===n?1:-1;for(let e=1;e<=r;e++)u.push(0,m*x,0),h.push(0,x,0),d.push(.5,.5),f++;const b=f;for(let e=0;e<=r;e++){const t=e/r*s+o,n=Math.cos(t),i=Math.sin(t);p.x=y*i,p.y=m*x,p.z=y*n,u.push(p.x,p.y,p.z),h.push(0,x,0),a.x=.5*n+.5,a.y=.5*i*x+.5,d.push(a.x,a.y),f++}for(let e=0;e<r;e++){const t=i+e,r=b+e;!0===n?c.push(r,r+1,t):c.push(r+1,r,t),v+=3}l.addGroup(g,v,!0===n?1:2),g+=v}!function(){const a=new Ir,v=new Ir;let y=0;const x=(t-e)/n;for(let l=0;l<=i;l++){const c=[],g=l/i,y=g*(t-e)+e;for(let e=0;e<=r;e++){const t=e/r,i=t*s+o,l=Math.sin(i),p=Math.cos(i);v.x=y*l,v.y=-g*n+m,v.z=y*p,u.push(v.x,v.y,v.z),a.set(l,x,p).normalize(),h.push(a.x,a.y,a.z),d.push(t,1-g),c.push(f++)}p.push(c)}for(let n=0;n<r;n++)for(let r=0;r<i;r++){const a=p[r][n],o=p[r+1][n],s=p[r+1][n+1],l=p[r][n+1];(e>0||0!==r)&&(c.push(a,o,l),y+=3),(t>0||r!==i-1)&&(c.push(o,s,l),y+=3)}l.addGroup(g,y,0),g+=y}(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new Da(u,3)),this.setAttribute("normal",new Da(h,3)),this.setAttribute("uv",new Da(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pl(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ml extends pl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,n,r,i,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}static fromJSON(e){return new ml(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class gl extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const i=[],a=[];function o(e,t,n,r){const i=r+1,a=[];for(let o=0;o<=i;o++){a[o]=[];const r=e.clone().lerp(n,o/i),s=t.clone().lerp(n,o/i),l=i-o;for(let e=0;e<=l;e++)a[o][e]=0===e&&o===i?r:r.clone().lerp(s,e/l)}for(let o=0;o<i;o++)for(let e=0;e<2*(i-o)-1;e++){const t=Math.floor(e/2);e%2===0?(s(a[o][t+1]),s(a[o+1][t]),s(a[o][t])):(s(a[o][t+1]),s(a[o+1][t+1]),s(a[o+1][t]))}}function s(e){i.push(e.x,e.y,e.z)}function l(t,n){const r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function c(e,t,n,r){r<0&&1===e.x&&(a[t]=e.x-1),0===n.x&&0===n.z&&(a[t]=r/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}!function(e){const n=new Ir,r=new Ir,i=new Ir;for(let a=0;a<t.length;a+=3)l(t[a+0],n),l(t[a+1],r),l(t[a+2],i),o(n,r,i,e)}(r),function(e){const t=new Ir;for(let n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){const e=new Ir;for(let n=0;n<i.length;n+=3){e.x=i[n+0],e.y=i[n+1],e.z=i[n+2];const r=u(e)/2/Math.PI+.5,o=(t=e,Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5);a.push(r,1-o)}var t;(function(){const e=new Ir,t=new Ir,n=new Ir,r=new Ir,o=new tr,s=new tr,l=new tr;for(let h=0,d=0;h<i.length;h+=9,d+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),o.set(a[d+0],a[d+1]),s.set(a[d+2],a[d+3]),l.set(a[d+4],a[d+5]),r.copy(e).add(t).add(n).divideScalar(3);const f=u(r);c(o,d+0,e,f),c(s,d+2,t,f),c(l,d+4,n,f)}})(),function(){for(let e=0;e<a.length;e+=6){const t=a[e+0],n=a[e+2],r=a[e+4],i=Math.max(t,n,r),o=Math.min(t,n,r);i>.9&&o<.1&&(t<.2&&(a[e+0]+=1),n<.2&&(a[e+2]+=1),r<.2&&(a[e+4]+=1))}}()}(),this.setAttribute("position",new Da(i,3)),this.setAttribute("normal",new Da(i.slice(),3)),this.setAttribute("uv",new Da(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gl(e.vertices,e.indices,e.radius,e.details)}}class vl extends gl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new vl(e.radius,e.detail)}}const yl=new Ir,xl=new Ir,bl=new Ir,_l=new Ji;class wl extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=4,r=Math.pow(10,n),i=Math.cos(Wn*t),a=e.getIndex(),o=e.getAttribute("position"),s=a?a.count:o.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),h={},d=[];for(let e=0;e<s;e+=3){a?(l[0]=a.getX(e),l[1]=a.getX(e+1),l[2]=a.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:n,c:s}=_l;if(t.fromBufferAttribute(o,l[0]),n.fromBufferAttribute(o,l[1]),s.fromBufferAttribute(o,l[2]),_l.getNormal(bl),u[0]="".concat(Math.round(t.x*r),",").concat(Math.round(t.y*r),",").concat(Math.round(t.z*r)),u[1]="".concat(Math.round(n.x*r),",").concat(Math.round(n.y*r),",").concat(Math.round(n.z*r)),u[2]="".concat(Math.round(s.x*r),",").concat(Math.round(s.y*r),",").concat(Math.round(s.z*r)),u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=u[e],r=u[t],a=_l[c[e]],o=_l[c[t]],s="".concat(n,"_").concat(r),f="".concat(r,"_").concat(n);f in h&&h[f]?(bl.dot(h[f].normal)<=i&&(d.push(a.x,a.y,a.z),d.push(o.x,o.y,o.z)),h[f]=null):s in h||(h[s]={index0:l[e],index1:l[t],normal:bl.clone()})}}for(const e in h)if(h[e]){const{index0:t,index1:n}=h[e];yl.fromBufferAttribute(o,t),xl.fromBufferAttribute(o,n),d.push(yl.x,yl.y,yl.z),d.push(xl.x,xl.y,xl.z)}this.setAttribute("position",new Da(d,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Sl{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getLengths();let r=0;const i=n.length;let a;a=t||e*n[i-1];let o,s=0,l=i-1;for(;s<=l;)if(r=Math.floor(s+(l-s)/2),o=n[r]-a,o<0)s=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(r=l,n[r]===a)return r/(i-1);const c=n[r];return(r+(a-c)/(n[r+1]-c))/(i-1)}getTangent(e,t){const n=1e-4;let r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);const a=this.getPoint(r),o=this.getPoint(i),s=t||(a.isVector2?new tr:new Ir);return s.copy(o).sub(a).normalize(),s}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Ir,r=[],i=[],a=[],o=new Ir,s=new hi;for(let d=0;d<=e;d++){const t=d/e;r[d]=this.getTangentAt(t,new Ir)}i[0]=new Ir,a[0]=new Ir;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(let d=1;d<=e;d++){if(i[d]=i[d-1].clone(),a[d]=a[d-1].clone(),o.crossVectors(r[d-1],r[d]),o.length()>Number.EPSILON){o.normalize();const e=Math.acos(Zn(r[d-1].dot(r[d]),-1,1));i[d].applyMatrix4(s.makeRotationAxis(o,e))}a[d].crossVectors(r[d],i[d])}if(!0===t){let t=Math.acos(Zn(i[0].dot(i[e]),-1,1));t/=e,r[0].dot(o.crossVectors(i[0],i[e]))>0&&(t=-t);for(let n=1;n<=e;n++)i[n].applyMatrix4(s.makeRotationAxis(r[n],t*n)),a[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Ml extends Sl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tr,n=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const i=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=i?0:n),!0!==this.aClockwise||i||(r===n?r=-n:r-=n);const a=this.aStartAngle+e*r;let o=this.aX+this.xRadius*Math.cos(a),s=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=o-this.aX,r=s-this.aY;o=n*e-r*t+this.aX,s=n*t+r*e+this.aY}return t.set(o,s)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Dl extends Ml{constructor(e,t,n,r,i,a){super(e,t,n,n,r,i,a),this.isArcCurve=!0,this.type="ArcCurve"}}function El(){let e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){let l=(t-e)/a-(n-e)/(a+o)+(n-t)/o,c=(n-t)/o-(r-t)/(o+s)+(r-n)/s;l*=o,c*=o,i(t,n,l,c)},calc:function(i){const a=i*i;return e+t*i+n*a+r*(a*i)}}}const Cl=new Ir,Al=new El,Tl=new El,Nl=new El;class Rl extends Sl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir,n=this.points,r=n.length,i=(r-(this.closed?0:1))*e;let a,o,s=Math.floor(i),l=i-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/r)+1)*r:0===l&&s===r-1&&(s=r-2,l=1),this.closed||s>0?a=n[(s-1)%r]:(Cl.subVectors(n[0],n[1]).add(n[0]),a=Cl);const c=n[s%r],u=n[(s+1)%r];if(this.closed||s+2<r?o=n[(s+2)%r]:(Cl.subVectors(n[r-1],n[r-2]).add(n[r-1]),o=Cl),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(a.distanceToSquared(c),e),n=Math.pow(c.distanceToSquared(u),e),r=Math.pow(u.distanceToSquared(o),e);n<1e-4&&(n=1),t<1e-4&&(t=n),r<1e-4&&(r=n),Al.initNonuniformCatmullRom(a.x,c.x,u.x,o.x,t,n,r),Tl.initNonuniformCatmullRom(a.y,c.y,u.y,o.y,t,n,r),Nl.initNonuniformCatmullRom(a.z,c.z,u.z,o.z,t,n,r)}else"catmullrom"===this.curveType&&(Al.initCatmullRom(a.x,c.x,u.x,o.x,this.tension),Tl.initCatmullRom(a.y,c.y,u.y,o.y,this.tension),Nl.initCatmullRom(a.z,c.z,u.z,o.z,this.tension));return t.set(Al.calc(l),Tl.calc(l),Nl.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Ir).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Pl(e,t,n,r,i){const a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function Fl(e,t,n,r){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function Ol(e,t,n,r,i){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}class Il extends Sl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tr,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new tr,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new tr;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tr,n=this.v0,r=this.v1,i=this.v2,a=this.v3;return t.set(Ol(e,n.x,r.x,i.x,a.x),Ol(e,n.y,r.y,i.y,a.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Bl extends Sl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ir,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ir,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ir;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir,n=this.v0,r=this.v1,i=this.v2,a=this.v3;return t.set(Ol(e,n.x,r.x,i.x,a.x),Ol(e,n.y,r.y,i.y,a.y),Ol(e,n.z,r.z,i.z,a.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class kl extends Sl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tr;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tr;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tr).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Ll extends Sl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ir,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Ul extends Sl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tr,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tr,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new tr;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tr,n=this.v0,r=this.v1,i=this.v2;return t.set(Fl(e,n.x,r.x,i.x),Fl(e,n.y,r.y,i.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class zl extends Sl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ir,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ir;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir,n=this.v0,r=this.v1,i=this.v2;return t.set(Fl(e,n.x,r.x,i.x),Fl(e,n.y,r.y,i.y),Fl(e,n.z,r.z,i.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Hl extends Sl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tr,n=this.points,r=(n.length-1)*e,i=Math.floor(r),a=r-i,o=n[0===i?i:i-1],s=n[i],l=n[i>n.length-2?n.length-1:i+1],c=n[i>n.length-3?n.length-1:i+2];return t.set(Pl(a,o.x,s.x,l.x,c.x),Pl(a,o.y,s.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new tr).fromArray(n))}return this}}var Vl=Object.freeze({__proto__:null,ArcCurve:Dl,CatmullRomCurve3:Rl,CubicBezierCurve:Il,CubicBezierCurve3:Bl,EllipseCurve:Ml,LineCurve:kl,LineCurve3:Ll,QuadraticBezierCurve:Ul,QuadraticBezierCurve3:zl,SplineCurve:Hl});class Gl extends Sl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new Vl[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=n){const e=r[i]-n,a=this.curves[i],o=a.getLength(),s=0===o?0:1-e/o;return a.getPointAt(s,t)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const a=i[r],o=a.isEllipseCurve?2*e:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o);for(let e=0;e<s.length;e++){const r=s[e];n&&n.equals(r)||(t.push(r),n=r)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new Vl[n.type]).fromJSON(n))}return this}}class ql extends Gl{constructor(e){super(),this.type="Path",this.currentPoint=new tr,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new kl(this.currentPoint.clone(),new tr(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const i=new Ul(this.currentPoint.clone(),new tr(e,t),new tr(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,i,a){const o=new Il(this.currentPoint.clone(),new tr(e,t),new tr(n,r),new tr(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Hl(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,i,a){const o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this}absarc(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}ellipse(e,t,n,r,i,a,o,s){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,r,i,a,o,s),this}absellipse(e,t,n,r,i,a,o,s){const l=new Ml(e,t,n,r,i,a,o,s);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class jl extends ql{constructor(e){super(e),this.uuid=Yn(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new ql).fromJSON(n))}return this}}function Wl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const r=t&&t.length,i=r?t[0]*n:e.length;let a=Xl(e,0,i,n,!0);const o=[];if(!a||a.next===a.prev)return o;let s,l,c;if(r&&(a=function(e,t,n,r){const i=[];for(let a=0,o=t.length;a<o;a++){const n=Xl(e,t[a]*r,a<o-1?t[a+1]*r:e.length,r,!1);n===n.next&&(n.steiner=!0),i.push(ic(n))}i.sort(ec);for(let a=0;a<i.length;a++)n=tc(i[a],n);return n}(e,t,a,n)),e.length>80*n){s=1/0,l=1/0;let t=-1/0,r=-1/0;for(let a=n;a<i;a+=n){const n=e[a],i=e[a+1];n<s&&(s=n),i<l&&(l=i),n>t&&(t=n),i>r&&(r=i)}c=Math.max(t-s,r-l),c=0!==c?32767/c:0}return Zl(a,o,n,s,l,c,0),o}function Xl(e,t,n,r,i){let a;if(i===function(e,t,n,r){let i=0;for(let a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(let o=t;o<n;o+=r)a=mc(o/r|0,e[o],e[o+1],a);else for(let o=n-r;o>=t;o-=r)a=mc(o/r|0,e[o],e[o+1],a);return a&&cc(a,a.next)&&(gc(a),a=a.next),a}function Yl(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!cc(r,r.next)&&0!==lc(r.prev,r,r.next))r=r.next;else{if(gc(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function Zl(e,t,n,r,i,a,o){if(!e)return;!o&&a&&function(e,t,n,r){let i=e;do{0===i.z&&(i.z=rc(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,n=1;do{let r,i=e;e=null;let a=null;for(t=0;i;){t++;let o=i,s=0;for(let e=0;e<n&&(s++,o=o.nextZ,o);e++);let l=n;for(;s>0||l>0&&o;)0!==s&&(0===l||!o||i.z<=o.z)?(r=i,i=i.nextZ,s--):(r=o,o=o.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;i=o}a.nextZ=null,n*=2}while(t>1)}(i)}(e,r,i,a);let s=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(a?Ql(e,r,i,a):Kl(e))t.push(l.i,e.i,c.i),gc(e),e=c.next,s=c.next;else if((e=c)===s){o?1===o?Zl(e=Jl(Yl(e),t),t,n,r,i,a,2):2===o&&$l(e,t,n,r,i,a):Zl(Yl(e),t,n,r,i,a,1);break}}}function Kl(e){const t=e.prev,n=e,r=e.next;if(lc(t,n,r)>=0)return!1;const i=t.x,a=n.x,o=r.x,s=t.y,l=n.y,c=r.y,u=Math.min(i,a,o),h=Math.min(s,l,c),d=Math.max(i,a,o),f=Math.max(s,l,c);let p=r.next;for(;p!==t;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&oc(i,s,a,l,o,c,p.x,p.y)&&lc(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Ql(e,t,n,r){const i=e.prev,a=e,o=e.next;if(lc(i,a,o)>=0)return!1;const s=i.x,l=a.x,c=o.x,u=i.y,h=a.y,d=o.y,f=Math.min(s,l,c),p=Math.min(u,h,d),m=Math.max(s,l,c),g=Math.max(u,h,d),v=rc(f,p,t,n,r),y=rc(m,g,t,n,r);let x=e.prevZ,b=e.nextZ;for(;x&&x.z>=v&&b&&b.z<=y;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==i&&x!==o&&oc(s,u,l,h,c,d,x.x,x.y)&&lc(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==o&&oc(s,u,l,h,c,d,b.x,b.y)&&lc(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;x&&x.z>=v;){if(x.x>=f&&x.x<=m&&x.y>=p&&x.y<=g&&x!==i&&x!==o&&oc(s,u,l,h,c,d,x.x,x.y)&&lc(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==o&&oc(s,u,l,h,c,d,b.x,b.y)&&lc(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Jl(e,t){let n=e;do{const r=n.prev,i=n.next.next;!cc(r,i)&&uc(r,n,n.next,i)&&fc(r,i)&&fc(i,r)&&(t.push(r.i,n.i,i.i),gc(n),gc(n.next),n=e=i),n=n.next}while(n!==e);return Yl(n)}function $l(e,t,n,r,i,a){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&sc(o,e)){let s=pc(o,e);return o=Yl(o,o.next),s=Yl(s,s.next),Zl(o,t,n,r,i,a,0),void Zl(s,t,n,r,i,a,0)}e=e.next}o=o.next}while(o!==e)}function ec(e,t){let n=e.x-t.x;if(0===n&&(n=e.y-t.y,0===n)){n=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)}return n}function tc(e,t){const n=function(e,t){let n=t;const r=e.x,i=e.y;let a,o=-1/0;if(cc(e,n))return n;do{if(cc(e,n.next))return n.next;if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const e=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>o&&(o=e,a=n.x<n.next.x?n:n.next,e===r))return a}n=n.next}while(n!==t);if(!a)return null;const s=a,l=a.x,c=a.y;let u=1/0;n=a;do{if(r>=n.x&&n.x>=l&&r!==n.x&&ac(i<c?r:o,i,l,c,i<c?o:r,i,n.x,n.y)){const t=Math.abs(i-n.y)/(r-n.x);fc(n,e)&&(t<u||t===u&&(n.x>a.x||n.x===a.x&&nc(a,n)))&&(a=n,u=t)}n=n.next}while(n!==s);return a}(e,t);if(!n)return t;const r=pc(n,e);return Yl(r,r.next),Yl(n,n.next)}function nc(e,t){return lc(e.prev,e,t.prev)<0&&lc(t.next,e,e.next)<0}function rc(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ic(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function ac(e,t,n,r,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(r-s)>=(n-o)*(t-s)&&(n-o)*(a-s)>=(i-o)*(r-s)}function oc(e,t,n,r,i,a,o,s){return!(e===o&&t===s)&&ac(e,t,n,r,i,a,o,s)}function sc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&uc(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(fc(e,t)&&fc(t,e)&&function(e,t){let n=e,r=!1;const i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!==n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(lc(e.prev,e,t.prev)||lc(e,t.prev,t))||cc(e,t)&&lc(e.prev,e,e.next)>0&&lc(t.prev,t,t.next)>0)}function lc(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function cc(e,t){return e.x===t.x&&e.y===t.y}function uc(e,t,n,r){const i=dc(lc(e,t,n)),a=dc(lc(e,t,r)),o=dc(lc(n,r,e)),s=dc(lc(n,r,t));return i!==a&&o!==s||(!(0!==i||!hc(e,n,t))||(!(0!==a||!hc(e,r,t))||(!(0!==o||!hc(n,e,r))||!(0!==s||!hc(n,t,r)))))}function hc(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function dc(e){return e>0?1:e<0?-1:0}function fc(e,t){return lc(e.prev,e,e.next)<0?lc(e,t,e.next)>=0&&lc(e,e.prev,t)>=0:lc(e,t,e.prev)<0||lc(e,e.next,t)<0}function pc(e,t){const n=vc(e.i,e.x,e.y),r=vc(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function mc(e,t,n,r){const i=vc(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function gc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function vc(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class yc{static triangulate(e,t){return Wl(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:2)}}class xc{static area(e){const t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}static isClockWise(e){return xc.area(e)<0}static triangulateShape(e,t){const n=[],r=[],i=[];bc(e),_c(n,e);let a=e.length;t.forEach(bc);for(let s=0;s<t.length;s++)r.push(a),a+=t[s].length,_c(n,t[s]);const o=yc.triangulate(n,r);for(let s=0;s<o.length;s+=3)i.push(o.slice(s,s+3));return i}}function bc(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function _c(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class wc extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new jl([new tr(.5,.5),new tr(-.5,.5),new tr(-.5,-.5),new tr(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],i=[];for(let o=0,s=e.length;o<s;o++){a(e[o])}function a(e){const a=[],o=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:.2,h=void 0!==t.bevelSize?t.bevelSize:u-.1,d=void 0!==t.bevelOffset?t.bevelOffset:0,f=void 0!==t.bevelSegments?t.bevelSegments:3;const p=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:Sc;let g,v,y,x,b,_=!1;p&&(g=p.getSpacedPoints(s),_=!0,c=!1,v=p.computeFrenetFrames(s,!1),y=new Ir,x=new Ir,b=new Ir),c||(f=0,u=0,h=0,d=0);const w=e.extractPoints(o);let S=w.shape;const M=w.holes;if(!xc.isClockWise(S)){S=S.reverse();for(let e=0,t=M.length;e<t;e++){const t=M[e];xc.isClockWise(t)&&(M[e]=t.reverse())}}function D(e){const t=1e-10*1e-10;let n=e[0];for(let r=1;r<=e.length;r++){const i=r%e.length,a=e[i],o=a.x-n.x,s=a.y-n.y,l=o*o+s*s,c=Math.max(Math.abs(a.x),Math.abs(a.y),Math.abs(n.x),Math.abs(n.y));l<=t*c*c?(e.splice(i,1),r--):n=a}}D(S),M.forEach(D);const E=M.length,C=S;for(let t=0;t<E;t++){const e=M[t];S=S.concat(e)}function A(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,n)}const T=S.length;function N(e,t,n){let r,i,a;const o=e.x-t.x,s=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=o*o+s*s,h=o*c-s*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),f=t.x-s/h,p=t.y+o/h,m=((n.x-c/d-f)*c-(n.y+l/d-p)*l)/(o*c-s*l);r=f+o*m-e.x,i=p+s*m-e.y;const g=r*r+i*i;if(g<=2)return new tr(r,i);a=Math.sqrt(g/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(s)===Math.sign(c)&&(e=!0),e?(r=-s,i=o,a=Math.sqrt(u)):(r=o,i=s,a=Math.sqrt(u/2))}return new tr(r/a,i/a)}const R=[];for(let t=0,n=C.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),R[t]=N(C[t],C[r],C[i]);const P=[];let F,O,I=R.concat();for(let t=0,n=E;t<n;t++){const e=M[t];F=[];for(let t=0,n=e.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),F[t]=N(e[t],e[r],e[i]);P.push(F),I=I.concat(F)}if(0===f)O=xc.triangulateShape(C,M);else{const e=[],t=[];for(let n=0;n<f;n++){const r=n/f,i=u*Math.cos(r*Math.PI/2),a=h*Math.sin(r*Math.PI/2)+d;for(let t=0,n=C.length;t<n;t++){const n=A(C[t],R[t],a);U(n.x,n.y,-i),0===r&&e.push(n)}for(let e=0,n=E;e<n;e++){const n=M[e];F=P[e];const o=[];for(let e=0,t=n.length;e<t;e++){const t=A(n[e],F[e],a);U(t.x,t.y,-i),0===r&&o.push(t)}0===r&&t.push(o)}}O=xc.triangulateShape(e,t)}const B=O.length,k=h+d;for(let t=0;t<T;t++){const e=c?A(S[t],I[t],k):S[t];_?(x.copy(v.normals[0]).multiplyScalar(e.x),y.copy(v.binormals[0]).multiplyScalar(e.y),b.copy(g[0]).add(x).add(y),U(b.x,b.y,b.z)):U(e.x,e.y,0)}for(let t=1;t<=s;t++)for(let e=0;e<T;e++){const n=c?A(S[e],I[e],k):S[e];_?(x.copy(v.normals[t]).multiplyScalar(n.x),y.copy(v.binormals[t]).multiplyScalar(n.y),b.copy(g[t]).add(x).add(y),U(b.x,b.y,b.z)):U(n.x,n.y,l/s*t)}for(let t=f-1;t>=0;t--){const e=t/f,n=u*Math.cos(e*Math.PI/2),r=h*Math.sin(e*Math.PI/2)+d;for(let t=0,i=C.length;t<i;t++){const e=A(C[t],R[t],r);U(e.x,e.y,l+n)}for(let t=0,i=M.length;t<i;t++){const e=M[t];F=P[t];for(let t=0,i=e.length;t<i;t++){const i=A(e[t],F[t],r);_?U(i.x,i.y+g[s-1].y,g[s-1].x+n):U(i.x,i.y,l+n)}}}function L(e,t){let n=e.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=e.length-1);for(let e=0,n=s+2*f;e<n;e++){const n=T*e,a=T*(e+1);H(t+r+n,t+i+n,t+i+a,t+r+a)}}}function U(e,t,n){a.push(e),a.push(t),a.push(n)}function z(e,t,i){V(e),V(t),V(i);const a=r.length/3,o=m.generateTopUV(n,r,a-3,a-2,a-1);G(o[0]),G(o[1]),G(o[2])}function H(e,t,i,a){V(e),V(t),V(a),V(t),V(i),V(a);const o=r.length/3,s=m.generateSideWallUV(n,r,o-6,o-3,o-2,o-1);G(s[0]),G(s[1]),G(s[3]),G(s[1]),G(s[2]),G(s[3])}function V(e){r.push(a[3*e+0]),r.push(a[3*e+1]),r.push(a[3*e+2])}function G(e){i.push(e.x),i.push(e.y)}!function(){const e=r.length/3;if(c){let e=0,t=T*e;for(let n=0;n<B;n++){const e=O[n];z(e[2]+t,e[1]+t,e[0]+t)}e=s+2*f,t=T*e;for(let n=0;n<B;n++){const e=O[n];z(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<B;e++){const t=O[e];z(t[2],t[1],t[0])}for(let e=0;e<B;e++){const t=O[e];z(t[0]+T*s,t[1]+T*s,t[2]+T*s)}}n.addGroup(e,r.length/3-e,0)}(),function(){const e=r.length/3;let t=0;L(C,t),t+=C.length;for(let n=0,r=M.length;n<r;n++){const e=M[n];L(e,t),t+=e.length}n.addGroup(e,r.length/3-e,1)}()}this.setAttribute("position",new Da(r,3)),this.setAttribute("uv",new Da(i,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let r=0,i=e.length;r<i;r++){const t=e[r];n.shapes.push(t.uuid)}else n.shapes.push(e.uuid);n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let i=0,a=e.shapes.length;i<a;i++){const r=t[e.shapes[i]];n.push(r)}const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new Vl[r.type]).fromJSON(r)),new wc(n,e.options)}}const Sc={generateTopUV:function(e,t,n,r,i){const a=t[3*n],o=t[3*n+1],s=t[3*r],l=t[3*r+1],c=t[3*i],u=t[3*i+1];return[new tr(a,o),new tr(s,l),new tr(c,u)]},generateSideWallUV:function(e,t,n,r,i,a){const o=t[3*n],s=t[3*n+1],l=t[3*n+2],c=t[3*r],u=t[3*r+1],h=t[3*r+2],d=t[3*i],f=t[3*i+1],p=t[3*i+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(s-u)<Math.abs(o-c)?[new tr(o,1-l),new tr(c,1-h),new tr(d,1-p),new tr(m,1-v)]:[new tr(s,1-l),new tr(u,1-h),new tr(f,1-p),new tr(g,1-v)]}};class Mc extends gl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Mc(e.radius,e.detail)}}class Dc extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new tr(0,-.5),new tr(.5,0),new tr(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=Zn(r,0,2*Math.PI);const i=[],a=[],o=[],s=[],l=[],c=1/t,u=new Ir,h=new tr,d=new Ir,f=new Ir,p=new Ir;let m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.normalize(),s.push(d.x,d.y,d.z);break;case e.length-1:s.push(p.x,p.y,p.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),s.push(d.x,d.y,d.z),p.copy(f)}for(let v=0;v<=t;v++){const i=n+v*c*r,d=Math.sin(i),f=Math.cos(i);for(let n=0;n<=e.length-1;n++){u.x=e[n].x*d,u.y=e[n].y,u.z=e[n].x*f,a.push(u.x,u.y,u.z),h.x=v/t,h.y=n/(e.length-1),o.push(h.x,h.y);const r=s[3*n+0]*d,i=s[3*n+1],c=s[3*n+0]*f;l.push(r,i,c)}}for(let v=0;v<t;v++)for(let t=0;t<e.length-1;t++){const n=t+v*e.length,r=n,a=n+e.length,o=n+e.length+1,s=n+1;i.push(r,a,s),i.push(o,s,a)}this.setIndex(i),this.setAttribute("position",new Da(a,3)),this.setAttribute("uv",new Da(o,2)),this.setAttribute("normal",new Da(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Dc(e.points,e.segments,e.phiStart,e.phiLength)}}class Ec extends gl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ec(e.radius,e.detail)}}class Cc extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,a=t/2,o=Math.floor(n),s=Math.floor(r),l=o+1,c=s+1,u=e/o,h=t/s,d=[],f=[],p=[],m=[];for(let g=0;g<c;g++){const e=g*h-a;for(let t=0;t<l;t++){const n=t*u-i;f.push(n,-e,0),p.push(0,0,1),m.push(t/o),m.push(1-g/s)}}for(let g=0;g<s;g++)for(let e=0;e<o;e++){const t=e+l*g,n=e+l*(g+1),r=e+1+l*(g+1),i=e+1+l*g;d.push(t,n,i),d.push(n,r,i)}this.setIndex(d),this.setAttribute("position",new Da(f,3)),this.setAttribute("normal",new Da(p,3)),this.setAttribute("uv",new Da(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cc(e.width,e.height,e.widthSegments,e.heightSegments)}}class Ac extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},n=Math.max(3,n),r=Math.max(1,r);const o=[],s=[],l=[],c=[];let u=e;const h=(t-e)/r,d=new Ir,f=new tr;for(let p=0;p<=r;p++){for(let e=0;e<=n;e++){const r=i+e/n*a;d.x=u*Math.cos(r),d.y=u*Math.sin(r),s.push(d.x,d.y,d.z),l.push(0,0,1),f.x=(d.x/t+1)/2,f.y=(d.y/t+1)/2,c.push(f.x,f.y)}u+=h}for(let p=0;p<r;p++){const e=p*(n+1);for(let t=0;t<n;t++){const r=t+e,i=r,a=r+n+1,s=r+n+2,l=r+1;o.push(i,a,l),o.push(a,s,l)}}this.setIndex(o),this.setAttribute("position",new Da(s,3)),this.setAttribute("normal",new Da(l,3)),this.setAttribute("uv",new Da(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ac(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Tc extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new jl([new tr(0,.5),new tr(-.5,-.5),new tr(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],i=[],a=[];let o=0,s=0;if(!1===Array.isArray(e))l(e);else for(let c=0;c<e.length;c++)l(e[c]),this.addGroup(o,s,c),o+=s,s=0;function l(e){const o=r.length/3,l=e.extractPoints(t);let c=l.shape;const u=l.holes;!1===xc.isClockWise(c)&&(c=c.reverse());for(let t=0,n=u.length;t<n;t++){const e=u[t];!0===xc.isClockWise(e)&&(u[t]=e.reverse())}const h=xc.triangulateShape(c,u);for(let t=0,n=u.length;t<n;t++){const e=u[t];c=c.concat(e)}for(let t=0,n=c.length;t<n;t++){const e=c[t];r.push(e.x,e.y,0),i.push(0,0,1),a.push(e.x,e.y)}for(let t=0,r=h.length;t<r;t++){const e=h[t],r=e[0]+o,i=e[1]+o,a=e[2]+o;n.push(r,i,a),s+=3}}this.setIndex(n),this.setAttribute("position",new Da(r,3)),this.setAttribute("normal",new Da(i,3)),this.setAttribute("uv",new Da(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,r=e.length;n<r;n++){const r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,i=e.shapes.length;r<i;r++){const i=t[e.shapes[r]];n.push(i)}return new Tc(n,e.curveSegments)}}class Nc extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const s=Math.min(a+o,Math.PI);let l=0;const c=[],u=new Ir,h=new Ir,d=[],f=[],p=[],m=[];for(let g=0;g<=n;g++){const d=[],v=g/n;let y=0;0===g&&0===a?y=.5/t:g===n&&s===Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const s=n/t;u.x=-e*Math.cos(r+s*i)*Math.sin(a+v*o),u.y=e*Math.cos(a+v*o),u.z=e*Math.sin(r+s*i)*Math.sin(a+v*o),f.push(u.x,u.y,u.z),h.copy(u).normalize(),p.push(h.x,h.y,h.z),m.push(s+y,1-v),d.push(l++)}c.push(d)}for(let g=0;g<n;g++)for(let e=0;e<t;e++){const t=c[g][e+1],r=c[g][e],i=c[g+1][e],o=c[g+1][e+1];(0!==g||a>0)&&d.push(t,r,o),(g!==n-1||s<Math.PI)&&d.push(r,i,o)}this.setIndex(d),this.setAttribute("position",new Da(f,3)),this.setAttribute("normal",new Da(p,3)),this.setAttribute("uv",new Da(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Nc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Rc extends gl{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Rc(e.radius,e.detail)}}class Pc extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const a=[],o=[],s=[],l=[],c=new Ir,u=new Ir,h=new Ir;for(let d=0;d<=n;d++)for(let a=0;a<=r;a++){const f=a/r*i,p=d/n*Math.PI*2;u.x=(e+t*Math.cos(p))*Math.cos(f),u.y=(e+t*Math.cos(p))*Math.sin(f),u.z=t*Math.sin(p),o.push(u.x,u.y,u.z),c.x=e*Math.cos(f),c.y=e*Math.sin(f),h.subVectors(u,c).normalize(),s.push(h.x,h.y,h.z),l.push(a/r),l.push(d/n)}for(let d=1;d<=n;d++)for(let e=1;e<=r;e++){const t=(r+1)*d+e-1,n=(r+1)*(d-1)+e-1,i=(r+1)*(d-1)+e,o=(r+1)*d+e;a.push(t,n,o),a.push(n,i,o)}this.setIndex(a),this.setAttribute("position",new Da(o,3)),this.setAttribute("normal",new Da(s,3)),this.setAttribute("uv",new Da(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Pc(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Fc extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},n=Math.floor(n),r=Math.floor(r);const o=[],s=[],l=[],c=[],u=new Ir,h=new Ir,d=new Ir,f=new Ir,p=new Ir,m=new Ir,g=new Ir;for(let y=0;y<=n;++y){const o=y/n*i*Math.PI*2;v(o,i,a,e,d),v(o+.01,i,a,e,f),m.subVectors(f,d),g.addVectors(f,d),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let e=0;e<=r;++e){const i=e/r*Math.PI*2,a=-t*Math.cos(i),o=t*Math.sin(i);u.x=d.x+(a*g.x+o*p.x),u.y=d.y+(a*g.y+o*p.y),u.z=d.z+(a*g.z+o*p.z),s.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(y/n),c.push(e/r)}}for(let y=1;y<=n;y++)for(let e=1;e<=r;e++){const t=(r+1)*(y-1)+(e-1),n=(r+1)*y+(e-1),i=(r+1)*y+e,a=(r+1)*(y-1)+e;o.push(t,n,a),o.push(n,i,a)}function v(e,t,n,r,i){const a=Math.cos(e),o=Math.sin(e),s=n/t*e,l=Math.cos(s);i.x=r*(2+l)*.5*a,i.y=r*(2+l)*o*.5,i.z=r*Math.sin(s)*.5}this.setIndex(o),this.setAttribute("position",new Da(s,3)),this.setAttribute("normal",new Da(l,3)),this.setAttribute("uv",new Da(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Fc(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Oc extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new zl(new Ir(-1,-1,0),new Ir(-1,1,0),new Ir(1,1,0)),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i};const a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new Ir,s=new Ir,l=new tr;let c=new Ir;const u=[],h=[],d=[],f=[];function p(i){c=e.getPointAt(i/t,c);const l=a.normals[i],d=a.binormals[i];for(let e=0;e<=r;e++){const t=e/r*Math.PI*2,i=Math.sin(t),a=-Math.cos(t);s.x=a*l.x+i*d.x,s.y=a*l.y+i*d.y,s.z=a*l.z+i*d.z,s.normalize(),h.push(s.x,s.y,s.z),o.x=c.x+n*s.x,o.y=c.y+n*s.y,o.z=c.z+n*s.z,u.push(o.x,o.y,o.z)}}!function(){for(let e=0;e<t;e++)p(e);p(!1===i?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=r;n++)l.x=e/t,l.y=n/r,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),a=(r+1)*e+t,o=(r+1)*(e-1)+t;f.push(n,i,o),f.push(i,a,o)}}()}(),this.setIndex(f),this.setAttribute("position",new Da(u,3)),this.setAttribute("normal",new Da(h,3)),this.setAttribute("uv",new Da(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Oc((new Vl[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Ic extends Fa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new Ir,i=new Ir;if(null!==e.index){const a=e.attributes.position,o=e.index;let s=e.groups;0===s.length&&(s=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,l=s.length;e<l;++e){const l=s[e],c=l.start;for(let e=c,s=c+l.count;e<s;e+=3)for(let l=0;l<3;l++){const s=o.getX(e+l),c=o.getX(e+(l+1)%3);r.fromBufferAttribute(a,s),i.fromBufferAttribute(a,c),!0===Bc(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}}else{const a=e.attributes.position;for(let e=0,o=a.count/3;e<o;e++)for(let s=0;s<3;s++){const o=3*e+s,l=3*e+(s+1)%3;r.fromBufferAttribute(a,o),i.fromBufferAttribute(a,l),!0===Bc(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new Da(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function Bc(e,t,n){const r="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}var kc=Object.freeze({__proto__:null,BoxGeometry:Xa,CapsuleGeometry:dl,CircleGeometry:fl,ConeGeometry:ml,CylinderGeometry:pl,DodecahedronGeometry:vl,EdgesGeometry:wl,ExtrudeGeometry:wc,IcosahedronGeometry:Mc,LatheGeometry:Dc,OctahedronGeometry:Ec,PlaneGeometry:Cc,PolyhedronGeometry:gl,RingGeometry:Ac,ShapeGeometry:Tc,SphereGeometry:Nc,TetrahedronGeometry:Rc,TorusGeometry:Pc,TorusKnotGeometry:Fc,TubeGeometry:Oc,WireframeGeometry:Ic});class Lc extends oa{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ra(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Uc extends Ja{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class zc extends oa{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new ra(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ra(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Zt,this.normalScale=new tr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new _i,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Hc extends zc{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new tr(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Zn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ra(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ra(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ra(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!==e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!==e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!==e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!==e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!==e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!==e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Vc extends oa{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ra(16777215),this.specular=new ra(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ra(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Zt,this.normalScale=new tr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new _i,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Gc extends oa{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ra(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ra(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Zt,this.normalScale=new tr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class qc extends oa{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Zt,this.normalScale=new tr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class jc extends oa{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ra(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ra(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Zt,this.normalScale=new tr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new _i,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Wc extends oa{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=jt,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Xc extends oa{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class Yc extends oa{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ra(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Zt,this.normalScale=new tr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Zc extends Bs{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Kc(e,t){return e&&e.constructor!==t?"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function Qc(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Jc(e){const t=e.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n}function $c(e,t,n){const r=e.length,i=new e.constructor(r);for(let a=0,o=0;o!==r;++a){const r=n[a]*t;for(let n=0;n!==t;++n)i[o++]=e[r+n]}return i}function eu(e,t,n,r){let i=1,a=e[0];for(;void 0!==a&&void 0===a[r];)a=e[i++];if(void 0===a)return;let o=a[r];if(void 0!==o)if(Array.isArray(o))do{o=a[r],void 0!==o&&(t.push(a.time),n.push(...o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{o=a[r],void 0!==o&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{o=a[r],void 0!==o&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}class tu{static convertArray(e,t){return Kc(e,t)}static isTypedArray(e){return Qc(e)}static getKeyframeOrder(e){return Jc(e)}static sortedArray(e,t,n){return $c(e,t,n)}static flattenJSON(e,t,n,r){eu(e,t,n,r)}static subclip(e,t,n,r){return function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30;const a=e.clone();a.name=t;const o=[];for(let l=0;l<a.tracks.length;++l){const e=a.tracks[l],t=e.getValueSize(),s=[],c=[];for(let a=0;a<e.times.length;++a){const o=e.times[a]*i;if(!(o<n||o>=r)){s.push(e.times[a]);for(let n=0;n<t;++n)c.push(e.values[a*t+n])}}0!==s.length&&(e.times=Kc(s,e.times.constructor),e.values=Kc(c,e.values.constructor),o.push(e))}a.tracks=o;let s=1/0;for(let l=0;l<a.tracks.length;++l)s>a.tracks[l].times[0]&&(s=a.tracks[l].times[0]);for(let l=0;l<a.tracks.length;++l)a.tracks[l].shift(-1*s);return a.resetDuration(),a}(e,t,n,r,arguments.length>4&&void 0!==arguments[4]?arguments[4]:30)}static makeClipAdditive(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);const i=n.tracks.length,a=t/r;for(let o=0;o<i;++o){const t=n.tracks[o],r=t.ValueTypeName;if("bool"===r||"string"===r)continue;const i=e.tracks.find((function(e){return e.name===t.name&&e.ValueTypeName===r}));if(void 0===i)continue;let s=0;const l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=l/3);let c=0;const u=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=t.times.length-1;let d;if(a<=t.times[0]){const e=s,n=l-s;d=t.values.slice(e,n)}else if(a>=t.times[h]){const e=h*l+s,n=e+l-s;d=t.values.slice(e,n)}else{const e=t.createInterpolant(),n=s,r=l-s;e.evaluate(a),d=e.resultBuffer.slice(n,r)}"quaternion"===r&&(new Or).fromArray(d).normalize().conjugate().toArray(d);const f=i.times.length;for(let e=0;e<f;++e){const t=e*u+c;if("quaternion"===r)Or.multiplyQuaternionsFlat(i.values,t,d,0,i.values,t);else{const e=u-2*c;for(let n=0;n<e;++n)i.values[t+n]-=d[n]}}}return e.blendMode=Ht,e}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:30)}}class nu{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(i=r,r=t[++n],e<r)break t}a=t.length;break n}if(e>=i)break e;{const o=t[1];e<o&&(n=2,i=o);for(let a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===a)break;if(r=i,i=t[--n-1],e>=i)break t}a=n,n=0}}for(;n<a;){const r=n+a>>>1;e<t[r]?a=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let a=0;a!==r;++a)t[a]=n[i+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ru extends nu{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:kt,endingEnd:kt}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case Lt:i=e,o=2*t-n;break;case Ut:i=r.length-2,o=t+r[i]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Lt:a=e,s=2*n-t;break;case Ut:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=i*c,this._offsetNext=a*c}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,x=d*m-d*p;for(let b=0;b!==o;++b)i[b]=g*a[c+b]+v*a[l+b]+y*a[s+b]+x*a[u+b];return i}}class iu extends nu{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(n-t)/(r-t),u=1-c;for(let h=0;h!==o;++h)i[h]=a[l+h]*u+a[s+h]*c;return i}}class au extends nu{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class ou{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Kc(t,this.TimeBufferType),this.values=Kc(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Kc(e.times,Array),values:Kc(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new au(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new iu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ru(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Ot:t=this.InterpolantFactoryMethodDiscrete;break;case It:t=this.InterpolantFactoryMethodLinear;break;case Bt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ot;case this.InterpolantFactoryMethodLinear:return It;case this.InterpolantFactoryMethodSmooth:return Bt}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,a=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);const e=this.getValueSize();this.times=n.slice(i,a),this.values=this.values.slice(i*e,a*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==i;o++){const t=n[o];if("number"===typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,t),e=!1;break}if(null!==a&&a>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,t,a),e=!1;break}a=t}if(void 0!==r&&Qc(r))for(let o=0,s=r.length;o!==s;++o){const t=r[o];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,t),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Bt,i=e.length-1;let a=1;for(let o=1;o<i;++o){let i=!1;const s=e[o];if(s!==e[o+1]&&(1!==o||s!==e[0]))if(r)i=!0;else{const e=o*n,r=e-n,a=e+n;for(let o=0;o!==n;++o){const n=t[e+o];if(n!==t[r+o]||n!==t[a+o]){i=!0;break}}}if(i){if(o!==a){e[a]=e[o];const r=o*n,i=a*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++a}}if(i>0){e[a]=e[i];for(let e=i*n,r=a*n,o=0;o!==n;++o)t[r+o]=t[e+o];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}ou.prototype.ValueTypeName="",ou.prototype.TimeBufferType=Float32Array,ou.prototype.ValueBufferType=Float32Array,ou.prototype.DefaultInterpolation=It;class su extends ou{constructor(e,t,n){super(e,t,n)}}su.prototype.ValueTypeName="bool",su.prototype.ValueBufferType=Array,su.prototype.DefaultInterpolation=Ot,su.prototype.InterpolantFactoryMethodLinear=void 0,su.prototype.InterpolantFactoryMethodSmooth=void 0;class lu extends ou{constructor(e,t,n,r){super(e,t,n,r)}}lu.prototype.ValueTypeName="color";class cu extends ou{constructor(e,t,n,r){super(e,t,n,r)}}cu.prototype.ValueTypeName="number";class uu extends nu{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t);let l=e*o;for(let c=l+o;l!==c;l+=4)Or.slerpFlat(i,0,a,l-o,a,l,s);return i}}class hu extends ou{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new uu(this.times,this.values,this.getValueSize(),e)}}hu.prototype.ValueTypeName="quaternion",hu.prototype.InterpolantFactoryMethodSmooth=void 0;class du extends ou{constructor(e,t,n){super(e,t,n)}}du.prototype.ValueTypeName="string",du.prototype.ValueBufferType=Array,du.prototype.DefaultInterpolation=Ot,du.prototype.InterpolantFactoryMethodLinear=void 0,du.prototype.InterpolantFactoryMethodSmooth=void 0;class fu extends ou{constructor(e,t,n,r){super(e,t,n,r)}}fu.prototype.ValueTypeName="vector";class pu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:zt;this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=Yn(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,o=n.length;a!==o;++a)t.push(mu(n[a]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let i=0,a=n.length;i!==a;++i)t.push(ou.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,a=[];for(let o=0;o<i;o++){let e=[],s=[];e.push((o+i-1)%i,o,(o+1)%i),s.push(0,1,0);const l=Jc(e);e=$c(e,1,l),s=$c(s,1,l),r||0!==e[0]||(e.push(i),s.push(s[0])),a.push(new cu(".morphTargetInfluences["+t[o].name+"]",e,s).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let o=0,s=e.length;o<s;o++){const t=e[o],n=t.name.match(i);if(n&&n.length>1){const e=n[1];let i=r[e];i||(r[e]=i=[]),i.push(t)}}const a=[];for(const o in r)a.push(this.CreateFromMorphTargetSequence(o,r[o],t,n));return a}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,r,i){if(0!==n.length){const a=[],o=[];eu(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode;let s=e.length||-1;const l=e.hierarchy||[];for(let c=0;c<l.length;c++){const e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let n;for(n=0;n<e.length;n++)if(e[n].morphTargets)for(let r=0;r<e[n].morphTargets.length;r++)t[e[n].morphTargets[r]]=-1;for(const i in t){const t=[],a=[];for(let r=0;r!==e[n].morphTargets.length;++r){const r=e[n];t.push(r.time),a.push(r.morphTarget===i?1:0)}r.push(new cu(".morphTargetInfluence["+i+"]",t,a))}s=t.length*a}else{const i=".bones["+t[c].name+"]";n(fu,i+".position",e,"pos",r),n(hu,i+".quaternion",e,"rot",r),n(fu,i+".scale",e,"scl",r)}}if(0===r.length)return null;return new this(i,s,r,o)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function mu(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return cu;case"vector":case"vector2":case"vector3":case"vector4":return fu;case"color":return lu;case"quaternion":return hu;case"bool":case"boolean":return su;case"string":return du}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];eu(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const gu={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class vu{constructor(e,t,n){const r=this;let i,a=!1,o=0,s=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){s++,!1===a&&void 0!==r.onStart&&r.onStart(e,o,s),a=!0},this.itemEnd=function(e){o++,void 0!==r.onProgress&&r.onProgress(e,o,s),o===s&&(a=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],r=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null}}}const yu=new vu;class xu{constructor(e){this.manager=void 0!==e?e:yu,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}xu.DEFAULT_MATERIAL_NAME="__DEFAULT";const bu={};class _u extends Error{constructor(e,t){super(e),this.response=t}}class wu extends xu{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=gu.get(e);if(void 0!==i)return this.manager.itemStart(e),setTimeout((()=>{t&&t(i),this.manager.itemEnd(e)}),0),i;if(void 0!==bu[e])return void bu[e].push({onLoad:t,onProgress:n,onError:r});bu[e]=[],bu[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,s=this.responseType;fetch(a).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=bu[e],r=t.body.getReader(),i=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),a=i?parseInt(i):0,o=0!==a;let s=0;const l=new ReadableStream({start(e){!function t(){r.read().then((r=>{let{done:i,value:l}=r;if(i)e.close();else{s+=l.byteLength;const r=new ProgressEvent("progress",{lengthComputable:o,loaded:s,total:a});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(r)}e.enqueue(l),t()}}),(t=>{e.error(t)}))}()}});return new Response(l)}throw new _u('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)})).then((e=>{switch(s){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,o)));case"json":return e.json();default:if(""===o)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(o),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then((e=>r.decode(e)))}}})).then((t=>{gu.add(e,t);const n=bu[e];delete bu[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onLoad&&r.onLoad(t)}})).catch((t=>{const n=bu[e];if(void 0===n)throw this.manager.itemError(e),t;delete bu[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Su extends xu{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new wu(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r?r(a):console.error(a),i.manager.itemError(e)}}),n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=pu.parse(e[n]);t.push(r)}return t}}class Mu extends xu{constructor(e){super(e)}load(e,t,n,r){const i=this,a=[],o=new ol,s=new wu(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);let l=0;function c(c){s.load(e[c],(function(e){const n=i.parse(e,!0);a[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(o.minFilter=De),o.image=a,o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,r)}if(Array.isArray(e))for(let u=0,h=e.length;u<h;++u)c(u);else s.load(e,(function(e){const n=i.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){a[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)a[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),a[t].format=n.format,a[t].width=n.width,a[t].height=n.height}o.image=a}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=De),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}}class Du extends xu{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=gu.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;const o=sr("img");function s(){c(),gu.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){c(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}class Eu extends xu{constructor(e){super(e)}load(e,t,n,r){const i=new oo;i.colorSpace=Jt;const a=new Du(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function s(n){a.load(e[n],(function(e){i.images[n]=e,o++,6===o&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(let l=0;l<e.length;++l)s(l);return i}}class Cu extends xu{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new Yo,o=new wu(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,(function(e){let n;try{n=i.parse(e)}catch(o){if(void 0===r)return void console.error(o);r(o)}void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:ye,a.wrapT=void 0!==n.wrapT?n.wrapT:ye,a.magFilter=void 0!==n.magFilter?n.magFilter:De,a.minFilter=void 0!==n.minFilter?n.minFilter:De,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace&&(a.colorSpace=n.colorSpace),void 0!==n.flipY&&(a.flipY=n.flipY),void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=Ae),1===n.mipmapCount&&(a.minFilter=De),void 0!==n.generateMipmaps&&(a.generateMipmaps=n.generateMipmaps),a.needsUpdate=!0,t&&t(a,n)}),n,r),a}}class Au extends xu{constructor(e){super(e)}load(e,t,n,r){const i=new Er,a=new Du(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}class Tu extends Li{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new ra(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}class Nu extends Tu{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Li.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ra(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Ru=new hi,Pu=new Ir,Fu=new Ir;class Ou{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new tr(512,512),this.mapType=Ne,this.map=null,this.mapPass=null,this.matrix=new hi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new fs,this._frameExtents=new tr(1,1),this._viewportCount=1,this._viewports=[new Cr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Pu.setFromMatrixPosition(e.matrixWorld),t.position.copy(Pu),Fu.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Fu),t.updateMatrixWorld(),Ru.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ru),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Ru)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Iu extends Ou{constructor(){super(new ro(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*Xn*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Bu extends Tu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Li.DEFAULT_UP),this.updateMatrix(),this.target=new Li,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new Iu}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const ku=new hi,Lu=new Ir,Uu=new Ir;class zu extends Ou{constructor(){super(new ro(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new tr(4,2),this._viewportCount=6,this._viewports=[new Cr(2,1,1,1),new Cr(0,1,1,1),new Cr(3,1,1,1),new Cr(1,1,1,1),new Cr(3,0,1,1),new Cr(1,0,1,1)],this._cubeDirections=[new Ir(1,0,0),new Ir(-1,0,0),new Ir(0,0,1),new Ir(0,0,-1),new Ir(0,1,0),new Ir(0,-1,0)],this._cubeUps=[new Ir(0,1,0),new Ir(0,1,0),new Ir(0,1,0),new Ir(0,1,0),new Ir(0,0,1),new Ir(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),Lu.setFromMatrixPosition(e.matrixWorld),n.position.copy(Lu),Uu.copy(n.position),Uu.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Uu),n.updateMatrixWorld(),r.makeTranslation(-Lu.x,-Lu.y,-Lu.z),ku.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ku)}}class Hu extends Tu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new zu}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Vu extends $a{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,a=i+e*this.view.width,o-=t*this.view.offsetY,s=o-t*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class Gu extends Ou{constructor(){super(new Vu(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class qu extends Tu{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Li.DEFAULT_UP),this.updateMatrix(),this.target=new Li,this.shadow=new Gu}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class ju extends Tu{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Wu extends Tu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Xu{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Ir)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}class Yu extends Tu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Xu;super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Zu extends xu{constructor(e){super(e),this.textures={}}load(e,t,n,r){const i=this,a=new wu(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r?r(a):console.error(a),i.manager.itemError(e)}}),n,r)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const r=this.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new ra).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.dispersion&&(r.dispersion=e.dispersion),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(r.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(r.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(r.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(r.depthFunc=e.depthFunc),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(r.blendSrc=e.blendSrc),void 0!==e.blendDst&&(r.blendDst=e.blendDst),void 0!==e.blendEquation&&(r.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(r.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(r.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(r.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==r.blendColor&&r.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(r.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),void 0!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const i in e.uniforms){const t=e.uniforms[i];switch(r.uniforms[i]={},t.type){case"t":r.uniforms[i].value=n(t.value);break;case"c":r.uniforms[i].value=(new ra).setHex(t.value);break;case"v2":r.uniforms[i].value=(new tr).fromArray(t.value);break;case"v3":r.uniforms[i].value=(new Ir).fromArray(t.value);break;case"v4":r.uniforms[i].value=(new Cr).fromArray(t.value);break;case"m3":r.uniforms[i].value=(new nr).fromArray(t.value);break;case"m4":r.uniforms[i].value=(new hi).fromArray(t.value);break;default:r.uniforms[i].value=t.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const i in e.extensions)r.extensions[i]=e.extensions[i];if(void 0!==e.lights&&(r.lights=e.lights),void 0!==e.clipping&&(r.clipping=e.clipping),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),r.normalScale=(new tr).fromArray(t)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapRotation&&r.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new tr).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.anisotropyMap&&(r.anisotropyMap=n(e.anisotropyMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return Zu.createMaterialFromType(e)}static createMaterialFromType(e){return new{ShadowMaterial:Lc,SpriteMaterial:yo,RawShaderMaterial:Uc,ShaderMaterial:Ja,PointsMaterial:Ks,MeshPhysicalMaterial:Hc,MeshStandardMaterial:zc,MeshPhongMaterial:Vc,MeshToonMaterial:Gc,MeshNormalMaterial:qc,MeshLambertMaterial:jc,MeshDepthMaterial:Wc,MeshDistanceMaterial:Xc,MeshBasicMaterial:sa,MeshMatcapMaterial:Yc,LineDashedMaterial:Zc,LineBasicMaterial:Bs,Material:oa}[e]}}class Ku{static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Qu extends Fa{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Ju extends xu{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new wu(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(a){r?r(a):console.error(a),i.manager.itemError(e)}}),n,r)}parse(e){const t={},n={};function r(e,r){if(void 0!==t[r])return t[r];const i=e.interleavedBuffers[r],a=function(e,t){if(void 0!==n[t])return n[t];const r=e.arrayBuffers,i=r[t],a=new Uint32Array(i).buffer;return n[t]=a,a}(e,i.buffer),o=or(i.type,a),s=new mo(o,i.stride);return s.uuid=i.uuid,t[r]=s,s}const i=e.isInstancedBufferGeometry?new Qu:new Fa,a=e.data.index;if(void 0!==a){const e=or(a.type,a.array);i.setIndex(new ga(e,1))}const o=e.data.attributes;for(const u in o){const t=o[u];let n;if(t.isInterleavedBufferAttribute){const i=r(e.data,t.data);n=new vo(i,t.itemSize,t.offset,t.normalized)}else{const e=or(t.type,t.array);n=new(t.isInstancedBufferAttribute?Jo:ga)(e,t.itemSize,t.normalized)}void 0!==t.name&&(n.name=t.name),void 0!==t.usage&&n.setUsage(t.usage),i.setAttribute(u,n)}const s=e.data.morphAttributes;if(s)for(const u in s){const t=s[u],n=[];for(let i=0,a=t.length;i<a;i++){const a=t[i];let o;if(a.isInterleavedBufferAttribute){const t=r(e.data,a.data);o=new vo(t,a.itemSize,a.offset,a.normalized)}else{const e=or(a.type,a.array);o=new ga(e,a.itemSize,a.normalized)}void 0!==a.name&&(o.name=a.name),n.push(o)}i.morphAttributes[u]=n}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let u=0,h=l.length;u!==h;++u){const e=l[u];i.addGroup(e.start,e.count,e.materialIndex)}const c=e.data.boundingSphere;if(void 0!==c){const e=new Ir;void 0!==c.center&&e.fromArray(c.center),i.boundingSphere=new ni(e,c.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}class $u extends xu{constructor(e){super(e)}load(e,t,n,r){const i=this,a=""===this.path?Ku.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new wu(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){let a=null;try{a=JSON.parse(n)}catch(s){return void 0!==r&&r(s),void console.error("THREE:ObjectLoader: Can't parse "+e+".",s.message)}const o=a.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);i.parse(a,t)}),n,r)}async loadAsync(e,t){const n=""===this.path?Ku.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const r=new wu(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const i=await r.loadAsync(e,t),a=JSON.parse(i),o=a.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(a)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),o=this.parseTextures(e.textures,a),s=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,s,o,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),this.bindLightTargets(l),void 0!==t){let e=!1;for(const t in a)if(a[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),i=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,r,o,a,t),l=this.parseSkeletons(e.skeletons,s);return this.bindSkeletons(s,l),this.bindLightTargets(s),s}parseShapes(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const r=(new jl).fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(let i=0,a=e.length;i<a;i++){const t=(new Qo).fromJSON(e[i],r);n[t.uuid]=t}return n}parseGeometries(e,t){const n={};if(void 0!==e){const r=new Ju;for(let i=0,a=e.length;i<a;i++){let a;const o=e[i];switch(o.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(o);break;default:o.type in kc?a=kc[o.type].fromJSON(o,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(o.type,'"'))}a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),void 0!==o.userData&&(a.userData=o.userData),n[o.uuid]=a}}return n}parseMaterials(e,t){const n={},r={};if(void 0!==e){const i=new Zu;i.setTextures(t);for(let t=0,a=e.length;t<a;t++){const a=e[t];void 0===n[a.uuid]&&(n[a.uuid]=i.parse(a)),r[a.uuid]=n[a.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const r=e[n],i=pu.parse(r);t[i.uuid]=i}return t}parseImages(e,t){const n=this,r={};let i;function a(e){if("string"===typeof e){const t=e;return function(e){return n.manager.itemStart(e),i.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:or(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new vu(t);i=new Du(n),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const n=e[t],i=n.url;if(Array.isArray(i)){const e=[];for(let t=0,n=i.length;t<n;t++){const n=a(i[t]);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new Yo(n.data,n.width,n.height)))}r[n.uuid]=new Sr(e)}else{const e=a(n.url);r[n.uuid]=new Sr(e)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function i(e){if("string"===typeof e){const n=e,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await r.loadAsync(i)}return e.data?{data:or(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){r=new Du(this.manager),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const r=e[t],a=r.url;if(Array.isArray(a)){const e=[];for(let t=0,n=a.length;t<n;t++){const n=a[t],r=await i(n);null!==r&&(r instanceof HTMLImageElement?e.push(r):e.push(new Yo(r.data,r.width,r.height)))}n[r.uuid]=new Sr(e)}else{const e=await i(r.url);n[r.uuid]=new Sr(e)}}}return n}parseTextures(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const r={};if(void 0!==e)for(let i=0,a=e.length;i<a;i++){const a=e[i];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const o=t[a.image],s=o.data;let l;Array.isArray(s)?(l=new oo,6===s.length&&(l.needsUpdate=!0)):(l=s&&s.data?new Yo:new Er,s&&(l.needsUpdate=!0)),l.source=o,l.uuid=a.uuid,void 0!==a.name&&(l.name=a.name),void 0!==a.mapping&&(l.mapping=n(a.mapping,eh)),void 0!==a.channel&&(l.channel=a.channel),void 0!==a.offset&&l.offset.fromArray(a.offset),void 0!==a.repeat&&l.repeat.fromArray(a.repeat),void 0!==a.center&&l.center.fromArray(a.center),void 0!==a.rotation&&(l.rotation=a.rotation),void 0!==a.wrap&&(l.wrapS=n(a.wrap[0],th),l.wrapT=n(a.wrap[1],th)),void 0!==a.format&&(l.format=a.format),void 0!==a.internalFormat&&(l.internalFormat=a.internalFormat),void 0!==a.type&&(l.type=a.type),void 0!==a.colorSpace&&(l.colorSpace=a.colorSpace),void 0!==a.minFilter&&(l.minFilter=n(a.minFilter,nh)),void 0!==a.magFilter&&(l.magFilter=n(a.magFilter,nh)),void 0!==a.anisotropy&&(l.anisotropy=a.anisotropy),void 0!==a.flipY&&(l.flipY=a.flipY),void 0!==a.generateMipmaps&&(l.generateMipmaps=a.generateMipmaps),void 0!==a.premultiplyAlpha&&(l.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(l.unpackAlignment=a.unpackAlignment),void 0!==a.compareFunction&&(l.compareFunction=a.compareFunction),void 0!==a.userData&&(l.userData=a.userData),r[a.uuid]=l}return r}parseObject(e,t,n,i,a){let o,s,l;function c(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function u(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];void 0===n[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),t.push(n[i])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function h(e){return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),i[e]}switch(e.type){case"Scene":o=new po,void 0!==e.background&&(Number.isInteger(e.background)?o.background=new ra(e.background):o.background=h(e.background)),void 0!==e.environment&&(o.environment=h(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?o.fog=new fo(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(o.fog=new ho(e.fog.color,e.fog.density)),""!==e.fog.name&&(o.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(o.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(o.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&o.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentIntensity&&(o.environmentIntensity=e.environmentIntensity),void 0!==e.environmentRotation&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new ro(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(o.focus=e.focus),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.filmGauge&&(o.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(o.filmOffset=e.filmOffset),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Vu(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(o.zoom=e.zoom),void 0!==e.view&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new ju(e.color,e.intensity);break;case"DirectionalLight":o=new qu(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new Hu(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Wu(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Bu(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new Nu(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=(new Yu).fromJSON(e);break;case"SkinnedMesh":s=c(e.geometry),l=u(e.material),o=new Wo(s,l),void 0!==e.bindMode&&(o.bindMode=e.bindMode),void 0!==e.bindMatrix&&o.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(o.skeleton=e.skeleton);break;case"Mesh":s=c(e.geometry),l=u(e.material),o=new ja(s,l);break;case"InstancedMesh":s=c(e.geometry),l=u(e.material);const t=e.count,n=e.instanceMatrix,i=e.instanceColor;o=new os(s,l,t),o.instanceMatrix=new Jo(new Float32Array(n.array),16),void 0!==i&&(o.instanceColor=new Jo(new Float32Array(i.array),i.itemSize));break;case"BatchedMesh":s=c(e.geometry),l=u(e.material),o=new Is(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,l),o.geometry=s,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._geometryInfo=e.geometryInfo.map((e=>{let t=null,n=null;return void 0!==e.boundingBox&&(t=new Lr,t.min.fromArray(e.boundingBox.min),t.max.fromArray(e.boundingBox.max)),void 0!==e.boundingSphere&&(n=new ni,n.radius=e.boundingSphere.radius,n.center.fromArray(e.boundingSphere.center)),(0,r.A)((0,r.A)({},e),{},{boundingBox:t,boundingSphere:n})})),o._instanceInfo=e.instanceInfo,o._availableInstanceIds=e._availableInstanceIds,o._availableGeometryIds=e._availableGeometryIds,o._nextIndexStart=e.nextIndexStart,o._nextVertexStart=e.nextVertexStart,o._geometryCount=e.geometryCount,o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._matricesTexture=h(e.matricesTexture.uuid),o._indirectTexture=h(e.indirectTexture.uuid),void 0!==e.colorsTexture&&(o._colorsTexture=h(e.colorsTexture.uuid)),void 0!==e.boundingSphere&&(o.boundingSphere=new ni,o.boundingSphere.center.fromArray(e.boundingSphere.center),o.boundingSphere.radius=e.boundingSphere.radius),void 0!==e.boundingBox&&(o.boundingBox=new Lr,o.boundingBox.min.fromArray(e.boundingBox.min),o.boundingBox.max.fromArray(e.boundingBox.max));break;case"LOD":o=new Bo;break;case"Line":o=new qs(c(e.geometry),u(e.material));break;case"LineLoop":o=new Zs(c(e.geometry),u(e.material));break;case"LineSegments":o=new Ys(c(e.geometry),u(e.material));break;case"PointCloud":case"Points":o=new tl(c(e.geometry),u(e.material));break;case"Sprite":o=new Po(u(e.material));break;case"Group":o=new lo;break;case"Bone":o=new Xo;break;default:o=new Li}if(o.uuid=e.uuid,void 0!==e.name&&(o.name=e.name),void 0!==e.matrix?(o.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==e.position&&o.position.fromArray(e.position),void 0!==e.rotation&&o.rotation.fromArray(e.rotation),void 0!==e.quaternion&&o.quaternion.fromArray(e.quaternion),void 0!==e.scale&&o.scale.fromArray(e.scale)),void 0!==e.up&&o.up.fromArray(e.up),void 0!==e.castShadow&&(o.castShadow=e.castShadow),void 0!==e.receiveShadow&&(o.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.intensity&&(o.shadow.intensity=e.shadow.intensity),void 0!==e.shadow.bias&&(o.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(o.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(o.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&o.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(o.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(o.visible=e.visible),void 0!==e.frustumCulled&&(o.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(o.renderOrder=e.renderOrder),void 0!==e.userData&&(o.userData=e.userData),void 0!==e.layers&&(o.layers.mask=e.layers),void 0!==e.children){const r=e.children;for(let e=0;e<r.length;e++)o.add(this.parseObject(r[e],t,n,i,a))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];o.animations.push(a[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(o.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],r=o.getObjectByProperty("uuid",n.object);void 0!==r&&o.addLevel(r,n.distance,n.hysteresis)}}return o}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}bindLightTargets(e){e.traverse((function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,r=e.getObjectByProperty("uuid",n);t.target=void 0!==r?r:new Li}}))}}const eh={UVMapping:he,CubeReflectionMapping:de,CubeRefractionMapping:fe,EquirectangularReflectionMapping:pe,EquirectangularRefractionMapping:me,CubeUVReflectionMapping:ge},th={RepeatWrapping:ve,ClampToEdgeWrapping:ye,MirroredRepeatWrapping:xe},nh={NearestFilter:be,NearestMipmapNearestFilter:_e,NearestMipmapLinearFilter:Se,LinearFilter:De,LinearMipmapNearestFilter:Ee,LinearMipmapLinearFilter:Ae};class rh extends xu{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=gu.get(e);if(void 0!==a)return i.manager.itemStart(e),a.then?void a.then((n=>{t&&t(n),i.manager.itemEnd(e)})).catch((e=>{r&&r(e)})):(setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a);const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader;const s=fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){return gu.add(e,n),t&&t(n),i.manager.itemEnd(e),n})).catch((function(t){r&&r(t),gu.remove(e),i.manager.itemError(e),i.manager.itemEnd(e)}));gu.add(e,s),i.manager.itemStart(e)}}let ih;class ah{static getContext(){return void 0===ih&&(ih=new(window.AudioContext||window.webkitAudioContext)),ih}static setContext(e){ih=e}}class oh extends xu{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new wu(this.manager);function o(t){r?r(t):console.error(t),i.manager.itemError(e)}a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(e){try{const n=e.slice(0);ah.getContext().decodeAudioData(n,(function(e){t(e)})).catch(o)}catch(n){o(n)}}),n,r)}}const sh=new hi,lh=new hi,ch=new hi;class uh{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ro,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ro,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,ch.copy(e.projectionMatrix);const n=t.eyeSep/2,r=n*t.near/t.focus,i=t.near*Math.tan(Wn*t.fov*.5)/t.zoom;let a,o;lh.elements[12]=-n,sh.elements[12]=n,a=-i*t.aspect+r,o=i*t.aspect+r,ch.elements[0]=2*t.near/(o-a),ch.elements[8]=(o+a)/(o-a),this.cameraL.projectionMatrix.copy(ch),a=-i*t.aspect-r,o=i*t.aspect-r,ch.elements[0]=2*t.near/(o-a),ch.elements[8]=(o+a)/(o-a),this.cameraR.projectionMatrix.copy(ch)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(lh),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(sh)}}class hh extends ro{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class dh{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=fh(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=fh();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function fh(){return performance.now()}const ph=new Ir,mh=new Or,gh=new Ir,vh=new Ir;class yh extends Li{constructor(){super(),this.type="AudioListener",this.context=ah.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new dh}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(ph,mh,gh),vh.set(0,0,-1).applyQuaternion(mh),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(ph.x,e),t.positionY.linearRampToValueAtTime(ph.y,e),t.positionZ.linearRampToValueAtTime(ph.z,e),t.forwardX.linearRampToValueAtTime(vh.x,e),t.forwardY.linearRampToValueAtTime(vh.y,e),t.forwardZ.linearRampToValueAtTime(vh.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(ph.x,ph.y,ph.z),t.setOrientation(vh.x,vh.y,vh.z,n.x,n.y,n.z)}}class xh extends Li{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),"buffer"!==e.sourceType?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const bh=new Ir,_h=new Or,wh=new Ir,Sh=new Ir;class Mh extends xh{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(bh,_h,wh),Sh.set(0,0,1).applyQuaternion(_h);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(bh.x,e),t.positionY.linearRampToValueAtTime(bh.y,e),t.positionZ.linearRampToValueAtTime(bh.z,e),t.orientationX.linearRampToValueAtTime(Sh.x,e),t.orientationY.linearRampToValueAtTime(Sh.y,e),t.orientationZ.linearRampToValueAtTime(Sh.z,e)}else t.setPosition(bh.x,bh.y,bh.z),t.setOrientation(Sh.x,Sh.y,Sh.z)}}class Dh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class Eh{constructor(e,t,n){let r,i,a;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let a=this.cumulativeWeight;if(0===a){for(let e=0;e!==r;++e)n[i+e]=n[e];a=t}else{a+=t;const e=t/a;this._mixBufferRegion(n,i,0,e,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const e=t*this._origIndex;this._mixBufferRegion(n,r,e,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let s=t,l=t+t;s!==l;++s)if(n[s]!==n[s+t]){o.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(r>=.5)for(let a=0;a!==i;++a)e[t+a]=e[n+a]}_slerp(e,t,n,r){Or.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){const a=this._workIndex*i;Or.multiplyQuaternionsFlat(e,a,e,t,e,n),Or.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,i){const a=1-r;for(let o=0;o!==i;++o){const i=t+o;e[i]=e[i]*a+e[n+o]*r}}_lerpAdditive(e,t,n,r,i){for(let a=0;a!==i;++a){const i=t+a;e[i]=e[i]+e[n+a]*r}}}const Ch="\\[\\]\\.:\\/",Ah=new RegExp("["+Ch+"]","g"),Th="[^"+Ch+"]",Nh="[^"+Ch.replace("\\.","")+"]",Rh=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Th)+/(WCOD+)?/.source.replace("WCOD",Nh)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Th)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Th)+"$"),Ph=["material","materials","bones","map"];class Fh{constructor(e,t,n){this.path=t,this.parsedPath=n||Fh.parseTrackName(t),this.node=Fh.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Fh.Composite(e,t,n):new Fh(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Ah,"")}static parseTrackName(e){const t=Rh.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==Ph.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const a=n(i.children);if(a)return a}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=Fh.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const a=e[r];if(void 0===a){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",e)}let o=this.Versioning.None;this.targetObject=e,!0===e.isMaterial?o=this.Versioning.NeedsUpdate:!0===e.isObject3D&&(o=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}s=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(s=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Fh.Composite=class{constructor(e,t,n){const r=n||Fh.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Fh.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Fh.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Fh.prototype.GetterByBindingType=[Fh.prototype._getValue_direct,Fh.prototype._getValue_array,Fh.prototype._getValue_arrayElement,Fh.prototype._getValue_toArray],Fh.prototype.SetterByBindingTypeAndVersioning=[[Fh.prototype._setValue_direct,Fh.prototype._setValue_direct_setNeedsUpdate,Fh.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Fh.prototype._setValue_array,Fh.prototype._setValue_array_setNeedsUpdate,Fh.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Fh.prototype._setValue_arrayElement,Fh.prototype._setValue_arrayElement_setNeedsUpdate,Fh.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Fh.prototype._setValue_fromArray,Fh.prototype._setValue_fromArray_setNeedsUpdate,Fh.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Oh{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Yn(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length;let o,s=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=t[h];if(void 0===d){d=s++,t[h]=d,e.push(u);for(let e=0,t=a;e!==t;++e)i[e].push(new Fh(u,n[e],r[e]))}else if(d<l){o=e[d];const s=--l,c=e[s];t[c.uuid]=d,e[d]=c,t[h]=s,e[s]=u;for(let e=0,t=a;e!==t;++e){const t=i[e],a=t[s];let o=t[d];t[d]=a,void 0===o&&(o=new Fh(u,n[e],r[e])),t[s]=o}}else e[d]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const o=arguments[a],s=o.uuid,l=t[s];if(void 0!==l&&l>=i){const a=i++,c=e[a];t[c.uuid]=l,e[l]=c,t[s]=a,e[a]=o;for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[a],i=t[l];t[l]=r,t[a]=i}}}this.nCachedObjects_=i}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,a=e.length;for(let o=0,s=arguments.length;o!==s;++o){const s=arguments[o].uuid,l=t[s];if(void 0!==l)if(delete t[s],l<i){const o=--i,s=e[o],c=--a,u=e[c];t[s.uuid]=l,e[l]=s,t[u.uuid]=o,e[o]=u,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[o],i=t[c];t[l]=r,t[o]=i,t.pop()}}else{const i=--a,o=e[i];i>0&&(t[o.uuid]=l),e[l]=o,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e];t[l]=t[i],t.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const i=this._bindings;if(void 0!==r)return i[r];const a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,u=new Array(l);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(u);for(let h=c,d=s.length;h!==d;++h){const n=s[h];u[h]=new Fh(n,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}class Ih{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const i=t.tracks,a=i.length,o=new Array(a),s={endingStart:kt,endingEnd:kt};for(let l=0;l!==a;++l){const e=i[l].createInterpolant(null);o[l]=e,e.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Pt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.fadeOut(t),this.fadeIn(t),!0===n){const n=this._clip.duration,r=e._clip.duration,i=r/n,a=n/r;e.warp(1,i,t),this.warp(a,1,t)}return this}crossFadeTo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,i=r.time,a=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);const s=o.parameterPositions,l=o.sampleValues;return s[0]=i,s[1]=i+n,l[0]=e/a,l[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const i=this._startTime;if(null!==i){const r=(e-i)*n;r<0||0===n?t=0:(this._startTime=null,t=n*r)}t*=this._updateTimeScale(e);const a=this._updateTime(t),o=this._updateWeight(e);if(o>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===Ht)for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(a),t[n].accumulateAdditive(o);else for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(a),t[n].accumulate(r,o)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const a=n===Ft;if(0===e)return-1===i?r:a&&1===(1&i)?t-r:r;if(n===Rt){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){const n=Math.floor(r/t);r-=t*n,i+=Math.abs(n);const o=this.repetitions-i;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){const t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(a&&1===(1&i))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=Lt,r.endingEnd=Lt):(r.endingStart=e?this.zeroSlopeAtStart?Lt:kt:Ut,r.endingEnd=t?this.zeroSlopeAtEnd?Lt:kt:Ut)}_scheduleFading(e,t,n){const r=this._mixer,i=r.time;let a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}const Bh=new Float32Array(1);class kh extends Gn{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName;let c=l[s];void 0===c&&(c={},l[s]=c);for(let u=0;u!==i;++u){const e=r[u],i=e.name;let l=c[i];if(void 0!==l)++l.referenceCount,a[u]=l;else{if(l=a[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,s,i));continue}const r=t&&t._propertyBindings[u].binding.parsedPath;l=new Eh(Fh.create(n,i,r),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,s,i),a[u]=l}o[u].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,i=this._actionsByClip;let a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{const t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),e._byClipCacheIndex=null;delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let a=r[t];void 0===a&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new iu(new Float32Array(2),new Float32Array(2),1,Bh),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const r=t||this._root,i=r.uuid;let a="string"===typeof e?pu.findByName(r,e):e;const o=null!==a?a.uuid:e,s=this._actionsByClip[o];let l=null;if(void 0===n&&(n=null!==a?a.blendMode:zt),void 0!==s){const e=s.actionByRoot[i];if(void 0!==e&&e.blendMode===n)return e;l=s.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;const c=new Ih(this,a,t,n);return this._bindAction(c,l),this._addInactiveAction(c,o,i),c}existingAction(e,t){const n=t||this._root,r=n.uuid,i="string"===typeof e?pu.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==n;++l){t[l]._update(r,e,i,a)}const o=this._bindings,s=this._nActiveBindings;for(let l=0;l!==s;++l)o[l].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const e=i.knownActions;for(let n=0,r=e.length;n!==r;++n){const r=e[n];this._deactivateAction(r);const i=r._cacheIndex,a=t[t.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,a._cacheIndex=i,t[i]=a,t.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const i in n){const e=n[i].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const r=this._bindingsByRootAndName[t];if(void 0!==r)for(const i in r){const e=r[i];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Lh extends Ar{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isRenderTarget3D=!0,this.depth=n,this.texture=new Pr(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Uh extends Ar{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isRenderTargetArray=!0,this.depth=n,this.texture=new Nr(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class zh{constructor(e){this.value=e}clone(){return new zh(void 0===this.value.clone?this.value:this.value.clone())}}let Hh=0;class Vh extends Gn{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Hh++}),this.name="",this.usage=Cn,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const e=Array.isArray(t[n])?t[n]:[t[n]];for(let t=0;t<e.length;t++)this.uniforms.push(e[t].clone())}return this}clone(){return(new this.constructor).copy(this)}}class Gh extends mo{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class qh{constructor(e,t,n,r,i){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const jh=new hi;class Wh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new ui(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new wi,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return jh.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(jh),this}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Yh(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(Xh),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let r=0,i=e.length;r<i;r++)Yh(e[r],this,n,t);return n.sort(Xh),n}}function Xh(e,t){return e.distance-t.distance}function Yh(e,t,n,r){let i=!0;if(e.layers.test(t.layers)){!1===e.raycast(t,n)&&(i=!1)}if(!0===i&&!0===r){const r=e.children;for(let e=0,i=r.length;e<i;e++)Yh(r[e],t,n,!0)}}class Zh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Zn(this.phi,e,Math.PI-e),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Zn(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Kh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}class Qh{constructor(e,t,n,r){Qh.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==e&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const i=this.elements;return i[0]=e,i[2]=t,i[1]=n,i[3]=r,this}}const Jh=new tr;class $h{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new tr(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new tr(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Jh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Jh).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ed=new Ir,td=new Ir;class nd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ir,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){ed.subVectors(e,this.start),td.subVectors(this.end,this.start);const n=td.dot(td);let r=td.dot(ed)/n;return t&&(r=Zn(r,0,1)),r}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const rd=new Ir;class id extends Li{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new Fa,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,s=32;a<s;a++,o++){const e=a/s*Math.PI*2,t=o/s*Math.PI*2;r.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new Da(r,3));const i=new Bs({fog:!1,toneMapped:!1});this.cone=new Ys(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),rd.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(rd),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const ad=new Ir,od=new hi,sd=new hi;class ld extends Ys{constructor(e){const t=cd(e),n=new Fa,r=[],i=[],a=new ra(0,0,1),o=new ra(0,1,0);for(let s=0;s<t.length;s++){const e=t[s];e.parent&&e.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}n.setAttribute("position",new Da(r,3)),n.setAttribute("color",new Da(i,3));super(n,new Bs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");sd.copy(this.root.matrixWorld).invert();for(let i=0,a=0;i<t.length;i++){const e=t[i];e.parent&&e.parent.isBone&&(od.multiplyMatrices(sd,e.matrixWorld),ad.setFromMatrixPosition(od),r.setXYZ(a,ad.x,ad.y,ad.z),od.multiplyMatrices(sd,e.parent.matrixWorld),ad.setFromMatrixPosition(od),r.setXYZ(a+1,ad.x,ad.y,ad.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function cd(e){const t=[];!0===e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push(...cd(e.children[n]));return t}class ud extends ja{constructor(e,t,n){super(new Nc(t,4,2),new sa({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const hd=new Ir,dd=new ra,fd=new ra;class pd extends Li{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new Ec(t);r.rotateY(.5*Math.PI),this.material=new sa({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.setAttribute("color",new ga(a,3)),this.add(new ja(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");dd.copy(this.light.color),fd.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const r=e<n/2?dd:fd;t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(hd.setFromMatrixPosition(this.light.matrixWorld).negate())}}class md extends Ys{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;n=new ra(n),r=new ra(r);const i=t/2,a=e/t,o=e/2,s=[],l=[];for(let u=0,h=0,d=-o;u<=t;u++,d+=a){s.push(-o,0,d,o,0,d),s.push(d,0,-o,d,0,o);const e=u===i?n:r;e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3}const c=new Fa;c.setAttribute("position",new Da(s,3)),c.setAttribute("color",new Da(l,3));super(c,new Bs({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class gd extends Ys{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;i=new ra(i),a=new ra(a);const o=[],s=[];if(t>1)for(let c=0;c<t;c++){const n=c/t*(2*Math.PI),r=Math.sin(n)*e,l=Math.cos(n)*e;o.push(0,0,0),o.push(r,0,l);const u=1&c?i:a;s.push(u.r,u.g,u.b),s.push(u.r,u.g,u.b)}for(let c=0;c<n;c++){const t=1&c?i:a,l=e-e/n*c;for(let e=0;e<r;e++){let n=e/r*(2*Math.PI),i=Math.sin(n)*l,a=Math.cos(n)*l;o.push(i,0,a),s.push(t.r,t.g,t.b),n=(e+1)/r*(2*Math.PI),i=Math.sin(n)*l,a=Math.cos(n)*l,o.push(i,0,a),s.push(t.r,t.g,t.b)}}const l=new Fa;l.setAttribute("position",new Da(o,3)),l.setAttribute("color",new Da(s,3));super(l,new Bs({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const vd=new Ir,yd=new Ir,xd=new Ir;class bd extends Li{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let r=new Fa;r.setAttribute("position",new Da([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new Bs({fog:!1,toneMapped:!1});this.lightPlane=new qs(r,i),this.add(this.lightPlane),r=new Fa,r.setAttribute("position",new Da([0,0,0,0,0,1],3)),this.targetLine=new qs(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),vd.setFromMatrixPosition(this.light.matrixWorld),yd.setFromMatrixPosition(this.light.target.matrixWorld),xd.subVectors(yd,vd),this.lightPlane.lookAt(yd),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(yd),this.targetLine.scale.z=xd.length()}}const _d=new Ir,wd=new $a;class Sd extends Ys{constructor(e){const t=new Fa,n=new Bs({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],a={};function o(e,t){s(e),s(t)}function s(e){r.push(0,0,0),i.push(0,0,0),void 0===a[e]&&(a[e]=[]),a[e].push(r.length/3-1)}o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4"),t.setAttribute("position",new Da(r,3)),t.setAttribute("color",new Da(i,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const l=new ra(16755200),c=new ra(16711680),u=new ra(43775),h=new ra(16777215),d=new ra(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,n,r,i){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,i.r,i.g,i.b),a.setXYZ(41,i.r,i.g,i.b),a.setXYZ(42,i.r,i.g,i.b),a.setXYZ(43,i.r,i.g,i.b),a.setXYZ(44,i.r,i.g,i.b),a.setXYZ(45,i.r,i.g,i.b),a.setXYZ(46,i.r,i.g,i.b),a.setXYZ(47,i.r,i.g,i.b),a.setXYZ(48,i.r,i.g,i.b),a.setXYZ(49,i.r,i.g,i.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;wd.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const n=this.camera.coordinateSystem===Ln?-1:0;Md("c",t,e,wd,0,0,n),Md("t",t,e,wd,0,0,1),Md("n1",t,e,wd,-1,-1,n),Md("n2",t,e,wd,1,-1,n),Md("n3",t,e,wd,-1,1,n),Md("n4",t,e,wd,1,1,n),Md("f1",t,e,wd,-1,-1,1),Md("f2",t,e,wd,1,-1,1),Md("f3",t,e,wd,-1,1,1),Md("f4",t,e,wd,1,1,1),Md("u1",t,e,wd,.7,1.1,n),Md("u2",t,e,wd,-.7,1.1,n),Md("u3",t,e,wd,0,2,n),Md("cf1",t,e,wd,-1,0,1),Md("cf2",t,e,wd,1,0,1),Md("cf3",t,e,wd,0,-1,1),Md("cf4",t,e,wd,0,1,1),Md("cn1",t,e,wd,-1,0,n),Md("cn2",t,e,wd,1,0,n),Md("cn3",t,e,wd,0,-1,n),Md("cn4",t,e,wd,0,1,n),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Md(e,t,n,r,i,a,o){_d.set(i,a,o).unproject(r);const s=t[e];if(void 0!==s){const e=n.getAttribute("position");for(let t=0,n=s.length;t<n;t++)e.setXYZ(s[t],_d.x,_d.y,_d.z)}}const Dd=new Lr;class Ed extends Ys{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Fa;i.setIndex(new ga(n,1)),i.setAttribute("position",new ga(r,3)),super(i,new Bs({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(void 0!==this.object&&Dd.setFromObject(this.object),Dd.isEmpty())return;const e=Dd.min,t=Dd.max,n=this.geometry.attributes.position,r=n.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Cd extends Ys{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Fa;r.setIndex(new ga(n,1)),r.setAttribute("position",new Da([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new Bs({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Ad extends qs{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960,r=new Fa;r.setAttribute("position",new Da([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),r.computeBoundingSphere(),super(r,new Bs({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const i=new Fa;i.setAttribute("position",new Da([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new ja(i,new sa({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const Td=new Ir;let Nd,Rd;class Pd extends Li{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ir(0,0,1),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ir(0,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*n,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*i;super(),this.type="ArrowHelper",void 0===Nd&&(Nd=new Fa,Nd.setAttribute("position",new Da([0,0,0,0,1,0],3)),Rd=new ml(.5,1,5,1),Rd.translate(0,-.5,0)),this.position.copy(t),this.line=new qs(Nd,new Bs({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ja(Rd,new sa({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Td.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Td,t)}}setLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Fd extends Ys{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new Fa;n.setAttribute("position",new Da(t,3)),n.setAttribute("color",new Da([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new Bs({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new ra,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Od{constructor(){this.type="ShapePath",this.color=new ra,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new ql,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(e,t){const n=t.length;let r=!1;for(let i=n-1,a=0;a<n;i=a++){let n=t[i],o=t[a],s=o.x-n.x,l=o.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[a],s=-s,o=t[i],l=-l),e.y<n.y||e.y>o.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-s*(e.y-n.y);if(0===t)return!0;if(t<0)continue;r=!r}}else{if(e.y!==n.y)continue;if(o.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=o.x)return!0}}return r}const n=xc.isClockWise,r=this.subPaths;if(0===r.length)return[];let i,a,o;const s=[];if(1===r.length)return a=r[0],o=new jl,o.curves=a.curves,s.push(o),s;let l=!n(r[0].getPoints());l=e?!l:l;const c=[],u=[];let h,d,f=[],p=0;u[p]=void 0,f[p]=[];for(let m=0,g=r.length;m<g;m++)a=r[m],h=a.getPoints(),i=n(h),i=e?!i:i,i?(!l&&u[p]&&p++,u[p]={s:new jl,p:h},u[p].s.curves=a.curves,l&&p++,f[p]=[]):f[p].push({h:a,p:h[0]});if(!u[0])return function(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n],i=new jl;i.curves=r.curves,t.push(i)}return t}(r);if(u.length>1){let e=!1,n=0;for(let t=0,r=u.length;t<r;t++)c[t]=[];for(let r=0,i=u.length;r<i;r++){const i=f[r];for(let a=0;a<i.length;a++){const o=i[a];let s=!0;for(let i=0;i<u.length;i++)t(o.p,u[i].p)&&(r!==i&&n++,s?(s=!1,c[i].push(o)):e=!0);s&&c[r].push(o)}}n>0&&!1===e&&(f=c)}for(let m=0,g=u.length;m<g;m++){o=u[m].s,s.push(o),d=f[m];for(let e=0,t=d.length;e<t;e++)o.holes.push(d[e].h)}return s}}class Id extends Gn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){void 0!==e?(null!==this.domElement&&this.disconnect(),this.domElement=e):console.warn("THREE.Controls: connect() now requires an element.")}disconnect(){}dispose(){}update(){}}function Bd(e,t,n,r){const i=function(e){switch(e){case Ne:case Re:return{byteLength:1,components:1};case Fe:case Pe:case ke:return{byteLength:2,components:1};case Le:case Ue:return{byteLength:2,components:4};case Ie:case Oe:case Be:return{byteLength:4,components:1};case He:return{byteLength:4,components:3}}throw new Error("Unknown texture type ".concat(e,"."))}(r);switch(n){case Ve:return e*t;case Xe:case Ye:return e*t/i.components*i.byteLength;case Ze:case Ke:return e*t*2/i.components*i.byteLength;case Ge:return e*t*3/i.components*i.byteLength;case qe:case Je:return e*t*4/i.components*i.byteLength;case $e:case et:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case tt:case nt:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case it:case ot:return Math.max(e,16)*Math.max(t,8)/4;case rt:case at:return Math.max(e,8)*Math.max(t,8)/2;case st:case lt:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case ct:case ut:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case ht:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case dt:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case ft:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case pt:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case mt:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case gt:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case vt:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case yt:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case xt:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case bt:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case _t:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case wt:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case St:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case Mt:case Dt:case Et:return Math.ceil(e/4)*Math.ceil(t/4)*16;case Ct:case At:return Math.ceil(e/4)*Math.ceil(t/4)*8;case Tt:case Nt:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error("Unable to determine texture byte length for ".concat(n," format."))}class kd{static contain(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2):(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0),e}(e,t)}static cover(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0):(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2),e}(e,t)}static fill(e){return function(e){return e.repeat.x=1,e.repeat.y=1,e.offset.x=0,e.offset.y=0,e}(e)}static getByteLength(e,t,n,r){return Bd(e,t,n,r)}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:i}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=i)},9485:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCapturedShape=function(e){return i.get(e)},t.createEvent=o,t.hasPointerCapture=function(e,t){return i.get(e)===t},t.setPointerCapture=function(e,t){s(e);if(!t.getStage())return;i.set(e,t),a&&t._fire("gotpointercapture",o(new PointerEvent("gotpointercapture")))},t.releaseCapture=s;const r=n(4602),i=new Map,a=void 0!==r.Konva._global.PointerEvent;function o(e){return{evt:e,pointerId:e.pointerId}}function s(e,t){const n=i.get(e);if(!n)return;const r=n.getStage();r&&r.content,i.delete(e),a&&n._fire("lostpointercapture",o(new PointerEvent("lostpointercapture")))}},9538:function(e,t,n){var r;!function(e,i){function a(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],n=(e^=e>>>7)^e<<24,n^=(e=r[i+1&7])^e>>>10,n^=(e=r[i+3&7])^e>>>3,n^=(e=r[i+4&7])^e<<7,e=r[i+7&7],n^=(e^=e<<13)^e<<9,r[i]=n,t.i=i+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new a(e),r=t&&t.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=n.next,i.quick=i,r&&(r.x&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,i))||(i.exports=r):this.xorshift7=s}(0,e=n.nmd(e),n.amdD)},9554:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ellipse=void 0;const r=n(1751),i=n(3304),a=n(9910),o=n(4602);class s extends i.Shape{_sceneFunc(e){const t=this.radiusX(),n=this.radiusY();e.beginPath(),e.save(),t!==n&&e.scale(1,n/t),e.arc(0,0,t,0,2*Math.PI,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return 2*this.radiusX()}getHeight(){return 2*this.radiusY()}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}t.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,o._registerNode)(s),r.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),r.Factory.addGetterSetter(s,"radiusX",0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(s,"radiusY",0,(0,a.getNumberValidator)())},9841:e=>{function t(){}t.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function i(){r.off(e,i),t.apply(n,arguments)}return i._=t,this.on(e,i,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,i=n.length;r<i;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],i=[];if(r&&t)for(var a=0,o=r.length;a<o;a++)r[a].fn!==t&&r[a].fn._!==t&&i.push(r[a]);return i.length?n[e]=i:delete n[e],this}},e.exports=t,e.exports.TinyEmitter=t},9910:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RGBComponent=function(e){if(e>255)return 255;if(e<0)return 0;return Math.round(e)},t.alphaComponent=function(e){if(e>1)return 1;if(e<1e-4)return 1e-4;return e},t.getNumberValidator=function(){if(r.Konva.isUnminified)return function(e,t){return i.Util._isNumber(e)||i.Util.warn(a(e)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),e}},t.getNumberOrArrayOfNumbersValidator=function(e){if(r.Konva.isUnminified)return function(t,n){let r=i.Util._isNumber(t),o=i.Util._isArray(t)&&t.length==e;return r||o||i.Util.warn(a(t)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+e+")"),t}},t.getNumberOrAutoValidator=function(){if(r.Konva.isUnminified)return function(e,t){return i.Util._isNumber(e)||"auto"===e||i.Util.warn(a(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),e}},t.getStringValidator=function(){if(r.Konva.isUnminified)return function(e,t){return i.Util._isString(e)||i.Util.warn(a(e)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),e}},t.getStringOrGradientValidator=function(){if(r.Konva.isUnminified)return function(e,t){const n=i.Util._isString(e),r="[object CanvasGradient]"===Object.prototype.toString.call(e)||e&&e.addColorStop;return n||r||i.Util.warn(a(e)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),e}},t.getFunctionValidator=function(){if(r.Konva.isUnminified)return function(e,t){return i.Util._isFunction(e)||i.Util.warn(a(e)+' is a not valid value for "'+t+'" attribute. The value should be a function.'),e}},t.getNumberArrayValidator=function(){if(r.Konva.isUnminified)return function(e,t){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&e instanceof n||(i.Util._isArray(e)?e.forEach((function(e){i.Util._isNumber(e)||i.Util.warn('"'+t+'" attribute has non numeric element '+e+". Make sure that all elements are numbers.")})):i.Util.warn(a(e)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),e}},t.getBooleanValidator=function(){if(r.Konva.isUnminified)return function(e,t){return!0===e||!1===e||i.Util.warn(a(e)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),e}},t.getComponentValidator=function(e){if(r.Konva.isUnminified)return function(t,n){return void 0===t||null===t||i.Util.isObject(t)||i.Util.warn(a(t)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+e),t}};const r=n(4602),i=n(7149);function a(e){return i.Util._isString(e)?'"'+e+'"':"[object Number]"===Object.prototype.toString.call(e)||i.Util._isBoolean(e)?e:Object.prototype.toString.call(e)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=e,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>r[e]));return o.default=()=>r,n.d(a,o),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+"."+{60:"e38a2aad",266:"63127054",284:"7975fffa",307:"076d646d",387:"8fe3f92f",414:"0c8922ed",453:"db721201",550:"31d628af",601:"67eef2b5",629:"91677e81",735:"cd72ceb0",796:"63fa0d45",934:"ffe31d60"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="math-visualizer-react:";n.l=(r,i,a,o)=>{if(e[r])e[r].push(i);else{var s,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+a){s=h;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+a),s.src=r),e[r]=[i];var d=(t,n)=>{s.onerror=s.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(n))),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="./",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=a);var o=n.p+n.u(t),s=new Error;n.l(o,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,i[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,a,o=r[0],s=r[1],l=r[2],c=0;if(o.some((t=>0!==e[t]))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(l)l(n)}for(t&&t(r);c<o.length;c++)a=o[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkmath_visualizer_react=self.webpackChunkmath_visualizer_react||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{Adder:()=>Ae,Delaunay:()=>sc,FormatSpecifier:()=>Eh,InternMap:()=>Re,InternSet:()=>Pe,Node:()=>tv,Path:()=>Ss,Voronoi:()=>tc,ZoomTransform:()=>hC,active:()=>fo,arc:()=>ZM,area:()=>rD,areaRadial:()=>dD,ascending:()=>ne,autoType:()=>Hc,axisBottom:()=>xn,axisLeft:()=>bn,axisRight:()=>yn,axisTop:()=>vn,bin:()=>dt,bisect:()=>he,bisectCenter:()=>ue,bisectLeft:()=>ce,bisectRight:()=>le,bisector:()=>ie,blob:()=>Nu,blur:()=>de,blur2:()=>fe,blurImage:()=>pe,brush:()=>Vo,brushSelection:()=>Uo,brushX:()=>zo,brushY:()=>Ho,buffer:()=>Pu,chord:()=>fs,chordDirected:()=>ms,chordTranspose:()=>ps,cluster:()=>Yg,color:()=>hi,contourDensity:()=>Pl,contours:()=>Ml,count:()=>xe,create:()=>SM,creator:()=>Er,cross:()=>Se,csv:()=>ku,csvFormat:()=>Ac,csvFormatBody:()=>Tc,csvFormatRow:()=>Rc,csvFormatRows:()=>Nc,csvFormatValue:()=>Pc,csvParse:()=>Ec,csvParseRows:()=>Cc,cubehelix:()=>pl,cumsum:()=>Me,curveBasis:()=>nE,curveBasisClosed:()=>iE,curveBasisOpen:()=>oE,curveBumpX:()=>gD,curveBumpY:()=>vD,curveBundle:()=>lE,curveCardinal:()=>hE,curveCardinalClosed:()=>fE,curveCardinalOpen:()=>mE,curveCatmullRom:()=>yE,curveCatmullRomClosed:()=>bE,curveCatmullRomOpen:()=>wE,curveLinear:()=>$M,curveLinearClosed:()=>ME,curveMonotoneX:()=>PE,curveMonotoneY:()=>FE,curveNatural:()=>BE,curveStep:()=>LE,curveStepAfter:()=>zE,curveStepBefore:()=>UE,descending:()=>re,deviation:()=>Ee,difference:()=>Kt,disjoint:()=>Qt,dispatch:()=>En,drag:()=>pc,dragDisable:()=>jr,dragEnable:()=>Wr,dsv:()=>Bu,dsvFormat:()=>Mc,easeBack:()=>Mu,easeBackIn:()=>wu,easeBackInOut:()=>Mu,easeBackOut:()=>Su,easeBounce:()=>xu,easeBounceIn:()=>yu,easeBounceInOut:()=>bu,easeBounceOut:()=>xu,easeCircle:()=>su,easeCircleIn:()=>au,easeCircleInOut:()=>su,easeCircleOut:()=>ou,easeCubic:()=>lo,easeCubicIn:()=>oo,easeCubicInOut:()=>lo,easeCubicOut:()=>so,easeElastic:()=>Cu,easeElasticIn:()=>Eu,easeElasticInOut:()=>Au,easeElasticOut:()=>Cu,easeExp:()=>iu,easeExpIn:()=>nu,easeExpInOut:()=>iu,easeExpOut:()=>ru,easeLinear:()=>Gc,easePoly:()=>Zc,easePolyIn:()=>Xc,easePolyInOut:()=>Zc,easePolyOut:()=>Yc,easeQuad:()=>Wc,easeQuadIn:()=>qc,easeQuadInOut:()=>Wc,easeQuadOut:()=>jc,easeSin:()=>eu,easeSinIn:()=>Jc,easeSinInOut:()=>eu,easeSinOut:()=>$c,every:()=>qt,extent:()=>Ce,fcumsum:()=>Ne,filter:()=>Wt,flatGroup:()=>He,flatRollup:()=>Ve,forceCenter:()=>Wu,forceCollide:()=>ah,forceLink:()=>lh,forceManyBody:()=>vh,forceRadial:()=>yh,forceSimulation:()=>gh,forceX:()=>xh,forceY:()=>bh,format:()=>Rh,formatDefaultLocale:()=>Bh,formatLocale:()=>Ih,formatPrefix:()=>Ph,formatSpecifier:()=>Dh,fsum:()=>Te,geoAlbers:()=>cg,geoAlbersUsa:()=>ug,geoArea:()=>zd,geoAzimuthalEqualArea:()=>pg,geoAzimuthalEqualAreaRaw:()=>fg,geoAzimuthalEquidistant:()=>gg,geoAzimuthalEquidistantRaw:()=>mg,geoBounds:()=>wf,geoCentroid:()=>Of,geoCircle:()=>jf,geoClipAntimeridian:()=>np,geoClipCircle:()=>rp,geoClipExtent:()=>hp,geoClipRectangle:()=>up,geoConicConformal:()=>wg,geoConicConformalRaw:()=>_g,geoConicEqualArea:()=>lg,geoConicEqualAreaRaw:()=>sg,geoConicEquidistant:()=>Eg,geoConicEquidistantRaw:()=>Dg,geoContains:()=>Ap,geoDistance:()=>xp,geoEqualEarth:()=>Fg,geoEqualEarthRaw:()=>Pg,geoEquirectangular:()=>Mg,geoEquirectangularRaw:()=>Sg,geoGnomonic:()=>Ig,geoGnomonicRaw:()=>Og,geoGraticule:()=>Rp,geoGraticule10:()=>Pp,geoIdentity:()=>Bg,geoInterpolate:()=>Fp,geoLength:()=>gp,geoMercator:()=>yg,geoMercatorRaw:()=>vg,geoNaturalEarth1:()=>Lg,geoNaturalEarth1Raw:()=>kg,geoOrthographic:()=>zg,geoOrthographicRaw:()=>Ug,geoPath:()=>qm,geoProjection:()=>ig,geoProjectionMutator:()=>ag,geoRotation:()=>Vf,geoStereographic:()=>Vg,geoStereographicRaw:()=>Hg,geoStream:()=>gd,geoTransform:()=>jm,geoTransverseMercator:()=>qg,geoTransverseMercatorRaw:()=>Gg,gray:()=>Ys,greatest:()=>xt,greatestIndex:()=>Bt,group:()=>Le,groupSort:()=>$e,groups:()=>Ue,hcl:()=>rl,hierarchy:()=>Kg,histogram:()=>dt,hsl:()=>Mi,html:()=>qu,image:()=>Uu,index:()=>je,indexes:()=>We,interpolate:()=>Qi,interpolateArray:()=>Gi,interpolateBasis:()=>Ni,interpolateBasisClosed:()=>Ri,interpolateBlues:()=>KS,interpolateBrBG:()=>lS,interpolateBuGn:()=>ES,interpolateBuPu:()=>AS,interpolateCividis:()=>sM,interpolateCool:()=>uM,interpolateCubehelix:()=>my,interpolateCubehelixDefault:()=>lM,interpolateCubehelixLong:()=>gy,interpolateDate:()=>ji,interpolateDiscrete:()=>ny,interpolateGnBu:()=>NS,interpolateGreens:()=>JS,interpolateGreys:()=>eM,interpolateHcl:()=>dy,interpolateHclLong:()=>fy,interpolateHsl:()=>ly,interpolateHslLong:()=>cy,interpolateHue:()=>ry,interpolateInferno:()=>_M,interpolateLab:()=>uy,interpolateMagma:()=>bM,interpolateNumber:()=>Wi,interpolateNumberArray:()=>Hi,interpolateObject:()=>Xi,interpolateOrRd:()=>PS,interpolateOranges:()=>oM,interpolatePRGn:()=>uS,interpolatePiYG:()=>dS,interpolatePlasma:()=>wM,interpolatePuBu:()=>BS,interpolatePuBuGn:()=>OS,interpolatePuOr:()=>pS,interpolatePuRd:()=>LS,interpolatePurples:()=>nM,interpolateRainbow:()=>dM,interpolateRdBu:()=>gS,interpolateRdGy:()=>yS,interpolateRdPu:()=>zS,interpolateRdYlBu:()=>bS,interpolateRdYlGn:()=>wS,interpolateReds:()=>iM,interpolateRgb:()=>ki,interpolateRgbBasis:()=>Ui,interpolateRgbBasisClosed:()=>zi,interpolateRound:()=>iy,interpolateSinebow:()=>gM,interpolateSpectral:()=>MS,interpolateString:()=>Ki,interpolateTransformCss:()=>Ia,interpolateTransformSvg:()=>Ba,interpolateTurbo:()=>vM,interpolateViridis:()=>xM,interpolateWarm:()=>cM,interpolateYlGn:()=>qS,interpolateYlGnBu:()=>VS,interpolateYlOrBr:()=>WS,interpolateYlOrRd:()=>YS,interpolateZoom:()=>oy,interrupt:()=>Ta,intersection:()=>Jt,interval:()=>lC,isoFormat:()=>aC,isoParse:()=>sC,json:()=>Hu,lab:()=>Zs,lch:()=>nl,least:()=>Ot,leastIndex:()=>It,line:()=>nD,lineRadial:()=>hD,link:()=>_D,linkHorizontal:()=>wD,linkRadial:()=>MD,linkVertical:()=>SD,local:()=>DM,map:()=>Xt,matcher:()=>Pn,max:()=>ft,maxIndex:()=>pt,mean:()=>Dt,median:()=>Et,medianIndex:()=>Ct,merge:()=>At,min:()=>mt,minIndex:()=>gt,mode:()=>Tt,namespace:()=>Xn,namespaces:()=>Wn,nice:()=>ut,now:()=>ua,pack:()=>Ev,packEnclose:()=>uv,packSiblings:()=>Mv,pairs:()=>Nt,partition:()=>Pv,path:()=>Ms,pathRound:()=>Ds,permute:()=>Ze,pie:()=>oD,piecewise:()=>vy,pointRadial:()=>fD,pointer:()=>$i,pointers:()=>CM,polygonArea:()=>xy,polygonCentroid:()=>by,polygonContains:()=>Dy,polygonHull:()=>My,polygonLength:()=>Ey,precisionFixed:()=>kh,precisionPrefix:()=>Lh,precisionRound:()=>Uh,quadtree:()=>Qu,quantile:()=>bt,quantileIndex:()=>wt,quantileSorted:()=>_t,quantize:()=>yy,quickselect:()=>vt,radialArea:()=>dD,radialLine:()=>hD,randomBates:()=>Fy,randomBernoulli:()=>By,randomBeta:()=>Uy,randomBinomial:()=>zy,randomCauchy:()=>Vy,randomExponential:()=>Oy,randomGamma:()=>Ly,randomGeometric:()=>ky,randomInt:()=>Ty,randomIrwinHall:()=>Py,randomLcg:()=>Yy,randomLogNormal:()=>Ry,randomLogistic:()=>Gy,randomNormal:()=>Ny,randomPareto:()=>Iy,randomPoisson:()=>qy,randomUniform:()=>Ay,randomWeibull:()=>Hy,range:()=>Pt,rank:()=>Ft,reduce:()=>Yt,reverse:()=>Zt,rgb:()=>mi,ribbon:()=>Bs,ribbonArrow:()=>ks,rollup:()=>Ge,rollups:()=>qe,scaleBand:()=>$y,scaleDiverging:()=>Gw,scaleDivergingLog:()=>qw,scaleDivergingPow:()=>Ww,scaleDivergingSqrt:()=>Xw,scaleDivergingSymlog:()=>jw,scaleIdentity:()=>px,scaleImplicit:()=>Qy,scaleLinear:()=>fx,scaleLog:()=>Sx,scaleOrdinal:()=>Jy,scalePoint:()=>tx,scalePow:()=>Px,scaleQuantile:()=>Bx,scaleQuantize:()=>kx,scaleRadial:()=>Ix,scaleSequential:()=>Bw,scaleSequentialLog:()=>kw,scaleSequentialPow:()=>Uw,scaleSequentialQuantile:()=>Hw,scaleSequentialSqrt:()=>zw,scaleSequentialSymlog:()=>Lw,scaleSqrt:()=>Fx,scaleSymlog:()=>Cx,scaleThreshold:()=>Lx,scaleTime:()=>Pw,scaleUtc:()=>Fw,scan:()=>kt,schemeAccent:()=>Kw,schemeBlues:()=>ZS,schemeBrBG:()=>sS,schemeBuGn:()=>DS,schemeBuPu:()=>CS,schemeCategory10:()=>Zw,schemeDark2:()=>Qw,schemeGnBu:()=>TS,schemeGreens:()=>QS,schemeGreys:()=>$S,schemeObservable10:()=>Jw,schemeOrRd:()=>RS,schemeOranges:()=>aM,schemePRGn:()=>cS,schemePaired:()=>$w,schemePastel1:()=>eS,schemePastel2:()=>tS,schemePiYG:()=>hS,schemePuBu:()=>IS,schemePuBuGn:()=>FS,schemePuOr:()=>fS,schemePuRd:()=>kS,schemePurples:()=>tM,schemeRdBu:()=>mS,schemeRdGy:()=>vS,schemeRdPu:()=>US,schemeRdYlBu:()=>xS,schemeRdYlGn:()=>_S,schemeReds:()=>rM,schemeSet1:()=>nS,schemeSet2:()=>rS,schemeSet3:()=>iS,schemeSpectral:()=>SS,schemeTableau10:()=>aS,schemeYlGn:()=>GS,schemeYlGnBu:()=>HS,schemeYlOrBr:()=>jS,schemeYlOrRd:()=>XS,select:()=>zr,selectAll:()=>AM,selection:()=>Ur,selector:()=>An,selectorAll:()=>Rn,shuffle:()=>Lt,shuffler:()=>Ut,some:()=>jt,sort:()=>Ke,stack:()=>jE,stackOffsetDiverging:()=>XE,stackOffsetExpand:()=>WE,stackOffsetNone:()=>HE,stackOffsetSilhouette:()=>YE,stackOffsetWiggle:()=>ZE,stackOrderAppearance:()=>KE,stackOrderAscending:()=>JE,stackOrderDescending:()=>eC,stackOrderInsideOut:()=>tC,stackOrderNone:()=>VE,stackOrderReverse:()=>nC,stratify:()=>Lv,style:()=>ir,subset:()=>nn,sum:()=>zt,superset:()=>en,svg:()=>ju,symbol:()=>JD,symbolAsterisk:()=>ED,symbolCircle:()=>CD,symbolCross:()=>AD,symbolDiamond:()=>RD,symbolDiamond2:()=>PD,symbolPlus:()=>FD,symbolSquare:()=>OD,symbolSquare2:()=>ID,symbolStar:()=>UD,symbolTimes:()=>ZD,symbolTriangle:()=>HD,symbolTriangle2:()=>GD,symbolWye:()=>YD,symbolX:()=>ZD,symbols:()=>KD,symbolsFill:()=>KD,symbolsStroke:()=>QD,text:()=>Ou,thresholdFreedmanDiaconis:()=>St,thresholdScott:()=>Mt,thresholdSturges:()=>ht,tickFormat:()=>hx,tickIncrement:()=>lt,tickStep:()=>ct,ticks:()=>st,timeDay:()=>sb,timeDays:()=>lb,timeFormat:()=>s_,timeFormatDefaultLocale:()=>Aw,timeFormatLocale:()=>a_,timeFriday:()=>xb,timeFridays:()=>Eb,timeHour:()=>rb,timeHours:()=>ib,timeInterval:()=>Yx,timeMillisecond:()=>Zx,timeMilliseconds:()=>Kx,timeMinute:()=>$x,timeMinutes:()=>eb,timeMonday:()=>mb,timeMondays:()=>wb,timeMonth:()=>Gb,timeMonths:()=>qb,timeParse:()=>l_,timeSaturday:()=>bb,timeSaturdays:()=>Cb,timeSecond:()=>Qx,timeSeconds:()=>Jx,timeSunday:()=>pb,timeSundays:()=>_b,timeThursday:()=>yb,timeThursdays:()=>Db,timeTickInterval:()=>t_,timeTicks:()=>e_,timeTuesday:()=>gb,timeTuesdays:()=>Sb,timeWednesday:()=>vb,timeWednesdays:()=>Mb,timeWeek:()=>pb,timeWeeks:()=>_b,timeYear:()=>Xb,timeYears:()=>Yb,timeout:()=>ya,timer:()=>fa,timerFlush:()=>pa,transition:()=>ro,transpose:()=>Ht,tree:()=>Xv,treemap:()=>Jv,treemapBinary:()=>$v,treemapDice:()=>Rv,treemapResquarify:()=>ty,treemapSlice:()=>Yv,treemapSliceDice:()=>ey,treemapSquarify:()=>Qv,tsv:()=>Lu,tsvFormat:()=>Bc,tsvFormatBody:()=>kc,tsvFormatRow:()=>Uc,tsvFormatRows:()=>Lc,tsvFormatValue:()=>zc,tsvParse:()=>Oc,tsvParseRows:()=>Ic,union:()=>rn,unixDay:()=>hb,unixDays:()=>db,utcDay:()=>cb,utcDays:()=>ub,utcFormat:()=>c_,utcFriday:()=>Ob,utcFridays:()=>Hb,utcHour:()=>ab,utcHours:()=>ob,utcMillisecond:()=>Zx,utcMilliseconds:()=>Kx,utcMinute:()=>tb,utcMinutes:()=>nb,utcMonday:()=>Nb,utcMondays:()=>kb,utcMonth:()=>jb,utcMonths:()=>Wb,utcParse:()=>u_,utcSaturday:()=>Ib,utcSaturdays:()=>Vb,utcSecond:()=>Qx,utcSeconds:()=>Jx,utcSunday:()=>Tb,utcSundays:()=>Bb,utcThursday:()=>Fb,utcThursdays:()=>zb,utcTickInterval:()=>$b,utcTicks:()=>Jb,utcTuesday:()=>Rb,utcTuesdays:()=>Lb,utcWednesday:()=>Pb,utcWednesdays:()=>Ub,utcWeek:()=>Tb,utcWeeks:()=>Bb,utcYear:()=>Zb,utcYears:()=>Kb,variance:()=>De,window:()=>er,xml:()=>Gu,zip:()=>Gt,zoom:()=>wC,zoomIdentity:()=>dC,zoomTransform:()=>fC});var t={};n.r(t),n.d(t,{createAbs:()=>FO,createAccessorNode:()=>hQ,createAcos:()=>IO,createAcosh:()=>Ik,createAcot:()=>eI,createAcoth:()=>AL,createAcsc:()=>nI,createAcsch:()=>kk,createAdd:()=>ZU,createAddScalar:()=>iI,createAnd:()=>EV,createAndTransform:()=>pJ,createArg:()=>aI,createArrayNode:()=>XK,createAsec:()=>Uk,createAsech:()=>sI,createAsin:()=>NL,createAsinh:()=>lI,createAssignmentNode:()=>fQ,createAtan:()=>cI,createAtan2:()=>QU,createAtanh:()=>hI,createAtomicMass:()=>dP,createAvogadro:()=>fP,createBellNumbers:()=>HG,createBigNumberClass:()=>EN,createBigint:()=>dI,createBignumber:()=>zk,createBin:()=>RL,createBitAnd:()=>$U,createBitAndTransform:()=>_J,createBitNot:()=>NI,createBitOr:()=>tz,createBitOrTransform:()=>MJ,createBitXor:()=>rz,createBlockNode:()=>ZK,createBohrMagneton:()=>WR,createBohrRadius:()=>JR,createBoltzmann:()=>pP,createBoolean:()=>PI,createCatalan:()=>SH,createCbrt:()=>az,createCeil:()=>RV,createChain:()=>sQ,createChainClass:()=>rQ,createClassicalElectronRadius:()=>$R,createClone:()=>OI,createColumn:()=>FV,createColumnTransform:()=>PJ,createCombinations:()=>LI,createCombinationsWithRep:()=>Vk,createCompare:()=>lz,createCompareNatural:()=>EH,createCompareText:()=>dz,createCompile:()=>CQ,createComplex:()=>zI,createComplexClass:()=>oR,createComposition:()=>AH,createConcat:()=>FL,createConcatTransform:()=>mJ,createConditionalNode:()=>QK,createConductanceQuantum:()=>XR,createConj:()=>VI,createConstantNode:()=>$K,createCorr:()=>mq,createCos:()=>qI,createCosh:()=>jk,createCot:()=>jI,createCoth:()=>IL,createCoulomb:()=>qR,createCount:()=>pz,createCreateUnit:()=>xG,createCross:()=>IV,createCsc:()=>WI,createCsch:()=>Xk,createCtranspose:()=>kL,createCube:()=>YI,createCumSum:()=>oG,createCumSumTransform:()=>EJ,createDeepEqual:()=>gz,createDenseMatrixClass:()=>QF,createDerivative:()=>JQ,createDet:()=>BV,createDeuteronMass:()=>aP,createDiag:()=>UL,createDiff:()=>NH,createDiffTransform:()=>AJ,createDistance:()=>PH,createDivide:()=>bG,createDivideScalar:()=>yz,createDot:()=>FH,createDotDivide:()=>bz,createDotMultiply:()=>YL,createDotPow:()=>lG,createE:()=>MR,createEfimovFactor:()=>hP,createEigs:()=>qG,createElectricConstant:()=>VR,createElectronMass:()=>eP,createElementaryCharge:()=>jR,createEqual:()=>$L,createEqualScalar:()=>JI,createEqualText:()=>wz,createErf:()=>$I,createEvaluate:()=>RQ,createExp:()=>aB,createExpm:()=>uG,createExpm1:()=>sB,createFactorial:()=>wG,createFalse:()=>yR,createFaraday:()=>mP,createFermiCoupling:()=>tP,createFft:()=>hG,createFibonacciHeapClass:()=>OH,createFilter:()=>lB,createFilterTransform:()=>uJ,createFineStructure:()=>nP,createFirstRadiation:()=>gP,createFix:()=>zV,createFlatten:()=>hB,createFloor:()=>Cz,createForEach:()=>fB,createForEachTransform:()=>hJ,createFormat:()=>gB,createFraction:()=>tU,createFractionClass:()=>JP,createFreqz:()=>yq,createFunctionAssignmentNode:()=>aQ,createFunctionNode:()=>yQ,createGamma:()=>fG,createGasConstant:()=>yP,createGcd:()=>Fz,createGetMatrixDataType:()=>yB,createGravitationConstant:()=>LR,createGravity:()=>CP,createHartreeEnergy:()=>rP,createHasNumericValue:()=>Iz,createHelp:()=>rJ,createHelpClass:()=>PQ,createHex:()=>xB,createHypot:()=>kz,createI:()=>PR,createIdentity:()=>rU,createIfft:()=>mG,createIm:()=>bB,createImmutableDenseMatrixClass:()=>Lz,createIndex:()=>BH,createIndexClass:()=>Uz,createIndexNode:()=>mQ,createIndexTransform:()=>gJ,createInfinity:()=>bR,createIntersect:()=>SG,createInv:()=>HV,createInverseConductanceQuantum:()=>YR,createInvmod:()=>LH,createIsInteger:()=>wB,createIsNaN:()=>Zk,createIsNegative:()=>AB,createIsNumeric:()=>aU,createIsPositive:()=>NB,createIsPrime:()=>Qk,createIsZero:()=>PB,createKldivergence:()=>WG,createKlitzing:()=>QR,createKron:()=>sU,createLN10:()=>CR,createLN2:()=>ER,createLOG10E:()=>TR,createLOG2E:()=>AR,createLarger:()=>Vz,createLargerEq:()=>cU,createLcm:()=>UH,createLeafCount:()=>GQ,createLeftShift:()=>gU,createLgamma:()=>zB,createLog:()=>Wz,createLog10:()=>jB,createLog1p:()=>HH,createLog2:()=>XB,createLoschmidt:()=>vP,createLsolve:()=>Zz,createLsolveAll:()=>GH,createLup:()=>MG,createLusolve:()=>KG,createLyap:()=>Gq,createMad:()=>bq,createMagneticConstant:()=>HR,createMagneticFluxQuantum:()=>ZR,createMap:()=>ZB,createMapSlices:()=>$k,createMapSlicesTransform:()=>aJ,createMapTransform:()=>dJ,createMatrix:()=>nL,createMatrixClass:()=>$P,createMatrixFromColumns:()=>Qz,createMatrixFromFunction:()=>iL,createMatrixFromRows:()=>jH,createMax:()=>Jz,createMaxTransform:()=>TJ,createMean:()=>$G,createMeanTransform:()=>FJ,createMedian:()=>dq,createMin:()=>$z,createMinTransform:()=>wJ,createMod:()=>Az,createMode:()=>yU,createMolarMass:()=>DP,createMolarMassC12:()=>EP,createMolarPlanckConstant:()=>xP,createMolarVolume:()=>bP,createMultinomial:()=>EG,createMultiply:()=>XH,createMultiplyScalar:()=>KB,createNaN:()=>_R,createNeutronMass:()=>oP,createNode:()=>MK,createNorm:()=>Aq,createNot:()=>nk,createNthRoot:()=>_U,createNthRoots:()=>tH,createNuclearMagneton:()=>KR,createNull:()=>xR,createNumber:()=>rk,createNumeric:()=>DU,createObjectNode:()=>EK,createOct:()=>ik,createOnes:()=>aL,createOperatorNode:()=>HK,createOr:()=>nH,createOrTransform:()=>fJ,createParenthesisNode:()=>GK,createParse:()=>bQ,createParser:()=>WQ,createParserClass:()=>FQ,createPartitionSelect:()=>iH,createPermutations:()=>AG,createPhi:()=>DR,createPi:()=>wR,createPickRandom:()=>ck,createPinv:()=>GV,createPlanckCharge:()=>RP,createPlanckConstant:()=>UR,createPlanckLength:()=>AP,createPlanckMass:()=>TP,createPlanckTemperature:()=>PP,createPlanckTime:()=>NP,createPolynomialRoot:()=>RG,createPow:()=>qV,createPrint:()=>dk,createPrintTransform:()=>yJ,createProd:()=>AU,createProtonMass:()=>iP,createQr:()=>aH,createQuantileSeq:()=>nq,createQuantileSeqTransform:()=>OJ,createQuantumOfCirculation:()=>sP,createRandom:()=>gk,createRandomInt:()=>lL,createRange:()=>ZH,createRangeClass:()=>eF,createRangeNode:()=>tQ,createRangeTransform:()=>NJ,createRationalize:()=>ZQ,createRe:()=>vk,createReducedPlanckConstant:()=>zR,createRelationalNode:()=>jK,createReplacer:()=>JF,createReshape:()=>uL,createResize:()=>NU,createResolve:()=>_Q,createResultSet:()=>tF,createReviver:()=>nQ,createRightArithShift:()=>PU,createRightLogShift:()=>sH,createRotate:()=>kq,createRotationMatrix:()=>Rq,createRound:()=>IU,createRow:()=>KH,createRowTransform:()=>RJ,createRydberg:()=>lP,createSQRT1_2:()=>NR,createSQRT2:()=>RR,createSackurTetrode:()=>_P,createSchur:()=>Oq,createSec:()=>yk,createSech:()=>dL,createSecondRadiation:()=>wP,createSetCartesian:()=>JH,createSetDifference:()=>WV,createSetDistinct:()=>eV,createSetIntersect:()=>FG,createSetIsSubset:()=>nV,createSetMultiplicity:()=>YV,createSetPowerset:()=>iV,createSetSize:()=>vG,createSetSymDifference:()=>KV,createSetUnion:()=>aq,createSign:()=>bk,createSimplify:()=>kQ,createSimplifyConstant:()=>DQ,createSimplifyCore:()=>TQ,createSin:()=>_k,createSinh:()=>pL,createSize:()=>kU,createSlu:()=>vV,createSmaller:()=>UU,createSmallerEq:()=>cH,createSolveODE:()=>IG,createSort:()=>xV,createSpaClass:()=>QV,createSparse:()=>gL,createSparseMatrixClass:()=>wk,createSpeedOfLight:()=>kR,createSplitUnit:()=>Mk,createSqrt:()=>vL,createSqrtm:()=>$V,createSquare:()=>Ek,createSqueeze:()=>xL,createStd:()=>wq,createStdTransform:()=>kJ,createStefanBoltzmann:()=>SP,createStirlingS2:()=>kG,createString:()=>Ak,createSubset:()=>dH,createSubsetTransform:()=>SJ,createSubtract:()=>yH,createSubtractScalar:()=>Nk,createSum:()=>eG,createSumTransform:()=>bJ,createSylvester:()=>zq,createSymbolNode:()=>gQ,createSymbolicEqual:()=>zQ,createTan:()=>Rk,createTanh:()=>bL,createTau:()=>SR,createThomsonCrossSection:()=>cP,createTo:()=>HU,createTrace:()=>xH,createTranspose:()=>wL,createTrue:()=>vR,createTypeOf:()=>Fk,createTyped:()=>eO,createUnaryMinus:()=>GU,createUnaryPlus:()=>_V,createUnequal:()=>jU,createUnitClass:()=>iG,createUnitFunction:()=>UG,createUppercaseE:()=>OR,createUppercasePi:()=>FR,createUsolve:()=>_H,createUsolveAll:()=>SV,createVacuumImpedance:()=>GR,createVariance:()=>cq,createVarianceTransform:()=>BJ,createVersion:()=>IR,createWeakMixingAngle:()=>uP,createWienDisplacement:()=>MP,createXgcd:()=>ML,createXor:()=>XU,createZeros:()=>EL,createZeta:()=>Dq,createZpk2tf:()=>DV});var r={};n.r(r),n.d(r,{AccessorNode:()=>t$,AccessorNodeDependencies:()=>L$,ArgumentsError:()=>TU,ArrayNode:()=>WJ,ArrayNodeDependencies:()=>Z$,AssignmentNode:()=>n$,AssignmentNodeDependencies:()=>e0,BigNumber:()=>qq,BigNumberDependencies:()=>_$,BlockNode:()=>XJ,BlockNodeDependencies:()=>X0,Chain:()=>JJ,ChainDependencies:()=>e1,Complex:()=>jq,ComplexDependencies:()=>w$,ConditionalNode:()=>YJ,ConditionalNodeDependencies:()=>y1,ConstantNode:()=>ZJ,ConstantNodeDependencies:()=>x1,DenseMatrix:()=>hj,DenseMatrixDependencies:()=>M$,DimensionError:()=>fF,EDependencies:()=>Z5,FibonacciHeap:()=>hY,FibonacciHeapDependencies:()=>Y2,Fraction:()=>Zq,FractionDependencies:()=>D$,FunctionAssignmentNode:()=>$J,FunctionAssignmentNodeDependencies:()=>b1,FunctionNode:()=>a$,FunctionNodeDependencies:()=>w1,Help:()=>d$,HelpDependencies:()=>l3,ImmutableDenseMatrix:()=>zX,ImmutableDenseMatrixDependencies:()=>a1,Index:()=>HX,IndexDependencies:()=>s1,IndexError:()=>pF,IndexNode:()=>r$,IndexNodeDependencies:()=>S1,InfinityDependencies:()=>m3,LN10:()=>Jq,LN10Dependencies:()=>T3,LN2:()=>fj,LN2Dependencies:()=>N3,LOG10E:()=>$q,LOG10EDependencies:()=>R3,LOG2E:()=>tW,LOG2EDependencies:()=>P3,Matrix:()=>ej,MatrixDependencies:()=>S$,NaNDependencies:()=>v4,Node:()=>HJ,NodeDependencies:()=>A$,ObjectNode:()=>VJ,ObjectNodeDependencies:()=>M1,OperatorNode:()=>GJ,OperatorNodeDependencies:()=>D1,PIDependencies:()=>K5,ParenthesisNode:()=>qJ,ParenthesisNodeDependencies:()=>E1,Parser:()=>f$,ParserDependencies:()=>C4,Range:()=>ij,RangeDependencies:()=>Z4,RangeNode:()=>KJ,RangeNodeDependencies:()=>C1,RelationalNode:()=>jJ,RelationalNodeDependencies:()=>A1,ResultSet:()=>aj,ResultSetDependencies:()=>W0,SQRT1_2:()=>oj,SQRT1_2Dependencies:()=>l5,SQRT2:()=>gj,SQRT2Dependencies:()=>c5,Spa:()=>VY,SpaDependencies:()=>V3,SparseMatrix:()=>vW,SparseMatrixDependencies:()=>N$,SymbolNode:()=>i$,SymbolNodeDependencies:()=>_1,Unit:()=>jY,UnitDependencies:()=>A0,_Infinity:()=>Qq,_NaN:()=>tj,_false:()=>Xq,_null:()=>nj,_true:()=>cj,abs:()=>xj,absDependencies:()=>C$,acos:()=>bj,acosDependencies:()=>U$,acosh:()=>MW,acoshDependencies:()=>z$,acot:()=>_j,acotDependencies:()=>H$,acoth:()=>ZW,acothDependencies:()=>V$,acsc:()=>wj,acscDependencies:()=>G$,acsch:()=>DW,acschDependencies:()=>q$,add:()=>SX,addDependencies:()=>I$,addScalar:()=>Sj,addScalarDependencies:()=>R$,all:()=>a6,and:()=>NY,andDependencies:()=>W$,andTransformDependencies:()=>X$,apply:()=>OW,arg:()=>Mj,argDependencies:()=>Y$,asec:()=>EW,asecDependencies:()=>K$,asech:()=>Dj,asechDependencies:()=>Q$,asin:()=>KW,asinDependencies:()=>J$,asinh:()=>Ej,asinhDependencies:()=>$$,atan:()=>Cj,atan2:()=>MX,atan2Dependencies:()=>n0,atanDependencies:()=>t0,atanh:()=>Aj,atanhDependencies:()=>r0,atomicMass:()=>YY,atomicMassDependencies:()=>T0,avogadro:()=>RZ,avogadroDependencies:()=>N0,bellNumbers:()=>QZ,bellNumbersDependencies:()=>k0,bigint:()=>Tj,bigintDependencies:()=>L0,bignumber:()=>CW,bignumberDependencies:()=>i0,bin:()=>QW,binDependencies:()=>U0,bitAnd:()=>DX,bitAndDependencies:()=>z0,bitAndTransformDependencies:()=>H0,bitNot:()=>Nj,bitNotDependencies:()=>V0,bitOr:()=>EX,bitOrDependencies:()=>G0,bitOrTransformDependencies:()=>q0,bitXor:()=>CX,bitXorDependencies:()=>j0,bohrMagneton:()=>ZY,bohrMagnetonDependencies:()=>Y0,bohrRadius:()=>PZ,bohrRadiusDependencies:()=>Z0,boltzmann:()=>KY,boltzmannDependencies:()=>K0,boolean:()=>Rj,booleanDependencies:()=>Q0,catalan:()=>aY,catalanDependencies:()=>J0,cbrt:()=>AX,cbrtDependencies:()=>$0,ceil:()=>RY,ceilDependencies:()=>h0,chain:()=>e$,chainDependencies:()=>t1,classicalElectronRadius:()=>cK,classicalElectronRadiusDependencies:()=>n1,clone:()=>Pj,cloneDependencies:()=>r1,column:()=>PY,columnDependencies:()=>d1,columnTransformDependencies:()=>f1,combinations:()=>Fj,combinationsDependencies:()=>P0,combinationsWithRep:()=>AW,combinationsWithRepDependencies:()=>p1,compare:()=>TX,compareDependencies:()=>m1,compareNatural:()=>oY,compareNaturalDependencies:()=>g1,compareText:()=>NX,compareTextDependencies:()=>v1,compile:()=>c$,compileDependencies:()=>N1,complex:()=>Oj,complexDependencies:()=>R1,composition:()=>sY,compositionDependencies:()=>P1,concat:()=>JW,concatDependencies:()=>O$,concatTransformDependencies:()=>F1,conductanceQuantum:()=>QY,conductanceQuantumDependencies:()=>O1,config:()=>UA,conj:()=>Ij,conjDependencies:()=>x0,corr:()=>hK,corrDependencies:()=>z1,cos:()=>Bj,cosDependencies:()=>H1,cosh:()=>TW,coshDependencies:()=>V1,cot:()=>kj,cotDependencies:()=>G1,coth:()=>$W,cothDependencies:()=>q1,coulomb:()=>JY,coulombDependencies:()=>j1,count:()=>RX,countDependencies:()=>X1,create:()=>l6,createAbs:()=>FO,createAccessorNode:()=>hQ,createAcos:()=>IO,createAcosh:()=>Ik,createAcot:()=>eI,createAcoth:()=>AL,createAcsc:()=>nI,createAcsch:()=>kk,createAdd:()=>ZU,createAddScalar:()=>iI,createAnd:()=>EV,createAndTransform:()=>pJ,createArg:()=>aI,createArrayNode:()=>XK,createAsec:()=>Uk,createAsech:()=>sI,createAsin:()=>NL,createAsinh:()=>lI,createAssignmentNode:()=>fQ,createAtan:()=>cI,createAtan2:()=>QU,createAtanh:()=>hI,createAtomicMass:()=>dP,createAvogadro:()=>fP,createBellNumbers:()=>HG,createBigNumberClass:()=>EN,createBigint:()=>dI,createBignumber:()=>zk,createBin:()=>RL,createBitAnd:()=>$U,createBitAndTransform:()=>_J,createBitNot:()=>NI,createBitOr:()=>tz,createBitOrTransform:()=>MJ,createBitXor:()=>rz,createBlockNode:()=>ZK,createBohrMagneton:()=>WR,createBohrRadius:()=>JR,createBoltzmann:()=>pP,createBoolean:()=>PI,createCatalan:()=>SH,createCbrt:()=>az,createCeil:()=>RV,createChain:()=>sQ,createChainClass:()=>rQ,createClassicalElectronRadius:()=>$R,createClone:()=>OI,createColumn:()=>FV,createColumnTransform:()=>PJ,createCombinations:()=>LI,createCombinationsWithRep:()=>Vk,createCompare:()=>lz,createCompareNatural:()=>EH,createCompareText:()=>dz,createCompile:()=>CQ,createComplex:()=>zI,createComplexClass:()=>oR,createComposition:()=>AH,createConcat:()=>FL,createConcatTransform:()=>mJ,createConditionalNode:()=>QK,createConductanceQuantum:()=>XR,createConj:()=>VI,createConstantNode:()=>$K,createCorr:()=>mq,createCos:()=>qI,createCosh:()=>jk,createCot:()=>jI,createCoth:()=>IL,createCoulomb:()=>qR,createCount:()=>pz,createCreateUnit:()=>xG,createCross:()=>IV,createCsc:()=>WI,createCsch:()=>Xk,createCtranspose:()=>kL,createCube:()=>YI,createCumSum:()=>oG,createCumSumTransform:()=>EJ,createDeepEqual:()=>gz,createDenseMatrixClass:()=>QF,createDerivative:()=>JQ,createDet:()=>BV,createDeuteronMass:()=>aP,createDiag:()=>UL,createDiff:()=>NH,createDiffTransform:()=>AJ,createDistance:()=>PH,createDivide:()=>bG,createDivideScalar:()=>yz,createDot:()=>FH,createDotDivide:()=>bz,createDotMultiply:()=>YL,createDotPow:()=>lG,createE:()=>MR,createEfimovFactor:()=>hP,createEigs:()=>qG,createElectricConstant:()=>VR,createElectronMass:()=>eP,createElementaryCharge:()=>jR,createEqual:()=>$L,createEqualScalar:()=>JI,createEqualText:()=>wz,createErf:()=>$I,createEvaluate:()=>RQ,createExp:()=>aB,createExpm:()=>uG,createExpm1:()=>sB,createFactorial:()=>wG,createFalse:()=>yR,createFaraday:()=>mP,createFermiCoupling:()=>tP,createFft:()=>hG,createFibonacciHeapClass:()=>OH,createFilter:()=>lB,createFilterTransform:()=>uJ,createFineStructure:()=>nP,createFirstRadiation:()=>gP,createFix:()=>zV,createFlatten:()=>hB,createFloor:()=>Cz,createForEach:()=>fB,createForEachTransform:()=>hJ,createFormat:()=>gB,createFraction:()=>tU,createFractionClass:()=>JP,createFreqz:()=>yq,createFunctionAssignmentNode:()=>aQ,createFunctionNode:()=>yQ,createGamma:()=>fG,createGasConstant:()=>yP,createGcd:()=>Fz,createGetMatrixDataType:()=>yB,createGravitationConstant:()=>LR,createGravity:()=>CP,createHartreeEnergy:()=>rP,createHasNumericValue:()=>Iz,createHelp:()=>rJ,createHelpClass:()=>PQ,createHex:()=>xB,createHypot:()=>kz,createI:()=>PR,createIdentity:()=>rU,createIfft:()=>mG,createIm:()=>bB,createImmutableDenseMatrixClass:()=>Lz,createIndex:()=>BH,createIndexClass:()=>Uz,createIndexNode:()=>mQ,createIndexTransform:()=>gJ,createInfinity:()=>bR,createIntersect:()=>SG,createInv:()=>HV,createInverseConductanceQuantum:()=>YR,createInvmod:()=>LH,createIsInteger:()=>wB,createIsNaN:()=>Zk,createIsNegative:()=>AB,createIsNumeric:()=>aU,createIsPositive:()=>NB,createIsPrime:()=>Qk,createIsZero:()=>PB,createKldivergence:()=>WG,createKlitzing:()=>QR,createKron:()=>sU,createLN10:()=>CR,createLN2:()=>ER,createLOG10E:()=>TR,createLOG2E:()=>AR,createLarger:()=>Vz,createLargerEq:()=>cU,createLcm:()=>UH,createLeafCount:()=>GQ,createLeftShift:()=>gU,createLgamma:()=>zB,createLog:()=>Wz,createLog10:()=>jB,createLog1p:()=>HH,createLog2:()=>XB,createLoschmidt:()=>vP,createLsolve:()=>Zz,createLsolveAll:()=>GH,createLup:()=>MG,createLusolve:()=>KG,createLyap:()=>Gq,createMad:()=>bq,createMagneticConstant:()=>HR,createMagneticFluxQuantum:()=>ZR,createMap:()=>ZB,createMapSlices:()=>$k,createMapSlicesTransform:()=>aJ,createMapTransform:()=>dJ,createMatrix:()=>nL,createMatrixClass:()=>$P,createMatrixFromColumns:()=>Qz,createMatrixFromFunction:()=>iL,createMatrixFromRows:()=>jH,createMax:()=>Jz,createMaxTransform:()=>TJ,createMean:()=>$G,createMeanTransform:()=>FJ,createMedian:()=>dq,createMin:()=>$z,createMinTransform:()=>wJ,createMod:()=>Az,createMode:()=>yU,createMolarMass:()=>DP,createMolarMassC12:()=>EP,createMolarPlanckConstant:()=>xP,createMolarVolume:()=>bP,createMultinomial:()=>EG,createMultiply:()=>XH,createMultiplyScalar:()=>KB,createNaN:()=>_R,createNeutronMass:()=>oP,createNode:()=>MK,createNorm:()=>Aq,createNot:()=>nk,createNthRoot:()=>_U,createNthRoots:()=>tH,createNuclearMagneton:()=>KR,createNull:()=>xR,createNumber:()=>rk,createNumeric:()=>DU,createObjectNode:()=>EK,createOct:()=>ik,createOnes:()=>aL,createOperatorNode:()=>HK,createOr:()=>nH,createOrTransform:()=>fJ,createParenthesisNode:()=>GK,createParse:()=>bQ,createParser:()=>WQ,createParserClass:()=>FQ,createPartitionSelect:()=>iH,createPermutations:()=>AG,createPhi:()=>DR,createPi:()=>wR,createPickRandom:()=>ck,createPinv:()=>GV,createPlanckCharge:()=>RP,createPlanckConstant:()=>UR,createPlanckLength:()=>AP,createPlanckMass:()=>TP,createPlanckTemperature:()=>PP,createPlanckTime:()=>NP,createPolynomialRoot:()=>RG,createPow:()=>qV,createPrint:()=>dk,createPrintTransform:()=>yJ,createProd:()=>AU,createProtonMass:()=>iP,createQr:()=>aH,createQuantileSeq:()=>nq,createQuantileSeqTransform:()=>OJ,createQuantumOfCirculation:()=>sP,createRandom:()=>gk,createRandomInt:()=>lL,createRange:()=>ZH,createRangeClass:()=>eF,createRangeNode:()=>tQ,createRangeTransform:()=>NJ,createRationalize:()=>ZQ,createRe:()=>vk,createReducedPlanckConstant:()=>zR,createRelationalNode:()=>jK,createReplacer:()=>JF,createReshape:()=>uL,createResize:()=>NU,createResolve:()=>_Q,createResultSet:()=>tF,createReviver:()=>nQ,createRightArithShift:()=>PU,createRightLogShift:()=>sH,createRotate:()=>kq,createRotationMatrix:()=>Rq,createRound:()=>IU,createRow:()=>KH,createRowTransform:()=>RJ,createRydberg:()=>lP,createSQRT1_2:()=>NR,createSQRT2:()=>RR,createSackurTetrode:()=>_P,createSchur:()=>Oq,createSec:()=>yk,createSech:()=>dL,createSecondRadiation:()=>wP,createSetCartesian:()=>JH,createSetDifference:()=>WV,createSetDistinct:()=>eV,createSetIntersect:()=>FG,createSetIsSubset:()=>nV,createSetMultiplicity:()=>YV,createSetPowerset:()=>iV,createSetSize:()=>vG,createSetSymDifference:()=>KV,createSetUnion:()=>aq,createSign:()=>bk,createSimplify:()=>kQ,createSimplifyConstant:()=>DQ,createSimplifyCore:()=>TQ,createSin:()=>_k,createSinh:()=>pL,createSize:()=>kU,createSlu:()=>vV,createSmaller:()=>UU,createSmallerEq:()=>cH,createSolveODE:()=>IG,createSort:()=>xV,createSpaClass:()=>QV,createSparse:()=>gL,createSparseMatrixClass:()=>wk,createSpeedOfLight:()=>kR,createSplitUnit:()=>Mk,createSqrt:()=>vL,createSqrtm:()=>$V,createSquare:()=>Ek,createSqueeze:()=>xL,createStd:()=>wq,createStdTransform:()=>kJ,createStefanBoltzmann:()=>SP,createStirlingS2:()=>kG,createString:()=>Ak,createSubset:()=>dH,createSubsetTransform:()=>SJ,createSubtract:()=>yH,createSubtractScalar:()=>Nk,createSum:()=>eG,createSumTransform:()=>bJ,createSylvester:()=>zq,createSymbolNode:()=>gQ,createSymbolicEqual:()=>zQ,createTan:()=>Rk,createTanh:()=>bL,createTau:()=>SR,createThomsonCrossSection:()=>cP,createTo:()=>HU,createTrace:()=>xH,createTranspose:()=>wL,createTrue:()=>vR,createTypeOf:()=>Fk,createTyped:()=>eO,createUnaryMinus:()=>GU,createUnaryPlus:()=>_V,createUnequal:()=>jU,createUnit:()=>FZ,createUnitClass:()=>iG,createUnitDependencies:()=>Y1,createUnitFunction:()=>UG,createUppercaseE:()=>OR,createUppercasePi:()=>FR,createUsolve:()=>_H,createUsolveAll:()=>SV,createVacuumImpedance:()=>GR,createVariance:()=>cq,createVarianceTransform:()=>BJ,createVersion:()=>IR,createWeakMixingAngle:()=>uP,createWienDisplacement:()=>MP,createXgcd:()=>ML,createXor:()=>XU,createZeros:()=>EL,createZeta:()=>Dq,createZpk2tf:()=>DV,cross:()=>FY,crossDependencies:()=>Z1,csc:()=>Lj,cscDependencies:()=>K1,csch:()=>NW,cschDependencies:()=>Q1,ctranspose:()=>eX,ctransposeDependencies:()=>$1,cube:()=>Uj,cubeDependencies:()=>e2,cumsum:()=>$Y,cumsumDependencies:()=>n2,cumsumTransformDependencies:()=>r2,deepEqual:()=>PX,deepEqualDependencies:()=>i2,derivative:()=>x$,derivativeDependencies:()=>u2,det:()=>OY,detDependencies:()=>D0,deuteronMass:()=>eZ,deuteronMassDependencies:()=>h2,diag:()=>tX,diagDependencies:()=>d2,diff:()=>lY,diffDependencies:()=>f2,diffTransformDependencies:()=>p2,distance:()=>cY,distanceDependencies:()=>m2,divide:()=>OZ,divideDependencies:()=>I1,divideScalar:()=>FX,divideScalarDependencies:()=>l0,docs:()=>tJ,dot:()=>uY,dotDependencies:()=>_0,dotDivide:()=>OX,dotDivideDependencies:()=>g2,dotMultiply:()=>nX,dotMultiplyDependencies:()=>v2,dotPow:()=>tZ,dotPowDependencies:()=>y2,e:()=>Wq,eDependencies:()=>x2,efimovFactor:()=>dj,efimovFactorDependencies:()=>b2,eigs:()=>JZ,eigsDependencies:()=>R2,electricConstant:()=>nZ,electricConstantDependencies:()=>P2,electronMass:()=>IZ,electronMassDependencies:()=>F2,elementaryCharge:()=>rZ,elementaryChargeDependencies:()=>O2,equal:()=>rX,equalDependencies:()=>c0,equalScalar:()=>zj,equalScalarDependencies:()=>T$,equalText:()=>IX,equalTextDependencies:()=>I2,erf:()=>Hj,erfDependencies:()=>B2,evaluate:()=>h$,evaluateDependencies:()=>k2,exp:()=>Vj,expDependencies:()=>L2,expm:()=>iZ,expm1:()=>Gj,expm1Dependencies:()=>z2,expmDependencies:()=>U2,factorial:()=>BZ,factorialDependencies:()=>O0,factory:()=>SN,falseDependencies:()=>H2,faraday:()=>aZ,faradayDependencies:()=>V2,fermiCoupling:()=>$Z,fermiCouplingDependencies:()=>G2,fft:()=>oZ,fftDependencies:()=>X2,filter:()=>qj,filterDependencies:()=>Z2,filterTransformDependencies:()=>K2,fineStructure:()=>Yq,fineStructureDependencies:()=>Q2,firstRadiation:()=>kZ,firstRadiationDependencies:()=>J2,fix:()=>IY,fixDependencies:()=>f0,flatten:()=>jj,flattenDependencies:()=>_2,floor:()=>BX,floorDependencies:()=>d0,forEach:()=>Wj,forEachDependencies:()=>$2,forEachTransformDependencies:()=>e3,format:()=>Xj,formatDependencies:()=>p0,fraction:()=>iX,fractionDependencies:()=>a0,freqz:()=>dK,freqzDependencies:()=>t3,gamma:()=>sZ,gammaDependencies:()=>F0,gasConstant:()=>eK,gasConstantDependencies:()=>n3,gcd:()=>kX,gcdDependencies:()=>r3,getMatrixDataType:()=>Yj,getMatrixDataTypeDependencies:()=>o1,gravitationConstant:()=>lZ,gravitationConstantDependencies:()=>i3,gravity:()=>LZ,gravityDependencies:()=>a3,hartreeEnergy:()=>cZ,hartreeEnergyDependencies:()=>o3,hasNumericValue:()=>LX,hasNumericValueDependencies:()=>s3,help:()=>b$,helpDependencies:()=>c3,hex:()=>Zj,hexDependencies:()=>u3,hypot:()=>UX,hypotDependencies:()=>h3,i:()=>Kq,iDependencies:()=>q2,identity:()=>aX,identityDependencies:()=>v0,ifft:()=>uZ,ifftDependencies:()=>d3,im:()=>Kj,imDependencies:()=>w2,index:()=>dY,indexDependencies:()=>f3,indexTransformDependencies:()=>p3,intersect:()=>UZ,intersectDependencies:()=>g3,inv:()=>BY,invDependencies:()=>E0,inverseConductanceQuantum:()=>hZ,inverseConductanceQuantumDependencies:()=>v3,invmod:()=>fY,invmodDependencies:()=>b3,isAccessorNode:()=>lA,isArray:()=>GC,isArrayNode:()=>cA,isAssignmentNode:()=>uA,isBigInt:()=>LC,isBigNumber:()=>kC,isBlockNode:()=>hA,isBoolean:()=>KC,isChain:()=>DA,isCollection:()=>jC,isComplex:()=>UC,isConditionalNode:()=>dA,isConstantNode:()=>fA,isDate:()=>eA,isDenseMatrix:()=>WC,isFraction:()=>zC,isFunction:()=>$C,isFunctionAssignmentNode:()=>mA,isFunctionNode:()=>gA,isHelp:()=>JC,isIndex:()=>ZC,isIndexNode:()=>vA,isInteger:()=>Qj,isIntegerDependencies:()=>P$,isMap:()=>rA,isMatrix:()=>qC,isNaN:()=>RW,isNaNDependencies:()=>_3,isNegative:()=>Jj,isNegativeDependencies:()=>R0,isNode:()=>yA,isNull:()=>oA,isNumber:()=>BC,isNumeric:()=>oX,isNumericDependencies:()=>m0,isObject:()=>nA,isObjectNode:()=>xA,isObjectWrappingMap:()=>aA,isOperatorNode:()=>bA,isParenthesisNode:()=>_A,isPartitionedMap:()=>iA,isPositive:()=>$j,isPositiveDependencies:()=>l1,isPrime:()=>PW,isPrimeDependencies:()=>w3,isRange:()=>YC,isRangeNode:()=>wA,isRegExp:()=>tA,isRelationalNode:()=>SA,isResultSet:()=>QC,isSparseMatrix:()=>XC,isString:()=>VC,isSymbolNode:()=>MA,isUndefined:()=>sA,isUnit:()=>HC,isZero:()=>eW,isZeroDependencies:()=>y0,kldivergence:()=>tK,kldivergenceDependencies:()=>E3,klitzing:()=>dZ,klitzingDependencies:()=>C3,kron:()=>sX,kronDependencies:()=>A3,larger:()=>VX,largerDependencies:()=>I0,largerEq:()=>lX,largerEqDependencies:()=>c1,lcm:()=>pY,lcmDependencies:()=>F3,leafCount:()=>g$,leafCountDependencies:()=>O3,leftShift:()=>cX,leftShiftDependencies:()=>I3,lgamma:()=>nW,lgammaDependencies:()=>B3,log:()=>GX,log10:()=>rW,log10Dependencies:()=>k3,log1p:()=>mY,log1pDependencies:()=>L3,log2:()=>iW,log2Dependencies:()=>j2,logDependencies:()=>M3,loschmidt:()=>fZ,loschmidtDependencies:()=>U3,lsolve:()=>qX,lsolveAll:()=>gY,lsolveAllDependencies:()=>H3,lsolveDependencies:()=>z3,lup:()=>zZ,lupDependencies:()=>G3,lusolve:()=>nK,lusolveDependencies:()=>j3,lyap:()=>wK,lyapDependencies:()=>Z3,mad:()=>fK,madDependencies:()=>J3,magneticConstant:()=>pZ,magneticConstantDependencies:()=>$3,magneticFluxQuantum:()=>HZ,magneticFluxQuantumDependencies:()=>e4,map:()=>aW,mapDependencies:()=>D3,mapSlices:()=>FW,mapSlicesDependencies:()=>t4,mapSlicesTransformDependencies:()=>n4,mapTransformDependencies:()=>r4,matrix:()=>IW,matrixDependencies:()=>F$,matrixFromColumns:()=>jX,matrixFromColumnsDependencies:()=>S2,matrixFromFunction:()=>BW,matrixFromFunctionDependencies:()=>i4,matrixFromRows:()=>vY,matrixFromRowsDependencies:()=>a4,max:()=>WX,maxDependencies:()=>o4,maxTransformDependencies:()=>s4,mean:()=>rK,meanDependencies:()=>B1,meanTransformDependencies:()=>l4,median:()=>uK,medianDependencies:()=>Q3,min:()=>XX,minDependencies:()=>c4,minTransformDependencies:()=>u4,mod:()=>YX,modDependencies:()=>y3,mode:()=>uX,modeDependencies:()=>h4,molarMass:()=>mZ,molarMassC12:()=>VZ,molarMassC12Dependencies:()=>f4,molarMassDependencies:()=>d4,molarPlanckConstant:()=>gZ,molarPlanckConstantDependencies:()=>p4,molarVolume:()=>iK,molarVolumeDependencies:()=>m4,multinomial:()=>GZ,multinomialDependencies:()=>g4,multiply:()=>yY,multiplyDependencies:()=>w0,multiplyScalar:()=>oW,multiplyScalarDependencies:()=>g0,neutronMass:()=>vZ,neutronMassDependencies:()=>y4,norm:()=>gK,normDependencies:()=>W3,not:()=>sW,notDependencies:()=>j$,nthRoot:()=>hX,nthRootDependencies:()=>x4,nthRoots:()=>ZX,nthRootsDependencies:()=>b4,nuclearMagneton:()=>yZ,nuclearMagnetonDependencies:()=>_4,nullDependencies:()=>w4,number:()=>lW,numberDependencies:()=>o0,numeric:()=>dX,numericDependencies:()=>s0,oct:()=>cW,octDependencies:()=>S4,ones:()=>kW,onesDependencies:()=>M4,or:()=>KX,orDependencies:()=>D4,orTransformDependencies:()=>E4,parse:()=>o$,parseDependencies:()=>T1,parser:()=>v$,parserDependencies:()=>A4,partitionSelect:()=>QX,partitionSelectDependencies:()=>K3,permutations:()=>qZ,permutationsDependencies:()=>T4,phi:()=>rj,phiDependencies:()=>N4,pi:()=>pj,piDependencies:()=>R4,pickRandom:()=>uW,pickRandomDependencies:()=>P4,pinv:()=>kY,pinvDependencies:()=>F4,planckCharge:()=>xZ,planckChargeDependencies:()=>O4,planckConstant:()=>aK,planckConstantDependencies:()=>I4,planckLength:()=>bZ,planckLengthDependencies:()=>B4,planckMass:()=>jZ,planckMassDependencies:()=>k4,planckTemperature:()=>_Z,planckTemperatureDependencies:()=>L4,planckTime:()=>yK,planckTimeDependencies:()=>U4,polynomialRoot:()=>WZ,polynomialRootDependencies:()=>z4,pow:()=>LY,powDependencies:()=>C0,print:()=>hW,printDependencies:()=>H4,printTransformDependencies:()=>V4,prod:()=>fX,prodDependencies:()=>W1,protonMass:()=>wZ,protonMassDependencies:()=>G4,qr:()=>JX,qrDependencies:()=>D2,quantileSeq:()=>oK,quantileSeqDependencies:()=>q4,quantileSeqTransformDependencies:()=>j4,quantumOfCirculation:()=>SZ,quantumOfCirculationDependencies:()=>W4,random:()=>dW,randomDependencies:()=>X4,randomInt:()=>LW,randomIntDependencies:()=>Y4,range:()=>xY,rangeDependencies:()=>h1,rangeTransformDependencies:()=>K4,rationalize:()=>y$,rationalizeDependencies:()=>Q4,re:()=>fW,reDependencies:()=>E2,reducedPlanckConstant:()=>MZ,reducedPlanckConstantDependencies:()=>J4,replacer:()=>mj,replacerDependencies:()=>a2,reshape:()=>UW,reshapeDependencies:()=>C2,resize:()=>pX,resizeDependencies:()=>$4,resolve:()=>s$,resolveDependencies:()=>o2,reviver:()=>QJ,reviverDependencies:()=>e5,rightArithShift:()=>mX,rightArithShiftDependencies:()=>t5,rightLogShift:()=>$X,rightLogShiftDependencies:()=>n5,rotate:()=>bK,rotateDependencies:()=>i5,rotationMatrix:()=>vK,rotationMatrixDependencies:()=>r5,round:()=>gX,roundDependencies:()=>u0,row:()=>bY,rowDependencies:()=>a5,rowTransformDependencies:()=>o5,rydberg:()=>DZ,rydbergDependencies:()=>s5,sackurTetrode:()=>sj,sackurTetrodeDependencies:()=>u5,schur:()=>xK,schurDependencies:()=>X3,sec:()=>pW,secDependencies:()=>h5,sech:()=>zW,sechDependencies:()=>d5,secondRadiation:()=>EZ,secondRadiationDependencies:()=>f5,setCartesian:()=>_Y,setCartesianDependencies:()=>p5,setDifference:()=>UY,setDifferenceDependencies:()=>m5,setDistinct:()=>wY,setDistinctDependencies:()=>g5,setIntersect:()=>XZ,setIntersectDependencies:()=>v5,setIsSubset:()=>SY,setIsSubsetDependencies:()=>y5,setMultiplicity:()=>zY,setMultiplicityDependencies:()=>x5,setPowerset:()=>MY,setPowersetDependencies:()=>b5,setSize:()=>CZ,setSizeDependencies:()=>_5,setSymDifference:()=>HY,setSymDifferenceDependencies:()=>w5,setUnion:()=>sK,setUnionDependencies:()=>S5,sign:()=>mW,signDependencies:()=>M2,simplify:()=>p$,simplifyConstant:()=>l$,simplifyConstantDependencies:()=>s2,simplifyCore:()=>u$,simplifyCoreDependencies:()=>l2,simplifyDependencies:()=>c2,sin:()=>gW,sinDependencies:()=>A2,sinh:()=>HW,sinhDependencies:()=>M5,size:()=>vX,sizeDependencies:()=>b0,slu:()=>DY,sluDependencies:()=>q3,smaller:()=>yX,smallerDependencies:()=>i1,smallerEq:()=>eY,smallerEqDependencies:()=>u1,solveODE:()=>YZ,solveODEDependencies:()=>D5,sort:()=>EY,sortDependencies:()=>E5,sparse:()=>VW,sparseDependencies:()=>C5,speedOfLight:()=>AZ,speedOfLightDependencies:()=>A5,splitUnit:()=>yW,splitUnitDependencies:()=>T5,sqrt:()=>GW,sqrtDependencies:()=>k1,sqrtm:()=>GY,sqrtmDependencies:()=>N5,square:()=>xW,squareDependencies:()=>R5,squeeze:()=>qW,squeezeDependencies:()=>P5,std:()=>pK,stdDependencies:()=>O5,stdTransformDependencies:()=>I5,stefanBoltzmann:()=>TZ,stefanBoltzmannDependencies:()=>B5,stirlingS2:()=>ZZ,stirlingS2Dependencies:()=>B0,string:()=>bW,stringDependencies:()=>k5,subset:()=>tY,subsetDependencies:()=>k$,subsetTransformDependencies:()=>L5,subtract:()=>nY,subtractDependencies:()=>L1,subtractScalar:()=>_W,subtractScalarDependencies:()=>S0,sum:()=>qY,sumDependencies:()=>U1,sumTransformDependencies:()=>U5,sylvester:()=>_K,sylvesterDependencies:()=>Y3,symbolicEqual:()=>m$,symbolicEqualDependencies:()=>z5,tan:()=>wW,tanDependencies:()=>H5,tanh:()=>jW,tanhDependencies:()=>V5,tau:()=>lj,tauDependencies:()=>W2,thomsonCrossSection:()=>NZ,thomsonCrossSectionDependencies:()=>G5,to:()=>xX,toDependencies:()=>q5,trace:()=>rY,traceDependencies:()=>j5,transpose:()=>WW,transposeDependencies:()=>J1,trueDependencies:()=>W5,typeOf:()=>SW,typeOfDependencies:()=>S3,typed:()=>vj,typedDependencies:()=>E$,unaryMinus:()=>bX,unaryMinusDependencies:()=>M0,unaryPlus:()=>CY,unaryPlusDependencies:()=>t2,unequal:()=>_X,unequalDependencies:()=>X5,unit:()=>KZ,unitDependencies:()=>Y5,usolve:()=>iY,usolveAll:()=>AY,usolveAllDependencies:()=>N2,usolveDependencies:()=>T2,vacuumImpedance:()=>WY,vacuumImpedanceDependencies:()=>Q5,variance:()=>lK,varianceDependencies:()=>F5,varianceTransformDependencies:()=>J5,version:()=>uj,versionDependencies:()=>$5,weakMixingAngle:()=>yj,weakMixingAngleDependencies:()=>e6,wienDisplacement:()=>XY,wienDisplacementDependencies:()=>t6,xgcd:()=>XW,xgcdDependencies:()=>x3,xor:()=>wX,xorDependencies:()=>n6,zeros:()=>YW,zerosDependencies:()=>B$,zeta:()=>mK,zetaDependencies:()=>r6,zpk2tf:()=>TY,zpk2tfDependencies:()=>i6});var i=n(9408);const a=1,o=2,s=4,l=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,SCREEN_PAN:4,OFFSET:8,DOLLY:16,ZOOM:32,TOUCH_ROTATE:64,TOUCH_TRUCK:128,TOUCH_SCREEN_PAN:256,TOUCH_OFFSET:512,TOUCH_DOLLY:1024,TOUCH_ZOOM:2048,TOUCH_DOLLY_TRUCK:4096,TOUCH_DOLLY_SCREEN_PAN:8192,TOUCH_DOLLY_OFFSET:16384,TOUCH_DOLLY_ROTATE:32768,TOUCH_ZOOM_TRUCK:65536,TOUCH_ZOOM_OFFSET:131072,TOUCH_ZOOM_SCREEN_PAN:262144,TOUCH_ZOOM_ROTATE:524288}),c=0,u=1,h=-1;function d(e){return e.isPerspectiveCamera}function f(e){return e.isOrthographicCamera}const p=2*Math.PI,m=Math.PI/2,g=1e-5,v=Math.PI/180;function y(e,t,n){return Math.max(t,Math.min(n,e))}function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g;return Math.abs(e)<t}function b(e,t){return x(e-t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:g)}function _(e,t){return Math.round(e/t)*t}function w(e){return isFinite(e)?e:e<0?-Number.MAX_VALUE:Number.MAX_VALUE}function S(e){return Math.abs(e)<Number.MAX_VALUE?e:e*(1/0)}function M(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,a=arguments.length>5?arguments[5]:void 0;const o=2/(r=Math.max(1e-4,r)),s=o*a,l=1/(1+s+.48*s*s+.235*s*s*s);let c=e-t;const u=t,h=i*r;c=y(c,-h,h),t=e-c;const d=(n.value+o*c)*a;n.value=(n.value-o*d)*l;let f=t+(c+d)*l;return u-e>0===f>u&&(f=u,n.value=(f-u)/a),f}function D(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,a=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;const s=2/(r=Math.max(1e-4,r)),l=s*a,c=1/(1+l+.48*l*l+.235*l*l*l);let u=t.x,h=t.y,d=t.z,f=e.x-u,p=e.y-h,m=e.z-d;const g=u,v=h,y=d,x=i*r,b=f*f+p*p+m*m;if(b>x*x){const e=Math.sqrt(b);f=f/e*x,p=p/e*x,m=m/e*x}u=e.x-f,h=e.y-p,d=e.z-m;const _=(n.x+s*f)*a,w=(n.y+s*p)*a,S=(n.z+s*m)*a;n.x=(n.x-s*_)*c,n.y=(n.y-s*w)*c,n.z=(n.z-s*S)*c,o.x=u+(f+_)*c,o.y=h+(p+w)*c,o.z=d+(m+S)*c;const M=g-e.x,D=v-e.y,E=y-e.z;return M*(o.x-g)+D*(o.y-v)+E*(o.z-y)>0&&(o.x=g,o.y=v,o.z=y,n.x=(o.x-g)/a,n.y=(o.y-v)/a,n.z=(o.z-y)/a),o}function E(e,t){t.set(0,0),e.forEach((e=>{t.x+=e.clientX,t.y+=e.clientY})),t.x/=e.length,t.y/=e.length}function C(e,t){return!!f(e)&&(console.warn("".concat(t," is not supported in OrthographicCamera")),!0)}class A{constructor(){this._listeners={}}addEventListener(e,t){const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}removeAllEventListeners(e){e?Array.isArray(this._listeners[e])&&(this._listeners[e].length=0):this._listeners={}}dispatchEvent(e){const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e)}}}var T;const N=1/8,R=/Mac/.test(null===(T=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===T?void 0:T.platform);let P,F,O,I,B,k,L,U,z,H,V,G,q,j,W,X,Y,Z,K,Q,J,$,ee;class te extends A{static install(e){P=e.THREE,F=Object.freeze(new P.Vector3(0,0,0)),O=Object.freeze(new P.Vector3(0,1,0)),I=Object.freeze(new P.Vector3(0,0,1)),B=new P.Vector2,k=new P.Vector3,L=new P.Vector3,U=new P.Vector3,z=new P.Vector3,H=new P.Vector3,V=new P.Vector3,G=new P.Vector3,q=new P.Vector3,j=new P.Vector3,W=new P.Spherical,X=new P.Spherical,Y=new P.Box3,Z=new P.Box3,K=new P.Sphere,Q=new P.Quaternion,J=new P.Quaternion,$=new P.Matrix4,ee=new P.Raycaster}static get ACTION(){return l}set verticalDragToForward(e){console.warn("camera-controls: `verticalDragToForward` was removed. Use `mouseButtons.left = CameraControls.ACTION.SCREEN_PAN` instead.")}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=l.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=c,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new P.Vector3,this._focalOffsetVelocity=new P.Vector3,this._zoomVelocity={value:0},this._truckInternal=(e,t,n,r)=>{let i,a;if(d(this._camera)){const n=k.copy(this._camera.position).sub(this._target),r=this._camera.getEffectiveFOV()*v,o=n.length()*Math.tan(.5*r);i=this.truckSpeed*e*o/this._elementRect.height,a=this.truckSpeed*t*o/this._elementRect.height}else{if(!f(this._camera))return;{const n=this._camera;i=this.truckSpeed*e*(n.right-n.left)/n.zoom/this._elementRect.width,a=this.truckSpeed*t*(n.top-n.bottom)/n.zoom/this._elementRect.height}}r?(n?this.setFocalOffset(this._focalOffsetEnd.x+i,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(i,0,!0),this.forward(-a,!0)):n?this.setFocalOffset(this._focalOffsetEnd.x+i,this._focalOffsetEnd.y+a,this._focalOffsetEnd.z,!0):this.truck(i,a,!0)},this._rotateInternal=(e,t)=>{const n=p*this.azimuthRotateSpeed*e/this._elementRect.height,r=p*this.polarRotateSpeed*t/this._elementRect.height;this.rotate(n,r,!0)},this._dollyInternal=(e,t,n)=>{const r=Math.pow(.95,-e*this.dollySpeed),i=this._sphericalEnd.radius,a=this._sphericalEnd.radius*r,o=y(a,this.minDistance,this.maxDistance),s=o-a;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(a,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(s,!0),this._dollyToNoClamp(o,!0)):this._dollyToNoClamp(o,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?a:o)-i,this._dollyControlCoord.set(t,n)),this._lastDollyDirection=Math.sign(-e)},this._zoomInternal=(e,t,n)=>{const r=Math.pow(.95,e*this.dollySpeed),i=this._zoom,a=this._zoom*r;this.zoomTo(a,!0),this.dollyToCursor&&(this._changedZoom+=a-i,this._dollyControlCoord.set(t,n))},"undefined"===typeof P&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=(new P.Quaternion).setFromUnitVectors(this._camera.up,O),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=l.NONE,this._target=new P.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new P.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=(new P.Spherical).setFromVector3(k.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new P.Vector3,new P.Vector3,new P.Vector3,new P.Vector3],this._updateNearPlaneCorners(),this._boundary=new P.Box3(new P.Vector3(-1/0,-1/0,-1/0),new P.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new P.Vector2,this.mouseButtons={left:l.ROTATE,middle:l.DOLLY,right:l.TRUCK,wheel:d(this._camera)?l.DOLLY:f(this._camera)?l.ZOOM:l.NONE},this.touches={one:l.TOUCH_ROTATE,two:d(this._camera)?l.TOUCH_DOLLY_TRUCK:f(this._camera)?l.TOUCH_ZOOM_TRUCK:l.NONE,three:l.TOUCH_TRUCK};const n=new P.Vector2,r=new P.Vector2,i=new P.Vector2,u=e=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const t=this._domElement.getBoundingClientRect(),n=e.clientX/t.width,r=e.clientY/t.height;if(n<this._interactiveArea.left||n>this._interactiveArea.right||r<this._interactiveArea.top||r>this._interactiveArea.bottom)return}const t="mouse"!==e.pointerType?null:(e.buttons&a)===a?a:(e.buttons&s)===s?s:(e.buttons&o)===o?o:null;if(null!==t){const e=this._findPointerByMouseButton(t);e&&this._disposePointer(e)}if((e.buttons&a)===a&&this._lockedPointer)return;const n={pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0,mouseButton:t};this._activePointers.push(n),this._domElement.ownerDocument.removeEventListener("pointermove",h,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",m),this._domElement.ownerDocument.addEventListener("pointermove",h,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",m),this._isDragging=!0,_(e)},h=e=>{e.cancelable&&e.preventDefault();const t=e.pointerId,n=this._lockedPointer||this._findPointerById(t);if(n){if(n.clientX=e.clientX,n.clientY=e.clientY,n.deltaX=e.movementX,n.deltaY=e.movementY,this._state=0,"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(e.buttons&a)===a)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(e.buttons&s)===s&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(e.buttons&o)===o&&(this._state=this._state|this.mouseButtons.right);w()}},m=e=>{const t=this._findPointerById(e.pointerId);if(!t||t!==this._lockedPointer){if(t&&this._disposePointer(t),"touch"===e.pointerType)switch(this._activePointers.length){case 0:this._state=l.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=l.NONE;S()}};let g=-1;const x=e=>{if(!this._domElement)return;if(!this._enabled||this.mouseButtons.wheel===l.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const t=this._domElement.getBoundingClientRect(),n=e.clientX/t.width,r=e.clientY/t.height;if(n<this._interactiveArea.left||n>this._interactiveArea.right||r<this._interactiveArea.top||r>this._interactiveArea.bottom)return}if(e.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===l.ROTATE||this.mouseButtons.wheel===l.TRUCK){const e=performance.now();g-e<1e3&&this._getClientRect(this._elementRect),g=e}const t=R?-1:-3,n=1===e.deltaMode||e.ctrlKey?e.deltaY/t:e.deltaY/(10*t),r=this.dollyToCursor?(e.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,i=this.dollyToCursor?(e.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case l.ROTATE:this._rotateInternal(e.deltaX,e.deltaY),this._isUserControllingRotate=!0;break;case l.TRUCK:this._truckInternal(e.deltaX,e.deltaY,!1,!1),this._isUserControllingTruck=!0;break;case l.SCREEN_PAN:this._truckInternal(e.deltaX,e.deltaY,!1,!0),this._isUserControllingTruck=!0;break;case l.OFFSET:this._truckInternal(e.deltaX,e.deltaY,!0,!1),this._isUserControllingOffset=!0;break;case l.DOLLY:this._dollyInternal(-n,r,i),this._isUserControllingDolly=!0;break;case l.ZOOM:this._zoomInternal(-n,r,i),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},b=e=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===te.ACTION.NONE){const t=e instanceof PointerEvent?e.pointerId:0,n=this._findPointerById(t);return n&&this._disposePointer(n),this._domElement.ownerDocument.removeEventListener("pointermove",h,{passive:!1}),void this._domElement.ownerDocument.removeEventListener("pointerup",m)}e.preventDefault()}},_=e=>{if(!this._enabled)return;E(this._activePointers,B),this._getClientRect(this._elementRect),n.copy(B),r.copy(B);if(this._activePointers.length>=2){const e=B.x-this._activePointers[1].clientX,t=B.y-this._activePointers[1].clientY,n=Math.sqrt(e*e+t*t);i.set(0,n);const a=.5*(this._activePointers[0].clientX+this._activePointers[1].clientX),o=.5*(this._activePointers[0].clientY+this._activePointers[1].clientY);r.set(a,o)}if(this._state=0,e)if("pointerType"in e&&"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._lockedPointer||(e.buttons&a)!==a||(this._state=this._state|this.mouseButtons.left),(e.buttons&s)===s&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&o)===o&&(this._state=this._state|this.mouseButtons.right);else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);(this._state&l.ROTATE)!==l.ROTATE&&(this._state&l.TOUCH_ROTATE)!==l.TOUCH_ROTATE&&(this._state&l.TOUCH_DOLLY_ROTATE)!==l.TOUCH_DOLLY_ROTATE&&(this._state&l.TOUCH_ZOOM_ROTATE)!==l.TOUCH_ZOOM_ROTATE||(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),(this._state&l.TRUCK)!==l.TRUCK&&(this._state&l.SCREEN_PAN)!==l.SCREEN_PAN&&(this._state&l.TOUCH_TRUCK)!==l.TOUCH_TRUCK&&(this._state&l.TOUCH_SCREEN_PAN)!==l.TOUCH_SCREEN_PAN&&(this._state&l.TOUCH_DOLLY_TRUCK)!==l.TOUCH_DOLLY_TRUCK&&(this._state&l.TOUCH_DOLLY_SCREEN_PAN)!==l.TOUCH_DOLLY_SCREEN_PAN&&(this._state&l.TOUCH_ZOOM_TRUCK)!==l.TOUCH_ZOOM_TRUCK&&(this._state&l.TOUCH_ZOOM_SCREEN_PAN)!==l.TOUCH_DOLLY_SCREEN_PAN||(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),(this._state&l.DOLLY)!==l.DOLLY&&(this._state&l.TOUCH_DOLLY)!==l.TOUCH_DOLLY&&(this._state&l.TOUCH_DOLLY_TRUCK)!==l.TOUCH_DOLLY_TRUCK&&(this._state&l.TOUCH_DOLLY_SCREEN_PAN)!==l.TOUCH_DOLLY_SCREEN_PAN&&(this._state&l.TOUCH_DOLLY_OFFSET)!==l.TOUCH_DOLLY_OFFSET&&(this._state&l.TOUCH_DOLLY_ROTATE)!==l.TOUCH_DOLLY_ROTATE||(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),(this._state&l.ZOOM)!==l.ZOOM&&(this._state&l.TOUCH_ZOOM)!==l.TOUCH_ZOOM&&(this._state&l.TOUCH_ZOOM_TRUCK)!==l.TOUCH_ZOOM_TRUCK&&(this._state&l.TOUCH_ZOOM_SCREEN_PAN)!==l.TOUCH_ZOOM_SCREEN_PAN&&(this._state&l.TOUCH_ZOOM_OFFSET)!==l.TOUCH_ZOOM_OFFSET&&(this._state&l.TOUCH_ZOOM_ROTATE)!==l.TOUCH_ZOOM_ROTATE||(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),(this._state&l.OFFSET)!==l.OFFSET&&(this._state&l.TOUCH_OFFSET)!==l.TOUCH_OFFSET&&(this._state&l.TOUCH_DOLLY_OFFSET)!==l.TOUCH_DOLLY_OFFSET&&(this._state&l.TOUCH_ZOOM_OFFSET)!==l.TOUCH_ZOOM_OFFSET||(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},w=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,E(this._activePointers,B);const e=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,t=e?-e.deltaX:r.x-B.x,a=e?-e.deltaY:r.y-B.y;if(r.copy(B),(this._state&l.ROTATE)!==l.ROTATE&&(this._state&l.TOUCH_ROTATE)!==l.TOUCH_ROTATE&&(this._state&l.TOUCH_DOLLY_ROTATE)!==l.TOUCH_DOLLY_ROTATE&&(this._state&l.TOUCH_ZOOM_ROTATE)!==l.TOUCH_ZOOM_ROTATE||(this._rotateInternal(t,a),this._isUserControllingRotate=!0),(this._state&l.DOLLY)===l.DOLLY||(this._state&l.ZOOM)===l.ZOOM){const e=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,t=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0,r=this.dollyDragInverted?-1:1;(this._state&l.DOLLY)===l.DOLLY?(this._dollyInternal(r*a*N,e,t),this._isUserControllingDolly=!0):(this._zoomInternal(r*a*N,e,t),this._isUserControllingZoom=!0)}if((this._state&l.TOUCH_DOLLY)===l.TOUCH_DOLLY||(this._state&l.TOUCH_ZOOM)===l.TOUCH_ZOOM||(this._state&l.TOUCH_DOLLY_TRUCK)===l.TOUCH_DOLLY_TRUCK||(this._state&l.TOUCH_ZOOM_TRUCK)===l.TOUCH_ZOOM_TRUCK||(this._state&l.TOUCH_DOLLY_SCREEN_PAN)===l.TOUCH_DOLLY_SCREEN_PAN||(this._state&l.TOUCH_ZOOM_SCREEN_PAN)===l.TOUCH_ZOOM_SCREEN_PAN||(this._state&l.TOUCH_DOLLY_OFFSET)===l.TOUCH_DOLLY_OFFSET||(this._state&l.TOUCH_ZOOM_OFFSET)===l.TOUCH_ZOOM_OFFSET||(this._state&l.TOUCH_DOLLY_ROTATE)===l.TOUCH_DOLLY_ROTATE||(this._state&l.TOUCH_ZOOM_ROTATE)===l.TOUCH_ZOOM_ROTATE){const e=B.x-this._activePointers[1].clientX,t=B.y-this._activePointers[1].clientY,n=Math.sqrt(e*e+t*t),a=i.y-n;i.set(0,n);const o=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,s=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&l.TOUCH_DOLLY)===l.TOUCH_DOLLY||(this._state&l.TOUCH_DOLLY_ROTATE)===l.TOUCH_DOLLY_ROTATE||(this._state&l.TOUCH_DOLLY_TRUCK)===l.TOUCH_DOLLY_TRUCK||(this._state&l.TOUCH_DOLLY_SCREEN_PAN)===l.TOUCH_DOLLY_SCREEN_PAN||(this._state&l.TOUCH_DOLLY_OFFSET)===l.TOUCH_DOLLY_OFFSET?(this._dollyInternal(a*N,o,s),this._isUserControllingDolly=!0):(this._zoomInternal(a*N,o,s),this._isUserControllingZoom=!0)}(this._state&l.TRUCK)!==l.TRUCK&&(this._state&l.TOUCH_TRUCK)!==l.TOUCH_TRUCK&&(this._state&l.TOUCH_DOLLY_TRUCK)!==l.TOUCH_DOLLY_TRUCK&&(this._state&l.TOUCH_ZOOM_TRUCK)!==l.TOUCH_ZOOM_TRUCK||(this._truckInternal(t,a,!1,!1),this._isUserControllingTruck=!0),(this._state&l.SCREEN_PAN)!==l.SCREEN_PAN&&(this._state&l.TOUCH_SCREEN_PAN)!==l.TOUCH_SCREEN_PAN&&(this._state&l.TOUCH_DOLLY_SCREEN_PAN)!==l.TOUCH_DOLLY_SCREEN_PAN&&(this._state&l.TOUCH_ZOOM_SCREEN_PAN)!==l.TOUCH_ZOOM_SCREEN_PAN||(this._truckInternal(t,a,!1,!0),this._isUserControllingTruck=!0),(this._state&l.OFFSET)!==l.OFFSET&&(this._state&l.TOUCH_OFFSET)!==l.TOUCH_OFFSET&&(this._state&l.TOUCH_DOLLY_OFFSET)!==l.TOUCH_DOLLY_OFFSET&&(this._state&l.TOUCH_ZOOM_OFFSET)!==l.TOUCH_ZOOM_OFFSET||(this._truckInternal(t,a,!0,!1),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},S=()=>{E(this._activePointers,B),r.copy(B),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",h,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",m),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{this._enabled&&this._domElement&&(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",h,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",m),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",M),this._domElement.ownerDocument.addEventListener("pointerlockerror",D),this._domElement.ownerDocument.addEventListener("pointermove",h,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",m),_())},this.unlockPointer=()=>{var e,t,n;null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),null===(e=this._domElement)||void 0===e||e.ownerDocument.exitPointerLock(),null===(t=this._domElement)||void 0===t||t.ownerDocument.removeEventListener("pointerlockchange",M),null===(n=this._domElement)||void 0===n||n.ownerDocument.removeEventListener("pointerlockerror",D),this.cancel()};const M=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},D=()=>{this.unlockPointer()};this._addAllEventListeners=e=>{this._domElement=e,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",u),this._domElement.addEventListener("pointercancel",m),this._domElement.addEventListener("wheel",x,{passive:!1}),this._domElement.addEventListener("contextmenu",b)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",u),this._domElement.removeEventListener("pointercancel",m),this._domElement.removeEventListener("wheel",x,{passive:!1}),this._domElement.removeEventListener("contextmenu",b),this._domElement.ownerDocument.removeEventListener("pointermove",h,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",m),this._domElement.ownerDocument.removeEventListener("pointerlockchange",M),this._domElement.ownerDocument.removeEventListener("pointerlockerror",D))},this.cancel=()=>{this._state!==l.NONE&&(this._state=l.NONE,this._activePointers.length=0,S())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=y(e.width,0,1),this._interactiveArea.height=y(e.height,0,1),this._interactiveArea.x=y(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=y(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._isUserControllingRotate=!1;const r=y(e,this.minAzimuthAngle,this.maxAzimuthAngle),i=y(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=i,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const a=!n||b(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&b(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(a)}dolly(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._isUserControllingDolly=!1,this._lastDollyDirection=c,this._changedDolly=0,this._dollyToNoClamp(y(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const t=this._collisionTest(),r=b(t,this._spherical.radius);if(!(n>e)&&r)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,t)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const r=!t||b(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(r)}dollyInFixed(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._targetEnd.add(this._getCameraDirection(z).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const n=!t||b(this._target.x,this._targetEnd.x,this.restThreshold)&&b(this._target.y,this._targetEnd.y,this.restThreshold)&&b(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._isUserControllingZoom=!1,this._zoomEnd=y(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const n=!t||b(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._camera.updateMatrix(),H.setFromMatrixColumn(this._camera.matrix,0),V.setFromMatrixColumn(this._camera.matrix,1),H.multiplyScalar(e),V.multiplyScalar(-t);const r=k.copy(H).add(V),i=L.copy(this._targetEnd).add(r);return this.moveTo(i.x,i.y,i.z,n)}forward(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];k.setFromMatrixColumn(this._camera.matrix,0),k.crossVectors(this._camera.up,k),k.multiplyScalar(e);const n=L.copy(this._targetEnd).add(k);return this.moveTo(n.x,n.y,n.z,t)}elevate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return k.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+k.x,this._targetEnd.y+k.y,this._targetEnd.z+k.z,t)}moveTo(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._isUserControllingTruck=!1;const i=k.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,i,this.boundaryFriction),this._needsUpdate=!0,r||this._target.copy(this._targetEnd);const a=!r||b(this._target.x,this._targetEnd.x,this.restThreshold)&&b(this._target.y,this._targetEnd.y,this.restThreshold)&&b(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(a)}lookInDirectionOf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=k.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(i.x,i.y,i.z,r)}fitToBox(e,t){let{cover:n=!1,paddingLeft:r=0,paddingRight:i=0,paddingBottom:a=0,paddingTop:o=0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=[],l=e.isBox3?Y.copy(e):Y.setFromObject(e);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const c=_(this._sphericalEnd.theta,m),u=_(this._sphericalEnd.phi,m);s.push(this.rotateTo(c,u,t));const h=k.setFromSpherical(this._sphericalEnd).normalize(),p=Q.setFromUnitVectors(h,I),g=b(Math.abs(h.y),1);g&&p.multiply(J.setFromAxisAngle(O,c)),p.multiply(this._yAxisUpSpaceInverse);const v=Z.makeEmpty();L.copy(l.min).applyQuaternion(p),v.expandByPoint(L),L.copy(l.min).setX(l.max.x).applyQuaternion(p),v.expandByPoint(L),L.copy(l.min).setY(l.max.y).applyQuaternion(p),v.expandByPoint(L),L.copy(l.max).setZ(l.min.z).applyQuaternion(p),v.expandByPoint(L),L.copy(l.min).setZ(l.max.z).applyQuaternion(p),v.expandByPoint(L),L.copy(l.max).setY(l.min.y).applyQuaternion(p),v.expandByPoint(L),L.copy(l.max).setX(l.min.x).applyQuaternion(p),v.expandByPoint(L),L.copy(l.max).applyQuaternion(p),v.expandByPoint(L),v.min.x-=r,v.min.y-=a,v.max.x+=i,v.max.y+=o,p.setFromUnitVectors(I,h),g&&p.premultiply(J.invert()),p.premultiply(this._yAxisUpSpace);const y=v.getSize(k),x=v.getCenter(L).applyQuaternion(p);if(d(this._camera)){const e=this.getDistanceToFitBox(y.x,y.y,y.z,n);s.push(this.moveTo(x.x,x.y,x.z,t)),s.push(this.dollyTo(e,t)),s.push(this.setFocalOffset(0,0,0,t))}else if(f(this._camera)){const e=this._camera,r=e.right-e.left,i=e.top-e.bottom,a=n?Math.max(r/y.x,i/y.y):Math.min(r/y.x,i/y.y);s.push(this.moveTo(x.x,x.y,x.z,t)),s.push(this.zoomTo(a,t)),s.push(this.setFocalOffset(0,0,0,t))}return Promise.all(s)}fitToSphere(e,t){const n=[],r="isObject3D"in e?te.createBoundingSphere(e,K):K.copy(e);if(n.push(this.moveTo(r.center.x,r.center.y,r.center.z,t)),d(this._camera)){const e=this.getDistanceToFitSphere(r.radius);n.push(this.dollyTo(e,t))}else if(f(this._camera)){const e=this._camera.right-this._camera.left,i=this._camera.top-this._camera.bottom,a=2*r.radius,o=Math.min(e/a,i/a);n.push(this.zoomTo(o,t))}return n.push(this.setFocalOffset(0,0,0,t)),Promise.all(n)}setLookAt(e,t,n,r,i,a){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=c,this._changedDolly=0;const s=L.set(r,i,a),l=k.set(e,t,n);this._targetEnd.copy(s),this._sphericalEnd.setFromVector3(l.sub(s).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,o||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const u=!o||b(this._target.x,this._targetEnd.x,this.restThreshold)&&b(this._target.y,this._targetEnd.y,this.restThreshold)&&b(this._target.z,this._targetEnd.z,this.restThreshold)&&b(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&b(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&b(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(u)}lerpLookAt(e,t,n,r,i,a,o,s,l,u,h,d,f){let p=arguments.length>13&&void 0!==arguments[13]&&arguments[13];this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=c,this._changedDolly=0;const m=k.set(r,i,a),g=L.set(e,t,n);W.setFromVector3(g.sub(m).applyQuaternion(this._yAxisUpSpace));const v=U.set(u,h,d),y=L.set(o,s,l);X.setFromVector3(y.sub(v).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(m.lerp(v,f));const x=X.theta-W.theta,_=X.phi-W.phi,w=X.radius-W.radius;this._sphericalEnd.set(W.radius+w*f,W.phi+_*f,W.theta+x*f),this.normalizeRotations(),this._needsUpdate=!0,p||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const S=!p||b(this._target.x,this._targetEnd.x,this.restThreshold)&&b(this._target.y,this._targetEnd.y,this.restThreshold)&&b(this._target.z,this._targetEnd.z,this.restThreshold)&&b(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&b(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&b(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(S)}setPosition(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)}setTarget(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=this.getPosition(k),a=this.setLookAt(i.x,i.y,i.z,e,t,n,r);return this._sphericalEnd.phi=y(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),a}setFocalOffset(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,r||this._focalOffset.copy(this._focalOffsetEnd);const i=!r||b(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&b(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&b(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),H.setFromMatrixColumn(this._camera.matrixWorldInverse,0),V.setFromMatrixColumn(this._camera.matrixWorldInverse,1),G.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const r=k.set(e,t,n),i=r.distanceTo(this._camera.position),a=r.sub(this._camera.position);H.multiplyScalar(a.x),V.multiplyScalar(a.y),G.multiplyScalar(a.z),k.copy(H).add(V).add(G),k.z=k.z+i,this.dollyTo(i,!1),this.setFocalOffset(-k.x,k.y,-k.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,r){null!==e?(this._viewport=this._viewport||new P.Vector4,"number"===typeof e?this._viewport.set(e,t,n,r):this._viewport.copy(e)):this._viewport=null}getDistanceToFitBox(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(C(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const i=e/t,a=this._camera.getEffectiveFOV()*v,o=this._camera.aspect;return.5*((r?i>o:i<o)?t:e/o)/Math.tan(.5*a)+.5*n}getDistanceToFitSphere(e){if(C(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*v,n=2*Math.atan(Math.tan(.5*t)*this._camera.aspect),r=1<this._camera.aspect?t:n;return e/Math.sin(.5*r)}getTarget(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(e&&e.isVector3?e:new P.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(e&&e.isVector3?e:new P.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(e||new P.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(e&&e.isVector3?e:new P.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%p,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=p),this._spherical.theta+=p*Math.round((this._sphericalEnd.theta-this._spherical.theta)/p)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!b(this._camera.up.x,this._cameraUp0.x)||!b(this._camera.up.y,this._cameraUp0.y)||!b(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const e=this.getPosition(k);this.updateCameraUp(),this.setPosition(e.x,e.y,e.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,O),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=k.subVectors(this._target,this._camera.position).normalize(),t=L.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const n=this.getPosition(k);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,r=this._sphericalEnd.radius-this._spherical.radius,i=q.subVectors(this._targetEnd,this._target),a=j.subVectors(this._focalOffsetEnd,this._focalOffset),o=this._zoomEnd-this._zoom;if(x(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=M(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,t,1/0,e),this._needsUpdate=!0}if(x(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=M(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,t,1/0,e),this._needsUpdate=!0}if(x(r))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const t=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=M(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,t,this.maxSpeed,e),this._needsUpdate=!0}if(x(i.x)&&x(i.y)&&x(i.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const t=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;D(this._target,this._targetEnd,this._targetVelocity,t,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(x(a.x)&&x(a.y)&&x(a.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const t=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;D(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,t,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(x(o))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const t=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=M(this._zoom,this._zoomEnd,this._zoomVelocity,t,1/0,e)}if(this.dollyToCursor)if(d(this._camera)&&0!==this._changedDolly){const e=this._spherical.radius-this._lastDistance,t=this._camera,n=this._getCameraDirection(z),r=k.copy(n).cross(t.up).normalize();0===r.lengthSq()&&(r.x=1);const i=L.crossVectors(r,n),a=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*v*.5),o=(this._sphericalEnd.radius-e-this._sphericalEnd.radius)/this._sphericalEnd.radius,s=U.copy(this._targetEnd).add(r.multiplyScalar(this._dollyControlCoord.x*a*t.aspect)).add(i.multiplyScalar(this._dollyControlCoord.y*a)),l=k.copy(this._targetEnd).lerp(s,o),c=this._lastDollyDirection===u&&this._spherical.radius<=this.minDistance,d=this._lastDollyDirection===h&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(c||d)){this._sphericalEnd.radius-=e,this._spherical.radius-=e;const t=L.copy(n).multiplyScalar(-e);l.add(t)}this._boundary.clampPoint(l,l);const f=L.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(f),this._changedDolly-=e,x(this._changedDolly)&&(this._changedDolly=0)}else if(f(this._camera)&&0!==this._changedZoom){const e=this._zoom-this._lastZoom,t=this._camera,n=k.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),r=L.set(0,0,-1).applyQuaternion(t.quaternion),i=U.copy(n).add(r.multiplyScalar(-n.dot(t.up))),a=-(this._zoom-e-this._zoom)/this._zoom,o=this._getCameraDirection(z),s=this._targetEnd.dot(o),l=k.copy(this._targetEnd).lerp(i,a),c=l.dot(o),u=o.multiplyScalar(c-s);l.sub(u),this._boundary.clampPoint(l,l);const h=L.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(h),this._changedZoom-=e,x(this._changedZoom)&&(this._changedZoom=0)}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const s=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,s),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target);(!x(this._focalOffset.x)||!x(this._focalOffset.y)||!x(this._focalOffset.z))&&(H.setFromMatrixColumn(this._camera.matrix,0),V.setFromMatrixColumn(this._camera.matrix,1),G.setFromMatrixColumn(this._camera.matrix,2),H.multiplyScalar(this._focalOffset.x),V.multiplyScalar(-this._focalOffset.y),G.multiplyScalar(this._focalOffset.z),k.copy(H).add(V).add(G),this._camera.position.add(k),this._camera.updateMatrixWorld()),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),k.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const l=this._needsUpdate;return l&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):l?(this.dispatchEvent({type:"update"}),x(t,this.restThreshold)&&x(n,this.restThreshold)&&x(r,this.restThreshold)&&x(i.x,this.restThreshold)&&x(i.y,this.restThreshold)&&x(i.z,this.restThreshold)&&x(a.x,this.restThreshold)&&x(a.y,this.restThreshold)&&x(a.z,this.restThreshold)&&x(o,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!l&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=l,this._needsUpdate=!1,l}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:w(this.maxDistance),minZoom:this.minZoom,maxZoom:w(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:w(this.maxPolarAngle),minAzimuthAngle:w(this.minAzimuthAngle),maxAzimuthAngle:w(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,target:this._targetEnd.toArray(),position:k.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=S(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=S(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=S(n.maxPolarAngle),this.minAzimuthAngle=S(n.minAzimuthAngle),this.maxAzimuthAngle=S(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),W.setFromVector3(k.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(W.theta,W.phi,t),this.dollyTo(W.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){this._domElement?console.warn("camera-controls is already connected."):(e.setAttribute("data-camera-controls-version","2.10.1"),this._addAllEventListeners(e),this._getClientRect(this._elementRect))}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find((t=>t.pointerId===e))}_findPointerByMouseButton(e){return this._activePointers.find((t=>t.mouseButton===e))}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){const r=t.lengthSq();if(0===r)return e;const i=L.copy(t).add(e),a=this._boundary.clampPoint(i,U).sub(i),o=a.lengthSq();if(0===o)return e.add(t);if(o===r)return e;if(0===n)return e.add(t).add(a);{const r=1+n*o/t.dot(a);return e.add(L.copy(t).multiplyScalar(r)).add(a.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(d(this._camera)){const e=this._camera,t=e.near,n=e.getEffectiveFOV()*v,r=Math.tan(.5*n)*t,i=r*e.aspect;this._nearPlaneCorners[0].set(-i,-r,0),this._nearPlaneCorners[1].set(i,-r,0),this._nearPlaneCorners[2].set(i,r,0),this._nearPlaneCorners[3].set(-i,r,0)}else if(f(this._camera)){const e=this._camera,t=1/e.zoom,n=e.left*t,r=e.right*t,i=e.top*t,a=e.bottom*t;this._nearPlaneCorners[0].set(n,i,0),this._nearPlaneCorners[1].set(r,i,0),this._nearPlaneCorners[2].set(r,a,0),this._nearPlaneCorners[3].set(n,a,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1))return e;if(C(this._camera,"_collisionTest"))return e;const t=this._getTargetDirection(z);$.lookAt(F,t,this._camera.up);for(let n=0;n<4;n++){const r=L.copy(this._nearPlaneCorners[n]);r.applyMatrix4($);const i=U.addVectors(this._target,r);ee.set(i,t),ee.far=this._spherical.radius+1;const a=ee.intersectObjects(this.colliderMeshes);0!==a.length&&a[0].distance<e&&(e=a[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise((e=>{const t=()=>{this.removeEventListener("rest",t),e()};this.addEventListener("rest",t)})))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new P.Sphere,n=t.center;Y.makeEmpty(),e.traverseVisible((e=>{e.isMesh&&Y.expandByObject(e)})),Y.getCenter(n);let r=0;return e.traverseVisible((e=>{if(!e.isMesh)return;const t=e;if(!t.geometry)return;const i=t.geometry.clone();i.applyMatrix4(t.matrixWorld);const a=i.attributes.position;for(let o=0,s=a.count;o<s;o++)k.fromBufferAttribute(a,o),r=Math.max(r,n.distanceToSquared(k))})),t.radius=Math.sqrt(r),t}}function ne(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function re(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ie(e){let t,n,r;function i(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<a){if(0!==t(r,r))return a;do{const t=i+a>>>1;n(e[t],r)<0?i=t+1:a=t}while(i<a)}return i}return 2!==e.length?(t=ne,n=(t,n)=>ne(e(t),n),r=(t,n)=>e(t)-n):(t=e===ne||e===re?e:ae,n=e,r=e),{left:i,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<a){if(0!==t(r,r))return a;do{const t=i+a>>>1;n(e[t],r)<=0?i=t+1:a=t}while(i<a)}return i}}}function ae(){return 0}function oe(e){return null===e?NaN:+e}const se=ie(ne),le=se.right,ce=se.left,ue=ie(oe).center,he=le;function de(e,t){if(!((t=+t)>=0))throw new RangeError("invalid r");let n=e.length;if(!((n=Math.floor(n))>=0))throw new RangeError("invalid length");if(!n||!t)return e;const r=ye(t),i=e.slice();return r(e,i,0,n,1),r(i,e,0,n,1),r(e,i,0,n,1),e}const fe=me(ye),pe=me((function(e){const t=ye(e);return(e,n,r,i,a)=>{t(e,n,(r<<=2)+0,(i<<=2)+0,a<<=2),t(e,n,r+1,i+1,a),t(e,n,r+2,i+2,a),t(e,n,r+3,i+3,a)}}));function me(e){return function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;if(!((n=+n)>=0))throw new RangeError("invalid rx");if(!((r=+r)>=0))throw new RangeError("invalid ry");let{data:i,width:a,height:o}=t;if(!((a=Math.floor(a))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(void 0!==o?o:i.length/a))>=0))throw new RangeError("invalid height");if(!a||!o||!n&&!r)return t;const s=n&&e(n),l=r&&e(r),c=i.slice();return s&&l?(ge(s,c,i,a,o),ge(s,i,c,a,o),ge(s,c,i,a,o),ve(l,i,c,a,o),ve(l,c,i,a,o),ve(l,i,c,a,o)):s?(ge(s,i,c,a,o),ge(s,c,i,a,o),ge(s,i,c,a,o)):l&&(ve(l,i,c,a,o),ve(l,c,i,a,o),ve(l,i,c,a,o)),t}}function ge(e,t,n,r,i){for(let a=0,o=r*i;a<o;)e(t,n,a,a+=r,1)}function ve(e,t,n,r,i){for(let a=0,o=r*i;a<r;++a)e(t,n,a,a+o,r)}function ye(e){const t=Math.floor(e);if(t===e)return function(e){const t=2*e+1;return(n,r,i,a,o)=>{if(!((a-=o)>=i))return;let s=e*r[i];const l=o*e;for(let e=i,t=i+l;e<t;e+=o)s+=r[Math.min(a,e)];for(let e=i,c=a;e<=c;e+=o)s+=r[Math.min(a,e+l)],n[e]=s/t,s-=r[Math.max(i,e-l)]}}(e);const n=e-t,r=2*e+1;return(e,i,a,o,s)=>{if(!((o-=s)>=a))return;let l=t*i[a];const c=s*t,u=c+s;for(let t=a,n=a+c;t<n;t+=s)l+=i[Math.min(o,t)];for(let t=a,h=o;t<=h;t+=s)l+=i[Math.min(o,t+c)],e[t]=(l+n*(i[Math.max(a,t-u)]+i[Math.min(o,t+u)]))/r,l-=i[Math.max(a,t-c)]}}function xe(e,t){let n=0;if(void 0===t)for(let r of e)null!=r&&(r=+r)>=r&&++n;else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(i=+i)>=i&&++n}return n}function be(e){return 0|e.length}function _e(e){return!(e>0)}function we(e){return"object"!==typeof e||"length"in e?e:Array.from(e)}function Se(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r="function"===typeof t[t.length-1]&&function(e){return t=>e(...t)}(t.pop()),i=(t=t.map(we)).map(be),a=t.length-1,o=new Array(a+1).fill(0),s=[];if(a<0||i.some(_e))return s;for(;;){s.push(o.map(((e,n)=>t[n][e])));let e=a;for(;++o[e]===i[e];){if(0===e)return r?s.map(r):s;o[e--]=0}}}function Me(e,t){var n=0,r=0;return Float64Array.from(e,void 0===t?e=>n+=+e||0:i=>n+=+t(i,r++,e)||0)}function De(e,t){let n,r=0,i=0,a=0;if(void 0===t)for(let o of e)null!=o&&(o=+o)>=o&&(n=o-i,i+=n/++r,a+=n*(o-i));else{let o=-1;for(let s of e)null!=(s=t(s,++o,e))&&(s=+s)>=s&&(n=s-i,i+=n/++r,a+=n*(s-i))}if(r>1)return a/(r-1)}function Ee(e,t){const n=De(e,t);return n?Math.sqrt(n):n}function Ce(e,t){let n,r;if(void 0===t)for(const i of e)null!=i&&(void 0===n?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let a of e)null!=(a=t(a,++i,e))&&(void 0===n?a>=a&&(n=r=a):(n>a&&(n=a),r<a&&(r=a)))}return[n,r]}class Ae{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=t[r],a=e+i,o=Math.abs(e)<Math.abs(i)?e-(a-i):i-(a-e);o&&(t[n++]=o),e=a}return t[n]=e,this._n=n+1,this}valueOf(){const e=this._partials;let t,n,r,i=this._n,a=0;if(i>0){for(a=e[--i];i>0&&(t=a,n=e[--i],a=t+n,r=n-(a-t),!r););i>0&&(r<0&&e[i-1]<0||r>0&&e[i-1]>0)&&(n=2*r,t=a+n,n==t-a&&(a=t))}return a}}function Te(e,t){const n=new Ae;if(void 0===t)for(let r of e)(r=+r)&&n.add(r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&n.add(i)}return+n}function Ne(e,t){const n=new Ae;let r=-1;return Float64Array.from(e,void 0===t?e=>n.add(+e||0):i=>n.add(+t(i,++r,e)||0))}class Re extends Map{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Be;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(Fe(this,e))}has(e){return super.has(Fe(this,e))}set(e,t){return super.set(Oe(this,e),t)}delete(e){return super.delete(Ie(this,e))}}class Pe extends Set{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Be;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const n of e)this.add(n)}has(e){return super.has(Fe(this,e))}add(e){return super.add(Oe(this,e))}delete(e){return super.delete(Ie(this,e))}}function Fe(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):t}function Oe(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):(n.set(i,t),t)}function Ie(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)&&(t=n.get(i),n.delete(i)),t}function Be(e){return null!==e&&"object"===typeof e?e.valueOf():e}function ke(e){return e}function Le(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ye(e,ke,ke,n)}function Ue(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ye(e,Array.from,ke,n)}function ze(e,t){for(let n=1,r=t.length;n<r;++n)e=e.flatMap((e=>e.pop().map((t=>{let[n,r]=t;return[...e,n,r]}))));return e}function He(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ze(Ue(e,...n),n)}function Ve(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return ze(qe(e,t,...r),r)}function Ge(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return Ye(e,ke,t,r)}function qe(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return Ye(e,Array.from,t,r)}function je(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ye(e,ke,Xe,n)}function We(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ye(e,Array.from,Xe,n)}function Xe(e){if(1!==e.length)throw new Error("duplicate key");return e[0]}function Ye(e,t,n,r){return function e(i,a){if(a>=r.length)return n(i);const o=new Re,s=r[a++];let l=-1;for(const t of i){const e=s(t,++l,i),n=o.get(e);n?n.push(t):o.set(e,[t])}for(const[t,n]of o)o.set(t,e(n,a));return t(o)}(e,0)}function Ze(e,t){return Array.from(t,(t=>e[t]))}function Ke(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("function"!==typeof e[Symbol.iterator])throw new TypeError("values is not iterable");e=Array.from(e);let[i]=n;if(i&&2!==i.length||n.length>1){const t=Uint32Array.from(e,((e,t)=>t));return n.length>1?(n=n.map((t=>e.map(t))),t.sort(((e,t)=>{for(const r of n){const n=Je(r[e],r[t]);if(n)return n}}))):(i=e.map(i),t.sort(((e,t)=>Je(i[e],i[t])))),Ze(e,t)}return e.sort(Qe(i))}function Qe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne;if(e===ne)return Je;if("function"!==typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||0===r?r:(0===e(n,n))-(0===e(t,t))}}function Je(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}function $e(e,t,n){return(2!==t.length?Ke(Ge(e,t,n),((e,t)=>{let[n,r]=e,[i,a]=t;return ne(r,a)||ne(n,i)})):Ke(Le(e,n),((e,n)=>{let[r,i]=e,[a,o]=n;return t(i,o)||ne(r,a)}))).map((e=>{let[t]=e;return t}))}var et=Array.prototype,tt=et.slice;et.map;function nt(e){return()=>e}const rt=Math.sqrt(50),it=Math.sqrt(10),at=Math.sqrt(2);function ot(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),o=a>=rt?10:a>=it?5:a>=at?2:1;let s,l,c;return i<0?(c=Math.pow(10,-i)/o,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*o,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=n&&n<2?ot(e,t,2*n):[s,l,c]}function st(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[i,a,o]=r?ot(t,e,n):ot(e,t,n);if(!(a>=i))return[];const s=a-i+1,l=new Array(s);if(r)if(o<0)for(let c=0;c<s;++c)l[c]=(a-c)/-o;else for(let c=0;c<s;++c)l[c]=(a-c)*o;else if(o<0)for(let c=0;c<s;++c)l[c]=(i+c)/-o;else for(let c=0;c<s;++c)l[c]=(i+c)*o;return l}function lt(e,t,n){return ot(e=+e,t=+t,n=+n)[2]}function ct(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?lt(t,e,n):lt(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function ut(e,t,n){let r;for(;;){const i=lt(e,t,n);if(i===r||0===i||!isFinite(i))return[e,t];i>0?(e=Math.floor(e/i)*i,t=Math.ceil(t/i)*i):i<0&&(e=Math.ceil(e*i)/i,t=Math.floor(t*i)/i),r=i}}function ht(e){return Math.max(1,Math.ceil(Math.log(xe(e))/Math.LN2)+1)}function dt(){var e=ke,t=Ce,n=ht;function r(r){Array.isArray(r)||(r=Array.from(r));var i,a,o,s=r.length,l=new Array(s);for(i=0;i<s;++i)l[i]=e(r[i],i,r);var c=t(l),u=c[0],h=c[1],d=n(l,u,h);if(!Array.isArray(d)){const e=h,n=+d;if(t===Ce&&([u,h]=ut(u,h,n)),(d=st(u,h,n))[0]<=u&&(o=lt(u,h,n)),d[d.length-1]>=h)if(e>=h&&t===Ce){const e=lt(u,h,n);isFinite(e)&&(e>0?h=(Math.floor(h/e)+1)*e:e<0&&(h=(Math.ceil(h*-e)+1)/-e))}else d.pop()}for(var f=d.length,p=0,m=f;d[p]<=u;)++p;for(;d[m-1]>h;)--m;(p||m<f)&&(d=d.slice(p,m),f=m-p);var g,v=new Array(f+1);for(i=0;i<=f;++i)(g=v[i]=[]).x0=i>0?d[i-1]:u,g.x1=i<f?d[i]:h;if(isFinite(o)){if(o>0)for(i=0;i<s;++i)null!=(a=l[i])&&u<=a&&a<=h&&v[Math.min(f,Math.floor((a-u)/o))].push(r[i]);else if(o<0)for(i=0;i<s;++i)if(null!=(a=l[i])&&u<=a&&a<=h){const e=Math.floor((u-a)*o);v[Math.min(f,e+(d[e]<=a))].push(r[i])}}else for(i=0;i<s;++i)null!=(a=l[i])&&u<=a&&a<=h&&v[he(d,a,0,f)].push(r[i]);return v}return r.value=function(t){return arguments.length?(e="function"===typeof t?t:nt(t),r):e},r.domain=function(e){return arguments.length?(t="function"===typeof e?e:nt([e[0],e[1]]),r):t},r.thresholds=function(e){return arguments.length?(n="function"===typeof e?e:nt(Array.isArray(e)?tt.call(e):e),r):n},r}function ft(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function pt(e,t){let n,r=-1,i=-1;if(void 0===t)for(const a of e)++i,null!=a&&(n<a||void 0===n&&a>=a)&&(n=a,r=i);else for(let a of e)null!=(a=t(a,++i,e))&&(n<a||void 0===n&&a>=a)&&(n=a,r=i);return r}function mt(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function gt(e,t){let n,r=-1,i=-1;if(void 0===t)for(const a of e)++i,null!=a&&(n>a||void 0===n&&a>=a)&&(n=a,r=i);else for(let a of e)null!=(a=t(a,++i,e))&&(n>a||void 0===n&&a>=a)&&(n=a,r=i);return r}function vt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=arguments.length>4?arguments[4]:void 0;if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=void 0===i?Je:Qe(i);r>n;){if(r-n>600){const a=r-n+1,o=t-n+1,s=Math.log(a),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1);vt(e,t,Math.max(n,Math.floor(t-o*l/a+c)),Math.min(r,Math.floor(t+(a-o)*l/a+c)),i)}const a=e[t];let o=n,s=r;for(yt(e,n,t),i(e[r],a)>0&&yt(e,n,r);o<s;){for(yt(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}0===i(e[n],a)?yt(e,n,s):(++s,yt(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function yt(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function xt(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ne,r=!1;if(1===n.length){let i;for(const a of e){const e=n(a);(r?ne(e,i)>0:0===ne(e,e))&&(t=a,i=e,r=!0)}}else for(const i of e)(r?n(i,t)>0:0===n(i,i))&&(t=i,r=!0);return t}function bt(e,t,n){if(e=Float64Array.from(function*(e,t){if(void 0===t)for(let n of e)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}(e,n)),(r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return mt(e);if(t>=1)return ft(e);var r,i=(r-1)*t,a=Math.floor(i),o=ft(vt(e,a).subarray(0,a+1));return o+(mt(e.subarray(a+1))-o)*(i-a)}}function _t(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:oe;if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e);return o+(+n(e[a+1],a+1,e)-o)*(i-a)}}function wt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:oe;if(!isNaN(t=+t)){if(r=Float64Array.from(e,((t,r)=>oe(n(e[r],r,e)))),t<=0)return gt(r);if(t>=1)return pt(r);var r,i=Uint32Array.from(e,((e,t)=>t)),a=r.length-1,o=Math.floor(a*t);return vt(i,o,0,a,((e,t)=>Je(r[e],r[t]))),(o=xt(i.subarray(0,o+1),(e=>r[e])))>=0?o:-1}}function St(e,t,n){const r=xe(e),i=bt(e,.75)-bt(e,.25);return r&&i?Math.ceil((n-t)/(2*i*Math.pow(r,-1/3))):1}function Mt(e,t,n){const r=xe(e),i=Ee(e);return r&&i?Math.ceil((n-t)*Math.cbrt(r)/(3.49*i)):1}function Dt(e,t){let n=0,r=0;if(void 0===t)for(let i of e)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let a of e)null!=(a=t(a,++i,e))&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}function Et(e,t){return bt(e,.5,t)}function Ct(e,t){return wt(e,.5,t)}function At(e){return Array.from(function*(e){for(const t of e)yield*t}(e))}function Tt(e,t){const n=new Re;if(void 0===t)for(let a of e)null!=a&&a>=a&&n.set(a,(n.get(a)||0)+1);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&i>=i&&n.set(i,(n.get(i)||0)+1)}let r,i=0;for(const[a,o]of n)o>i&&(i=o,r=a);return r}function Nt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rt;const n=[];let r,i=!1;for(const a of e)i&&n.push(t(r,a)),r=a,i=!0;return n}function Rt(e,t){return[e,t]}function Pt(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),a=new Array(i);++r<i;)a[r]=e+r*n;return a}function Ft(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ne;if("function"!==typeof e[Symbol.iterator])throw new TypeError("values is not iterable");let n=Array.from(e);const r=new Float64Array(n.length);2!==t.length&&(n=n.map(t),t=ne);const i=(e,r)=>t(n[e],n[r]);let a,o;return e=Uint32Array.from(n,((e,t)=>t)),e.sort(t===ne?(e,t)=>Je(n[e],n[t]):Qe(i)),e.forEach(((e,t)=>{const n=i(e,void 0===a?e:a);n>=0?((void 0===a||n>0)&&(a=e,o=t),r[e]=o):r[e]=NaN})),r}function Ot(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ne,r=!1;if(1===n.length){let i;for(const a of e){const e=n(a);(r?ne(e,i)<0:0===ne(e,e))&&(t=a,i=e,r=!0)}}else for(const i of e)(r?n(i,t)<0:0===n(i,i))&&(t=i,r=!0);return t}function It(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ne;if(1===n.length)return gt(e,n);let r=-1,i=-1;for(const a of e)++i,(r<0?0===n(a,a):n(a,t)<0)&&(t=a,r=i);return r}function Bt(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ne;if(1===n.length)return pt(e,n);let r=-1,i=-1;for(const a of e)++i,(r<0?0===n(a,a):n(a,t)>0)&&(t=a,r=i);return r}function kt(e,t){const n=It(e,t);return n<0?void 0:n}const Lt=Ut(Math.random);function Ut(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length)-(n=+n);for(;r;){const i=e()*r--|0,a=t[r+n];t[r+n]=t[i+n],t[i+n]=a}return t}}function zt(e,t){let n=0;if(void 0===t)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function Ht(e){if(!(i=e.length))return[];for(var t=-1,n=mt(e,Vt),r=new Array(n);++t<n;)for(var i,a=-1,o=r[t]=new Array(i);++a<i;)o[a]=e[a][t];return r}function Vt(e){return e.length}function Gt(){return Ht(arguments)}function qt(e,t){if("function"!==typeof t)throw new TypeError("test is not a function");let n=-1;for(const r of e)if(!t(r,++n,e))return!1;return!0}function jt(e,t){if("function"!==typeof t)throw new TypeError("test is not a function");let n=-1;for(const r of e)if(t(r,++n,e))return!0;return!1}function Wt(e,t){if("function"!==typeof t)throw new TypeError("test is not a function");const n=[];let r=-1;for(const i of e)t(i,++r,e)&&n.push(i);return n}function Xt(e,t){if("function"!==typeof e[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!==typeof t)throw new TypeError("mapper is not a function");return Array.from(e,((n,r)=>t(n,r,e)))}function Yt(e,t,n){if("function"!==typeof t)throw new TypeError("reducer is not a function");const r=e[Symbol.iterator]();let i,a,o=-1;if(arguments.length<3){if(({done:i,value:n}=r.next()),i)return;++o}for(;({done:i,value:a}=r.next()),!i;)n=t(n,a,++o,e);return n}function Zt(e){if("function"!==typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()}function Kt(e){e=new Pe(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)for(const t of i)e.delete(t);return e}function Qt(e,t){const n=t[Symbol.iterator](),r=new Pe;for(const i of e){if(r.has(i))return!1;let e,t;for(;({value:e,done:t}=n.next())&&!t;){if(Object.is(i,e))return!1;r.add(e)}}return!0}function Jt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=new Pe(e),n=n.map($t);e:for(const i of e)for(const t of n)if(!t.has(i)){e.delete(i);continue e}return e}function $t(e){return e instanceof Pe?e:new Pe(e)}function en(e,t){const n=e[Symbol.iterator](),r=new Set;for(const i of t){const e=tn(i);if(r.has(e))continue;let t,a;for(;({value:t,done:a}=n.next());){if(a)return!1;const n=tn(t);if(r.add(n),Object.is(e,n))break}}return!0}function tn(e){return null!==e&&"object"===typeof e?e.valueOf():e}function nn(e,t){return en(t,e)}function rn(){const e=new Pe;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)for(const t of i)e.add(t);return e}function an(e){return e}var on=1,sn=2,ln=3,cn=4,un=1e-6;function hn(e){return"translate("+e+",0)"}function dn(e){return"translate(0,"+e+")"}function fn(e){return t=>+e(t)}function pn(e,t){return t=Math.max(0,e.bandwidth()-2*t)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function mn(){return!this.__axis}function gn(e,t){var n=[],r=null,i=null,a=6,o=6,s=3,l="undefined"!==typeof window&&window.devicePixelRatio>1?0:.5,c=e===on||e===cn?-1:1,u=e===cn||e===sn?"x":"y",h=e===on||e===ln?hn:dn;function d(d){var f=null==r?t.ticks?t.ticks.apply(t,n):t.domain():r,p=null==i?t.tickFormat?t.tickFormat.apply(t,n):an:i,m=Math.max(a,0)+s,g=t.range(),v=+g[0]+l,y=+g[g.length-1]+l,x=(t.bandwidth?pn:fn)(t.copy(),l),b=d.selection?d.selection():d,_=b.selectAll(".domain").data([null]),w=b.selectAll(".tick").data(f,t).order(),S=w.exit(),M=w.enter().append("g").attr("class","tick"),D=w.select("line"),E=w.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),w=w.merge(M),D=D.merge(M.append("line").attr("stroke","currentColor").attr(u+"2",c*a)),E=E.merge(M.append("text").attr("fill","currentColor").attr(u,c*m).attr("dy",e===on?"0em":e===ln?"0.71em":"0.32em")),d!==b&&(_=_.transition(d),w=w.transition(d),D=D.transition(d),E=E.transition(d),S=S.transition(d).attr("opacity",un).attr("transform",(function(e){return isFinite(e=x(e))?h(e+l):this.getAttribute("transform")})),M.attr("opacity",un).attr("transform",(function(e){var t=this.parentNode.__axis;return h((t&&isFinite(t=t(e))?t:x(e))+l)}))),S.remove(),_.attr("d",e===cn||e===sn?o?"M"+c*o+","+v+"H"+l+"V"+y+"H"+c*o:"M"+l+","+v+"V"+y:o?"M"+v+","+c*o+"V"+l+"H"+y+"V"+c*o:"M"+v+","+l+"H"+y),w.attr("opacity",1).attr("transform",(function(e){return h(x(e)+l)})),D.attr(u+"2",c*a),E.attr(u,c*m).text(p),b.filter(mn).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===sn?"start":e===cn?"end":"middle"),b.each((function(){this.__axis=x}))}return d.scale=function(e){return arguments.length?(t=e,d):t},d.ticks=function(){return n=Array.from(arguments),d},d.tickArguments=function(e){return arguments.length?(n=null==e?[]:Array.from(e),d):n.slice()},d.tickValues=function(e){return arguments.length?(r=null==e?null:Array.from(e),d):r&&r.slice()},d.tickFormat=function(e){return arguments.length?(i=e,d):i},d.tickSize=function(e){return arguments.length?(a=o=+e,d):a},d.tickSizeInner=function(e){return arguments.length?(a=+e,d):a},d.tickSizeOuter=function(e){return arguments.length?(o=+e,d):o},d.tickPadding=function(e){return arguments.length?(s=+e,d):s},d.offset=function(e){return arguments.length?(l=+e,d):l},d}function vn(e){return gn(on,e)}function yn(e){return gn(sn,e)}function xn(e){return gn(ln,e)}function bn(e){return gn(cn,e)}var _n={value:()=>{}};function wn(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new Sn(r)}function Sn(e){this._=e}function Mn(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function Dn(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=_n,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}Sn.prototype=wn.prototype={constructor:Sn,on:function(e,t){var n,r,i=this._,a=(r=i,(e+"").trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}))),o=-1,s=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(n=(e=a[o]).type)i[n]=Dn(i[n],e.name,t);else if(null==t)for(n in i)i[n]=Dn(i[n],e.name,null);return this}for(;++o<s;)if((n=(e=a[o]).type)&&(n=Mn(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Sn(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=0,n=(r=this._[e]).length;a<n;++a)r[a].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};const En=wn;function Cn(){}function An(e){return null==e?Cn:function(){return this.querySelector(e)}}function Tn(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function Nn(){return[]}function Rn(e){return null==e?Nn:function(){return this.querySelectorAll(e)}}function Pn(e){return function(){return this.matches(e)}}function Fn(e){return function(t){return t.matches(e)}}var On=Array.prototype.find;function In(){return this.firstElementChild}var Bn=Array.prototype.filter;function kn(){return Array.from(this.children)}function Ln(e){return new Array(e.length)}function Un(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function zn(e,t,n,r,i,a){for(var o,s=0,l=t.length,c=a.length;s<c;++s)(o=t[s])?(o.__data__=a[s],r[s]=o):n[s]=new Un(e,a[s]);for(;s<l;++s)(o=t[s])&&(i[s]=o)}function Hn(e,t,n,r,i,a,o){var s,l,c,u=new Map,h=t.length,d=a.length,f=new Array(h);for(s=0;s<h;++s)(l=t[s])&&(f[s]=c=o.call(l,l.__data__,s,t)+"",u.has(c)?i[s]=l:u.set(c,l));for(s=0;s<d;++s)c=o.call(e,a[s],s,a)+"",(l=u.get(c))?(r[s]=l,l.__data__=a[s],u.delete(c)):n[s]=new Un(e,a[s]);for(s=0;s<h;++s)(l=t[s])&&u.get(f[s])===l&&(i[s]=l)}function Vn(e){return e.__data__}function Gn(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function qn(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}Un.prototype={constructor:Un,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var jn="http://www.w3.org/1999/xhtml";const Wn={svg:"http://www.w3.org/2000/svg",xhtml:jn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Xn(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Wn.hasOwnProperty(t)?{space:Wn[t],local:e}:e}function Yn(e){return function(){this.removeAttribute(e)}}function Zn(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Kn(e,t){return function(){this.setAttribute(e,t)}}function Qn(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Jn(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function $n(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function er(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function tr(e){return function(){this.style.removeProperty(e)}}function nr(e,t,n){return function(){this.style.setProperty(e,t,n)}}function rr(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function ir(e,t){return e.style.getPropertyValue(t)||er(e).getComputedStyle(e,null).getPropertyValue(t)}function ar(e){return function(){delete this[e]}}function or(e,t){return function(){this[e]=t}}function sr(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function lr(e){return e.trim().split(/^|\s+/)}function cr(e){return e.classList||new ur(e)}function ur(e){this._node=e,this._names=lr(e.getAttribute("class")||"")}function hr(e,t){for(var n=cr(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function dr(e,t){for(var n=cr(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function fr(e){return function(){hr(this,e)}}function pr(e){return function(){dr(this,e)}}function mr(e,t){return function(){(t.apply(this,arguments)?hr:dr)(this,e)}}function gr(){this.textContent=""}function vr(e){return function(){this.textContent=e}}function yr(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function xr(){this.innerHTML=""}function br(e){return function(){this.innerHTML=e}}function _r(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function wr(){this.nextSibling&&this.parentNode.appendChild(this)}function Sr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Mr(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===jn&&t.documentElement.namespaceURI===jn?t.createElement(e):t.createElementNS(n,e)}}function Dr(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Er(e){var t=Xn(e);return(t.local?Dr:Mr)(t)}function Cr(){return null}function Ar(){var e=this.parentNode;e&&e.removeChild(this)}function Tr(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Nr(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Rr(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,a=t.length;r<a;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function Pr(e,t,n){return function(){var r,i=this.__on,a=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var o=0,s=i.length;o<s;++o)if((r=i[o]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=t);this.addEventListener(e.type,a,n),r={type:e.type,name:e.name,value:t,listener:a,options:n},i?i.push(r):this.__on=[r]}}function Fr(e,t,n){var r=er(e),i=r.CustomEvent;"function"===typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Or(e,t){return function(){return Fr(this,e,t)}}function Ir(e,t){return function(){return Fr(this,e,t.apply(this,arguments))}}ur.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var Br=[null];function kr(e,t){this._groups=e,this._parents=t}function Lr(){return new kr([[document.documentElement]],Br)}kr.prototype=Lr.prototype={constructor:kr,select:function(e){"function"!==typeof e&&(e=An(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=t[i],l=s.length,c=r[i]=new Array(l),u=0;u<l;++u)(a=s[u])&&(o=e.call(a,a.__data__,u,s))&&("__data__"in a&&(o.__data__=a.__data__),c[u]=o);return new kr(r,this._parents)},selectAll:function(e){e="function"===typeof e?function(e){return function(){return Tn(e.apply(this,arguments))}}(e):Rn(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o,s=t[a],l=s.length,c=0;c<l;++c)(o=s[c])&&(r.push(e.call(o,o.__data__,c,s)),i.push(o));return new kr(r,i)},selectChild:function(e){return this.select(null==e?In:function(e){return function(){return On.call(this.children,e)}}("function"===typeof e?e:Fn(e)))},selectChildren:function(e){return this.selectAll(null==e?kn:function(e){return function(){return Bn.call(this.children,e)}}("function"===typeof e?e:Fn(e)))},filter:function(e){"function"!==typeof e&&(e=Pn(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o=t[i],s=o.length,l=r[i]=[],c=0;c<s;++c)(a=o[c])&&e.call(a,a.__data__,c,o)&&l.push(a);return new kr(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,Vn);var n=t?Hn:zn,r=this._parents,i=this._groups;"function"!==typeof e&&(e=function(e){return function(){return e}}(e));for(var a=i.length,o=new Array(a),s=new Array(a),l=new Array(a),c=0;c<a;++c){var u=r[c],h=i[c],d=h.length,f=Gn(e.call(u,u&&u.__data__,c,r)),p=f.length,m=s[c]=new Array(p),g=o[c]=new Array(p);n(u,h,m,g,l[c]=new Array(d),f,t);for(var v,y,x=0,b=0;x<p;++x)if(v=m[x]){for(x>=b&&(b=x+1);!(y=g[b])&&++b<p;);v._next=y||null}}return(o=new kr(o,r))._enter=s,o._exit=l,o},enter:function(){return new kr(this._enter||this._groups.map(Ln),this._parents)},exit:function(){return new kr(this._exit||this._groups.map(Ln),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,a=this.exit();return"function"===typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),s=new Array(i),l=0;l<o;++l)for(var c,u=n[l],h=r[l],d=u.length,f=s[l]=new Array(d),p=0;p<d;++p)(c=u[p]||h[p])&&(f[p]=c);for(;l<i;++l)s[l]=n[l];return new kr(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=qn);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],l=s.length,c=i[a]=new Array(l),u=0;u<l;++u)(o=s[u])&&(c[u]=o);c.sort(t)}return new kr(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,a=t[n],o=0,s=a.length;o<s;++o)(i=a[o])&&e.call(i,i.__data__,o,a);return this},attr:function(e,t){var n=Xn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?Zn:Yn:"function"===typeof t?n.local?$n:Jn:n.local?Qn:Kn)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?tr:"function"===typeof t?rr:nr)(e,t,null==n?"":n)):ir(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?ar:"function"===typeof t?sr:or)(e,t)):this.node()[e]},classed:function(e,t){var n=lr(e+"");if(arguments.length<2){for(var r=cr(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof t?mr:t?fr:pr)(n,t))},text:function(e){return arguments.length?this.each(null==e?gr:("function"===typeof e?yr:vr)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?xr:("function"===typeof e?_r:br)(e)):this.node().innerHTML},raise:function(){return this.each(wr)},lower:function(){return this.each(Sr)},append:function(e){var t="function"===typeof e?e:Er(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"===typeof e?e:Er(e),r=null==t?Cr:"function"===typeof t?t:An(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Ar)},clone:function(e){return this.select(e?Nr:Tr)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,a=function(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}(e+""),o=a.length;if(!(arguments.length<2)){for(s=t?Pr:Rr,r=0;r<o;++r)this.each(s(a[r],t,n));return this}var s=this.node().__on;if(s)for(var l,c=0,u=s.length;c<u;++c)for(r=0,l=s[c];r<o;++r)if((i=a[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"===typeof t?Ir:Or)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,i=e[t],a=0,o=i.length;a<o;++a)(r=i[a])&&(yield r)}};const Ur=Lr;function zr(e){return"string"===typeof e?new kr([[document.querySelector(e)]],[document.documentElement]):new kr([[e]],Br)}const Hr={passive:!1},Vr={capture:!0,passive:!1};function Gr(e){e.stopImmediatePropagation()}function qr(e){e.preventDefault(),e.stopImmediatePropagation()}function jr(e){var t=e.document.documentElement,n=zr(e).on("dragstart.drag",qr,Vr);"onselectstart"in t?n.on("selectstart.drag",qr,Vr):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Wr(e,t){var n=e.document.documentElement,r=zr(e).on("dragstart.drag",null);t&&(r.on("click.drag",qr,Vr),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Xr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Yr(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Zr(){}var Kr=.7,Qr=1/Kr,Jr="\\s*([+-]?\\d+)\\s*",$r="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ei="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ti=/^#([0-9a-f]{3,8})$/,ni=new RegExp("^rgb\\(".concat(Jr,",").concat(Jr,",").concat(Jr,"\\)$")),ri=new RegExp("^rgb\\(".concat(ei,",").concat(ei,",").concat(ei,"\\)$")),ii=new RegExp("^rgba\\(".concat(Jr,",").concat(Jr,",").concat(Jr,",").concat($r,"\\)$")),ai=new RegExp("^rgba\\(".concat(ei,",").concat(ei,",").concat(ei,",").concat($r,"\\)$")),oi=new RegExp("^hsl\\(".concat($r,",").concat(ei,",").concat(ei,"\\)$")),si=new RegExp("^hsla\\(".concat($r,",").concat(ei,",").concat(ei,",").concat($r,"\\)$")),li={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ci(){return this.rgb().formatHex()}function ui(){return this.rgb().formatRgb()}function hi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=ti.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?di(t):3===n?new gi(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?fi(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?fi(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=ni.exec(e))?new gi(t[1],t[2],t[3],1):(t=ri.exec(e))?new gi(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=ii.exec(e))?fi(t[1],t[2],t[3],t[4]):(t=ai.exec(e))?fi(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=oi.exec(e))?wi(t[1],t[2]/100,t[3]/100,1):(t=si.exec(e))?wi(t[1],t[2]/100,t[3]/100,t[4]):li.hasOwnProperty(e)?di(li[e]):"transparent"===e?new gi(NaN,NaN,NaN,0):null}function di(e){return new gi(e>>16&255,e>>8&255,255&e,1)}function fi(e,t,n,r){return r<=0&&(e=t=n=NaN),new gi(e,t,n,r)}function pi(e){return e instanceof Zr||(e=hi(e)),e?new gi((e=e.rgb()).r,e.g,e.b,e.opacity):new gi}function mi(e,t,n,r){return 1===arguments.length?pi(e):new gi(e,t,n,null==r?1:r)}function gi(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function vi(){return"#".concat(_i(this.r)).concat(_i(this.g)).concat(_i(this.b))}function yi(){const e=xi(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(bi(this.r),", ").concat(bi(this.g),", ").concat(bi(this.b)).concat(1===e?")":", ".concat(e,")"))}function xi(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function bi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function _i(e){return((e=bi(e))<16?"0":"")+e.toString(16)}function wi(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Di(e,t,n,r)}function Si(e){if(e instanceof Di)return new Di(e.h,e.s,e.l,e.opacity);if(e instanceof Zr||(e=hi(e)),!e)return new Di;if(e instanceof Di)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,l=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Di(o,s,l,e.opacity)}function Mi(e,t,n,r){return 1===arguments.length?Si(e):new Di(e,t,n,null==r?1:r)}function Di(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Ei(e){return(e=(e||0)%360)<0?e+360:e}function Ci(e){return Math.max(0,Math.min(1,e||0))}function Ai(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function Ti(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}function Ni(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return Ti((n-r/t)*t,o,i,a,s)}}function Ri(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return Ti((n-r/t)*t,i,a,o,s)}}Xr(Zr,hi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ci,formatHex:ci,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Si(this).formatHsl()},formatRgb:ui,toString:ui}),Xr(gi,mi,Yr(Zr,{brighter(e){return e=null==e?Qr:Math.pow(Qr,e),new gi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Kr:Math.pow(Kr,e),new gi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new gi(bi(this.r),bi(this.g),bi(this.b),xi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:vi,formatHex:vi,formatHex8:function(){return"#".concat(_i(this.r)).concat(_i(this.g)).concat(_i(this.b)).concat(_i(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:yi,toString:yi})),Xr(Di,Mi,Yr(Zr,{brighter(e){return e=null==e?Qr:Math.pow(Qr,e),new Di(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Kr:Math.pow(Kr,e),new Di(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new gi(Ai(e>=240?e-240:e+120,i,r),Ai(e,i,r),Ai(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Di(Ei(this.h),Ci(this.s),Ci(this.l),xi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=xi(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(Ei(this.h),", ").concat(100*Ci(this.s),"%, ").concat(100*Ci(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const Pi=e=>()=>e;function Fi(e,t){return function(n){return e+n*t}}function Oi(e,t){var n=t-e;return n?Fi(e,n>180||n<-180?n-360*Math.round(n/360):n):Pi(isNaN(e)?t:e)}function Ii(e){return 1===(e=+e)?Bi:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Pi(isNaN(t)?n:t)}}function Bi(e,t){var n=t-e;return n?Fi(e,n):Pi(isNaN(e)?t:e)}const ki=function e(t){var n=Ii(t);function r(e,t){var r=n((e=mi(e)).r,(t=mi(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=Bi(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function Li(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=mi(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}var Ui=Li(Ni),zi=Li(Ri);function Hi(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(n=0;n<r;++n)i[n]=e[n]*(1-a)+t[n]*a;return i}}function Vi(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Gi(e,t){return(Vi(t)?Hi:qi)(e,t)}function qi(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Qi(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=a[n](e);return o}}function ji(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Wi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Xi(e,t){var n,r={},i={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=Qi(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}var Yi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Zi=new RegExp(Yi.source,"g");function Ki(e,t){var n,r,i,a=Yi.lastIndex=Zi.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(n=Yi.exec(e))&&(r=Zi.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,l.push({i:o,x:Wi(n,r)})),a=Zi.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}function Qi(e,t){var n,r=typeof t;return null==t||"boolean"===r?Pi(t):("number"===r?Wi:"string"===r?(n=hi(t))?(t=n,ki):Ki:t instanceof hi?ki:t instanceof Date?ji:Vi(t)?Hi:Array.isArray(t)?qi:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?Xi:Wi)(e,t)}function Ji(e){let t;for(;t=e.sourceEvent;)e=t;return e}function $i(e,t){if(e=Ji(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}var ea,ta,na=0,ra=0,ia=0,aa=0,oa=0,sa=0,la="object"===typeof performance&&performance.now?performance:Date,ca="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ua(){return oa||(ca(ha),oa=la.now()+sa)}function ha(){oa=0}function da(){this._call=this._time=this._next=null}function fa(e,t,n){var r=new da;return r.restart(e,t,n),r}function pa(){ua(),++na;for(var e,t=ea;t;)(e=oa-t._time)>=0&&t._call.call(void 0,e),t=t._next;--na}function ma(){oa=(aa=la.now())+sa,na=ra=0;try{pa()}finally{na=0,function(){var e,t,n=ea,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:ea=t);ta=e,va(r)}(),oa=0}}function ga(){var e=la.now(),t=e-aa;t>1e3&&(sa-=t,aa=e)}function va(e){na||(ra&&(ra=clearTimeout(ra)),e-oa>24?(e<1/0&&(ra=setTimeout(ma,e-la.now()-sa)),ia&&(ia=clearInterval(ia))):(ia||(aa=la.now(),ia=setInterval(ga,1e3)),na=1,ca(ma)))}function ya(e,t,n){var r=new da;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}da.prototype=fa.prototype={constructor:da,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?ua():+n)+(null==t?0:+t),this._next||ta===this||(ta?ta._next=this:ea=this,ta=this),this._call=e,this._time=n,va()},stop:function(){this._call&&(this._call=null,this._time=1/0,va())}};var xa=En("start","end","cancel","interrupt"),ba=[],_a=1,wa=2,Sa=5,Ma=6;function Da(e,t,n,r,i,a){var o=e.__transition;if(o){if(n in o)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function a(e){n.state=_a,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}function o(a){var c,u,h,d;if(n.state!==_a)return l();for(c in i)if((d=i[c]).name===n.name){if(3===d.state)return ya(o);4===d.state?(d.state=Ma,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete i[c]):+c<t&&(d.state=Ma,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete i[c])}if(ya((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(a))})),n.state=wa,n.on.call("start",e,e.__data__,n.index,n.group),n.state===wa){for(n.state=3,r=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function s(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=Sa,1),a=-1,o=r.length;++a<o;)r[a].call(e,i);n.state===Sa&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var r in n.state=Ma,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=fa(a,0,n.time)}(e,n,{name:t,index:r,group:i,on:xa,tween:ba,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function Ea(e,t){var n=Aa(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function Ca(e,t){var n=Aa(e,t);if(n.state>3)throw new Error("too late; already running");return n}function Aa(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Ta(e,t){var n,r,i,a=e.__transition,o=!0;if(a){for(i in t=null==t?null:t+"",a)(n=a[i]).name===t?(r=n.state>wa&&n.state<Sa,n.state=Ma,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete e.__transition}}var Na,Ra=180/Math.PI,Pa={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Fa(e,t,n,r,i,a){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Ra,skewX:Math.atan(l)*Ra,scaleX:o,scaleY:s}}function Oa(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(a,o){var s=[],l=[];return a=e(a),o=e(o),function(e,r,i,a,o,s){if(e!==i||r!==a){var l=o.push("translate(",null,t,null,n);s.push({i:l-4,x:Wi(e,i)},{i:l-2,x:Wi(r,a)})}else(i||a)&&o.push("translate("+i+t+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,l),function(e,t,n,a){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Wi(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(a.rotate,o.rotate,s,l),function(e,t,n,a){e!==t?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Wi(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(a.skewX,o.skewX,s,l),function(e,t,n,r,a,o){if(e!==n||t!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:Wi(e,n)},{i:s-2,x:Wi(t,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,l),a=o=null,function(e){for(var t,n=-1,r=l.length;++n<r;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var Ia=Oa((function(e){const t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Pa:Fa(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),Ba=Oa((function(e){return null==e?Pa:(Na||(Na=document.createElementNS("http://www.w3.org/2000/svg","g")),Na.setAttribute("transform",e),(e=Na.transform.baseVal.consolidate())?Fa((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Pa)}),", ",")",")");function ka(e,t){var n,r;return function(){var i=Ca(this,e),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===t){(r=r.slice()).splice(o,1);break}i.tween=r}}function La(e,t,n){var r,i;if("function"!==typeof n)throw new Error;return function(){var a=Ca(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=s;break}l===c&&i.push(s)}a.tween=i}}function Ua(e,t,n){var r=e._id;return e.each((function(){var e=Ca(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return Aa(e,r).value[t]}}function za(e,t){var n;return("number"===typeof t?Wi:t instanceof hi?ki:(n=hi(t))?(t=n,ki):Ki)(e,t)}function Ha(e){return function(){this.removeAttribute(e)}}function Va(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ga(e,t,n){var r,i,a=n+"";return function(){var o=this.getAttribute(e);return o===a?null:o===r?i:i=t(r=o,n)}}function qa(e,t,n){var r,i,a=n+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===a?null:o===r?i:i=t(r=o,n)}}function ja(e,t,n){var r,i,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttribute(e))===(s=l+"")?null:o===r&&s===i?a:(i=s,a=t(r=o,l));this.removeAttribute(e)}}function Wa(e,t,n){var r,i,a;return function(){var o,s,l=n(this);if(null!=l)return(o=this.getAttributeNS(e.space,e.local))===(s=l+"")?null:o===r&&s===i?a:(i=s,a=t(r=o,l));this.removeAttributeNS(e.space,e.local)}}function Xa(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,i)),n}return i._value=t,i}function Ya(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,i)),n}return i._value=t,i}function Za(e,t){return function(){Ea(this,e).delay=+t.apply(this,arguments)}}function Ka(e,t){return t=+t,function(){Ea(this,e).delay=t}}function Qa(e,t){return function(){Ca(this,e).duration=+t.apply(this,arguments)}}function Ja(e,t){return t=+t,function(){Ca(this,e).duration=t}}var $a=Ur.prototype.constructor;function eo(e){return function(){this.style.removeProperty(e)}}var to=0;function no(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function ro(e){return Ur().transition(e)}function io(){return++to}var ao=Ur.prototype;function oo(e){return e*e*e}function so(e){return--e*e*e+1}function lo(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}no.prototype=ro.prototype={constructor:no,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=An(e));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,l,c=r[o],u=c.length,h=a[o]=new Array(u),d=0;d<u;++d)(s=c[d])&&(l=e.call(s,s.__data__,d,c))&&("__data__"in s&&(l.__data__=s.__data__),h[d]=l,Da(h[d],t,n,d,h,Aa(s,n)));return new no(a,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=Rn(e));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var l,c=r[s],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,f=e.call(l,l.__data__,h,c),p=Aa(l,n),m=0,g=f.length;m<g;++m)(d=f[m])&&Da(d,t,n,m,f,p);a.push(f),o.push(l)}return new no(a,o,t,n)},selectChild:ao.selectChild,selectChildren:ao.selectChildren,filter:function(e){"function"!==typeof e&&(e=Pn(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o=t[i],s=o.length,l=r[i]=[],c=0;c<s;++c)(a=o[c])&&e.call(a,a.__data__,c,o)&&l.push(a);return new no(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var l,c=t[s],u=n[s],h=c.length,d=o[s]=new Array(h),f=0;f<h;++f)(l=c[f]||u[f])&&(d[f]=l);for(;s<r;++s)o[s]=t[s];return new no(o,this._parents,this._name,this._id)},selection:function(){return new $a(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=io(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,c=0;c<l;++c)if(o=s[c]){var u=Aa(o,t);Da(o,e,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new no(r,this._parents,e,n)},call:ao.call,nodes:ao.nodes,node:ao.node,size:ao.size,empty:ao.empty,each:ao.each,on:function(e,t){var n=this._id;return arguments.length<2?Aa(this.node(),n).on.on(e):this.each(function(e,t,n){var r,i,a=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?Ea:Ca;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}(n,e,t))},attr:function(e,t){var n=Xn(e),r="transform"===n?Ba:za;return this.attrTween(e,"function"===typeof t?(n.local?Wa:ja)(n,r,Ua(this,"attr."+e,t)):null==t?(n.local?Va:Ha)(n):(n.local?qa:Ga)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var r=Xn(e);return this.tween(n,(r.local?Xa:Ya)(r,t))},style:function(e,t,n){var r="transform"===(e+="")?Ia:za;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var a=ir(this,e),o=(this.style.removeProperty(e),ir(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}(e,r)).on("end.style."+e,eo(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var r,i,a;return function(){var o=ir(this,e),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(e),l=s=ir(this,e)),o===l?null:o===r&&l===i?a:(i=l,a=t(r=o,s))}}(e,r,Ua(this,"style."+e,t))).each(function(e,t){var n,r,i,a,o="style."+t,s="end."+o;return function(){var l=Ca(this,e),c=l.on,u=null==l.value[o]?a||(a=eo(t)):void 0;c===n&&i===u||(r=(n=c).copy()).on(s,i=u),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,a=n+"";return function(){var o=ir(this,e);return o===a?null:o===r?i:i=t(r=o,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!==typeof t)throw new Error;return this.tween(r,function(e,t,n){var r,i;function a(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&function(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}(e,a,n)),r}return a._value=t,a}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Ua(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){return function(t){this.textContent=e.call(this,t)}}(r)),t}return r._value=e,r}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=Aa(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===e)return r.value;return null}return this.each((null==t?ka:La)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?Za:Ka)(t,e)):Aa(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?Qa:Ja)(t,e)):Aa(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!==typeof t)throw new Error;return function(){Ca(this,e).ease=t}}(t,e)):Aa(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;Ca(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(a,o){var s={value:o},l={value:function(){0===--i&&a()}};n.each((function(){var n=Ca(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(l)),n.on=t})),0===i&&a()}))},[Symbol.iterator]:ao[Symbol.iterator]};var co={time:null,delay:0,duration:250,ease:lo};function uo(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}Ur.prototype.interrupt=function(e){return this.each((function(){Ta(this,e)}))},Ur.prototype.transition=function(e){var t,n;e instanceof no?(t=e._id,e=e._name):(t=io(),(n=co).time=ua(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],l=s.length,c=0;c<l;++c)(o=s[c])&&Da(o,e,t,c,s,n||uo(o,t));return new no(r,this._parents,e,t)};var ho=[null];function fo(e,t){var n,r,i=e.__transition;if(i)for(r in t=null==t?null:t+"",i)if((n=i[r]).state>_a&&n.name===t)return new no([[e]],ho,t,+r);return null}const po=e=>()=>e;function mo(e,t){let{sourceEvent:n,target:r,selection:i,mode:a,dispatch:o}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:a,enumerable:!0,configurable:!0},_:{value:o}})}function go(e){e.preventDefault(),e.stopImmediatePropagation()}var vo={name:"drag"},yo={name:"space"},xo={name:"handle"},bo={name:"center"};const{abs:_o,max:wo,min:So}=Math;function Mo(e){return[+e[0],+e[1]]}function Do(e){return[Mo(e[0]),Mo(e[1])]}var Eo={name:"x",handles:["w","e"].map(Oo),input:function(e,t){return null==e?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},Co={name:"y",handles:["n","s"].map(Oo),input:function(e,t){return null==e?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},Ao={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Oo),input:function(e){return null==e?null:Do(e)},output:function(e){return e}},To={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},No={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Ro={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Po={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Fo={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Oo(e){return{type:e}}function Io(e){return!e.ctrlKey&&!e.button}function Bo(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function ko(){return navigator.maxTouchPoints||"ontouchstart"in this}function Lo(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function Uo(e){var t=e.__brush;return t?t.dim.output(t.selection):null}function zo(){return Go(Eo)}function Ho(){return Go(Co)}function Vo(){return Go(Ao)}function Go(e){var t,n=Bo,r=Io,i=ko,a=!0,o=En("start","brush","end"),s=6;function l(t){var n=t.property("__brush",m).selectAll(".overlay").data([Oo("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",To.overlay).merge(n).each((function(){var e=Lo(this).extent;zr(this).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1])})),t.selectAll(".selection").data([Oo("selection")]).enter().append("rect").attr("class","selection").attr("cursor",To.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=t.selectAll(".handle").data(e.handles,(function(e){return e.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(e){return"handle handle--"+e.type})).attr("cursor",(function(e){return To[e.type]})),t.each(c).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",d).filter(i).on("touchstart.brush",d).on("touchmove.brush",f).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function c(){var e=zr(this),t=Lo(this).selection;t?(e.selectAll(".selection").style("display",null).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1]),e.selectAll(".handle").style("display",null).attr("x",(function(e){return"e"===e.type[e.type.length-1]?t[1][0]-s/2:t[0][0]-s/2})).attr("y",(function(e){return"s"===e.type[0]?t[1][1]-s/2:t[0][1]-s/2})).attr("width",(function(e){return"n"===e.type||"s"===e.type?t[1][0]-t[0][0]+s:s})).attr("height",(function(e){return"e"===e.type||"w"===e.type?t[1][1]-t[0][1]+s:s}))):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(e,t,n){var r=e.__brush.emitter;return!r||n&&r.clean?new h(e,t,n):r}function h(e,t,n){this.that=e,this.args=t,this.state=e.__brush,this.active=0,this.clean=n}function d(n){if((!t||n.touches)&&r.apply(this,arguments)){var i,o,s,l,h,d,f,p,m,g,v,y=this,x=n.target.__data__.type,b="selection"===(a&&n.metaKey?x="overlay":x)?vo:a&&n.altKey?bo:xo,_=e===Co?null:Po[x],w=e===Eo?null:Fo[x],S=Lo(y),M=S.extent,D=S.selection,E=M[0][0],C=M[0][1],A=M[1][0],T=M[1][1],N=0,R=0,P=_&&w&&a&&n.shiftKey,F=Array.from(n.touches||[n],(e=>{const t=e.identifier;return(e=$i(e,y)).point0=e.slice(),e.identifier=t,e}));Ta(y);var O=u(y,arguments,!0).beforestart();if("overlay"===x){D&&(m=!0);const t=[F[0],F[1]||F[0]];S.selection=D=[[i=e===Co?E:So(t[0][0],t[1][0]),s=e===Eo?C:So(t[0][1],t[1][1])],[h=e===Co?A:wo(t[0][0],t[1][0]),f=e===Eo?T:wo(t[0][1],t[1][1])]],F.length>1&&U(n)}else i=D[0][0],s=D[0][1],h=D[1][0],f=D[1][1];o=i,l=s,d=h,p=f;var I=zr(y).attr("pointer-events","none"),B=I.selectAll(".overlay").attr("cursor",To[x]);if(n.touches)O.moved=L,O.ended=z;else{var k=zr(n.view).on("mousemove.brush",L,!0).on("mouseup.brush",z,!0);a&&k.on("keydown.brush",(function(e){switch(e.keyCode){case 16:P=_&&w;break;case 18:b===xo&&(_&&(h=d-N*_,i=o+N*_),w&&(f=p-R*w,s=l+R*w),b=bo,U(e));break;case 32:b!==xo&&b!==bo||(_<0?h=d-N:_>0&&(i=o-N),w<0?f=p-R:w>0&&(s=l-R),b=yo,B.attr("cursor",To.selection),U(e));break;default:return}go(e)}),!0).on("keyup.brush",(function(e){switch(e.keyCode){case 16:P&&(g=v=P=!1,U(e));break;case 18:b===bo&&(_<0?h=d:_>0&&(i=o),w<0?f=p:w>0&&(s=l),b=xo,U(e));break;case 32:b===yo&&(e.altKey?(_&&(h=d-N*_,i=o+N*_),w&&(f=p-R*w,s=l+R*w),b=bo):(_<0?h=d:_>0&&(i=o),w<0?f=p:w>0&&(s=l),b=xo),B.attr("cursor",To[x]),U(e));break;default:return}go(e)}),!0),jr(n.view)}c.call(y),O.start(n,b.name)}function L(e){for(const t of e.changedTouches||[e])for(const e of F)e.identifier===t.identifier&&(e.cur=$i(t,y));if(P&&!g&&!v&&1===F.length){const e=F[0];_o(e.cur[0]-e[0])>_o(e.cur[1]-e[1])?v=!0:g=!0}for(const t of F)t.cur&&(t[0]=t.cur[0],t[1]=t.cur[1]);m=!0,go(e),U(e)}function U(e){const t=F[0],n=t.point0;var r;switch(N=t[0]-n[0],R=t[1]-n[1],b){case yo:case vo:_&&(N=wo(E-i,So(A-h,N)),o=i+N,d=h+N),w&&(R=wo(C-s,So(T-f,R)),l=s+R,p=f+R);break;case xo:F[1]?(_&&(o=wo(E,So(A,F[0][0])),d=wo(E,So(A,F[1][0])),_=1),w&&(l=wo(C,So(T,F[0][1])),p=wo(C,So(T,F[1][1])),w=1)):(_<0?(N=wo(E-i,So(A-i,N)),o=i+N,d=h):_>0&&(N=wo(E-h,So(A-h,N)),o=i,d=h+N),w<0?(R=wo(C-s,So(T-s,R)),l=s+R,p=f):w>0&&(R=wo(C-f,So(T-f,R)),l=s,p=f+R));break;case bo:_&&(o=wo(E,So(A,i-N*_)),d=wo(E,So(A,h+N*_))),w&&(l=wo(C,So(T,s-R*w)),p=wo(C,So(T,f+R*w)))}d<o&&(_*=-1,r=i,i=h,h=r,r=o,o=d,d=r,x in No&&B.attr("cursor",To[x=No[x]])),p<l&&(w*=-1,r=s,s=f,f=r,r=l,l=p,p=r,x in Ro&&B.attr("cursor",To[x=Ro[x]])),S.selection&&(D=S.selection),g&&(o=D[0][0],d=D[1][0]),v&&(l=D[0][1],p=D[1][1]),D[0][0]===o&&D[0][1]===l&&D[1][0]===d&&D[1][1]===p||(S.selection=[[o,l],[d,p]],c.call(y),O.brush(e,b.name))}function z(e){if(function(e){e.stopImmediatePropagation()}(e),e.touches){if(e.touches.length)return;t&&clearTimeout(t),t=setTimeout((function(){t=null}),500)}else Wr(e.view,m),k.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);I.attr("pointer-events","all"),B.attr("cursor",To.overlay),S.selection&&(D=S.selection),function(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}(D)&&(S.selection=null,c.call(y)),O.end(e,b.name)}}function f(e){u(this,arguments).moved(e)}function p(e){u(this,arguments).ended(e)}function m(){var t=this.__brush||{selection:null};return t.extent=Do(n.apply(this,arguments)),t.dim=e,t}return l.move=function(t,n,r){t.tween?t.on("start.brush",(function(e){u(this,arguments).beforestart().start(e)})).on("interrupt.brush end.brush",(function(e){u(this,arguments).end(e)})).tween("brush",(function(){var t=this,r=t.__brush,i=u(t,arguments),a=r.selection,o=e.input("function"===typeof n?n.apply(this,arguments):n,r.extent),s=Qi(a,o);function l(e){r.selection=1===e&&null===o?null:s(e),c.call(t),i.brush()}return null!==a&&null!==o?l:l(1)})):t.each((function(){var t=this,i=arguments,a=t.__brush,o=e.input("function"===typeof n?n.apply(t,i):n,a.extent),s=u(t,i).beforestart();Ta(t),a.selection=null===o?null:o,c.call(t),s.start(r).brush(r).end(r)}))},l.clear=function(e,t){l.move(e,null,t)},h.prototype={beforestart:function(){return 1===++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(e,t){return this.starting?(this.starting=!1,this.emit("start",e,t)):this.emit("brush",e),this},brush:function(e,t){return this.emit("brush",e,t),this},end:function(e,t){return 0===--this.active&&(delete this.state.emitter,this.emit("end",e,t)),this},emit:function(t,n,r){var i=zr(this.that).datum();o.call(t,this.that,new mo(t,{sourceEvent:n,target:l,selection:e.output(this.state.selection),mode:r,dispatch:o}),i)}},l.extent=function(e){return arguments.length?(n="function"===typeof e?e:po(Do(e)),l):n},l.filter=function(e){return arguments.length?(r="function"===typeof e?e:po(!!e),l):r},l.touchable=function(e){return arguments.length?(i="function"===typeof e?e:po(!!e),l):i},l.handleSize=function(e){return arguments.length?(s=+e,l):s},l.keyModifiers=function(e){return arguments.length?(a=!!e,l):a},l.on=function(){var e=o.on.apply(o,arguments);return e===o?l:e},l}var qo,jo,Wo,Xo,Yo,Zo,Ko,Qo,Jo,$o,es,ts,ns,rs,is=Math.abs,as=Math.cos,os=Math.sin,ss=Math.PI,ls=ss/2,cs=2*ss,us=Math.max,hs=1e-12;function ds(e,t){return Array.from({length:t-e},((t,n)=>e+n))}function fs(){return gs(!1,!1)}function ps(){return gs(!1,!0)}function ms(){return gs(!0,!1)}function gs(e,t){var n=0,r=null,i=null,a=null;function o(o){var s,l=o.length,c=new Array(l),u=ds(0,l),h=new Array(l*l),d=new Array(l),f=0;o=Float64Array.from({length:l*l},t?(e,t)=>o[t%l][t/l|0]:(e,t)=>o[t/l|0][t%l]);for(let t=0;t<l;++t){let n=0;for(let r=0;r<l;++r)n+=o[t*l+r]+e*o[r*l+t];f+=c[t]=n}s=(f=us(0,cs-n*l)/f)?n:cs/l;{let t=0;r&&u.sort(((e,t)=>r(c[e],c[t])));for(const n of u){const r=t;if(e){const e=ds(1+~l,l).filter((e=>e<0?o[~e*l+n]:o[n*l+e]));i&&e.sort(((e,t)=>i(e<0?-o[~e*l+n]:o[n*l+e],t<0?-o[~t*l+n]:o[n*l+t])));for(const r of e)if(r<0){(h[~r*l+n]||(h[~r*l+n]={source:null,target:null})).target={index:n,startAngle:t,endAngle:t+=o[~r*l+n]*f,value:o[~r*l+n]}}else{(h[n*l+r]||(h[n*l+r]={source:null,target:null})).source={index:n,startAngle:t,endAngle:t+=o[n*l+r]*f,value:o[n*l+r]}}d[n]={index:n,startAngle:r,endAngle:t,value:c[n]}}else{const e=ds(0,l).filter((e=>o[n*l+e]||o[e*l+n]));i&&e.sort(((e,t)=>i(o[n*l+e],o[n*l+t])));for(const r of e){let e;if(n<r?(e=h[n*l+r]||(h[n*l+r]={source:null,target:null}),e.source={index:n,startAngle:t,endAngle:t+=o[n*l+r]*f,value:o[n*l+r]}):(e=h[r*l+n]||(h[r*l+n]={source:null,target:null}),e.target={index:n,startAngle:t,endAngle:t+=o[n*l+r]*f,value:o[n*l+r]},n===r&&(e.source=e.target)),e.source&&e.target&&e.source.value<e.target.value){const t=e.source;e.source=e.target,e.target=t}}d[n]={index:n,startAngle:r,endAngle:t,value:c[n]}}t+=s}}return(h=Object.values(h)).groups=d,a?h.sort(a):h}return o.padAngle=function(e){return arguments.length?(n=us(0,e),o):n},o.sortGroups=function(e){return arguments.length?(r=e,o):r},o.sortSubgroups=function(e){return arguments.length?(i=e,o):i},o.sortChords=function(e){return arguments.length?(null==e?a=null:(a=function(e){return function(t,n){return e(t.source.value+t.target.value,n.source.value+n.target.value)}}(e))._=e,o):a&&a._},o}function vs(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}const ys=Math.PI,xs=2*ys,bs=1e-6,_s=xs-bs;function ws(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class Ss{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?ws:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return ws;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append(qo||(qo=vs(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(jo||(jo=vs(["Z"]))))}lineTo(e,t){this._append(Wo||(Wo=vs(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,r){this._append(Xo||(Xo=vs(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}bezierCurveTo(e,t,n,r,i,a){this._append(Yo||(Yo=vs(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+i,this._y1=+a)}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: ".concat(i));let a=this._x1,o=this._y1,s=n-e,l=r-t,c=a-e,u=o-t,h=c*c+u*u;if(null===this._x1)this._append(Zo||(Zo=vs(["M",",",""])),this._x1=e,this._y1=t);else if(h>bs)if(Math.abs(u*s-l*c)>bs&&i){let d=n-a,f=r-o,p=s*s+l*l,m=d*d+f*f,g=Math.sqrt(p),v=Math.sqrt(h),y=i*Math.tan((ys-Math.acos((p+h-m)/(2*g*v)))/2),x=y/v,b=y/g;Math.abs(x-1)>bs&&this._append(Qo||(Qo=vs(["L",",",""])),e+x*c,t+x*u),this._append(Jo||(Jo=vs(["A",",",",0,0,",",",",",""])),i,i,+(u*d>c*f),this._x1=e+b*s,this._y1=t+b*l)}else this._append(Ko||(Ko=vs(["L",",",""])),this._x1=e,this._y1=t);else;}arc(e,t,n,r,i,a){if(e=+e,t=+t,a=!!a,(n=+n)<0)throw new Error("negative radius: ".concat(n));let o=n*Math.cos(r),s=n*Math.sin(r),l=e+o,c=t+s,u=1^a,h=a?r-i:i-r;null===this._x1?this._append($o||($o=vs(["M",",",""])),l,c):(Math.abs(this._x1-l)>bs||Math.abs(this._y1-c)>bs)&&this._append(es||(es=vs(["L",",",""])),l,c),n&&(h<0&&(h=h%xs+xs),h>_s?this._append(ts||(ts=vs(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,u,e-o,t-s,n,n,u,this._x1=l,this._y1=c):h>bs&&this._append(ns||(ns=vs(["A",",",",0,",",",",",",",""])),n,n,+(h>=ys),u,this._x1=e+n*Math.cos(i),this._y1=t+n*Math.sin(i)))}rect(e,t,n,r){this._append(rs||(rs=vs(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}toString(){return this._}}function Ms(){return new Ss}function Ds(){return new Ss(+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:3))}Ms.prototype=Ss.prototype;var Es=Array.prototype.slice;function Cs(e){return function(){return e}}function As(e){return e.source}function Ts(e){return e.target}function Ns(e){return e.radius}function Rs(e){return e.startAngle}function Ps(e){return e.endAngle}function Fs(){return 0}function Os(){return 10}function Is(e){var t=As,n=Ts,r=Ns,i=Ns,a=Rs,o=Ps,s=Fs,l=null;function c(){var c,u=t.apply(this,arguments),h=n.apply(this,arguments),d=s.apply(this,arguments)/2,f=Es.call(arguments),p=+r.apply(this,(f[0]=u,f)),m=a.apply(this,f)-ls,g=o.apply(this,f)-ls,v=+i.apply(this,(f[0]=h,f)),y=a.apply(this,f)-ls,x=o.apply(this,f)-ls;if(l||(l=c=Ms()),d>hs&&(is(g-m)>2*d+hs?g>m?(m+=d,g-=d):(m-=d,g+=d):m=g=(m+g)/2,is(x-y)>2*d+hs?x>y?(y+=d,x-=d):(y-=d,x+=d):y=x=(y+x)/2),l.moveTo(p*as(m),p*os(m)),l.arc(0,0,p,m,g),m!==y||g!==x)if(e){var b=v-+e.apply(this,arguments),_=(y+x)/2;l.quadraticCurveTo(0,0,b*as(y),b*os(y)),l.lineTo(v*as(_),v*os(_)),l.lineTo(b*as(x),b*os(x))}else l.quadraticCurveTo(0,0,v*as(y),v*os(y)),l.arc(0,0,v,y,x);if(l.quadraticCurveTo(0,0,p*as(m),p*os(m)),l.closePath(),c)return l=null,c+""||null}return e&&(c.headRadius=function(t){return arguments.length?(e="function"===typeof t?t:Cs(+t),c):e}),c.radius=function(e){return arguments.length?(r=i="function"===typeof e?e:Cs(+e),c):r},c.sourceRadius=function(e){return arguments.length?(r="function"===typeof e?e:Cs(+e),c):r},c.targetRadius=function(e){return arguments.length?(i="function"===typeof e?e:Cs(+e),c):i},c.startAngle=function(e){return arguments.length?(a="function"===typeof e?e:Cs(+e),c):a},c.endAngle=function(e){return arguments.length?(o="function"===typeof e?e:Cs(+e),c):o},c.padAngle=function(e){return arguments.length?(s="function"===typeof e?e:Cs(+e),c):s},c.source=function(e){return arguments.length?(t=e,c):t},c.target=function(e){return arguments.length?(n=e,c):n},c.context=function(e){return arguments.length?(l=null==e?null:e,c):l},c}function Bs(){return Is()}function ks(){return Is(Os)}const Ls=Math.PI/180,Us=180/Math.PI,zs=.96422,Hs=1,Vs=.82521,Gs=4/29,qs=6/29,js=3*qs*qs,Ws=qs*qs*qs;function Xs(e){if(e instanceof Ks)return new Ks(e.l,e.a,e.b,e.opacity);if(e instanceof il)return al(e);e instanceof gi||(e=pi(e));var t,n,r=el(e.r),i=el(e.g),a=el(e.b),o=Qs((.2225045*r+.7168786*i+.0606169*a)/Hs);return r===i&&i===a?t=n=o:(t=Qs((.4360747*r+.3850649*i+.1430804*a)/zs),n=Qs((.0139322*r+.0971045*i+.7141733*a)/Vs)),new Ks(116*o-16,500*(t-o),200*(o-n),e.opacity)}function Ys(e,t){return new Ks(e,0,0,null==t?1:t)}function Zs(e,t,n,r){return 1===arguments.length?Xs(e):new Ks(e,t,n,null==r?1:r)}function Ks(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function Qs(e){return e>Ws?Math.pow(e,1/3):e/js+Gs}function Js(e){return e>qs?e*e*e:js*(e-Gs)}function $s(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function el(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function tl(e){if(e instanceof il)return new il(e.h,e.c,e.l,e.opacity);if(e instanceof Ks||(e=Xs(e)),0===e.a&&0===e.b)return new il(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Us;return new il(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function nl(e,t,n,r){return 1===arguments.length?tl(e):new il(n,t,e,null==r?1:r)}function rl(e,t,n,r){return 1===arguments.length?tl(e):new il(e,t,n,null==r?1:r)}function il(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function al(e){if(isNaN(e.h))return new Ks(e.l,0,0,e.opacity);var t=e.h*Ls;return new Ks(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Xr(Ks,Zs,Yr(Zr,{brighter(e){return new Ks(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new Ks(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new gi($s(3.1338561*(t=zs*Js(t))-1.6168667*(e=Hs*Js(e))-.4906146*(n=Vs*Js(n))),$s(-.9787684*t+1.9161415*e+.033454*n),$s(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Xr(il,rl,Yr(Zr,{brighter(e){return new il(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new il(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return al(this).rgb()}}));var ol=-.14861,sl=1.78277,ll=-.29227,cl=-.90649,ul=1.97294,hl=ul*cl,dl=ul*sl,fl=sl*ll-cl*ol;function pl(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof ml)return new ml(e.h,e.s,e.l,e.opacity);e instanceof gi||(e=pi(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(fl*r+hl*t-dl*n)/(fl+hl-dl),a=r-i,o=(ul*(n-i)-ll*a)/cl,s=Math.sqrt(o*o+a*a)/(ul*i*(1-i)),l=s?Math.atan2(o,a)*Us-120:NaN;return new ml(l<0?l+360:l,s,i,e.opacity)}(e):new ml(e,t,n,null==r?1:r)}function ml(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Xr(ml,pl,Yr(Zr,{brighter(e){return e=null==e?Qr:Math.pow(Qr,e),new ml(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Kr:Math.pow(Kr,e),new ml(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*Ls,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new gi(255*(t+n*(ol*r+sl*i)),255*(t+n*(ll*r+cl*i)),255*(t+n*(ul*r)),this.opacity)}}));var gl=Array.prototype.slice;function vl(e,t){return e-t}const yl=e=>()=>e;function xl(e,t){for(var n,r=-1,i=t.length;++r<i;)if(n=bl(e,t[r]))return n;return 0}function bl(e,t){for(var n=t[0],r=t[1],i=-1,a=0,o=e.length,s=o-1;a<o;s=a++){var l=e[a],c=l[0],u=l[1],h=e[s],d=h[0],f=h[1];if(_l(l,h,t))return 0;u>r!==f>r&&n<(d-c)*(r-u)/(f-u)+c&&(i=-i)}return i}function _l(e,t,n){var r,i,a,o;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(i=e[r=+(e[0]===t[0])],a=n[r],o=t[r],i<=a&&a<=o||o<=a&&a<=i)}function wl(){}var Sl=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Ml(){var e=1,t=1,n=ht,r=s;function i(e){var t=n(e);if(Array.isArray(t))t=t.slice().sort(vl);else{const n=Ce(e,Dl);for(t=st(...ut(n[0],n[1],t),t);t[t.length-1]>=n[1];)t.pop();for(;t[1]<n[0];)t.shift()}return t.map((t=>a(e,t)))}function a(n,i){const a=null==i?NaN:+i;if(isNaN(a))throw new Error("invalid value: ".concat(i));var s=[],l=[];return function(n,r,i){var a,s,l,c,u,h,d=new Array,f=new Array;a=s=-1,c=El(n[0],r),Sl[c<<1].forEach(p);for(;++a<e-1;)l=c,c=El(n[a+1],r),Sl[l|c<<1].forEach(p);Sl[c|0].forEach(p);for(;++s<t-1;){for(a=-1,c=El(n[s*e+e],r),u=El(n[s*e],r),Sl[c<<1|u<<2].forEach(p);++a<e-1;)l=c,c=El(n[s*e+e+a+1],r),h=u,u=El(n[s*e+a+1],r),Sl[l|c<<1|u<<2|h<<3].forEach(p);Sl[c|u<<3].forEach(p)}a=-1,u=n[s*e]>=r,Sl[u<<2].forEach(p);for(;++a<e-1;)h=u,u=El(n[s*e+a+1],r),Sl[u<<2|h<<3].forEach(p);function p(e){var t,n,r=[e[0][0]+a,e[0][1]+s],l=[e[1][0]+a,e[1][1]+s],c=o(r),u=o(l);(t=f[c])?(n=d[u])?(delete f[t.end],delete d[n.start],t===n?(t.ring.push(l),i(t.ring)):d[t.start]=f[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete f[t.end],t.ring.push(l),f[t.end=u]=t):(t=d[u])?(n=f[c])?(delete d[t.start],delete f[n.end],t===n?(t.ring.push(l),i(t.ring)):d[n.start]=f[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=c]=t):d[c]=f[u]={start:c,end:u,ring:[r,l]}}Sl[u<<3].forEach(p)}(n,a,(function(e){r(e,n,a),function(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(e)>0?s.push([e]):l.push(e)})),l.forEach((function(e){for(var t,n=0,r=s.length;n<r;++n)if(-1!==xl((t=s[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:i,coordinates:s}}function o(t){return 2*t[0]+t[1]*(e+1)*4}function s(n,r,i){n.forEach((function(n){var a=n[0],o=n[1],s=0|a,l=0|o,c=Cl(r[l*e+s]);a>0&&a<e&&s===a&&(n[0]=Al(a,Cl(r[l*e+s-1]),c,i)),o>0&&o<t&&l===o&&(n[1]=Al(o,Cl(r[(l-1)*e+s]),c,i))}))}return i.contour=a,i.size=function(n){if(!arguments.length)return[e,t];var r=Math.floor(n[0]),a=Math.floor(n[1]);if(!(r>=0&&a>=0))throw new Error("invalid size");return e=r,t=a,i},i.thresholds=function(e){return arguments.length?(n="function"===typeof e?e:Array.isArray(e)?yl(gl.call(e)):yl(e),i):n},i.smooth=function(e){return arguments.length?(r=e?s:wl,i):r===s},i}function Dl(e){return isFinite(e)?e:NaN}function El(e,t){return null!=e&&+e>=t}function Cl(e){return null==e||isNaN(e=+e)?-1/0:e}function Al(e,t,n,r){const i=r-t,a=n-t,o=isFinite(i)||isFinite(a)?i/a:Math.sign(i)/Math.sign(a);return isNaN(o)?e:e+o-.5}function Tl(e){return e[0]}function Nl(e){return e[1]}function Rl(){return 1}function Pl(){var e=Tl,t=Nl,n=Rl,r=960,i=500,a=20,o=2,s=3*a,l=r+2*s>>o,c=i+2*s>>o,u=yl(20);function h(r){var i=new Float32Array(l*c),u=Math.pow(2,-o),h=-1;for(const a of r){var d=(e(a,++h,r)+s)*u,f=(t(a,h,r)+s)*u,p=+n(a,h,r);if(p&&d>=0&&d<l&&f>=0&&f<c){var m=Math.floor(d),g=Math.floor(f),v=d-m-.5,y=f-g-.5;i[m+g*l]+=(1-v)*(1-y)*p,i[m+1+g*l]+=v*(1-y)*p,i[m+1+(g+1)*l]+=v*y*p,i[m+(g+1)*l]+=(1-v)*y*p}}return fe({data:i,width:l,height:c},a*u),i}function d(e){var t=h(e),n=u(t),r=Math.pow(2,2*o);return Array.isArray(n)||(n=st(Number.MIN_VALUE,ft(t)/r,n)),Ml().size([l,c]).thresholds(n.map((e=>e*r)))(t).map(((e,t)=>(e.value=+n[t],f(e))))}function f(e){return e.coordinates.forEach(p),e}function p(e){e.forEach(m)}function m(e){e.forEach(g)}function g(e){e[0]=e[0]*Math.pow(2,o)-s,e[1]=e[1]*Math.pow(2,o)-s}function v(){return l=r+2*(s=3*a)>>o,c=i+2*s>>o,d}return d.contours=function(e){var t=h(e),n=Ml().size([l,c]),r=Math.pow(2,2*o),i=e=>{e=+e;var i=f(n.contour(t,e*r));return i.value=e,i};return Object.defineProperty(i,"max",{get:()=>ft(t)/r}),i},d.x=function(t){return arguments.length?(e="function"===typeof t?t:yl(+t),d):e},d.y=function(e){return arguments.length?(t="function"===typeof e?e:yl(+e),d):t},d.weight=function(e){return arguments.length?(n="function"===typeof e?e:yl(+e),d):n},d.size=function(e){if(!arguments.length)return[r,i];var t=+e[0],n=+e[1];if(!(t>=0&&n>=0))throw new Error("invalid size");return r=t,i=n,v()},d.cellSize=function(e){if(!arguments.length)return 1<<o;if(!((e=+e)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(e)/Math.LN2),v()},d.thresholds=function(e){return arguments.length?(u="function"===typeof e?e:Array.isArray(e)?yl(gl.call(e)):yl(e),d):u},d.bandwidth=function(e){if(!arguments.length)return Math.sqrt(a*(a+1));if(!((e=+e)>=0))throw new Error("invalid bandwidth");return a=(Math.sqrt(4*e*e+1)-1)/2,v()},d}const Fl=134217729;function Ol(e,t,n,r,i){let a,o,s,l,c=t[0],u=r[0],h=0,d=0;u>c===u>-c?(a=c,c=t[++h]):(a=u,u=r[++d]);let f=0;if(h<e&&d<n)for(u>c===u>-c?(o=c+a,s=a-(o-c),c=t[++h]):(o=u+a,s=a-(o-u),u=r[++d]),a=o,0!==s&&(i[f++]=s);h<e&&d<n;)u>c===u>-c?(o=a+c,l=o-a,s=a-(o-l)+(c-l),c=t[++h]):(o=a+u,l=o-a,s=a-(o-l)+(u-l),u=r[++d]),a=o,0!==s&&(i[f++]=s);for(;h<e;)o=a+c,l=o-a,s=a-(o-l)+(c-l),c=t[++h],a=o,0!==s&&(i[f++]=s);for(;d<n;)o=a+u,l=o-a,s=a-(o-l)+(u-l),u=r[++d],a=o,0!==s&&(i[f++]=s);return 0===a&&0!==f||(i[f++]=a),f}function Il(e){return new Float64Array(e)}const Bl=Il(4),kl=Il(8),Ll=Il(12),Ul=Il(16),zl=Il(4);function Hl(e,t,n,r,i,a){const o=(t-a)*(n-i),s=(e-i)*(r-a),l=o-s,c=Math.abs(o+s);return Math.abs(l)>=33306690738754716e-32*c?l:-function(e,t,n,r,i,a,o){let s,l,c,u,h,d,f,p,m,g,v,y,x,b,_,w,S,M;const D=e-i,E=n-i,C=t-a,A=r-a;b=D*A,d=Fl*D,f=d-(d-D),p=D-f,d=Fl*A,m=d-(d-A),g=A-m,_=p*g-(b-f*m-p*m-f*g),w=C*E,d=Fl*C,f=d-(d-C),p=C-f,d=Fl*E,m=d-(d-E),g=E-m,S=p*g-(w-f*m-p*m-f*g),v=_-S,h=_-v,Bl[0]=_-(v+h)+(h-S),y=b+v,h=y-b,x=b-(y-h)+(v-h),v=x-w,h=x-v,Bl[1]=x-(v+h)+(h-w),M=y+v,h=M-y,Bl[2]=y-(M-h)+(v-h),Bl[3]=M;let T=function(e,t){let n=t[0];for(let r=1;r<e;r++)n+=t[r];return n}(4,Bl),N=22204460492503146e-32*o;if(T>=N||-T>=N)return T;if(h=e-D,s=e-(D+h)+(h-i),h=n-E,c=n-(E+h)+(h-i),h=t-C,l=t-(C+h)+(h-a),h=r-A,u=r-(A+h)+(h-a),0===s&&0===l&&0===c&&0===u)return T;if(N=11093356479670487e-47*o+33306690738754706e-32*Math.abs(T),T+=D*u+A*s-(C*c+E*l),T>=N||-T>=N)return T;b=s*A,d=Fl*s,f=d-(d-s),p=s-f,d=Fl*A,m=d-(d-A),g=A-m,_=p*g-(b-f*m-p*m-f*g),w=l*E,d=Fl*l,f=d-(d-l),p=l-f,d=Fl*E,m=d-(d-E),g=E-m,S=p*g-(w-f*m-p*m-f*g),v=_-S,h=_-v,zl[0]=_-(v+h)+(h-S),y=b+v,h=y-b,x=b-(y-h)+(v-h),v=x-w,h=x-v,zl[1]=x-(v+h)+(h-w),M=y+v,h=M-y,zl[2]=y-(M-h)+(v-h),zl[3]=M;const R=Ol(4,Bl,4,zl,kl);b=D*u,d=Fl*D,f=d-(d-D),p=D-f,d=Fl*u,m=d-(d-u),g=u-m,_=p*g-(b-f*m-p*m-f*g),w=C*c,d=Fl*C,f=d-(d-C),p=C-f,d=Fl*c,m=d-(d-c),g=c-m,S=p*g-(w-f*m-p*m-f*g),v=_-S,h=_-v,zl[0]=_-(v+h)+(h-S),y=b+v,h=y-b,x=b-(y-h)+(v-h),v=x-w,h=x-v,zl[1]=x-(v+h)+(h-w),M=y+v,h=M-y,zl[2]=y-(M-h)+(v-h),zl[3]=M;const P=Ol(R,kl,4,zl,Ll);b=s*u,d=Fl*s,f=d-(d-s),p=s-f,d=Fl*u,m=d-(d-u),g=u-m,_=p*g-(b-f*m-p*m-f*g),w=l*c,d=Fl*l,f=d-(d-l),p=l-f,d=Fl*c,m=d-(d-c),g=c-m,S=p*g-(w-f*m-p*m-f*g),v=_-S,h=_-v,zl[0]=_-(v+h)+(h-S),y=b+v,h=y-b,x=b-(y-h)+(v-h),v=x-w,h=x-v,zl[1]=x-(v+h)+(h-w),M=y+v,h=M-y,zl[2]=y-(M-h)+(v-h),zl[3]=M;const F=Ol(P,Ll,4,zl,Ul);return Ul[F-1]}(e,t,n,r,i,a,c)}Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(8),Il(8),Il(8),Il(4),Il(8),Il(8),Il(8),Il(12);Il(192),Il(192);Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(8),Il(8),Il(8),Il(8),Il(8),Il(8),Il(8),Il(8),Il(8),Il(4),Il(4),Il(4),Il(8),Il(16),Il(16),Il(16),Il(32),Il(32),Il(48),Il(64);Il(1152),Il(1152);Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(4),Il(24),Il(24),Il(24),Il(24),Il(24),Il(24),Il(24),Il(24),Il(24),Il(24),Il(1152),Il(1152),Il(1152),Il(1152),Il(1152),Il(2304),Il(2304),Il(3456),Il(5760),Il(8),Il(8),Il(8),Il(16),Il(24),Il(48),Il(48),Il(96),Il(192),Il(384),Il(384),Il(384),Il(768);Il(96),Il(96),Il(96),Il(1152);const Vl=Math.pow(2,-52),Gl=new Uint32Array(512);class ql{static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kl,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ql;const r=e.length,i=new Float64Array(2*r);for(let a=0;a<r;a++){const r=e[a];i[2*a]=t(r),i[2*a+1]=n(r)}return new ql(i)}constructor(e){const t=e.length>>1;if(t>0&&"number"!==typeof e[0])throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:r,_hullHash:i}=this,a=e.length>>1;let o=1/0,s=1/0,l=-1/0,c=-1/0;for(let M=0;M<a;M++){const t=e[2*M],n=e[2*M+1];t<o&&(o=t),n<s&&(s=n),t>l&&(l=t),n>c&&(c=n),this._ids[M]=M}const u=(o+l)/2,h=(s+c)/2;let d,f,p;for(let M=0,D=1/0;M<a;M++){const t=jl(u,h,e[2*M],e[2*M+1]);t<D&&(d=M,D=t)}const m=e[2*d],g=e[2*d+1];for(let M=0,D=1/0;M<a;M++){if(M===d)continue;const t=jl(m,g,e[2*M],e[2*M+1]);t<D&&t>0&&(f=M,D=t)}let v=e[2*f],y=e[2*f+1],x=1/0;for(let M=0;M<a;M++){if(M===d||M===f)continue;const t=Xl(m,g,v,y,e[2*M],e[2*M+1]);t<x&&(p=M,x=t)}let b=e[2*p],_=e[2*p+1];if(x===1/0){for(let r=0;r<a;r++)this._dists[r]=e[2*r]-e[0]||e[2*r+1]-e[1];Yl(this._ids,this._dists,0,a-1);const t=new Uint32Array(a);let n=0;for(let e=0,r=-1/0;e<a;e++){const i=this._ids[e],a=this._dists[i];a>r&&(t[n++]=i,r=a)}return this.hull=t.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(Hl(m,g,v,y,b,_)<0){const e=f,t=v,n=y;f=p,v=b,y=_,p=e,b=t,_=n}const w=function(e,t,n,r,i,a){const o=n-e,s=r-t,l=i-e,c=a-t,u=o*o+s*s,h=l*l+c*c,d=.5/(o*c-s*l),f=e+(c*u-s*h)*d,p=t+(o*h-l*u)*d;return{x:f,y:p}}(m,g,v,y,b,_);this._cx=w.x,this._cy=w.y;for(let M=0;M<a;M++)this._dists[M]=jl(e[2*M],e[2*M+1],w.x,w.y);Yl(this._ids,this._dists,0,a-1),this._hullStart=d;let S=3;n[d]=t[p]=f,n[f]=t[d]=p,n[p]=t[f]=d,r[d]=0,r[f]=1,r[p]=2,i.fill(-1),i[this._hashKey(m,g)]=d,i[this._hashKey(v,y)]=f,i[this._hashKey(b,_)]=p,this.trianglesLen=0,this._addTriangle(d,f,p,-1,-1,-1);for(let M,D,E=0;E<this._ids.length;E++){const a=this._ids[E],o=e[2*a],s=e[2*a+1];if(E>0&&Math.abs(o-M)<=Vl&&Math.abs(s-D)<=Vl)continue;if(M=o,D=s,a===d||a===f||a===p)continue;let l=0;for(let e=0,t=this._hashKey(o,s);e<this._hashSize&&(l=i[(t+e)%this._hashSize],-1===l||l===n[l]);e++);l=t[l];let c,u=l;for(;c=n[u],Hl(o,s,e[2*u],e[2*u+1],e[2*c],e[2*c+1])>=0;)if(u=c,u===l){u=-1;break}if(-1===u)continue;let h=this._addTriangle(u,a,n[u],-1,-1,r[u]);r[a]=this._legalize(h+2),r[u]=h,S++;let m=n[u];for(;c=n[m],Hl(o,s,e[2*m],e[2*m+1],e[2*c],e[2*c+1])<0;)h=this._addTriangle(m,a,c,r[a],-1,r[m]),r[a]=this._legalize(h+2),n[m]=m,S--,m=c;if(u===l)for(;c=t[u],Hl(o,s,e[2*c],e[2*c+1],e[2*u],e[2*u+1])<0;)h=this._addTriangle(c,a,u,-1,r[u],r[c]),this._legalize(h+2),r[c]=h,n[u]=u,S--,u=c;this._hullStart=t[a]=u,n[u]=t[m]=a,n[a]=m,i[this._hashKey(o,s)]=a,i[this._hashKey(e[2*u],e[2*u+1])]=u}this.hull=new Uint32Array(S);for(let M=0,D=this._hullStart;M<S;M++)this.hull[M]=D,D=n[D];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(function(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:r}=this;let i=0,a=0;for(;;){const o=n[e],s=e-e%3;if(a=s+(e+2)%3,-1===o){if(0===i)break;e=Gl[--i];continue}const l=o-o%3,c=s+(e+1)%3,u=l+(o+2)%3,h=t[a],d=t[e],f=t[c],p=t[u];if(Wl(r[2*h],r[2*h+1],r[2*d],r[2*d+1],r[2*f],r[2*f+1],r[2*p],r[2*p+1])){t[e]=p,t[o]=h;const r=n[u];if(-1===r){let t=this._hullStart;do{if(this._hullTri[t]===u){this._hullTri[t]=e;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(e,r),this._link(o,n[a]),this._link(a,u);const s=l+(o+1)%3;i<Gl.length&&(Gl[i++]=s)}else{if(0===i)break;e=Gl[--i]}}return a}_link(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}_addTriangle(e,t,n,r,i,a){const o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,i),this._link(o+2,a),this.trianglesLen+=3,o}}function jl(e,t,n,r){const i=e-n,a=t-r;return i*i+a*a}function Wl(e,t,n,r,i,a,o,s){const l=e-o,c=t-s,u=n-o,h=r-s,d=i-o,f=a-s,p=u*u+h*h,m=d*d+f*f;return l*(h*m-p*f)-c*(u*m-p*d)+(l*l+c*c)*(u*f-h*d)<0}function Xl(e,t,n,r,i,a){const o=n-e,s=r-t,l=i-e,c=a-t,u=o*o+s*s,h=l*l+c*c,d=.5/(o*c-s*l),f=(c*u-s*h)*d,p=(o*h-l*u)*d;return f*f+p*p}function Yl(e,t,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=e[i],a=t[r];let o=i-1;for(;o>=n&&t[e[o]]>a;)e[o+1]=e[o--];e[o+1]=r}else{let i=n+1,a=r;Zl(e,n+r>>1,i),t[e[n]]>t[e[r]]&&Zl(e,n,r),t[e[i]]>t[e[r]]&&Zl(e,i,r),t[e[n]]>t[e[i]]&&Zl(e,n,i);const o=e[i],s=t[o];for(;;){do{i++}while(t[e[i]]<s);do{a--}while(t[e[a]]>s);if(a<i)break;Zl(e,i,a)}e[n+1]=e[a],e[a]=o,r-i+1>=a-n?(Yl(e,t,i,r),Yl(e,t,n,a-1)):(Yl(e,t,n,a-1),Yl(e,t,i,r))}}function Zl(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Kl(e){return e[0]}function Ql(e){return e[1]}const Jl=1e-6;class $l{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)}arc(e,t,n){const r=(e=+e)+(n=+n),i=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>Jl||Math.abs(this._y1-i)>Jl)&&(this._+="L"+r+","+i),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(e-n,",").concat(t,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}rect(e,t,n,r){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}value(){return this._||null}}class ec{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class tc{constructor(e){let[t,n,r,i]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500];if(!((r=+r)>=(t=+t))||!((i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(2*e.points.length),this.vectors=new Float64Array(2*e.points.length),this.xmax=r,this.xmin=t,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:r}=this;let i,a;const o=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let p,m,g=0,v=0,y=n.length;g<y;g+=3,v+=2){const r=2*n[g],s=2*n[g+1],l=2*n[g+2],c=e[r],u=e[r+1],h=e[s],d=e[s+1],f=e[l],y=e[l+1],x=h-c,b=d-u,_=f-c,w=y-u,S=2*(x*w-b*_);if(Math.abs(S)<1e-9){if(void 0===i){i=a=0;for(const n of t)i+=e[2*n],a+=e[2*n+1];i/=t.length,a/=t.length}const n=1e9*Math.sign((i-c)*w-(a-u)*_);p=(c+f)/2-n*w,m=(u+y)/2+n*_}else{const e=1/S,t=x*x+b*b,n=_*_+w*w;p=c+(w*t-b*n)*e,m=u+(x*n-_*t)*e}o[v]=p,o[v+1]=m}let s,l,c,u=t[t.length-1],h=4*u,d=e[2*u],f=e[2*u+1];r.fill(0);for(let p=0;p<t.length;++p)u=t[p],s=h,l=d,c=f,h=4*u,d=e[2*u],f=e[2*u+1],r[s+2]=r[h]=c-f,r[s+3]=r[h+1]=d-l}render(e){const t=null==e?e=new $l:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:a,vectors:o}=this;if(i.length<=1)return null;for(let c=0,u=n.length;c<u;++c){const t=n[c];if(t<c)continue;const r=2*Math.floor(c/3),i=2*Math.floor(t/3),o=a[r],s=a[r+1],l=a[i],u=a[i+1];this._renderSegment(o,s,l,u,e)}let s,l=i[i.length-1];for(let c=0;c<i.length;++c){s=l,l=i[c];const t=2*Math.floor(r[l]/3),n=a[t],u=a[t+1],h=4*s,d=this._project(n,u,o[h+2],o[h+3]);d&&this._renderSegment(n,u,d[0],d[1],e)}return t&&t.value()}renderBounds(e){const t=null==e?e=new $l:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=null==t?t=new $l:void 0,r=this._clip(e);if(null===r||!r.length)return;t.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let a=2;a<i;a+=2)r[a]===r[a-2]&&r[a+1]===r[a-1]||t.lineTo(r[a],r[a+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const e=this.cellPolygon(t);e&&(e.index=t,yield e)}}cellPolygon(e){const t=new ec;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,r,i){let a;const o=this._regioncode(e,t),s=this._regioncode(n,r);0===o&&0===s?(i.moveTo(e,t),i.lineTo(n,r)):(a=this._clipSegment(e,t,n,r,o,s))&&(i.moveTo(a[0],a[1]),i.lineTo(a[2],a[3]))}contains(e,t,n){return(t=+t)===t&&(n=+n)===n&&this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const e=this._clip(n);if(e)e:for(let r=0,i=t.length;r<i;r+=2)for(let a=0,o=e.length;a<o;a+=2)if(t[r]===e[a]&&t[r+1]===e[a+1]&&t[(r+2)%i]===e[(a+o-2)%o]&&t[(r+3)%i]===e[(a+o-1)%o]){yield n;break e}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,a=n[e];if(-1===a)return null;const o=[];let s=a;do{const n=Math.floor(s/3);if(o.push(t[2*n],t[2*n+1]),s=s%3===2?s-2:s+1,i[s]!==e)break;s=r[s]}while(s!==a&&-1!==s);return o}_clip(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(null===t)return null;const{vectors:n}=this,r=4*e;return this._simplify(n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t))}_clipFinite(e,t){const n=t.length;let r,i,a,o,s=null,l=t[n-2],c=t[n-1],u=this._regioncode(l,c),h=0;for(let d=0;d<n;d+=2)if(r=l,i=c,l=t[d],c=t[d+1],a=u,u=this._regioncode(l,c),0===a&&0===u)o=h,h=0,s?s.push(l,c):s=[l,c];else{let t,n,d,f,p;if(0===a){if(null===(t=this._clipSegment(r,i,l,c,a,u)))continue;[n,d,f,p]=t}else{if(null===(t=this._clipSegment(l,c,r,i,u,a)))continue;[f,p,n,d]=t,o=h,h=this._edgecode(n,d),o&&h&&this._edge(e,o,h,s,s.length),s?s.push(n,d):s=[n,d]}o=h,h=this._edgecode(f,p),o&&h&&this._edge(e,o,h,s,s.length),s?s.push(f,p):s=[f,p]}if(s)o=h,h=this._edgecode(s[0],s[1]),o&&h&&this._edge(e,o,h,s,s.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(e,t,n,r,i,a){const o=i<a;for(o&&([e,t,n,r,i,a]=[n,r,e,t,a,i]);;){if(0===i&&0===a)return o?[n,r,e,t]:[e,t,n,r];if(i&a)return null;let s,l,c=i||a;8&c?(s=e+(n-e)*(this.ymax-t)/(r-t),l=this.ymax):4&c?(s=e+(n-e)*(this.ymin-t)/(r-t),l=this.ymin):2&c?(l=t+(r-t)*(this.xmax-e)/(n-e),s=this.xmax):(l=t+(r-t)*(this.xmin-e)/(n-e),s=this.xmin),i?(e=s,t=l,i=this._regioncode(e,t)):(n=s,r=l,a=this._regioncode(n,r))}}_clipInfinite(e,t,n,r,i,a){let o,s=Array.from(t);if((o=this._project(s[0],s[1],n,r))&&s.unshift(o[0],o[1]),(o=this._project(s[s.length-2],s[s.length-1],i,a))&&s.push(o[0],o[1]),s=this._clipFinite(e,s))for(let l,c=0,u=s.length,h=this._edgecode(s[u-2],s[u-1]);c<u;c+=2)l=h,h=this._edgecode(s[c],s[c+1]),l&&h&&(c=this._edge(e,l,h,s,c),u=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(e,t,n,r,i){for(;t!==n;){let n,a;switch(t){case 5:t=4;continue;case 4:t=6,n=this.xmax,a=this.ymin;break;case 6:t=2;continue;case 2:t=10,n=this.xmax,a=this.ymax;break;case 10:t=8;continue;case 8:t=9,n=this.xmin,a=this.ymax;break;case 9:t=1;continue;case 1:t=5,n=this.xmin,a=this.ymin}r[i]===n&&r[i+1]===a||!this.contains(e,n,a)||(r.splice(i,0,n,a),i+=2)}return i}_project(e,t,n,r){let i,a,o,s=1/0;if(r<0){if(t<=this.ymin)return null;(i=(this.ymin-t)/r)<s&&(o=this.ymin,a=e+(s=i)*n)}else if(r>0){if(t>=this.ymax)return null;(i=(this.ymax-t)/r)<s&&(o=this.ymax,a=e+(s=i)*n)}if(n>0){if(e>=this.xmax)return null;(i=(this.xmax-e)/n)<s&&(a=this.xmax,o=t+(s=i)*r)}else if(n<0){if(e<=this.xmin)return null;(i=(this.xmin-e)/n)<s&&(a=this.xmin,o=t+(s=i)*r)}return[a,o]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const n=(t+2)%e.length,r=(t+4)%e.length;(e[t]===e[n]&&e[n]===e[r]||e[t+1]===e[n+1]&&e[n+1]===e[r+1])&&(e.splice(n,2),t-=2)}e.length||(e=null)}return e}}const nc=2*Math.PI,rc=Math.pow;function ic(e){return e[0]}function ac(e){return e[1]}function oc(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class sc{static from(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ic,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ac,r=arguments.length>3?arguments[3]:void 0;return new sc("length"in e?function(e,t,n,r){const i=e.length,a=new Float64Array(2*i);for(let o=0;o<i;++o){const i=e[o];a[2*o]=t.call(r,i,o,e),a[2*o+1]=n.call(r,i,o,e)}return a}(e,t,n,r):Float64Array.from(function*(e,t,n,r){let i=0;for(const a of e)yield t.call(r,a,i,e),yield n.call(r,a,i,e),++i}(e,t,n,r)))}constructor(e){this._delaunator=new ql(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const e=2*t[r],i=2*t[r+1],a=2*t[r+2];if((n[a]-n[e])*(n[i+1]-n[e+1])-(n[i]-n[e])*(n[a+1]-n[e+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},((e,t)=>t)).sort(((e,n)=>t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]));const e=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[t[2*e],t[2*e+1],t[2*n],t[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let a=0,o=t.length/2;a<o;++a){const e=oc(t[2*a],t[2*a+1],i);t[2*a]=e[0],t[2*a+1]=e[1]}this._delaunator=new ql(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let s=0,l=n.length;s<l;++s){const e=i[s%3===2?s-2:s+1];-1!==n[s]&&-1!==a[e]||(a[e]=s)}for(let s=0,l=r.length;s<l;++s)o[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],a[r[0]]=1,2===r.length&&(a[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(e){return new tc(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:r,halfedges:i,triangles:a,collinear:o}=this;if(o){const t=o.indexOf(e);return t>0&&(yield o[t-1]),void(t<o.length-1&&(yield o[t+1]))}const s=t[e];if(-1===s)return;let l=s,c=-1;do{if(yield c=a[l],l=l%3===2?l-2:l+1,a[l]!==e)return;if(l=i[l],-1===l){const t=n[(r[e]+1)%n.length];return void(t!==c&&(yield t))}}while(l!==s)}find(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((e=+e)!==e||(t=+t)!==t)return-1;const r=n;let i;for(;(i=this._step(n,e,t))>=0&&i!==n&&i!==r;)n=i;return i}_step(e,t,n){const{inedges:r,hull:i,_hullIndex:a,halfedges:o,triangles:s,points:l}=this;if(-1===r[e]||!l.length)return(e+1)%(l.length>>1);let c=e,u=rc(t-l[2*e],2)+rc(n-l[2*e+1],2);const h=r[e];let d=h;do{let r=s[d];const h=rc(t-l[2*r],2)+rc(n-l[2*r+1],2);if(h<u&&(u=h,c=r),d=d%3===2?d-2:d+1,s[d]!==e)break;if(d=o[d],-1===d){if(d=i[(a[e]+1)%i.length],d!==r&&rc(t-l[2*d],2)+rc(n-l[2*d+1],2)<u)return d;break}}while(d!==h);return c}render(e){const t=null==e?e=new $l:void 0,{points:n,halfedges:r,triangles:i}=this;for(let a=0,o=r.length;a<o;++a){const t=r[a];if(t<a)continue;const o=2*i[a],s=2*i[t];e.moveTo(n[o],n[o+1]),e.lineTo(n[s],n[s+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){void 0!==t||e&&"function"===typeof e.moveTo||(t=e,e=null),t=void 0==t?2:+t;const n=null==e?e=new $l:void 0,{points:r}=this;for(let i=0,a=r.length;i<a;i+=2){const n=r[i],a=r[i+1];e.moveTo(n+t,a),e.arc(n,a,t,0,nc)}return n&&n.value()}renderHull(e){const t=null==e?e=new $l:void 0,{hull:n,points:r}=this,i=2*n[0],a=n.length;e.moveTo(r[i],r[i+1]);for(let o=1;o<a;++o){const t=2*n[o];e.lineTo(r[t],r[t+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new ec;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=null==t?t=new $l:void 0,{points:r,triangles:i}=this,a=2*i[e*=3],o=2*i[e+1],s=2*i[e+2];return t.moveTo(r[a],r[a+1]),t.lineTo(r[o],r[o+1]),t.lineTo(r[s],r[s+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new ec;return this.renderTriangle(e,t),t.value()}}const lc=e=>()=>e;function cc(e,t){let{sourceEvent:n,subject:r,target:i,identifier:a,active:o,x:s,y:l,dx:c,dy:u,dispatch:h}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:h}})}function uc(e){return!e.ctrlKey&&!e.button}function hc(){return this.parentNode}function dc(e,t){return null==t?{x:e.x,y:e.y}:t}function fc(){return navigator.maxTouchPoints||"ontouchstart"in this}function pc(){var e,t,n,r,i=uc,a=hc,o=dc,s=fc,l={},c=En("start","drag","end"),u=0,h=0;function d(e){e.on("mousedown.drag",f).filter(s).on("touchstart.drag",g).on("touchmove.drag",v,Hr).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(o,s){if(!r&&i.call(this,o,s)){var l=x(this,a.call(this,o,s),o,s,"mouse");l&&(zr(o.view).on("mousemove.drag",p,Vr).on("mouseup.drag",m,Vr),jr(o.view),Gr(o),n=!1,e=o.clientX,t=o.clientY,l("start",o))}}function p(r){if(qr(r),!n){var i=r.clientX-e,a=r.clientY-t;n=i*i+a*a>h}l.mouse("drag",r)}function m(e){zr(e.view).on("mousemove.drag mouseup.drag",null),Wr(e.view,n),qr(e),l.mouse("end",e)}function g(e,t){if(i.call(this,e,t)){var n,r,o=e.changedTouches,s=a.call(this,e,t),l=o.length;for(n=0;n<l;++n)(r=x(this,s,e,t,o[n].identifier,o[n]))&&(Gr(e),r("start",e,o[n]))}}function v(e){var t,n,r=e.changedTouches,i=r.length;for(t=0;t<i;++t)(n=l[r[t].identifier])&&(qr(e),n("drag",e,r[t]))}function y(e){var t,n,i=e.changedTouches,a=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<a;++t)(n=l[i[t].identifier])&&(Gr(e),n("end",e,i[t]))}function x(e,t,n,r,i,a){var s,h,f,p=c.copy(),m=$i(a||n,t);if(null!=(f=o.call(e,new cc("beforestart",{sourceEvent:n,target:d,identifier:i,active:u,x:m[0],y:m[1],dx:0,dy:0,dispatch:p}),r)))return s=f.x-m[0]||0,h=f.y-m[1]||0,function n(a,o,c){var g,v=m;switch(a){case"start":l[i]=n,g=u++;break;case"end":delete l[i],--u;case"drag":m=$i(c||o,t),g=u}p.call(a,e,new cc(a,{sourceEvent:o,subject:f,target:d,identifier:i,active:g,x:m[0]+s,y:m[1]+h,dx:m[0]-v[0],dy:m[1]-v[1],dispatch:p}),r)}}return d.filter=function(e){return arguments.length?(i="function"===typeof e?e:lc(!!e),d):i},d.container=function(e){return arguments.length?(a="function"===typeof e?e:lc(e),d):a},d.subject=function(e){return arguments.length?(o="function"===typeof e?e:lc(e),d):o},d.touchable=function(e){return arguments.length?(s="function"===typeof e?e:lc(!!e),d):s},d.on=function(){var e=c.on.apply(c,arguments);return e===c?d:e},d.clickDistance=function(e){return arguments.length?(h=(e=+e)*e,d):Math.sqrt(h)},d}cc.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var mc={},gc={},vc=34,yc=10,xc=13;function bc(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function _c(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function wc(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function Sc(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),a=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+wc(-t,6):t>9999?"+"+wc(t,6):wc(t,4))+"-"+wc(e.getUTCMonth()+1,2)+"-"+wc(e.getUTCDate(),2)+(a?"T"+wc(n,2)+":"+wc(r,2)+":"+wc(i,2)+"."+wc(a,3)+"Z":i?"T"+wc(n,2)+":"+wc(r,2)+":"+wc(i,2)+"Z":r||n?"T"+wc(n,2)+":"+wc(r,2)+"Z":"")}function Mc(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],a=e.length,o=0,s=0,l=a<=0,c=!1;function u(){if(l)return gc;if(c)return c=!1,mc;var t,r,i=o;if(e.charCodeAt(i)===vc){for(;o++<a&&e.charCodeAt(o)!==vc||e.charCodeAt(++o)===vc;);return(t=o)>=a?l=!0:(r=e.charCodeAt(o++))===yc?c=!0:r===xc&&(c=!0,e.charCodeAt(o)===yc&&++o),e.slice(i+1,t-1).replace(/""/g,'"')}for(;o<a;){if((r=e.charCodeAt(t=o++))===yc)c=!0;else if(r===xc)c=!0,e.charCodeAt(o)===yc&&++o;else if(r!==n)continue;return e.slice(i,t)}return l=!0,e.slice(i,a)}for(e.charCodeAt(a-1)===yc&&--a,e.charCodeAt(a-1)===xc&&--a;(r=u())!==gc;){for(var h=[];r!==mc&&r!==gc;)h.push(r),r=u();t&&null==(h=t(h,s++))||i.push(h)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function a(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?Sc(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,a=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=bc(e);return function(r,i){return t(n(r),i,e)}}(e,t):bc(e)}));return a.columns=i||[],a},parseRows:r,format:function(t,n){return null==n&&(n=_c(t)),[n.map(o).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=_c(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(a).join("\n")},formatRow:a,formatValue:o}}var Dc=Mc(","),Ec=Dc.parse,Cc=Dc.parseRows,Ac=Dc.format,Tc=Dc.formatBody,Nc=Dc.formatRows,Rc=Dc.formatRow,Pc=Dc.formatValue,Fc=Mc("\t"),Oc=Fc.parse,Ic=Fc.parseRows,Bc=Fc.format,kc=Fc.formatBody,Lc=Fc.formatRows,Uc=Fc.formatRow,zc=Fc.formatValue;function Hc(e){for(var t in e){var n,r,i=e[t].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(n=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;Vc&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=n;else i=null;e[t]=i}return e}const Vc=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours(),Gc=e=>+e;function qc(e){return e*e}function jc(e){return e*(2-e)}function Wc(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}var Xc=function e(t){function n(e){return Math.pow(e,t)}return t=+t,n.exponent=e,n}(3),Yc=function e(t){function n(e){return 1-Math.pow(1-e,t)}return t=+t,n.exponent=e,n}(3),Zc=function e(t){function n(e){return((e*=2)<=1?Math.pow(e,t):2-Math.pow(2-e,t))/2}return t=+t,n.exponent=e,n}(3),Kc=Math.PI,Qc=Kc/2;function Jc(e){return 1===+e?1:1-Math.cos(e*Qc)}function $c(e){return Math.sin(e*Qc)}function eu(e){return(1-Math.cos(Kc*e))/2}function tu(e){return 1.0009775171065494*(Math.pow(2,-10*e)-.0009765625)}function nu(e){return tu(1-+e)}function ru(e){return 1-tu(e)}function iu(e){return((e*=2)<=1?tu(1-e):2-tu(e-1))/2}function au(e){return 1-Math.sqrt(1-e*e)}function ou(e){return Math.sqrt(1- --e*e)}function su(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var lu=4/11,cu=6/11,uu=8/11,hu=3/4,du=9/11,fu=10/11,pu=15/16,mu=21/22,gu=63/64,vu=1/lu/lu;function yu(e){return 1-xu(1-e)}function xu(e){return(e=+e)<lu?vu*e*e:e<uu?vu*(e-=cu)*e+hu:e<fu?vu*(e-=du)*e+pu:vu*(e-=mu)*e+gu}function bu(e){return((e*=2)<=1?1-xu(1-e):xu(e-1)+1)/2}var _u=1.70158,wu=function e(t){function n(e){return(e=+e)*e*(t*(e-1)+e)}return t=+t,n.overshoot=e,n}(_u),Su=function e(t){function n(e){return--e*e*((e+1)*t+e)+1}return t=+t,n.overshoot=e,n}(_u),Mu=function e(t){function n(e){return((e*=2)<1?e*e*((t+1)*e-t):(e-=2)*e*((t+1)*e+t)+2)/2}return t=+t,n.overshoot=e,n}(_u),Du=2*Math.PI,Eu=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Du);function i(e){return t*tu(- --e)*Math.sin((r-e)/n)}return i.amplitude=function(t){return e(t,n*Du)},i.period=function(n){return e(t,n)},i}(1,.3),Cu=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Du);function i(e){return 1-t*tu(e=+e)*Math.sin((e+r)/n)}return i.amplitude=function(t){return e(t,n*Du)},i.period=function(n){return e(t,n)},i}(1,.3),Au=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Du);function i(e){return((e=2*e-1)<0?t*tu(-e)*Math.sin((r-e)/n):2-t*tu(e)*Math.sin((r+e)/n))/2}return i.amplitude=function(t){return e(t,n*Du)},i.period=function(n){return e(t,n)},i}(1,.3);function Tu(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.blob()}function Nu(e,t){return fetch(e,t).then(Tu)}function Ru(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.arrayBuffer()}function Pu(e,t){return fetch(e,t).then(Ru)}function Fu(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function Ou(e,t){return fetch(e,t).then(Fu)}function Iu(e){return function(t,n,r){return 2===arguments.length&&"function"===typeof n&&(r=n,n=void 0),Ou(t,n).then((function(t){return e(t,r)}))}}function Bu(e,t,n,r){3===arguments.length&&"function"===typeof n&&(r=n,n=void 0);var i=Mc(e);return Ou(t,n).then((function(e){return i.parse(e,r)}))}var ku=Iu(Ec),Lu=Iu(Oc);function Uu(e,t){return new Promise((function(n,r){var i=new Image;for(var a in t)i[a]=t[a];i.onerror=r,i.onload=function(){n(i)},i.src=e}))}function zu(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);if(204!==e.status&&205!==e.status)return e.json()}function Hu(e,t){return fetch(e,t).then(zu)}function Vu(e){return(t,n)=>Ou(t,n).then((t=>(new DOMParser).parseFromString(t,e)))}const Gu=Vu("application/xml");var qu=Vu("text/html"),ju=Vu("image/svg+xml");function Wu(e,t){var n,r=1;function i(){var i,a,o=n.length,s=0,l=0;for(i=0;i<o;++i)s+=(a=n[i]).x,l+=a.y;for(s=(s/o-e)*r,l=(l/o-t)*r,i=0;i<o;++i)(a=n[i]).x-=s,a.y-=l}return null==e&&(e=0),null==t&&(t=0),i.initialize=function(e){n=e},i.x=function(t){return arguments.length?(e=+t,i):e},i.y=function(e){return arguments.length?(t=+e,i):t},i.strength=function(e){return arguments.length?(r=+e,i):r},i}function Xu(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a,o,s,l,c,u,h,d,f=e._root,p={data:r},m=e._x0,g=e._y0,v=e._x1,y=e._y1;if(!f)return e._root=p,e;for(;f.length;)if((c=t>=(a=(m+v)/2))?m=a:v=a,(u=n>=(o=(g+y)/2))?g=o:y=o,i=f,!(f=f[h=u<<1|c]))return i[h]=p,e;if(s=+e._x.call(null,f.data),l=+e._y.call(null,f.data),t===s&&n===l)return p.next=f,i?i[h]=p:e._root=p,e;do{i=i?i[h]=new Array(4):e._root=new Array(4),(c=t>=(a=(m+v)/2))?m=a:v=a,(u=n>=(o=(g+y)/2))?g=o:y=o}while((h=u<<1|c)===(d=(l>=o)<<1|s>=a));return i[d]=f,i[h]=p,e}function Yu(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function Zu(e){return e[0]}function Ku(e){return e[1]}function Qu(e,t,n){var r=new Ju(null==t?Zu:t,null==n?Ku:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function Ju(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function $u(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var eh=Qu.prototype=Ju.prototype;function th(e){return function(){return e}}function nh(e){return 1e-6*(e()-.5)}function rh(e){return e.x+e.vx}function ih(e){return e.y+e.vy}function ah(e){var t,n,r,i=1,a=1;function o(){for(var e,o,l,c,u,h,d,f=t.length,p=0;p<a;++p)for(o=Qu(t,rh,ih).visitAfter(s),e=0;e<f;++e)l=t[e],h=n[l.index],d=h*h,c=l.x+l.vx,u=l.y+l.vy,o.visit(m);function m(e,t,n,a,o){var s=e.data,f=e.r,p=h+f;if(!s)return t>c+p||a<c-p||n>u+p||o<u-p;if(s.index>l.index){var m=c-s.x-s.vx,g=u-s.y-s.vy,v=m*m+g*g;v<p*p&&(0===m&&(v+=(m=nh(r))*m),0===g&&(v+=(g=nh(r))*g),v=(p-(v=Math.sqrt(v)))/v*i,l.vx+=(m*=v)*(p=(f*=f)/(d+f)),l.vy+=(g*=v)*p,s.vx-=m*(p=1-p),s.vy-=g*p)}}}function s(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function l(){if(t){var r,i,a=t.length;for(n=new Array(a),r=0;r<a;++r)i=t[r],n[i.index]=+e(i,r,t)}}return"function"!==typeof e&&(e=th(null==e?1:+e)),o.initialize=function(e,n){t=e,r=n,l()},o.iterations=function(e){return arguments.length?(a=+e,o):a},o.strength=function(e){return arguments.length?(i=+e,o):i},o.radius=function(t){return arguments.length?(e="function"===typeof t?t:th(+t),l(),o):e},o}function oh(e){return e.index}function sh(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function lh(e){var t,n,r,i,a,o,s=oh,l=function(e){return 1/Math.min(i[e.source.index],i[e.target.index])},c=th(30),u=1;function h(r){for(var i=0,s=e.length;i<u;++i)for(var l,c,h,d,f,p,m,g=0;g<s;++g)c=(l=e[g]).source,d=(h=l.target).x+h.vx-c.x-c.vx||nh(o),f=h.y+h.vy-c.y-c.vy||nh(o),d*=p=((p=Math.sqrt(d*d+f*f))-n[g])/p*r*t[g],f*=p,h.vx-=d*(m=a[g]),h.vy-=f*m,c.vx+=d*(m=1-m),c.vy+=f*m}function d(){if(r){var o,l,c=r.length,u=e.length,h=new Map(r.map(((e,t)=>[s(e,t,r),e])));for(o=0,i=new Array(c);o<u;++o)(l=e[o]).index=o,"object"!==typeof l.source&&(l.source=sh(h,l.source)),"object"!==typeof l.target&&(l.target=sh(h,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(o=0,a=new Array(u);o<u;++o)l=e[o],a[o]=i[l.source.index]/(i[l.source.index]+i[l.target.index]);t=new Array(u),f(),n=new Array(u),p()}}function f(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+l(e[n],n,e)}function p(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+c(e[t],t,e)}return null==e&&(e=[]),h.initialize=function(e,t){r=e,o=t,d()},h.links=function(t){return arguments.length?(e=t,d(),h):e},h.id=function(e){return arguments.length?(s=e,h):s},h.iterations=function(e){return arguments.length?(u=+e,h):u},h.strength=function(e){return arguments.length?(l="function"===typeof e?e:th(+e),f(),h):l},h.distance=function(e){return arguments.length?(c="function"===typeof e?e:th(+e),p(),h):c},h}eh.copy=function(){var e,t,n=new Ju(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=$u(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=$u(t));return n},eh.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return Xu(this.cover(t,n),t,n,e)},eh.addAll=function(e){var t,n,r,i,a=e.length,o=new Array(a),s=new Array(a),l=1/0,c=1/0,u=-1/0,h=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(o[n]=r,s[n]=i,r<l&&(l=r),r>u&&(u=r),i<c&&(c=i),i>h&&(h=i));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),n=0;n<a;++n)Xu(this,o[n],s[n],e[n]);return this},eh.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o,s,l=i-n||1,c=this._root;n>e||e>=i||r>t||t>=a;)switch(s=(t<r)<<1|e<n,(o=new Array(4))[s]=c,c=o,l*=2,s){case 0:i=n+l,a=r+l;break;case 1:n=i-l,a=r+l;break;case 2:i=n+l,r=a-l;break;case 3:n=i-l,r=a-l}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},eh.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},eh.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},eh.find=function(e,t,n){var r,i,a,o,s,l,c,u=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],m=this._root;for(m&&p.push(new Yu(m,u,h,d,f)),null==n?n=1/0:(u=e-n,h=t-n,d=e+n,f=t+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(i=l.x0)>d||(a=l.y0)>f||(o=l.x1)<u||(s=l.y1)<h))if(m.length){var g=(i+o)/2,v=(a+s)/2;p.push(new Yu(m[3],g,v,o,s),new Yu(m[2],i,v,g,s),new Yu(m[1],g,a,o,v),new Yu(m[0],i,a,g,v)),(c=(t>=v)<<1|e>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=l)}else{var y=e-+this._x.call(null,m.data),x=t-+this._y.call(null,m.data),b=y*y+x*x;if(b<n){var _=Math.sqrt(n=b);u=e-_,h=t-_,d=e+_,f=t+_,r=m.data}}return r},eh.remove=function(e){if(isNaN(a=+this._x.call(null,e))||isNaN(o=+this._y.call(null,e)))return this;var t,n,r,i,a,o,s,l,c,u,h,d,f=this._root,p=this._x0,m=this._y0,g=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((c=a>=(s=(p+g)/2))?p=s:g=s,(u=o>=(l=(m+v)/2))?m=l:v=l,t=f,!(f=f[h=u<<1|c]))return this;if(!f.length)break;(t[h+1&3]||t[h+2&3]||t[h+3&3])&&(n=t,d=h)}for(;f.data!==e;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):t?(i?t[h]=i:delete t[h],(f=t[0]||t[1]||t[2]||t[3])&&f===(t[3]||t[2]||t[1]||t[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=i,this)},eh.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},eh.root=function(){return this._root},eh.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},eh.visit=function(e){var t,n,r,i,a,o,s=[],l=this._root;for(l&&s.push(new Yu(l,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(l=t.node,r=t.x0,i=t.y0,a=t.x1,o=t.y1)&&l.length){var c=(r+a)/2,u=(i+o)/2;(n=l[3])&&s.push(new Yu(n,c,u,a,o)),(n=l[2])&&s.push(new Yu(n,r,u,c,o)),(n=l[1])&&s.push(new Yu(n,c,i,a,u)),(n=l[0])&&s.push(new Yu(n,r,i,c,u))}return this},eh.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new Yu(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var a,o=t.x0,s=t.y0,l=t.x1,c=t.y1,u=(o+l)/2,h=(s+c)/2;(a=i[0])&&n.push(new Yu(a,o,s,u,h)),(a=i[1])&&n.push(new Yu(a,u,s,l,h)),(a=i[2])&&n.push(new Yu(a,o,h,u,c)),(a=i[3])&&n.push(new Yu(a,u,h,l,c))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},eh.x=function(e){return arguments.length?(this._x=e,this):this._x},eh.y=function(e){return arguments.length?(this._y=e,this):this._y};const ch=1664525,uh=1013904223,hh=4294967296;function dh(e){return e.x}function fh(e){return e.y}var ph=10,mh=Math.PI*(3-Math.sqrt(5));function gh(e){var t,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=new Map,l=fa(h),c=En("tick","end"),u=function(){let e=1;return()=>(e=(ch*e+uh)%hh)/hh}();function h(){d(),c.call("tick",t),n<r&&(l.stop(),c.call("end",t))}function d(r){var l,c,u=e.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(a-n)*i,s.forEach((function(e){e(n)})),l=0;l<u;++l)null==(c=e[l]).fx?c.x+=c.vx*=o:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=o:(c.y=c.fy,c.vy=0);return t}function f(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=ph*Math.sqrt(.5+n),a=n*mh;t.x=i*Math.cos(a),t.y=i*Math.sin(a)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function p(t){return t.initialize&&t.initialize(e,u),t}return null==e&&(e=[]),f(),t={tick:d,restart:function(){return l.restart(h),t},stop:function(){return l.stop(),t},nodes:function(n){return arguments.length?(e=n,f(),s.forEach(p),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(a=+e,t):a},velocityDecay:function(e){return arguments.length?(o=1-e,t):1-o},randomSource:function(e){return arguments.length?(u=e,s.forEach(p),t):u},force:function(e,n){return arguments.length>1?(null==n?s.delete(e):s.set(e,p(n)),t):s.get(e)},find:function(t,n,r){var i,a,o,s,l,c=0,u=e.length;for(null==r?r=1/0:r*=r,c=0;c<u;++c)(o=(i=t-(s=e[c]).x)*i+(a=n-s.y)*a)<r&&(l=s,r=o);return l},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}}function vh(){var e,t,n,r,i,a=th(-30),o=1,s=1/0,l=.81;function c(n){var i,a=e.length,o=Qu(e,dh,fh).visitAfter(h);for(r=n,i=0;i<a;++i)t=e[i],o.visit(d)}function u(){if(e){var t,n,r=e.length;for(i=new Array(r),t=0;t<r;++t)n=e[t],i[n.index]=+a(n,t,e)}}function h(e){var t,n,r,a,o,s=0,l=0;if(e.length){for(r=a=o=0;o<4;++o)(t=e[o])&&(n=Math.abs(t.value))&&(s+=t.value,l+=n,r+=n*t.x,a+=n*t.y);e.x=r/l,e.y=a/l}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=i[t.data.index]}while(t=t.next)}e.value=s}function d(e,a,c,u){if(!e.value)return!0;var h=e.x-t.x,d=e.y-t.y,f=u-a,p=h*h+d*d;if(f*f/l<p)return p<s&&(0===h&&(p+=(h=nh(n))*h),0===d&&(p+=(d=nh(n))*d),p<o&&(p=Math.sqrt(o*p)),t.vx+=h*e.value*r/p,t.vy+=d*e.value*r/p),!0;if(!(e.length||p>=s)){(e.data!==t||e.next)&&(0===h&&(p+=(h=nh(n))*h),0===d&&(p+=(d=nh(n))*d),p<o&&(p=Math.sqrt(o*p)));do{e.data!==t&&(f=i[e.data.index]*r/p,t.vx+=h*f,t.vy+=d*f)}while(e=e.next)}}return c.initialize=function(t,r){e=t,n=r,u()},c.strength=function(e){return arguments.length?(a="function"===typeof e?e:th(+e),u(),c):a},c.distanceMin=function(e){return arguments.length?(o=e*e,c):Math.sqrt(o)},c.distanceMax=function(e){return arguments.length?(s=e*e,c):Math.sqrt(s)},c.theta=function(e){return arguments.length?(l=e*e,c):Math.sqrt(l)},c}function yh(e,t,n){var r,i,a,o=th(.1);function s(e){for(var o=0,s=r.length;o<s;++o){var l=r[o],c=l.x-t||1e-6,u=l.y-n||1e-6,h=Math.sqrt(c*c+u*u),d=(a[o]-h)*i[o]*e/h;l.vx+=c*d,l.vy+=u*d}}function l(){if(r){var t,n=r.length;for(i=new Array(n),a=new Array(n),t=0;t<n;++t)a[t]=+e(r[t],t,r),i[t]=isNaN(a[t])?0:+o(r[t],t,r)}}return"function"!==typeof e&&(e=th(+e)),null==t&&(t=0),null==n&&(n=0),s.initialize=function(e){r=e,l()},s.strength=function(e){return arguments.length?(o="function"===typeof e?e:th(+e),l(),s):o},s.radius=function(t){return arguments.length?(e="function"===typeof t?t:th(+t),l(),s):e},s.x=function(e){return arguments.length?(t=+e,s):t},s.y=function(e){return arguments.length?(n=+e,s):n},s}function xh(e){var t,n,r,i=th(.1);function a(e){for(var i,a=0,o=t.length;a<o;++a)(i=t[a]).vx+=(r[a]-i.x)*n[a]*e}function o(){if(t){var a,o=t.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+e(t[a],a,t))?0:+i(t[a],a,t)}}return"function"!==typeof e&&(e=th(null==e?0:+e)),a.initialize=function(e){t=e,o()},a.strength=function(e){return arguments.length?(i="function"===typeof e?e:th(+e),o(),a):i},a.x=function(t){return arguments.length?(e="function"===typeof t?t:th(+t),o(),a):e},a}function bh(e){var t,n,r,i=th(.1);function a(e){for(var i,a=0,o=t.length;a<o;++a)(i=t[a]).vy+=(r[a]-i.y)*n[a]*e}function o(){if(t){var a,o=t.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+e(t[a],a,t))?0:+i(t[a],a,t)}}return"function"!==typeof e&&(e=th(null==e?0:+e)),a.initialize=function(e){t=e,o()},a.strength=function(e){return arguments.length?(i="function"===typeof e?e:th(+e),o(),a):i},a.y=function(t){return arguments.length?(e="function"===typeof t?t:th(+t),o(),a):e},a}function _h(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function wh(e){return(e=_h(Math.abs(e)))?e[1]:NaN}var Sh,Mh=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Dh(e){if(!(t=Mh.exec(e)))throw new Error("invalid format: "+e);var t;return new Eh({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Eh(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Ch(e,t){var n=_h(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Dh.prototype=Eh.prototype,Eh.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Ah={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Ch(100*e,t),r:Ch,s:function(e,t){var n=_h(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(Sh=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+_h(e,Math.max(0,t+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Th(e){return e}var Nh,Rh,Ph,Fh=Array.prototype.map,Oh=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Ih(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Th:(t=Fh.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,a=[],o=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),a.push(e.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[o=(o+1)%t.length];return a.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Th:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Fh.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=Dh(e)).fill,n=e.align,h=e.sign,d=e.symbol,f=e.zero,p=e.width,m=e.comma,g=e.precision,v=e.trim,y=e.type;"n"===y?(m=!0,y="g"):Ah[y]||(void 0===g&&(g=12),v=!0,y="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var x="$"===d?i:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",b="$"===d?a:/[%p]/.test(y)?l:"",_=Ah[y],w=/[defgprs%]/.test(y);function S(e){var i,a,l,d=x,S=b;if("c"===y)S=_(e)+S,e="";else{var M=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:_(Math.abs(e),g),v&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),M&&0===+e&&"+"!==h&&(M=!1),d=(M?"("===h?h:c:"-"===h||"("===h?"":h)+d,S=("s"===y?Oh[8+Sh/3]:"")+S+(M&&"("===h?")":""),w)for(i=-1,a=e.length;++i<a;)if(48>(l=e.charCodeAt(i))||l>57){S=(46===l?o+e.slice(i+1):e.slice(i))+S,e=e.slice(0,i);break}}m&&!f&&(e=r(e,1/0));var D=d.length+e.length+S.length,E=D<p?new Array(p-D+1).join(t):"";switch(m&&f&&(e=r(E+e,E.length?p-S.length:1/0),E=""),n){case"<":e=d+e+S+E;break;case"=":e=d+E+e+S;break;case"^":e=E.slice(0,D=E.length>>1)+d+e+S+E.slice(D);break;default:e=E+d+e+S}return s(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return e+""},S}return{format:h,formatPrefix:function(e,t){var n=h(((e=Dh(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(wh(t)/3))),i=Math.pow(10,-r),a=Oh[8+r/3];return function(e){return n(i*e)+a}}}}function Bh(e){return Nh=Ih(e),Rh=Nh.format,Ph=Nh.formatPrefix,Nh}function kh(e){return Math.max(0,-wh(Math.abs(e)))}function Lh(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(wh(t)/3)))-wh(Math.abs(e)))}function Uh(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,wh(t)-wh(e))+1}Bh({thousands:",",grouping:[3],currency:["$",""]});var zh=1e-6,Hh=1e-12,Vh=Math.PI,Gh=Vh/2,qh=Vh/4,jh=2*Vh,Wh=180/Vh,Xh=Vh/180,Yh=Math.abs,Zh=Math.atan,Kh=Math.atan2,Qh=Math.cos,Jh=Math.ceil,$h=Math.exp,ed=(Math.floor,Math.hypot),td=Math.log,nd=Math.pow,rd=Math.sin,id=Math.sign||function(e){return e>0?1:e<0?-1:0},ad=Math.sqrt,od=Math.tan;function sd(e){return e>1?0:e<-1?Vh:Math.acos(e)}function ld(e){return e>1?Gh:e<-1?-Gh:Math.asin(e)}function cd(e){return(e=rd(e/2))*e}function ud(){}function hd(e,t){e&&fd.hasOwnProperty(e.type)&&fd[e.type](e,t)}var dd={Feature:function(e,t){hd(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)hd(n[r].geometry,t)}},fd={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){pd(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)pd(n[r],t,0)},Polygon:function(e,t){md(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)md(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)hd(n[r],t)}};function pd(e,t,n){var r,i=-1,a=e.length-n;for(t.lineStart();++i<a;)r=e[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function md(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)pd(e[n],t,1);t.polygonEnd()}function gd(e,t){e&&dd.hasOwnProperty(e.type)?dd[e.type](e,t):hd(e,t)}var vd,yd,xd,bd,_d,wd,Sd,Md,Dd,Ed,Cd,Ad,Td,Nd,Rd,Pd,Fd=new Ae,Od=new Ae,Id={point:ud,lineStart:ud,lineEnd:ud,polygonStart:function(){Fd=new Ae,Id.lineStart=Bd,Id.lineEnd=kd},polygonEnd:function(){var e=+Fd;Od.add(e<0?jh+e:e),this.lineStart=this.lineEnd=this.point=ud},sphere:function(){Od.add(jh)}};function Bd(){Id.point=Ld}function kd(){Ud(vd,yd)}function Ld(e,t){Id.point=Ud,vd=e,yd=t,xd=e*=Xh,bd=Qh(t=(t*=Xh)/2+qh),_d=rd(t)}function Ud(e,t){var n=(e*=Xh)-xd,r=n>=0?1:-1,i=r*n,a=Qh(t=(t*=Xh)/2+qh),o=rd(t),s=_d*o,l=bd*a+s*Qh(i),c=s*r*rd(i);Fd.add(Kh(c,l)),xd=e,bd=a,_d=o}function zd(e){return Od=new Ae,gd(e,Id),2*Od}function Hd(e){return[Kh(e[1],e[0]),ld(e[2])]}function Vd(e){var t=e[0],n=e[1],r=Qh(n);return[r*Qh(t),r*rd(t),rd(n)]}function Gd(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function qd(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function jd(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Wd(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Xd(e){var t=ad(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Yd,Zd,Kd,Qd,Jd,$d,ef,tf,nf,rf,af,of,sf,lf,cf,uf,hf={point:df,lineStart:pf,lineEnd:mf,polygonStart:function(){hf.point=gf,hf.lineStart=vf,hf.lineEnd=yf,Nd=new Ae,Id.polygonStart()},polygonEnd:function(){Id.polygonEnd(),hf.point=df,hf.lineStart=pf,hf.lineEnd=mf,Fd<0?(wd=-(Md=180),Sd=-(Dd=90)):Nd>zh?Dd=90:Nd<-zh&&(Sd=-90),Pd[0]=wd,Pd[1]=Md},sphere:function(){wd=-(Md=180),Sd=-(Dd=90)}};function df(e,t){Rd.push(Pd=[wd=e,Md=e]),t<Sd&&(Sd=t),t>Dd&&(Dd=t)}function ff(e,t){var n=Vd([e*Xh,t*Xh]);if(Td){var r=qd(Td,n),i=qd([r[1],-r[0],0],r);Xd(i),i=Hd(i);var a,o=e-Ed,s=o>0?1:-1,l=i[0]*Wh*s,c=Yh(o)>180;c^(s*Ed<l&&l<s*e)?(a=i[1]*Wh)>Dd&&(Dd=a):c^(s*Ed<(l=(l+360)%360-180)&&l<s*e)?(a=-i[1]*Wh)<Sd&&(Sd=a):(t<Sd&&(Sd=t),t>Dd&&(Dd=t)),c?e<Ed?xf(wd,e)>xf(wd,Md)&&(Md=e):xf(e,Md)>xf(wd,Md)&&(wd=e):Md>=wd?(e<wd&&(wd=e),e>Md&&(Md=e)):e>Ed?xf(wd,e)>xf(wd,Md)&&(Md=e):xf(e,Md)>xf(wd,Md)&&(wd=e)}else Rd.push(Pd=[wd=e,Md=e]);t<Sd&&(Sd=t),t>Dd&&(Dd=t),Td=n,Ed=e}function pf(){hf.point=ff}function mf(){Pd[0]=wd,Pd[1]=Md,hf.point=df,Td=null}function gf(e,t){if(Td){var n=e-Ed;Nd.add(Yh(n)>180?n+(n>0?360:-360):n)}else Cd=e,Ad=t;Id.point(e,t),ff(e,t)}function vf(){Id.lineStart()}function yf(){gf(Cd,Ad),Id.lineEnd(),Yh(Nd)>zh&&(wd=-(Md=180)),Pd[0]=wd,Pd[1]=Md,Td=null}function xf(e,t){return(t-=e)<0?t+360:t}function bf(e,t){return e[0]-t[0]}function _f(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function wf(e){var t,n,r,i,a,o,s;if(Dd=Md=-(wd=Sd=1/0),Rd=[],gd(e,hf),n=Rd.length){for(Rd.sort(bf),t=1,a=[r=Rd[0]];t<n;++t)_f(r,(i=Rd[t])[0])||_f(r,i[1])?(xf(r[0],i[1])>xf(r[0],r[1])&&(r[1]=i[1]),xf(i[0],r[1])>xf(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,t=0,r=a[n=a.length-1];t<=n;r=i,++t)i=a[t],(s=xf(r[1],i[0]))>o&&(o=s,wd=i[0],Md=r[1])}return Rd=Pd=null,wd===1/0||Sd===1/0?[[NaN,NaN],[NaN,NaN]]:[[wd,Sd],[Md,Dd]]}var Sf={sphere:ud,point:Mf,lineStart:Ef,lineEnd:Tf,polygonStart:function(){Sf.lineStart=Nf,Sf.lineEnd=Rf},polygonEnd:function(){Sf.lineStart=Ef,Sf.lineEnd=Tf}};function Mf(e,t){e*=Xh;var n=Qh(t*=Xh);Df(n*Qh(e),n*rd(e),rd(t))}function Df(e,t,n){++Yd,Kd+=(e-Kd)/Yd,Qd+=(t-Qd)/Yd,Jd+=(n-Jd)/Yd}function Ef(){Sf.point=Cf}function Cf(e,t){e*=Xh;var n=Qh(t*=Xh);lf=n*Qh(e),cf=n*rd(e),uf=rd(t),Sf.point=Af,Df(lf,cf,uf)}function Af(e,t){e*=Xh;var n=Qh(t*=Xh),r=n*Qh(e),i=n*rd(e),a=rd(t),o=Kh(ad((o=cf*a-uf*i)*o+(o=uf*r-lf*a)*o+(o=lf*i-cf*r)*o),lf*r+cf*i+uf*a);Zd+=o,$d+=o*(lf+(lf=r)),ef+=o*(cf+(cf=i)),tf+=o*(uf+(uf=a)),Df(lf,cf,uf)}function Tf(){Sf.point=Mf}function Nf(){Sf.point=Pf}function Rf(){Ff(of,sf),Sf.point=Mf}function Pf(e,t){of=e,sf=t,e*=Xh,t*=Xh,Sf.point=Ff;var n=Qh(t);lf=n*Qh(e),cf=n*rd(e),uf=rd(t),Df(lf,cf,uf)}function Ff(e,t){e*=Xh;var n=Qh(t*=Xh),r=n*Qh(e),i=n*rd(e),a=rd(t),o=cf*a-uf*i,s=uf*r-lf*a,l=lf*i-cf*r,c=ed(o,s,l),u=ld(c),h=c&&-u/c;nf.add(h*o),rf.add(h*s),af.add(h*l),Zd+=u,$d+=u*(lf+(lf=r)),ef+=u*(cf+(cf=i)),tf+=u*(uf+(uf=a)),Df(lf,cf,uf)}function Of(e){Yd=Zd=Kd=Qd=Jd=$d=ef=tf=0,nf=new Ae,rf=new Ae,af=new Ae,gd(e,Sf);var t=+nf,n=+rf,r=+af,i=ed(t,n,r);return i<Hh&&(t=$d,n=ef,r=tf,Zd<zh&&(t=Kd,n=Qd,r=Jd),(i=ed(t,n,r))<Hh)?[NaN,NaN]:[Kh(n,t)*Wh,ld(r/i)*Wh]}function If(e){return function(){return e}}function Bf(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function kf(e,t){return Yh(e)>Vh&&(e-=Math.round(e/jh)*jh),[e,t]}function Lf(e,t,n){return(e%=jh)?t||n?Bf(zf(e),Hf(t,n)):zf(e):t||n?Hf(t,n):kf}function Uf(e){return function(t,n){return Yh(t+=e)>Vh&&(t-=Math.round(t/jh)*jh),[t,n]}}function zf(e){var t=Uf(e);return t.invert=Uf(-e),t}function Hf(e,t){var n=Qh(e),r=rd(e),i=Qh(t),a=rd(t);function o(e,t){var o=Qh(t),s=Qh(e)*o,l=rd(e)*o,c=rd(t),u=c*n+s*r;return[Kh(l*i-u*a,s*n-c*r),ld(u*i+l*a)]}return o.invert=function(e,t){var o=Qh(t),s=Qh(e)*o,l=rd(e)*o,c=rd(t),u=c*i-l*a;return[Kh(l*i+c*a,s*n+u*r),ld(u*n-s*r)]},o}function Vf(e){function t(t){return(t=e(t[0]*Xh,t[1]*Xh))[0]*=Wh,t[1]*=Wh,t}return e=Lf(e[0]*Xh,e[1]*Xh,e.length>2?e[2]*Xh:0),t.invert=function(t){return(t=e.invert(t[0]*Xh,t[1]*Xh))[0]*=Wh,t[1]*=Wh,t},t}function Gf(e,t,n,r,i,a){if(n){var o=Qh(t),s=rd(t),l=r*n;null==i?(i=t+r*jh,a=t-l/2):(i=qf(o,i),a=qf(o,a),(r>0?i<a:i>a)&&(i+=r*jh));for(var c,u=i;r>0?u>a:u<a;u-=l)c=Hd([o,-s*Qh(u),-s*rd(u)]),e.point(c[0],c[1])}}function qf(e,t){(t=Vd(t))[0]-=e,Xd(t);var n=sd(-t[1]);return((-t[2]<0?-n:n)+jh-zh)%jh}function jf(){var e,t,n=If([0,0]),r=If(90),i=If(2),a={point:function(n,r){e.push(n=t(n,r)),n[0]*=Wh,n[1]*=Wh}};function o(){var o=n.apply(this,arguments),s=r.apply(this,arguments)*Xh,l=i.apply(this,arguments)*Xh;return e=[],t=Lf(-o[0]*Xh,-o[1]*Xh,0).invert,Gf(a,s,l,1),o={type:"Polygon",coordinates:[e]},e=t=null,o}return o.center=function(e){return arguments.length?(n="function"===typeof e?e:If([+e[0],+e[1]]),o):n},o.radius=function(e){return arguments.length?(r="function"===typeof e?e:If(+e),o):r},o.precision=function(e){return arguments.length?(i="function"===typeof e?e:If(+e),o):i},o}function Wf(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:ud,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function Xf(e,t){return Yh(e[0]-t[0])<zh&&Yh(e[1]-t[1])<zh}function Yf(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Zf(e,t,n,r,i){var a,o,s=[],l=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],o=e[t];if(Xf(r,o)){if(!r[2]&&!o[2]){for(i.lineStart(),a=0;a<t;++a)i.point((r=e[a])[0],r[1]);return void i.lineEnd()}o[0]+=2*zh}s.push(n=new Yf(r,e,null,!0)),l.push(n.o=new Yf(r,null,n,!1)),s.push(n=new Yf(o,e,null,!1)),l.push(n.o=new Yf(o,null,n,!0))}})),s.length){for(l.sort(t),Kf(s),Kf(l),a=0,o=l.length;a<o;++a)l[a].e=n=!n;for(var c,u,h=s[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;c=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(a=0,o=c.length;a<o;++a)i.point((u=c[a])[0],u[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(f)for(c=d.p.z,a=c.length-1;a>=0;--a)i.point((u=c[a])[0],u[1]);else r(d.x,d.p.x,-1,i);d=d.p}c=(d=d.o).z,f=!f}while(!d.v);i.lineEnd()}}}function Kf(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.n=n=e[r],n.p=i,i=n;i.n=n=e[0],n.p=i}}function Qf(e){return Yh(e[0])<=Vh?e[0]:id(e[0])*((Yh(e[0])+Vh)%jh-Vh)}function Jf(e,t){var n=Qf(t),r=t[1],i=rd(r),a=[rd(n),-Qh(n),0],o=0,s=0,l=new Ae;1===i?r=Gh+zh:-1===i&&(r=-Gh-zh);for(var c=0,u=e.length;c<u;++c)if(d=(h=e[c]).length)for(var h,d,f=h[d-1],p=Qf(f),m=f[1]/2+qh,g=rd(m),v=Qh(m),y=0;y<d;++y,p=b,g=w,v=S,f=x){var x=h[y],b=Qf(x),_=x[1]/2+qh,w=rd(_),S=Qh(_),M=b-p,D=M>=0?1:-1,E=D*M,C=E>Vh,A=g*w;if(l.add(Kh(A*D*rd(E),v*S+A*Qh(E))),o+=C?M+D*jh:M,C^p>=n^b>=n){var T=qd(Vd(f),Vd(x));Xd(T);var N=qd(a,T);Xd(N);var R=(C^M>=0?-1:1)*ld(N[2]);(r>R||r===R&&(T[0]||T[1]))&&(s+=C^M>=0?1:-1)}}return(o<-zh||o<zh&&l<-Hh)^1&s}function $f(e,t,n,r){return function(i){var a,o,s,l=t(i),c=Wf(),u=t(c),h=!1,d={point:f,lineStart:m,lineEnd:g,polygonStart:function(){d.point=v,d.lineStart=y,d.lineEnd=x,o=[],a=[]},polygonEnd:function(){d.point=f,d.lineStart=m,d.lineEnd=g,o=At(o);var e=Jf(a,r);o.length?(h||(i.polygonStart(),h=!0),Zf(o,tp,e,n,i)):e&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function f(t,n){e(t,n)&&i.point(t,n)}function p(e,t){l.point(e,t)}function m(){d.point=p,l.lineStart()}function g(){d.point=f,l.lineEnd()}function v(e,t){s.push([e,t]),u.point(e,t)}function y(){u.lineStart(),s=[]}function x(){v(s[0][0],s[0][1]),u.lineEnd();var e,t,n,r,l=u.clean(),d=c.result(),f=d.length;if(s.pop(),a.push(s),s=null,f)if(1&l){if((t=(n=d[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),e=0;e<t;++e)i.point((r=n[e])[0],r[1]);i.lineEnd()}}else f>1&&2&l&&d.push(d.pop().concat(d.shift())),o.push(d.filter(ep))}return d}}function ep(e){return e.length>1}function tp(e,t){return((e=e.x)[0]<0?e[1]-Gh-zh:Gh-e[1])-((t=t.x)[0]<0?t[1]-Gh-zh:Gh-t[1])}kf.invert=kf;const np=$f((function(){return!0}),(function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(a,o){var s=a>0?Vh:-Vh,l=Yh(a-n);Yh(l-Vh)<zh?(e.point(n,r=(r+o)/2>0?Gh:-Gh),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(a,r),t=0):i!==s&&l>=Vh&&(Yh(n-i)<zh&&(n-=i*zh),Yh(a-s)<zh&&(a-=s*zh),r=function(e,t,n,r){var i,a,o=rd(e-n);return Yh(o)>zh?Zh((rd(t)*(a=Qh(r))*rd(n)-rd(r)*(i=Qh(t))*rd(e))/(i*a*o)):(t+r)/2}(n,r,a,o),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=a,r=o),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var i;if(null==e)i=n*Gh,r.point(-Vh,i),r.point(0,i),r.point(Vh,i),r.point(Vh,0),r.point(Vh,-i),r.point(0,-i),r.point(-Vh,-i),r.point(-Vh,0),r.point(-Vh,i);else if(Yh(e[0]-t[0])>zh){var a=e[0]<t[0]?Vh:-Vh;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(t[0],t[1])}),[-Vh,-Gh]);function rp(e){var t=Qh(e),n=2*Xh,r=t>0,i=Yh(t)>zh;function a(e,n){return Qh(e)*Qh(n)>t}function o(e,n,r){var i=[1,0,0],a=qd(Vd(e),Vd(n)),o=Gd(a,a),s=a[0],l=o-s*s;if(!l)return!r&&e;var c=t*o/l,u=-t*s/l,h=qd(i,a),d=Wd(i,c);jd(d,Wd(a,u));var f=h,p=Gd(d,f),m=Gd(f,f),g=p*p-m*(Gd(d,d)-1);if(!(g<0)){var v=ad(g),y=Wd(f,(-p-v)/m);if(jd(y,d),y=Hd(y),!r)return y;var x,b=e[0],_=n[0],w=e[1],S=n[1];_<b&&(x=b,b=_,_=x);var M=_-b,D=Yh(M-Vh)<zh;if(!D&&S<w&&(x=w,w=S,S=x),D||M<zh?D?w+S>0^y[1]<(Yh(y[0]-b)<zh?w:S):w<=y[1]&&y[1]<=S:M>Vh^(b<=y[0]&&y[0]<=_)){var E=Wd(f,(-p+v)/m);return jd(E,d),[y,Hd(E)]}}}function s(t,n){var i=r?e:Vh-e,a=0;return t<-i?a|=1:t>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return $f(a,(function(e){var t,n,l,c,u;return{lineStart:function(){c=l=!1,u=1},point:function(h,d){var f,p=[h,d],m=a(h,d),g=r?m?0:s(h,d):m?s(h+(h<0?Vh:-Vh),d):0;if(!t&&(c=l=m)&&e.lineStart(),m!==l&&(!(f=o(t,p))||Xf(t,f)||Xf(p,f))&&(p[2]=1),m!==l)u=0,m?(e.lineStart(),f=o(p,t),e.point(f[0],f[1])):(f=o(t,p),e.point(f[0],f[1],2),e.lineEnd()),t=f;else if(i&&t&&r^m){var v;g&n||!(v=o(p,t,!0))||(u=0,r?(e.lineStart(),e.point(v[0][0],v[0][1]),e.point(v[1][0],v[1][1]),e.lineEnd()):(e.point(v[1][0],v[1][1]),e.lineEnd(),e.lineStart(),e.point(v[0][0],v[0][1],3)))}!m||t&&Xf(t,p)||e.point(p[0],p[1]),t=p,l=m,n=g},lineEnd:function(){l&&e.lineEnd(),t=null},clean:function(){return u|(c&&l)<<1}}}),(function(t,r,i,a){Gf(a,e,n,i,t,r)}),r?[0,-e]:[-Vh,e-Vh])}var ip,ap,op,sp,lp=1e9,cp=-lp;function up(e,t,n,r){function i(i,a){return e<=i&&i<=n&&t<=a&&a<=r}function a(i,a,s,c){var u=0,h=0;if(null==i||(u=o(i,s))!==(h=o(a,s))||l(i,a)<0^s>0)do{c.point(0===u||3===u?e:n,u>1?r:t)}while((u=(u+s+4)%4)!==h);else c.point(a[0],a[1])}function o(r,i){return Yh(r[0]-e)<zh?i>0?0:3:Yh(r[0]-n)<zh?i>0?2:1:Yh(r[1]-t)<zh?i>0?1:0:i>0?3:2}function s(e,t){return l(e.x,t.x)}function l(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(o){var l,c,u,h,d,f,p,m,g,v,y,x=o,b=Wf(),_={point:w,lineStart:function(){_.point=S,c&&c.push(u=[]);v=!0,g=!1,p=m=NaN},lineEnd:function(){l&&(S(h,d),f&&g&&b.rejoin(),l.push(b.result()));_.point=w,g&&x.lineEnd()},polygonStart:function(){x=b,l=[],c=[],y=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,i=c.length;n<i;++n)for(var a,o,s=c[n],l=1,u=s.length,h=s[0],d=h[0],f=h[1];l<u;++l)a=d,o=f,d=(h=s[l])[0],f=h[1],o<=r?f>r&&(d-a)*(r-o)>(f-o)*(e-a)&&++t:f<=r&&(d-a)*(r-o)<(f-o)*(e-a)&&--t;return t}(),n=y&&t,i=(l=At(l)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&Zf(l,s,t,a,o),o.polygonEnd());x=o,l=c=u=null}};function w(e,t){i(e,t)&&x.point(e,t)}function S(a,o){var s=i(a,o);if(c&&u.push([a,o]),v)h=a,d=o,f=s,v=!1,s&&(x.lineStart(),x.point(a,o));else if(s&&g)x.point(a,o);else{var l=[p=Math.max(cp,Math.min(lp,p)),m=Math.max(cp,Math.min(lp,m))],b=[a=Math.max(cp,Math.min(lp,a)),o=Math.max(cp,Math.min(lp,o))];!function(e,t,n,r,i,a){var o,s=e[0],l=e[1],c=0,u=1,h=t[0]-s,d=t[1]-l;if(o=n-s,h||!(o>0)){if(o/=h,h<0){if(o<c)return;o<u&&(u=o)}else if(h>0){if(o>u)return;o>c&&(c=o)}if(o=i-s,h||!(o<0)){if(o/=h,h<0){if(o>u)return;o>c&&(c=o)}else if(h>0){if(o<c)return;o<u&&(u=o)}if(o=r-l,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<u&&(u=o)}else if(d>0){if(o>u)return;o>c&&(c=o)}if(o=a-l,d||!(o<0)){if(o/=d,d<0){if(o>u)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<u&&(u=o)}return c>0&&(e[0]=s+c*h,e[1]=l+c*d),u<1&&(t[0]=s+u*h,t[1]=l+u*d),!0}}}}}(l,b,e,t,n,r)?s&&(x.lineStart(),x.point(a,o),y=!1):(g||(x.lineStart(),x.point(l[0],l[1])),x.point(b[0],b[1]),s||x.lineEnd(),y=!1)}p=a,m=o,g=s}return _}}function hp(){var e,t,n,r=0,i=0,a=960,o=500;return n={stream:function(n){return e&&t===n?e:e=up(r,i,a,o)(t=n)},extent:function(s){return arguments.length?(r=+s[0][0],i=+s[0][1],a=+s[1][0],o=+s[1][1],e=t=null,n):[[r,i],[a,o]]}}}var dp={sphere:ud,point:ud,lineStart:function(){dp.point=pp,dp.lineEnd=fp},lineEnd:ud,polygonStart:ud,polygonEnd:ud};function fp(){dp.point=dp.lineEnd=ud}function pp(e,t){ap=e*=Xh,op=rd(t*=Xh),sp=Qh(t),dp.point=mp}function mp(e,t){e*=Xh;var n=rd(t*=Xh),r=Qh(t),i=Yh(e-ap),a=Qh(i),o=r*rd(i),s=sp*n-op*r*a,l=op*n+sp*r*a;ip.add(Kh(ad(o*o+s*s),l)),ap=e,op=n,sp=r}function gp(e){return ip=new Ae,gd(e,dp),+ip}var vp=[null,null],yp={type:"LineString",coordinates:vp};function xp(e,t){return vp[0]=e,vp[1]=t,gp(yp)}var bp={Feature:function(e,t){return wp(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)if(wp(n[r].geometry,t))return!0;return!1}},_p={Sphere:function(){return!0},Point:function(e,t){return Sp(e.coordinates,t)},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Sp(n[r],t))return!0;return!1},LineString:function(e,t){return Mp(e.coordinates,t)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Mp(n[r],t))return!0;return!1},Polygon:function(e,t){return Dp(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)if(Dp(n[r],t))return!0;return!1},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)if(wp(n[r],t))return!0;return!1}};function wp(e,t){return!(!e||!_p.hasOwnProperty(e.type))&&_p[e.type](e,t)}function Sp(e,t){return 0===xp(e,t)}function Mp(e,t){for(var n,r,i,a=0,o=e.length;a<o;a++){if(0===(r=xp(e[a],t)))return!0;if(a>0&&(i=xp(e[a],e[a-1]))>0&&n<=i&&r<=i&&(n+r-i)*(1-Math.pow((n-r)/i,2))<Hh*i)return!0;n=r}return!1}function Dp(e,t){return!!Jf(e.map(Ep),Cp(t))}function Ep(e){return(e=e.map(Cp)).pop(),e}function Cp(e){return[e[0]*Xh,e[1]*Xh]}function Ap(e,t){return(e&&bp.hasOwnProperty(e.type)?bp[e.type]:wp)(e,t)}function Tp(e,t,n){var r=Pt(e,t-zh,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function Np(e,t,n){var r=Pt(e,t-zh,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}function Rp(){var e,t,n,r,i,a,o,s,l,c,u,h,d=10,f=d,p=90,m=360,g=2.5;function v(){return{type:"MultiLineString",coordinates:y()}}function y(){return Pt(Jh(r/p)*p,n,p).map(u).concat(Pt(Jh(s/m)*m,o,m).map(h)).concat(Pt(Jh(t/d)*d,e,d).filter((function(e){return Yh(e%p)>zh})).map(l)).concat(Pt(Jh(a/f)*f,i,f).filter((function(e){return Yh(e%m)>zh})).map(c))}return v.lines=function(){return y().map((function(e){return{type:"LineString",coordinates:e}}))},v.outline=function(){return{type:"Polygon",coordinates:[u(r).concat(h(o).slice(1),u(n).reverse().slice(1),h(s).reverse().slice(1))]}},v.extent=function(e){return arguments.length?v.extentMajor(e).extentMinor(e):v.extentMinor()},v.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],o=+e[1][1],r>n&&(e=r,r=n,n=e),s>o&&(e=s,s=o,o=e),v.precision(g)):[[r,s],[n,o]]},v.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],a=+n[0][1],i=+n[1][1],t>e&&(n=t,t=e,e=n),a>i&&(n=a,a=i,i=n),v.precision(g)):[[t,a],[e,i]]},v.step=function(e){return arguments.length?v.stepMajor(e).stepMinor(e):v.stepMinor()},v.stepMajor=function(e){return arguments.length?(p=+e[0],m=+e[1],v):[p,m]},v.stepMinor=function(e){return arguments.length?(d=+e[0],f=+e[1],v):[d,f]},v.precision=function(d){return arguments.length?(g=+d,l=Tp(a,i,90),c=Np(t,e,g),u=Tp(s,o,90),h=Np(r,n,g),v):g},v.extentMajor([[-180,-90+zh],[180,90-zh]]).extentMinor([[-180,-80-zh],[180,80+zh]])}function Pp(){return Rp()()}function Fp(e,t){var n=e[0]*Xh,r=e[1]*Xh,i=t[0]*Xh,a=t[1]*Xh,o=Qh(r),s=rd(r),l=Qh(a),c=rd(a),u=o*Qh(n),h=o*rd(n),d=l*Qh(i),f=l*rd(i),p=2*ld(ad(cd(a-r)+o*l*cd(i-n))),m=rd(p),g=p?function(e){var t=rd(e*=p)/m,n=rd(p-e)/m,r=n*u+t*d,i=n*h+t*f,a=n*s+t*c;return[Kh(i,r)*Wh,Kh(a,ad(r*r+i*i))*Wh]}:function(){return[n*Wh,r*Wh]};return g.distance=p,g}const Op=e=>e;var Ip,Bp,kp,Lp,Up=new Ae,zp=new Ae,Hp={point:ud,lineStart:ud,lineEnd:ud,polygonStart:function(){Hp.lineStart=Vp,Hp.lineEnd=jp},polygonEnd:function(){Hp.lineStart=Hp.lineEnd=Hp.point=ud,Up.add(Yh(zp)),zp=new Ae},result:function(){var e=Up/2;return Up=new Ae,e}};function Vp(){Hp.point=Gp}function Gp(e,t){Hp.point=qp,Ip=kp=e,Bp=Lp=t}function qp(e,t){zp.add(Lp*e-kp*t),kp=e,Lp=t}function jp(){qp(Ip,Bp)}const Wp=Hp;var Xp=1/0,Yp=Xp,Zp=-Xp,Kp=Zp,Qp={point:function(e,t){e<Xp&&(Xp=e);e>Zp&&(Zp=e);t<Yp&&(Yp=t);t>Kp&&(Kp=t)},lineStart:ud,lineEnd:ud,polygonStart:ud,polygonEnd:ud,result:function(){var e=[[Xp,Yp],[Zp,Kp]];return Zp=Kp=-(Yp=Xp=1/0),e}};const Jp=Qp;var $p,em,tm,nm,rm=0,im=0,am=0,om=0,sm=0,lm=0,cm=0,um=0,hm=0,dm={point:fm,lineStart:pm,lineEnd:vm,polygonStart:function(){dm.lineStart=ym,dm.lineEnd=xm},polygonEnd:function(){dm.point=fm,dm.lineStart=pm,dm.lineEnd=vm},result:function(){var e=hm?[cm/hm,um/hm]:lm?[om/lm,sm/lm]:am?[rm/am,im/am]:[NaN,NaN];return rm=im=am=om=sm=lm=cm=um=hm=0,e}};function fm(e,t){rm+=e,im+=t,++am}function pm(){dm.point=mm}function mm(e,t){dm.point=gm,fm(tm=e,nm=t)}function gm(e,t){var n=e-tm,r=t-nm,i=ad(n*n+r*r);om+=i*(tm+e)/2,sm+=i*(nm+t)/2,lm+=i,fm(tm=e,nm=t)}function vm(){dm.point=fm}function ym(){dm.point=bm}function xm(){_m($p,em)}function bm(e,t){dm.point=_m,fm($p=tm=e,em=nm=t)}function _m(e,t){var n=e-tm,r=t-nm,i=ad(n*n+r*r);om+=i*(tm+e)/2,sm+=i*(nm+t)/2,lm+=i,cm+=(i=nm*e-tm*t)*(tm+e),um+=i*(nm+t),hm+=3*i,fm(tm=e,nm=t)}const wm=dm;function Sm(e){this._context=e}Sm.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,jh)}},result:ud};var Mm,Dm,Em,Cm,Am,Tm=new Ae,Nm={point:ud,lineStart:function(){Nm.point=Rm},lineEnd:function(){Mm&&Pm(Dm,Em),Nm.point=ud},polygonStart:function(){Mm=!0},polygonEnd:function(){Mm=null},result:function(){var e=+Tm;return Tm=new Ae,e}};function Rm(e,t){Nm.point=Pm,Dm=Cm=e,Em=Am=t}function Pm(e,t){Cm-=e,Am-=t,Tm.add(ad(Cm*Cm+Am*Am)),Cm=e,Am=t}const Fm=Nm;var Om,Im,Bm,km;let Lm,Um,zm,Hm;class Vm{constructor(e){this._append=null==e?Gm:function(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError("invalid digits: ".concat(e));if(t>15)return Gm;if(t!==Lm){const e=10**t;Lm=t,Um=function(t){let n=1;this._+=t[0];for(const r=t.length;n<r;++n)this._+=Math.round(arguments[n]*e)/e+t[n]}}return Um}(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(e,t){switch(this._point){case 0:this._append(Om||(Om=vs(["M",",",""])),e,t),this._point=1;break;case 1:this._append(Im||(Im=vs(["L",",",""])),e,t);break;default:if(this._append(Bm||(Bm=vs(["M",",",""])),e,t),this._radius!==zm||this._append!==Um){const e=this._radius,t=this._;this._="",this._append(km||(km=vs(["m0,","a",","," 0 1,1 0,","a",","," 0 1,1 0,","z"])),e,e,e,-2*e,e,e,2*e),zm=e,Um=this._append,Hm=this._,this._=t}this._+=Hm}}result(){const e=this._;return this._="",e.length?e:null}}function Gm(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function qm(e,t){let n,r,i=3,a=4.5;function o(e){return e&&("function"===typeof a&&r.pointRadius(+a.apply(this,arguments)),gd(e,n(r))),r.result()}return o.area=function(e){return gd(e,n(Wp)),Wp.result()},o.measure=function(e){return gd(e,n(Fm)),Fm.result()},o.bounds=function(e){return gd(e,n(Jp)),Jp.result()},o.centroid=function(e){return gd(e,n(wm)),wm.result()},o.projection=function(t){return arguments.length?(n=null==t?(e=null,Op):(e=t).stream,o):e},o.context=function(e){return arguments.length?(r=null==e?(t=null,new Vm(i)):new Sm(t=e),"function"!==typeof a&&r.pointRadius(a),o):t},o.pointRadius=function(e){return arguments.length?(a="function"===typeof e?e:(r.pointRadius(+e),+e),o):a},o.digits=function(e){if(!arguments.length)return i;if(null==e)i=null;else{const t=Math.floor(e);if(!(t>=0))throw new RangeError("invalid digits: ".concat(e));i=t}return null===t&&(r=new Vm(i)),o},o.projection(e).digits(i).context(t)}function jm(e){return{stream:Wm(e)}}function Wm(e){return function(t){var n=new Xm;for(var r in e)n[r]=e[r];return n.stream=t,n}}function Xm(){}function Ym(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),gd(n,e.stream(Jp)),t(Jp.result()),null!=r&&e.clipExtent(r),e}function Zm(e,t,n){return Ym(e,(function(n){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+t[0][0]+(r-a*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(i-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([o,s])}),n)}function Km(e,t,n){return Zm(e,[[0,0],t],n)}function Qm(e,t,n){return Ym(e,(function(n){var r=+t,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];e.scale(150*i).translate([a,o])}),n)}function Jm(e,t,n){return Ym(e,(function(n){var r=+t,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([a,o])}),n)}Xm.prototype={constructor:Xm,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var $m=16,eg=Qh(30*Xh);function tg(e,t){return+t?function(e,t){function n(r,i,a,o,s,l,c,u,h,d,f,p,m,g){var v=c-r,y=u-i,x=v*v+y*y;if(x>4*t&&m--){var b=o+d,_=s+f,w=l+p,S=ad(b*b+_*_+w*w),M=ld(w/=S),D=Yh(Yh(w)-1)<zh||Yh(a-h)<zh?(a+h)/2:Kh(_,b),E=e(D,M),C=E[0],A=E[1],T=C-r,N=A-i,R=y*T-v*N;(R*R/x>t||Yh((v*T+y*N)/x-.5)>.3||o*d+s*f+l*p<eg)&&(n(r,i,a,o,s,l,C,A,D,b/=S,_/=S,w,m,g),g.point(C,A),n(C,A,D,b,_,w,c,u,h,d,f,p,m,g))}}return function(t){var r,i,a,o,s,l,c,u,h,d,f,p,m={point:g,lineStart:v,lineEnd:x,polygonStart:function(){t.polygonStart(),m.lineStart=b},polygonEnd:function(){t.polygonEnd(),m.lineStart=v}};function g(n,r){n=e(n,r),t.point(n[0],n[1])}function v(){u=NaN,m.point=y,t.lineStart()}function y(r,i){var a=Vd([r,i]),o=e(r,i);n(u,h,c,d,f,p,u=o[0],h=o[1],c=r,d=a[0],f=a[1],p=a[2],$m,t),t.point(u,h)}function x(){m.point=g,t.lineEnd()}function b(){v(),m.point=_,m.lineEnd=w}function _(e,t){y(r=e,t),i=u,a=h,o=d,s=f,l=p,m.point=y}function w(){n(u,h,c,d,f,p,i,a,r,o,s,l,$m,t),m.lineEnd=x,x()}return m}}(e,t):function(e){return Wm({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var ng=Wm({point:function(e,t){this.stream.point(e*Xh,t*Xh)}});function rg(e,t,n,r,i,a){if(!a)return function(e,t,n,r,i){function a(a,o){return[t+e*(a*=r),n-e*(o*=i)]}return a.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]},a}(e,t,n,r,i);var o=Qh(a),s=rd(a),l=o*e,c=s*e,u=o/e,h=s/e,d=(s*n-o*t)/e,f=(s*t+o*n)/e;function p(e,a){return[l*(e*=r)-c*(a*=i)+t,n-c*e-l*a]}return p.invert=function(e,t){return[r*(u*e-h*t+d),i*(f-h*e-u*t)]},p}function ig(e){return ag((function(){return e}))()}function ag(e){var t,n,r,i,a,o,s,l,c,u,h=150,d=480,f=250,p=0,m=0,g=0,v=0,y=0,x=0,b=1,_=1,w=null,S=np,M=null,D=Op,E=.5;function C(e){return l(e[0]*Xh,e[1]*Xh)}function A(e){return(e=l.invert(e[0],e[1]))&&[e[0]*Wh,e[1]*Wh]}function T(){var e=rg(h,0,0,b,_,x).apply(null,t(p,m)),r=rg(h,d-e[0],f-e[1],b,_,x);return n=Lf(g,v,y),s=Bf(t,r),l=Bf(n,s),o=tg(s,E),N()}function N(){return c=u=null,C}return C.stream=function(e){return c&&u===e?c:c=ng(function(e){return Wm({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(S(o(D(u=e)))))},C.preclip=function(e){return arguments.length?(S=e,w=void 0,N()):S},C.postclip=function(e){return arguments.length?(D=e,M=r=i=a=null,N()):D},C.clipAngle=function(e){return arguments.length?(S=+e?rp(w=e*Xh):(w=null,np),N()):w*Wh},C.clipExtent=function(e){return arguments.length?(D=null==e?(M=r=i=a=null,Op):up(M=+e[0][0],r=+e[0][1],i=+e[1][0],a=+e[1][1]),N()):null==M?null:[[M,r],[i,a]]},C.scale=function(e){return arguments.length?(h=+e,T()):h},C.translate=function(e){return arguments.length?(d=+e[0],f=+e[1],T()):[d,f]},C.center=function(e){return arguments.length?(p=e[0]%360*Xh,m=e[1]%360*Xh,T()):[p*Wh,m*Wh]},C.rotate=function(e){return arguments.length?(g=e[0]%360*Xh,v=e[1]%360*Xh,y=e.length>2?e[2]%360*Xh:0,T()):[g*Wh,v*Wh,y*Wh]},C.angle=function(e){return arguments.length?(x=e%360*Xh,T()):x*Wh},C.reflectX=function(e){return arguments.length?(b=e?-1:1,T()):b<0},C.reflectY=function(e){return arguments.length?(_=e?-1:1,T()):_<0},C.precision=function(e){return arguments.length?(o=tg(s,E=e*e),N()):ad(E)},C.fitExtent=function(e,t){return Zm(C,e,t)},C.fitSize=function(e,t){return Km(C,e,t)},C.fitWidth=function(e,t){return Qm(C,e,t)},C.fitHeight=function(e,t){return Jm(C,e,t)},function(){return t=e.apply(this,arguments),C.invert=t.invert&&A,T()}}function og(e){var t=0,n=Vh/3,r=ag(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*Xh,n=e[1]*Xh):[t*Wh,n*Wh]},i}function sg(e,t){var n=rd(e),r=(n+rd(t))/2;if(Yh(r)<zh)return function(e){var t=Qh(e);function n(e,n){return[e*t,rd(n)/t]}return n.invert=function(e,n){return[e/t,ld(n*t)]},n}(e);var i=1+n*(2*r-n),a=ad(i)/r;function o(e,t){var n=ad(i-2*r*rd(t))/r;return[n*rd(e*=r),a-n*Qh(e)]}return o.invert=function(e,t){var n=a-t,o=Kh(e,Yh(n))*id(n);return n*r<0&&(o-=Vh*id(e)*id(n)),[o/r,ld((i-(e*e+n*n)*r*r)/(2*r))]},o}function lg(){return og(sg).scale(155.424).center([0,33.6442])}function cg(){return lg().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function ug(){var e,t,n,r,i,a,o=cg(),s=lg().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=lg().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(e,t){a=[e,t]}};function u(e){var t=e[0],o=e[1];return a=null,n.point(t,o),a||(r.point(t,o),a)||(i.point(t,o),a)}function h(){return e=t=null,u}return u.invert=function(e){var t=o.scale(),n=o.translate(),r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?l:o).invert(e)},u.stream=function(n){return e&&t===n?e:e=function(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}([o.stream(t=n),s.stream(n),l.stream(n)])},u.precision=function(e){return arguments.length?(o.precision(e),s.precision(e),l.precision(e),h()):o.precision()},u.scale=function(e){return arguments.length?(o.scale(e),s.scale(.35*e),l.scale(e),u.translate(o.translate())):o.scale()},u.translate=function(e){if(!arguments.length)return o.translate();var t=o.scale(),a=+e[0],u=+e[1];return n=o.translate(e).clipExtent([[a-.455*t,u-.238*t],[a+.455*t,u+.238*t]]).stream(c),r=s.translate([a-.307*t,u+.201*t]).clipExtent([[a-.425*t+zh,u+.12*t+zh],[a-.214*t-zh,u+.234*t-zh]]).stream(c),i=l.translate([a-.205*t,u+.212*t]).clipExtent([[a-.214*t+zh,u+.166*t+zh],[a-.115*t-zh,u+.234*t-zh]]).stream(c),h()},u.fitExtent=function(e,t){return Zm(u,e,t)},u.fitSize=function(e,t){return Km(u,e,t)},u.fitWidth=function(e,t){return Qm(u,e,t)},u.fitHeight=function(e,t){return Jm(u,e,t)},u.scale(1070)}function hg(e){return function(t,n){var r=Qh(t),i=Qh(n),a=e(r*i);return a===1/0?[2,0]:[a*i*rd(t),a*rd(n)]}}function dg(e){return function(t,n){var r=ad(t*t+n*n),i=e(r),a=rd(i),o=Qh(i);return[Kh(t*a,r*o),ld(r&&n*a/r)]}}var fg=hg((function(e){return ad(2/(1+e))}));function pg(){return ig(fg).scale(124.75).clipAngle(179.999)}fg.invert=dg((function(e){return 2*ld(e/2)}));var mg=hg((function(e){return(e=sd(e))&&e/rd(e)}));function gg(){return ig(mg).scale(79.4188).clipAngle(179.999)}function vg(e,t){return[e,td(od((Gh+t)/2))]}function yg(){return xg(vg).scale(961/jh)}function xg(e){var t,n,r,i=ig(e),a=i.center,o=i.scale,s=i.translate,l=i.clipExtent,c=null;function u(){var a=Vh*o(),s=i(Vf(i.rotate()).invert([0,0]));return l(null==c?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:e===vg?[[Math.max(s[0]-a,c),t],[Math.min(s[0]+a,n),r]]:[[c,Math.max(s[1]-a,t)],[n,Math.min(s[1]+a,r)]])}return i.scale=function(e){return arguments.length?(o(e),u()):o()},i.translate=function(e){return arguments.length?(s(e),u()):s()},i.center=function(e){return arguments.length?(a(e),u()):a()},i.clipExtent=function(e){return arguments.length?(null==e?c=t=n=r=null:(c=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),u()):null==c?null:[[c,t],[n,r]]},u()}function bg(e){return od((Gh+e)/2)}function _g(e,t){var n=Qh(e),r=e===t?rd(e):td(n/Qh(t))/td(bg(t)/bg(e)),i=n*nd(bg(e),r)/r;if(!r)return vg;function a(e,t){i>0?t<-Gh+zh&&(t=-Gh+zh):t>Gh-zh&&(t=Gh-zh);var n=i/nd(bg(t),r);return[n*rd(r*e),i-n*Qh(r*e)]}return a.invert=function(e,t){var n=i-t,a=id(r)*ad(e*e+n*n),o=Kh(e,Yh(n))*id(n);return n*r<0&&(o-=Vh*id(e)*id(n)),[o/r,2*Zh(nd(i/a,1/r))-Gh]},a}function wg(){return og(_g).scale(109.5).parallels([30,30])}function Sg(e,t){return[e,t]}function Mg(){return ig(Sg).scale(152.63)}function Dg(e,t){var n=Qh(e),r=e===t?rd(e):(n-Qh(t))/(t-e),i=n/r+e;if(Yh(r)<zh)return Sg;function a(e,t){var n=i-t,a=r*e;return[n*rd(a),i-n*Qh(a)]}return a.invert=function(e,t){var n=i-t,a=Kh(e,Yh(n))*id(n);return n*r<0&&(a-=Vh*id(e)*id(n)),[a/r,i-id(r)*ad(e*e+n*n)]},a}function Eg(){return og(Dg).scale(131.154).center([0,13.9389])}mg.invert=dg((function(e){return e})),vg.invert=function(e,t){return[e,2*Zh($h(t))-Gh]},Sg.invert=Sg;var Cg=1.340264,Ag=-.081106,Tg=893e-6,Ng=.003796,Rg=ad(3)/2;function Pg(e,t){var n=ld(Rg*rd(t)),r=n*n,i=r*r*r;return[e*Qh(n)/(Rg*(Cg+3*Ag*r+i*(7*Tg+9*Ng*r))),n*(Cg+Ag*r+i*(Tg+Ng*r))]}function Fg(){return ig(Pg).scale(177.158)}function Og(e,t){var n=Qh(t),r=Qh(e)*n;return[n*rd(e)/r,rd(t)/r]}function Ig(){return ig(Og).scale(144.049).clipAngle(60)}function Bg(){var e,t,n,r,i,a,o,s=1,l=0,c=0,u=1,h=1,d=0,f=null,p=1,m=1,g=Wm({point:function(e,t){var n=x([e,t]);this.stream.point(n[0],n[1])}}),v=Op;function y(){return p=s*u,m=s*h,a=o=null,x}function x(n){var r=n[0]*p,i=n[1]*m;if(d){var a=i*e-r*t;r=r*e+i*t,i=a}return[r+l,i+c]}return x.invert=function(n){var r=n[0]-l,i=n[1]-c;if(d){var a=i*e+r*t;r=r*e-i*t,i=a}return[r/p,i/m]},x.stream=function(e){return a&&o===e?a:a=g(v(o=e))},x.postclip=function(e){return arguments.length?(v=e,f=n=r=i=null,y()):v},x.clipExtent=function(e){return arguments.length?(v=null==e?(f=n=r=i=null,Op):up(f=+e[0][0],n=+e[0][1],r=+e[1][0],i=+e[1][1]),y()):null==f?null:[[f,n],[r,i]]},x.scale=function(e){return arguments.length?(s=+e,y()):s},x.translate=function(e){return arguments.length?(l=+e[0],c=+e[1],y()):[l,c]},x.angle=function(n){return arguments.length?(t=rd(d=n%360*Xh),e=Qh(d),y()):d*Wh},x.reflectX=function(e){return arguments.length?(u=e?-1:1,y()):u<0},x.reflectY=function(e){return arguments.length?(h=e?-1:1,y()):h<0},x.fitExtent=function(e,t){return Zm(x,e,t)},x.fitSize=function(e,t){return Km(x,e,t)},x.fitWidth=function(e,t){return Qm(x,e,t)},x.fitHeight=function(e,t){return Jm(x,e,t)},x}function kg(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function Lg(){return ig(kg).scale(175.295)}function Ug(e,t){return[Qh(t)*rd(e),rd(t)]}function zg(){return ig(Ug).scale(249.5).clipAngle(90+zh)}function Hg(e,t){var n=Qh(t),r=1+Qh(e)*n;return[n*rd(e)/r,rd(t)/r]}function Vg(){return ig(Hg).scale(250).clipAngle(142)}function Gg(e,t){return[td(od((Gh+t)/2)),-e]}function qg(){var e=xg(Gg),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}function jg(e,t){return e.parent===t.parent?1:2}function Wg(e,t){return e+t.x}function Xg(e,t){return Math.max(e,t.y)}function Yg(){var e=jg,t=1,n=1,r=!1;function i(i){var a,o=0;i.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(Wg,0)/e.length}(n),t.y=function(e){return 1+e.reduce(Xg,0)}(n)):(t.x=a?o+=e(t,a):0,t.y=0,a=t)}));var s=function(e){for(var t;t=e.children;)e=t[0];return e}(i),l=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(i),c=s.x-e(s,l)/2,u=l.x+e(l,s)/2;return i.eachAfter(r?function(e){e.x=(e.x-i.x)*t,e.y=(i.y-e.y)*n}:function(e){e.x=(e.x-c)/(u-c)*t,e.y=(1-(i.y?e.y/i.y:1))*n})}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i}function Zg(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function Kg(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=Jg)):void 0===t&&(t=Qg);for(var n,r,i,a,o,s=new tv(e),l=[s];n=l.pop();)if((i=t(n.data))&&(o=(i=Array.from(i)).length))for(n.children=i,a=o-1;a>=0;--a)l.push(r=i[a]=new tv(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(ev)}function Qg(e){return e.children}function Jg(e){return Array.isArray(e)?e[1]:null}function $g(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function ev(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function tv(e){this.data=e,this.depth=this.height=0,this.parent=null}function nv(e){return null==e?null:rv(e)}function rv(e){if("function"!==typeof e)throw new Error;return e}function iv(){return 0}function av(e){return function(){return e}}Pg.invert=function(e,t){for(var n,r=t,i=r*r,a=i*i*i,o=0;o<12&&(a=(i=(r-=n=(r*(Cg+Ag*i+a*(Tg+Ng*i))-t)/(Cg+3*Ag*i+a*(7*Tg+9*Ng*i)))*r)*i*i,!(Yh(n)<Hh));++o);return[Rg*e*(Cg+3*Ag*i+a*(7*Tg+9*Ng*i))/Qh(r),ld(rd(r)/Rg)]},Og.invert=dg(Zh),kg.invert=function(e,t){var n,r=t,i=25;do{var a=r*r,o=a*a;r-=n=(r*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-t)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while(Yh(n)>zh&&--i>0);return[e/(.8707+(a=r*r)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),r]},Ug.invert=dg(ld),Hg.invert=dg((function(e){return 2*Zh(e)})),Gg.invert=function(e,t){return[-t,2*Zh($h(e))-Gh]},tv.prototype=Kg.prototype={constructor:tv,count:function(){return this.eachAfter(Zg)},each:function(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this},eachAfter:function(e,t){for(var n,r,i,a=this,o=[a],s=[],l=-1;a=o.pop();)if(s.push(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r]);for(;a=s.pop();)e.call(t,a,++l,this);return this},eachBefore:function(e,t){for(var n,r,i=this,a=[i],o=-1;i=a.pop();)if(e.call(t,i,++o,this),n=i.children)for(r=n.length-1;r>=0;--r)a.push(n[r]);return this},find:function(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;e=n.pop(),t=r.pop();for(;e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return Kg(this).eachBefore($g)},[Symbol.iterator]:function*(){var e,t,n,r,i=this,a=[i];do{for(e=a.reverse(),a=[];i=e.pop();)if(yield i,t=i.children)for(n=0,r=t.length;n<r;++n)a.push(t[n])}while(a.length)}};const ov=1664525,sv=1013904223,lv=4294967296;function cv(){let e=1;return()=>(e=(ov*e+sv)%lv)/lv}function uv(e){return hv(e,cv())}function hv(e,t){for(var n,r,i=0,a=(e=function(e,t){let n,r,i=e.length;for(;i;)r=t()*i--|0,n=e[i],e[i]=e[r],e[r]=n;return e}(Array.from(e),t)).length,o=[];i<a;)n=e[i],r&&pv(r,n)?++i:(r=gv(o=dv(o,n)),i=0);return r}function dv(e,t){var n,r;if(mv(t,e))return[t];for(n=0;n<e.length;++n)if(fv(t,e[n])&&mv(vv(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(fv(vv(e[n],e[r]),t)&&fv(vv(e[n],t),e[r])&&fv(vv(e[r],t),e[n])&&mv(yv(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function fv(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function pv(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function mv(e,t){for(var n=0;n<t.length;++n)if(!pv(e,t[n]))return!1;return!0}function gv(e){switch(e.length){case 1:return function(e){return{x:e.x,y:e.y,r:e.r}}(e[0]);case 2:return vv(e[0],e[1]);case 3:return yv(e[0],e[1],e[2])}}function vv(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,o=t.y,s=t.r,l=a-n,c=o-r,u=s-i,h=Math.sqrt(l*l+c*c);return{x:(n+a+l/h*u)/2,y:(r+o+c/h*u)/2,r:(h+i+s)/2}}function yv(e,t,n){var r=e.x,i=e.y,a=e.r,o=t.x,s=t.y,l=t.r,c=n.x,u=n.y,h=n.r,d=r-o,f=r-c,p=i-s,m=i-u,g=l-a,v=h-a,y=r*r+i*i-a*a,x=y-o*o-s*s+l*l,b=y-c*c-u*u+h*h,_=f*p-d*m,w=(p*b-m*x)/(2*_)-r,S=(m*g-p*v)/_,M=(f*x-d*b)/(2*_)-i,D=(d*v-f*g)/_,E=S*S+D*D-1,C=2*(a+w*S+M*D),A=w*w+M*M-a*a,T=-(Math.abs(E)>1e-6?(C+Math.sqrt(C*C-4*E*A))/(2*E):A/C);return{x:r+w+S*T,y:i+M+D*T,r:T}}function xv(e,t,n){var r,i,a,o,s=e.x-t.x,l=e.y-t.y,c=s*s+l*l;c?(i=t.r+n.r,i*=i,o=e.r+n.r,i>(o*=o)?(r=(c+o-i)/(2*c),a=Math.sqrt(Math.max(0,o/c-r*r)),n.x=e.x-r*s-a*l,n.y=e.y-r*l+a*s):(r=(c+i-o)/(2*c),a=Math.sqrt(Math.max(0,i/c-r*r)),n.x=t.x+r*s-a*l,n.y=t.y+r*l+a*s)):(n.x=t.x+n.r,n.y=t.y)}function bv(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function _v(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,a=(t.y*n.r+n.y*t.r)/r;return i*i+a*a}function wv(e){this._=e,this.next=null,this.previous=null}function Sv(e,t){if(!(a=(e=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}(e)).length))return 0;var n,r,i,a,o,s,l,c,u,h,d;if((n=e[0]).x=0,n.y=0,!(a>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(a>2))return n.r+r.r;xv(r,n,i=e[2]),n=new wv(n),r=new wv(r),i=new wv(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(l=3;l<a;++l){xv(n._,r._,i=e[l]),i=new wv(i),c=r.next,u=n.previous,h=r._.r,d=n._.r;do{if(h<=d){if(bv(c._,i._)){r=c,n.next=r,r.previous=n,--l;continue e}h+=c._.r,c=c.next}else{if(bv(u._,i._)){(n=u).next=r,r.previous=n,--l;continue e}d+=u._.r,u=u.previous}}while(c!==u.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,o=_v(n);(i=i.next)!==r;)(s=_v(i))<o&&(n=i,o=s);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=hv(n,t),l=0;l<a;++l)(n=e[l]).x-=i.x,n.y-=i.y;return i.r}function Mv(e){return Sv(e,cv()),e}function Dv(e){return Math.sqrt(e.value)}function Ev(){var e=null,t=1,n=1,r=iv;function i(i){const a=cv();return i.x=t/2,i.y=n/2,e?i.eachBefore(Cv(e)).eachAfter(Av(r,.5,a)).eachBefore(Tv(1)):i.eachBefore(Cv(Dv)).eachAfter(Av(iv,1,a)).eachAfter(Av(r,i.r/Math.min(t,n),a)).eachBefore(Tv(Math.min(t,n)/(2*i.r))),i}return i.radius=function(t){return arguments.length?(e=nv(t),i):e},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(e){return arguments.length?(r="function"===typeof e?e:av(+e),i):r},i}function Cv(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function Av(e,t,n){return function(r){if(i=r.children){var i,a,o,s=i.length,l=e(r)*t||0;if(l)for(a=0;a<s;++a)i[a].r+=l;if(o=Sv(i,n),l)for(a=0;a<s;++a)i[a].r-=l;r.r=o+l}}}function Tv(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function Nv(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Rv(e,t,n,r,i){for(var a,o=e.children,s=-1,l=o.length,c=e.value&&(r-t)/e.value;++s<l;)(a=o[s]).y0=n,a.y1=i,a.x0=t,a.x1=t+=a.value*c}function Pv(){var e=1,t=1,n=0,r=!1;function i(i){var a=i.height+1;return i.x0=i.y0=n,i.x1=e,i.y1=t/a,i.eachBefore(function(e,t){return function(r){r.children&&Rv(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var i=r.x0,a=r.y0,o=r.x1-n,s=r.y1-n;o<i&&(i=o=(i+o)/2),s<a&&(a=s=(a+s)/2),r.x0=i,r.y0=a,r.x1=o,r.y1=s}}(t,a)),r&&i.eachBefore(Nv),i}return i.round=function(e){return arguments.length?(r=!!e,i):r},i.size=function(n){return arguments.length?(e=+n[0],t=+n[1],i):[e,t]},i.padding=function(e){return arguments.length?(n=+e,i):n},i}var Fv={depth:-1},Ov={},Iv={};function Bv(e){return e.id}function kv(e){return e.parentId}function Lv(){var e,t=Bv,n=kv;function r(r){var i,a,o,s,l,c,u,h,d=Array.from(r),f=t,p=n,m=new Map;if(null!=e){const t=d.map(((t,n)=>function(e){e="".concat(e);let t=e.length;zv(e,t-1)&&!zv(e,t-2)&&(e=e.slice(0,-1));return"/"===e[0]?e:"/".concat(e)}(e(t,n,r)))),n=t.map(Uv),i=new Set(t).add("");for(const e of n)i.has(e)||(i.add(e),t.push(e),n.push(Uv(e)),d.push(Iv));f=(e,n)=>t[n],p=(e,t)=>n[t]}for(o=0,i=d.length;o<i;++o)a=d[o],c=d[o]=new tv(a),null!=(u=f(a,o,r))&&(u+="")&&(h=c.id=u,m.set(h,m.has(h)?Ov:c)),null!=(u=p(a,o,r))&&(u+="")&&(c.parent=u);for(o=0;o<i;++o)if(u=(c=d[o]).parent){if(!(l=m.get(u)))throw new Error("missing: "+u);if(l===Ov)throw new Error("ambiguous: "+u);l.children?l.children.push(c):l.children=[c],c.parent=l}else{if(s)throw new Error("multiple roots");s=c}if(!s)throw new Error("no root");if(null!=e){for(;s.data===Iv&&1===s.children.length;)s=s.children[0],--i;for(let e=d.length-1;e>=0&&(c=d[e]).data===Iv;--e)c.data=null}if(s.parent=Fv,s.eachBefore((function(e){e.depth=e.parent.depth+1,--i})).eachBefore(ev),s.parent=null,i>0)throw new Error("cycle");return s}return r.id=function(e){return arguments.length?(t=nv(e),r):t},r.parentId=function(e){return arguments.length?(n=nv(e),r):n},r.path=function(t){return arguments.length?(e=nv(t),r):e},r}function Uv(e){let t=e.length;if(t<2)return"";for(;--t>1&&!zv(e,t););return e.slice(0,t)}function zv(e,t){if("/"===e[t]){let n=0;for(;t>0&&"\\"===e[--t];)++n;if(0===(1&n))return!0}return!1}function Hv(e,t){return e.parent===t.parent?1:2}function Vv(e){var t=e.children;return t?t[0]:e.t}function Gv(e){var t=e.children;return t?t[t.length-1]:e.t}function qv(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function jv(e,t,n){return e.a.parent===t.parent?e.a:n}function Wv(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function Xv(){var e=Hv,t=1,n=1,r=null;function i(i){var l=function(e){for(var t,n,r,i,a,o=new Wv(e,0),s=[o];t=s.pop();)if(r=t._.children)for(t.children=new Array(a=r.length),i=a-1;i>=0;--i)s.push(n=t.children[i]=new Wv(r[i],i)),n.parent=t;return(o.parent=new Wv(null,0)).children=[o],o}(i);if(l.eachAfter(a),l.parent.m=-l.z,l.eachBefore(o),r)i.eachBefore(s);else{var c=i,u=i,h=i;i.eachBefore((function(e){e.x<c.x&&(c=e),e.x>u.x&&(u=e),e.depth>h.depth&&(h=e)}));var d=c===u?1:e(c,u)/2,f=d-c.x,p=t/(u.x+d+f),m=n/(h.depth||1);i.eachBefore((function(e){e.x=(e.x+f)*p,e.y=e.depth*m}))}return i}function a(t){var n=t.children,r=t.parent.children,i=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,i=e.children,a=i.length;--a>=0;)(t=i[a]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var a=(n[0].z+n[n.length-1].z)/2;i?(t.z=i.z+e(t._,i._),t.m=t.z-a):t.z=a}else i&&(t.z=i.z+e(t._,i._));t.parent.A=function(t,n,r){if(n){for(var i,a=t,o=t,s=n,l=a.parent.children[0],c=a.m,u=o.m,h=s.m,d=l.m;s=Gv(s),a=Vv(a),s&&a;)l=Vv(l),(o=Gv(o)).a=t,(i=s.z+h-a.z-c+e(s._,a._))>0&&(qv(jv(s,t,r),t,i),c+=i,u+=i),h+=s.m,c+=a.m,d+=l.m,u+=o.m;s&&!Gv(o)&&(o.t=s,o.m+=h-u),a&&!Vv(l)&&(l.t=a,l.m+=c-d,r=t)}return r}(t,i,t.parent.A||r[0])}function o(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function s(e){e.x*=t,e.y=e.depth*n}return i.separation=function(t){return arguments.length?(e=t,i):e},i.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],i):r?null:[t,n]},i.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],i):r?[t,n]:null},i}function Yv(e,t,n,r,i){for(var a,o=e.children,s=-1,l=o.length,c=e.value&&(i-n)/e.value;++s<l;)(a=o[s]).x0=t,a.x1=r,a.y0=n,a.y1=n+=a.value*c}Wv.prototype=Object.create(tv.prototype);var Zv=(1+Math.sqrt(5))/2;function Kv(e,t,n,r,i,a){for(var o,s,l,c,u,h,d,f,p,m,g,v=[],y=t.children,x=0,b=0,_=y.length,w=t.value;x<_;){l=i-n,c=a-r;do{u=y[b++].value}while(!u&&b<_);for(h=d=u,g=u*u*(m=Math.max(c/l,l/c)/(w*e)),p=Math.max(d/g,g/h);b<_;++b){if(u+=s=y[b].value,s<h&&(h=s),s>d&&(d=s),g=u*u*m,(f=Math.max(d/g,g/h))>p){u-=s;break}p=f}v.push(o={value:u,dice:l<c,children:y.slice(x,b)}),o.dice?Rv(o,n,r,i,w?r+=c*u/w:a):Yv(o,n,r,w?n+=l*u/w:i,a),w-=u,x=b}return v}const Qv=function e(t){function n(e,n,r,i,a){Kv(t,e,n,r,i,a)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(Zv);function Jv(){var e=Qv,t=!1,n=1,r=1,i=[0],a=iv,o=iv,s=iv,l=iv,c=iv;function u(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(h),i=[0],t&&e.eachBefore(Nv),e}function h(t){var n=i[t.depth],r=t.x0+n,u=t.y0+n,h=t.x1-n,d=t.y1-n;h<r&&(r=h=(r+h)/2),d<u&&(u=d=(u+d)/2),t.x0=r,t.y0=u,t.x1=h,t.y1=d,t.children&&(n=i[t.depth+1]=a(t)/2,r+=c(t)-n,u+=o(t)-n,(h-=s(t)-n)<r&&(r=h=(r+h)/2),(d-=l(t)-n)<u&&(u=d=(u+d)/2),e(t,r,u,h,d))}return u.round=function(e){return arguments.length?(t=!!e,u):t},u.size=function(e){return arguments.length?(n=+e[0],r=+e[1],u):[n,r]},u.tile=function(t){return arguments.length?(e=rv(t),u):e},u.padding=function(e){return arguments.length?u.paddingInner(e).paddingOuter(e):u.paddingInner()},u.paddingInner=function(e){return arguments.length?(a="function"===typeof e?e:av(+e),u):a},u.paddingOuter=function(e){return arguments.length?u.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):u.paddingTop()},u.paddingTop=function(e){return arguments.length?(o="function"===typeof e?e:av(+e),u):o},u.paddingRight=function(e){return arguments.length?(s="function"===typeof e?e:av(+e),u):s},u.paddingBottom=function(e){return arguments.length?(l="function"===typeof e?e:av(+e),u):l},u.paddingLeft=function(e){return arguments.length?(c="function"===typeof e?e:av(+e),u):c},u}function $v(e,t,n,r,i){var a,o,s=e.children,l=s.length,c=new Array(l+1);for(c[0]=o=a=0;a<l;++a)c[a+1]=o+=s[a].value;!function e(t,n,r,i,a,o,l){if(t>=n-1){var u=s[t];return u.x0=i,u.y0=a,u.x1=o,void(u.y1=l)}var h=c[t],d=r/2+h,f=t+1,p=n-1;for(;f<p;){var m=f+p>>>1;c[m]<d?f=m+1:p=m}d-c[f-1]<c[f]-d&&t+1<f&&--f;var g=c[f]-h,v=r-g;if(o-i>l-a){var y=r?(i*v+o*g)/r:o;e(t,f,g,i,a,y,l),e(f,n,v,y,a,o,l)}else{var x=r?(a*v+l*g)/r:l;e(t,f,g,i,a,o,x),e(f,n,v,i,x,o,l)}}(0,l,e.value,t,n,r,i)}function ey(e,t,n,r,i){(1&e.depth?Yv:Rv)(e,t,n,r,i)}const ty=function e(t){function n(e,n,r,i,a){if((o=e._squarify)&&o.ratio===t)for(var o,s,l,c,u,h=-1,d=o.length,f=e.value;++h<d;){for(l=(s=o[h]).children,c=s.value=0,u=l.length;c<u;++c)s.value+=l[c].value;s.dice?Rv(s,n,r,i,f?r+=(a-r)*s.value/f:a):Yv(s,n,r,f?n+=(i-n)*s.value/f:i,a),f-=s.value}else e._squarify=o=Kv(t,e,n,r,i,a),o.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(Zv);function ny(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function ry(e,t){var n=Oi(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}function iy(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function ay(e){return((e=Math.exp(e))+1/e)/2}const oy=function e(t,n,r){function i(e,i){var a,o,s=e[0],l=e[1],c=e[2],u=i[0],h=i[1],d=i[2],f=u-s,p=h-l,m=f*f+p*p;if(m<1e-12)o=Math.log(d/c)/t,a=function(e){return[s+e*f,l+e*p,c*Math.exp(t*e*o)]};else{var g=Math.sqrt(m),v=(d*d-c*c+r*m)/(2*c*n*g),y=(d*d-c*c-r*m)/(2*d*n*g),x=Math.log(Math.sqrt(v*v+1)-v),b=Math.log(Math.sqrt(y*y+1)-y);o=(b-x)/t,a=function(e){var r=e*o,i=ay(x),a=c/(n*g)*(i*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+x)-function(e){return((e=Math.exp(e))-1/e)/2}(x));return[s+a*f,l+a*p,c*i/ay(t*r+x)]}}return a.duration=1e3*o*t/Math.SQRT2,a}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4);function sy(e){return function(t,n){var r=e((t=Mi(t)).h,(n=Mi(n)).h),i=Bi(t.s,n.s),a=Bi(t.l,n.l),o=Bi(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=a(e),t.opacity=o(e),t+""}}}const ly=sy(Oi);var cy=sy(Bi);function uy(e,t){var n=Bi((e=Zs(e)).l,(t=Zs(t)).l),r=Bi(e.a,t.a),i=Bi(e.b,t.b),a=Bi(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=a(t),e+""}}function hy(e){return function(t,n){var r=e((t=rl(t)).h,(n=rl(n)).h),i=Bi(t.c,n.c),a=Bi(t.l,n.l),o=Bi(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=a(e),t.opacity=o(e),t+""}}}const dy=hy(Oi);var fy=hy(Bi);function py(e){return function t(n){function r(t,r){var i=e((t=pl(t)).h,(r=pl(r)).h),a=Bi(t.s,r.s),o=Bi(t.l,r.l),s=Bi(t.opacity,r.opacity);return function(e){return t.h=i(e),t.s=a(e),t.l=o(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}const my=py(Oi);var gy=py(Bi);function vy(e,t){void 0===t&&(t=e,e=Qi);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return a[t](e-t)}}function yy(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}function xy(e){for(var t,n=-1,r=e.length,i=e[r-1],a=0;++n<r;)t=i,i=e[n],a+=t[1]*i[0]-t[0]*i[1];return a/2}function by(e){for(var t,n,r=-1,i=e.length,a=0,o=0,s=e[i-1],l=0;++r<i;)t=s,s=e[r],l+=n=t[0]*s[1]-s[0]*t[1],a+=(t[0]+s[0])*n,o+=(t[1]+s[1])*n;return[a/(l*=3),o/l]}function _y(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])}function wy(e,t){return e[0]-t[0]||e[1]-t[1]}function Sy(e){const t=e.length,n=[0,1];let r,i=2;for(r=2;r<t;++r){for(;i>1&&_y(e[n[i-2]],e[n[i-1]],e[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function My(e){if((n=e.length)<3)return null;var t,n,r=new Array(n),i=new Array(n);for(t=0;t<n;++t)r[t]=[+e[t][0],+e[t][1],t];for(r.sort(wy),t=0;t<n;++t)i[t]=[r[t][0],-r[t][1]];var a=Sy(r),o=Sy(i),s=o[0]===a[0],l=o[o.length-1]===a[a.length-1],c=[];for(t=a.length-1;t>=0;--t)c.push(e[r[a[t]][2]]);for(t=+s;t<o.length-l;++t)c.push(e[r[o[t]][2]]);return c}function Dy(e,t){for(var n,r,i=e.length,a=e[i-1],o=t[0],s=t[1],l=a[0],c=a[1],u=!1,h=0;h<i;++h)n=(a=e[h])[0],(r=a[1])>s!==c>s&&o<(l-n)*(s-r)/(c-r)+n&&(u=!u),l=n,c=r;return u}function Ey(e){for(var t,n,r=-1,i=e.length,a=e[i-1],o=a[0],s=a[1],l=0;++r<i;)t=o,n=s,t-=o=(a=e[r])[0],n-=s=a[1],l+=Math.hypot(t,n);return l}const Cy=Math.random,Ay=function e(t){function n(e,n){return e=null==e?0:+e,n=null==n?1:+n,1===arguments.length?(n=e,e=0):n-=e,function(){return t()*n+e}}return n.source=e,n}(Cy),Ty=function e(t){function n(e,n){return arguments.length<2&&(n=e,e=0),e=Math.floor(e),n=Math.floor(n)-e,function(){return Math.floor(t()*n+e)}}return n.source=e,n}(Cy),Ny=function e(t){function n(e,n){var r,i;return e=null==e?0:+e,n=null==n?1:+n,function(){var a;if(null!=r)a=r,r=null;else do{r=2*t()-1,a=2*t()-1,i=r*r+a*a}while(!i||i>1);return e+n*a*Math.sqrt(-2*Math.log(i)/i)}}return n.source=e,n}(Cy),Ry=function e(t){var n=Ny.source(t);function r(){var e=n.apply(this,arguments);return function(){return Math.exp(e())}}return r.source=e,r}(Cy),Py=function e(t){function n(e){return(e=+e)<=0?()=>0:function(){for(var n=0,r=e;r>1;--r)n+=t();return n+r*t()}}return n.source=e,n}(Cy),Fy=function e(t){var n=Py.source(t);function r(e){if(0===(e=+e))return t;var r=n(e);return function(){return r()/e}}return r.source=e,r}(Cy),Oy=function e(t){function n(e){return function(){return-Math.log1p(-t())/e}}return n.source=e,n}(Cy),Iy=function e(t){function n(e){if((e=+e)<0)throw new RangeError("invalid alpha");return e=1/-e,function(){return Math.pow(1-t(),e)}}return n.source=e,n}(Cy),By=function e(t){function n(e){if((e=+e)<0||e>1)throw new RangeError("invalid p");return function(){return Math.floor(t()+e)}}return n.source=e,n}(Cy),ky=function e(t){function n(e){if((e=+e)<0||e>1)throw new RangeError("invalid p");return 0===e?()=>1/0:1===e?()=>1:(e=Math.log1p(-e),function(){return 1+Math.floor(Math.log1p(-t())/e)})}return n.source=e,n}(Cy),Ly=function e(t){var n=Ny.source(t)();function r(e,r){if((e=+e)<0)throw new RangeError("invalid k");if(0===e)return()=>0;if(r=null==r?1:+r,1===e)return()=>-Math.log1p(-t())*r;var i=(e<1?e+1:e)-1/3,a=1/(3*Math.sqrt(i)),o=e<1?()=>Math.pow(t(),1/e):()=>1;return function(){do{do{var e=n(),s=1+a*e}while(s<=0);s*=s*s;var l=1-t()}while(l>=1-.0331*e*e*e*e&&Math.log(l)>=.5*e*e+i*(1-s+Math.log(s)));return i*s*o()*r}}return r.source=e,r}(Cy),Uy=function e(t){var n=Ly.source(t);function r(e,t){var r=n(e),i=n(t);return function(){var e=r();return 0===e?0:e/(e+i())}}return r.source=e,r}(Cy),zy=function e(t){var n=ky.source(t),r=Uy.source(t);function i(e,t){return e=+e,(t=+t)>=1?()=>e:t<=0?()=>0:function(){for(var i=0,a=e,o=t;a*o>16&&a*(1-o)>16;){var s=Math.floor((a+1)*o),l=r(s,a-s+1)();l<=o?(i+=s,a-=s,o=(o-l)/(1-l)):(a=s-1,o/=l)}for(var c=o<.5,u=n(c?o:1-o),h=u(),d=0;h<=a;++d)h+=u();return i+(c?d:a-d)}}return i.source=e,i}(Cy),Hy=function e(t){function n(e,n,r){var i;return 0===(e=+e)?i=e=>-Math.log(e):(e=1/e,i=t=>Math.pow(t,e)),n=null==n?0:+n,r=null==r?1:+r,function(){return n+r*i(-Math.log1p(-t()))}}return n.source=e,n}(Cy),Vy=function e(t){function n(e,n){return e=null==e?0:+e,n=null==n?1:+n,function(){return e+n*Math.tan(Math.PI*t())}}return n.source=e,n}(Cy),Gy=function e(t){function n(e,n){return e=null==e?0:+e,n=null==n?1:+n,function(){var r=t();return e+n*Math.log(r/(1-r))}}return n.source=e,n}(Cy),qy=function e(t){var n=Ly.source(t),r=zy.source(t);function i(e){return function(){for(var i=0,a=e;a>16;){var o=Math.floor(.875*a),s=n(o)();if(s>a)return i+r(o-1,a/s)();i+=o,a-=s}for(var l=-Math.log1p(-t()),c=0;l<=a;++c)l-=Math.log1p(-t());return i+c}}return i.source=e,i}(Cy),jy=1664525,Wy=1013904223,Xy=1/4294967296;function Yy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random(),t=0|(0<=e&&e<1?e/Xy:Math.abs(e));return()=>(t=jy*t+Wy|0,Xy*(t>>>0))}function Zy(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function Ky(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}const Qy=Symbol("implicit");function Jy(){var e=new Re,t=[],n=[],r=Qy;function i(i){let a=e.get(i);if(void 0===a){if(r!==Qy)return r;e.set(i,a=t.push(i)-1)}return n[a%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Re;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return Jy(t,n).unknown(r)},Zy.apply(i,arguments),i}function $y(){var e,t,n=Jy().unknown(void 0),r=n.domain,i=n.range,a=0,o=1,s=!1,l=0,c=0,u=.5;function h(){var n=r().length,h=o<a,d=h?o:a,f=h?a:o;e=(f-d)/Math.max(1,n-l+2*c),s&&(e=Math.floor(e)),d+=(f-d-e*(n-l))*u,t=e*(1-l),s&&(d=Math.round(d),t=Math.round(t));var p=Pt(n).map((function(t){return d+e*t}));return i(h?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),h()):r()},n.range=function(e){return arguments.length?([a,o]=e,a=+a,o=+o,h()):[a,o]},n.rangeRound=function(e){return[a,o]=e,a=+a,o=+o,s=!0,h()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,h()):s},n.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),h()):l},n.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),h()):l},n.paddingOuter=function(e){return arguments.length?(c=+e,h()):c},n.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),h()):u},n.copy=function(){return $y(r(),[a,o]).round(s).paddingInner(l).paddingOuter(c).align(u)},Zy.apply(h(),arguments)}function ex(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return ex(t())},e}function tx(){return ex($y.apply(null,arguments).paddingInner(1))}function nx(e){return+e}var rx=[0,1];function ix(e){return e}function ax(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function ox(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=ax(i,r),a=n(o,a)):(r=ax(r,i),a=n(a,o)),function(e){return a(r(e))}}function sx(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=ax(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(t){var n=he(e,t,1,r)-1;return a[n](i[n](t))}}function lx(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function cx(){var e,t,n,r,i,a,o=rx,s=rx,l=Qi,c=ix;function u(){var e=Math.min(o.length,s.length);return c!==ix&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?sx:ox,i=a=null,h}function h(t){return null==t||isNaN(t=+t)?n:(i||(i=r(o.map(e),s,l)))(e(c(t)))}return h.invert=function(n){return c(t((a||(a=r(s,o.map(e),Wi)))(n)))},h.domain=function(e){return arguments.length?(o=Array.from(e,nx),u()):o.slice()},h.range=function(e){return arguments.length?(s=Array.from(e),u()):s.slice()},h.rangeRound=function(e){return s=Array.from(e),l=iy,u()},h.clamp=function(e){return arguments.length?(c=!!e||ix,u()):c!==ix},h.interpolate=function(e){return arguments.length?(l=e,u()):l},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,u()}}function ux(){return cx()(ix,ix)}function hx(e,t,n,r){var i,a=ct(e,t,n);switch((r=Dh(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=Lh(a,o))||(r.precision=i),Ph(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Uh(a,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=kh(a))||(r.precision=i-2*("%"===r.type))}return Rh(r)}function dx(e){var t=e.domain;return e.ticks=function(e){var n=t();return st(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return hx(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,a=t(),o=0,s=a.length-1,l=a[o],c=a[s],u=10;for(c<l&&(i=l,l=c,c=i,i=o,o=s,s=i);u-- >0;){if((i=lt(l,c,n))===r)return a[o]=l,a[s]=c,t(a);if(i>0)l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i}r=i}return e},e}function fx(){var e=ux();return e.copy=function(){return lx(e,fx())},Zy.apply(e,arguments),dx(e)}function px(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,nx),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return px(e).unknown(t)},e=arguments.length?Array.from(e,nx):[0,1],dx(n)}function mx(e,t){var n,r=0,i=(e=e.slice()).length-1,a=e[r],o=e[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),e[r]=t.floor(a),e[i]=t.ceil(o),e}function gx(e){return Math.log(e)}function vx(e){return Math.exp(e)}function yx(e){return-Math.log(-e)}function xx(e){return-Math.exp(-e)}function bx(e){return isFinite(e)?+("1e"+e):e<0?0:e}function _x(e){return(t,n)=>-e(-t,n)}function wx(e){const t=e(gx,vx),n=t.domain;let r,i,a=10;function o(){return r=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(a),i=function(e){return 10===e?bx:e===Math.E?Math.exp:t=>Math.pow(e,t)}(a),n()[0]<0?(r=_x(r),i=_x(i),e(yx,xx)):e(gx,vx),t}return t.base=function(e){return arguments.length?(a=+e,o()):a},t.domain=function(e){return arguments.length?(n(e),o()):n()},t.ticks=e=>{const t=n();let o=t[0],s=t[t.length-1];const l=s<o;l&&([o,s]=[s,o]);let c,u,h=r(o),d=r(s);const f=null==e?10:+e;let p=[];if(!(a%1)&&d-h<f){if(h=Math.floor(h),d=Math.ceil(d),o>0){for(;h<=d;++h)for(c=1;c<a;++c)if(u=h<0?c/i(-h):c*i(h),!(u<o)){if(u>s)break;p.push(u)}}else for(;h<=d;++h)for(c=a-1;c>=1;--c)if(u=h>0?c/i(-h):c*i(h),!(u<o)){if(u>s)break;p.push(u)}2*p.length<f&&(p=st(o,s,f))}else p=st(h,d,Math.min(d-h,f)).map(i);return l?p.reverse():p},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===a?"s":","),"function"!==typeof n&&(a%1||null!=(n=Dh(n)).precision||(n.trim=!0),n=Rh(n)),e===1/0)return n;const o=Math.max(1,a*e/t.ticks().length);return e=>{let t=e/i(Math.round(r(e)));return t*a<a-.5&&(t*=a),t<=o?n(e):""}},t.nice=()=>n(mx(n(),{floor:e=>i(Math.floor(r(e))),ceil:e=>i(Math.ceil(r(e)))})),t}function Sx(){const e=wx(cx()).domain([1,10]);return e.copy=()=>lx(e,Sx()).base(e.base()),Zy.apply(e,arguments),e}function Mx(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Dx(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Ex(e){var t=1,n=e(Mx(t),Dx(t));return n.constant=function(n){return arguments.length?e(Mx(t=+n),Dx(t)):t},dx(n)}function Cx(){var e=Ex(cx());return e.copy=function(){return lx(e,Cx()).constant(e.constant())},Zy.apply(e,arguments)}function Ax(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Tx(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Nx(e){return e<0?-e*e:e*e}function Rx(e){var t=e(ix,ix),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(ix,ix):.5===n?e(Tx,Nx):e(Ax(n),Ax(1/n)):n},dx(t)}function Px(){var e=Rx(cx());return e.copy=function(){return lx(e,Px()).exponent(e.exponent())},Zy.apply(e,arguments),e}function Fx(){return Px.apply(null,arguments).exponent(.5)}function Ox(e){return Math.sign(e)*e*e}function Ix(){var e,t=ux(),n=[0,1],r=!1;function i(n){var i=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(t(n));return isNaN(i)?e:r?Math.round(i):i}return i.invert=function(e){return t.invert(Ox(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain()},i.range=function(e){return arguments.length?(t.range((n=Array.from(e,nx)).map(Ox)),i):n.slice()},i.rangeRound=function(e){return i.range(e).round(!0)},i.round=function(e){return arguments.length?(r=!!e,i):r},i.clamp=function(e){return arguments.length?(t.clamp(e),i):t.clamp()},i.unknown=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return Ix(t.domain(),n).round(r).clamp(t.clamp()).unknown(e)},Zy.apply(i,arguments),dx(i)}function Bx(){var e,t=[],n=[],r=[];function i(){var e=0,i=Math.max(1,n.length);for(r=new Array(i-1);++e<i;)r[e-1]=_t(t,e/i);return a}function a(t){return null==t||isNaN(t=+t)?e:n[he(r,t)]}return a.invertExtent=function(e){var i=n.indexOf(e);return i<0?[NaN,NaN]:[i>0?r[i-1]:t[0],i<r.length?r[i]:t[t.length-1]]},a.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(ne),i()},a.range=function(e){return arguments.length?(n=Array.from(e),i()):n.slice()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.quantiles=function(){return r.slice()},a.copy=function(){return Bx().domain(t).range(n).unknown(e)},Zy.apply(a,arguments)}function kx(){var e,t=0,n=1,r=1,i=[.5],a=[0,1];function o(t){return null!=t&&t<=t?a[he(i,t,0,r)]:e}function s(){var e=-1;for(i=new Array(r);++e<r;)i[e]=((e+1)*n-(e-r)*t)/(r+1);return o}return o.domain=function(e){return arguments.length?([t,n]=e,t=+t,n=+n,s()):[t,n]},o.range=function(e){return arguments.length?(r=(a=Array.from(e)).length-1,s()):a.slice()},o.invertExtent=function(e){var o=a.indexOf(e);return o<0?[NaN,NaN]:o<1?[t,i[0]]:o>=r?[i[r-1],n]:[i[o-1],i[o]]},o.unknown=function(t){return arguments.length?(e=t,o):o},o.thresholds=function(){return i.slice()},o.copy=function(){return kx().domain([t,n]).range(a).unknown(e)},Zy.apply(dx(o),arguments)}function Lx(){var e,t=[.5],n=[0,1],r=1;function i(i){return null!=i&&i<=i?n[he(t,i,0,r)]:e}return i.domain=function(e){return arguments.length?(t=Array.from(e),r=Math.min(t.length,n.length-1),i):t.slice()},i.range=function(e){return arguments.length?(n=Array.from(e),r=Math.min(t.length,n.length-1),i):n.slice()},i.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},i.unknown=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return Lx().domain(t).range(n).unknown(e)},Zy.apply(i,arguments)}const Ux=1e3,zx=6e4,Hx=36e5,Vx=864e5,Gx=6048e5,qx=2592e6,jx=31536e6,Wx=new Date,Xx=new Date;function Yx(e,t,n,r){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,r,a)=>{const o=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r)||!(a>0))return o;let s;do{o.push(s=new Date(+n)),t(n,a),e(n)}while(s<n&&n<r);return o},i.filter=n=>Yx((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})),n&&(i.count=(t,r)=>(Wx.setTime(+t),Xx.setTime(+r),e(Wx),e(Xx),Math.floor(n(Wx,Xx))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(r?t=>r(t)%e===0:t=>i.count(0,t)%e===0):i:null)),i}const Zx=Yx((()=>{}),((e,t)=>{e.setTime(+e+t)}),((e,t)=>t-e));Zx.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?Yx((t=>{t.setTime(Math.floor(t/e)*e)}),((t,n)=>{t.setTime(+t+n*e)}),((t,n)=>(n-t)/e)):Zx:null);const Kx=Zx.range,Qx=Yx((e=>{e.setTime(e-e.getMilliseconds())}),((e,t)=>{e.setTime(+e+t*Ux)}),((e,t)=>(t-e)/Ux),(e=>e.getUTCSeconds())),Jx=Qx.range,$x=Yx((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ux)}),((e,t)=>{e.setTime(+e+t*zx)}),((e,t)=>(t-e)/zx),(e=>e.getMinutes())),eb=$x.range,tb=Yx((e=>{e.setUTCSeconds(0,0)}),((e,t)=>{e.setTime(+e+t*zx)}),((e,t)=>(t-e)/zx),(e=>e.getUTCMinutes())),nb=tb.range,rb=Yx((e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ux-e.getMinutes()*zx)}),((e,t)=>{e.setTime(+e+t*Hx)}),((e,t)=>(t-e)/Hx),(e=>e.getHours())),ib=rb.range,ab=Yx((e=>{e.setUTCMinutes(0,0,0)}),((e,t)=>{e.setTime(+e+t*Hx)}),((e,t)=>(t-e)/Hx),(e=>e.getUTCHours())),ob=ab.range,sb=Yx((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*zx)/Vx),(e=>e.getDate()-1)),lb=sb.range,cb=Yx((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/Vx),(e=>e.getUTCDate()-1)),ub=cb.range,hb=Yx((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/Vx),(e=>Math.floor(e/Vx))),db=hb.range;function fb(e){return Yx((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*zx)/Gx))}const pb=fb(0),mb=fb(1),gb=fb(2),vb=fb(3),yb=fb(4),xb=fb(5),bb=fb(6),_b=pb.range,wb=mb.range,Sb=gb.range,Mb=vb.range,Db=yb.range,Eb=xb.range,Cb=bb.range;function Ab(e){return Yx((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/Gx))}const Tb=Ab(0),Nb=Ab(1),Rb=Ab(2),Pb=Ab(3),Fb=Ab(4),Ob=Ab(5),Ib=Ab(6),Bb=Tb.range,kb=Nb.range,Lb=Rb.range,Ub=Pb.range,zb=Fb.range,Hb=Ob.range,Vb=Ib.range,Gb=Yx((e=>{e.setDate(1),e.setHours(0,0,0,0)}),((e,t)=>{e.setMonth(e.getMonth()+t)}),((e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())),(e=>e.getMonth())),qb=Gb.range,jb=Yx((e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)}),((e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())),(e=>e.getUTCMonth())),Wb=jb.range,Xb=Yx((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear()));Xb.every=e=>isFinite(e=Math.floor(e))&&e>0?Yx((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null;const Yb=Xb.range,Zb=Yx((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));Zb.every=e=>isFinite(e=Math.floor(e))&&e>0?Yx((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null;const Kb=Zb.range;function Qb(e,t,n,r,i,a){const o=[[Qx,1,Ux],[Qx,5,5e3],[Qx,15,15e3],[Qx,30,3e4],[a,1,zx],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,Hx],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,Vx],[r,2,1728e5],[n,1,Gx],[t,1,qx],[t,3,7776e6],[e,1,jx]];function s(t,n,r){const i=Math.abs(n-t)/r,a=ie((e=>{let[,,t]=e;return t})).right(o,i);if(a===o.length)return e.every(ct(t/jx,n/jx,r));if(0===a)return Zx.every(Math.max(ct(t,n,r),1));const[s,l]=o[i/o[a-1][2]<o[a][2]/i?a-1:a];return s.every(l)}return[function(e,t,n){const r=t<e;r&&([e,t]=[t,e]);const i=n&&"function"===typeof n.range?n:s(e,t,n),a=i?i.range(e,+t+1):[];return r?a.reverse():a},s]}const[Jb,$b]=Qb(Zb,jb,Tb,hb,ab,tb),[e_,t_]=Qb(Xb,Gb,pb,sb,rb,$x);function n_(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function r_(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function i_(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function a_(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,c=v_(i),u=y_(i),h=v_(a),d=y_(a),f=v_(o),p=y_(o),m=v_(s),g=y_(s),v=v_(l),y=y_(l),x={a:function(e){return o[e.getDay()]},A:function(e){return a[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:U_,e:U_,f:q_,g:tw,G:rw,H:z_,I:H_,j:V_,L:G_,m:j_,M:W_,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Ew,s:Cw,S:X_,u:Y_,U:Z_,V:Q_,w:J_,W:$_,x:null,X:null,y:ew,Y:nw,Z:iw,"%":Dw},b={a:function(e){return o[e.getUTCDay()]},A:function(e){return a[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:aw,e:aw,f:uw,g:_w,G:Sw,H:ow,I:sw,j:lw,L:cw,m:hw,M:dw,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Ew,s:Cw,S:fw,u:pw,U:mw,V:vw,w:yw,W:xw,x:null,X:null,y:bw,Y:ww,Z:Mw,"%":Dw},_={a:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return M(e,t,n,r)},d:T_,e:T_,f:I_,g:D_,G:M_,H:R_,I:R_,j:N_,L:O_,m:A_,M:P_,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=u.get(r[0].toLowerCase()),n+r[0].length):-1},q:C_,Q:k_,s:L_,S:F_,u:b_,U:__,V:w_,w:x_,W:S_,x:function(e,t,r){return M(e,n,t,r)},X:function(e,t,n){return M(e,r,t,n)},y:D_,Y:M_,Z:E_,"%":B_};function w(e,t){return function(n){var r,i,a,o=[],s=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===e.charCodeAt(s)&&(o.push(e.slice(l,s)),null!=(i=h_[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(a=t[r])&&(r=a(n,i)),o.push(r),l=s+1);return o.push(e.slice(l,s)),o.join("")}}function S(e,t){return function(n){var r,i,a=i_(1900,void 0,1);if(M(a,e,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(t&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=r_(i_(a.y,0,1))).getUTCDay(),r=i>4||0===i?Nb.ceil(r):Nb(r),r=cb.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=n_(i_(a.y,0,1))).getDay(),r=i>4||0===i?mb.ceil(r):mb(r),r=sb.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?r_(i_(a.y,0,1)).getUTCDay():n_(i_(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,r_(a)):n_(a)}}function M(e,t,n,r){for(var i,a,o=0,s=t.length,l=n.length;o<s;){if(r>=l)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(a=_[i in h_?t.charAt(o++):i])||(r=a(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),b.x=w(n,b),b.X=w(r,b),b.c=w(t,b),{format:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},parse:function(e){var t=S(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+="",!0);return t.toString=function(){return e},t}}}var o_,s_,l_,c_,u_,h_={"-":"",_:" ",0:"0"},d_=/^\s*\d+/,f_=/^%/,p_=/[\\^$*+?|[\]().{}]/g;function m_(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function g_(e){return e.replace(p_,"\\$&")}function v_(e){return new RegExp("^(?:"+e.map(g_).join("|")+")","i")}function y_(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function x_(e,t,n){var r=d_.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function b_(e,t,n){var r=d_.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function __(e,t,n){var r=d_.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function w_(e,t,n){var r=d_.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function S_(e,t,n){var r=d_.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function M_(e,t,n){var r=d_.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function D_(e,t,n){var r=d_.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function E_(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function C_(e,t,n){var r=d_.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function A_(e,t,n){var r=d_.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function T_(e,t,n){var r=d_.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function N_(e,t,n){var r=d_.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function R_(e,t,n){var r=d_.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function P_(e,t,n){var r=d_.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function F_(e,t,n){var r=d_.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function O_(e,t,n){var r=d_.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function I_(e,t,n){var r=d_.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function B_(e,t,n){var r=f_.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function k_(e,t,n){var r=d_.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function L_(e,t,n){var r=d_.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function U_(e,t){return m_(e.getDate(),t,2)}function z_(e,t){return m_(e.getHours(),t,2)}function H_(e,t){return m_(e.getHours()%12||12,t,2)}function V_(e,t){return m_(1+sb.count(Xb(e),e),t,3)}function G_(e,t){return m_(e.getMilliseconds(),t,3)}function q_(e,t){return G_(e,t)+"000"}function j_(e,t){return m_(e.getMonth()+1,t,2)}function W_(e,t){return m_(e.getMinutes(),t,2)}function X_(e,t){return m_(e.getSeconds(),t,2)}function Y_(e){var t=e.getDay();return 0===t?7:t}function Z_(e,t){return m_(pb.count(Xb(e)-1,e),t,2)}function K_(e){var t=e.getDay();return t>=4||0===t?yb(e):yb.ceil(e)}function Q_(e,t){return e=K_(e),m_(yb.count(Xb(e),e)+(4===Xb(e).getDay()),t,2)}function J_(e){return e.getDay()}function $_(e,t){return m_(mb.count(Xb(e)-1,e),t,2)}function ew(e,t){return m_(e.getFullYear()%100,t,2)}function tw(e,t){return m_((e=K_(e)).getFullYear()%100,t,2)}function nw(e,t){return m_(e.getFullYear()%1e4,t,4)}function rw(e,t){var n=e.getDay();return m_((e=n>=4||0===n?yb(e):yb.ceil(e)).getFullYear()%1e4,t,4)}function iw(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+m_(t/60|0,"0",2)+m_(t%60,"0",2)}function aw(e,t){return m_(e.getUTCDate(),t,2)}function ow(e,t){return m_(e.getUTCHours(),t,2)}function sw(e,t){return m_(e.getUTCHours()%12||12,t,2)}function lw(e,t){return m_(1+cb.count(Zb(e),e),t,3)}function cw(e,t){return m_(e.getUTCMilliseconds(),t,3)}function uw(e,t){return cw(e,t)+"000"}function hw(e,t){return m_(e.getUTCMonth()+1,t,2)}function dw(e,t){return m_(e.getUTCMinutes(),t,2)}function fw(e,t){return m_(e.getUTCSeconds(),t,2)}function pw(e){var t=e.getUTCDay();return 0===t?7:t}function mw(e,t){return m_(Tb.count(Zb(e)-1,e),t,2)}function gw(e){var t=e.getUTCDay();return t>=4||0===t?Fb(e):Fb.ceil(e)}function vw(e,t){return e=gw(e),m_(Fb.count(Zb(e),e)+(4===Zb(e).getUTCDay()),t,2)}function yw(e){return e.getUTCDay()}function xw(e,t){return m_(Nb.count(Zb(e)-1,e),t,2)}function bw(e,t){return m_(e.getUTCFullYear()%100,t,2)}function _w(e,t){return m_((e=gw(e)).getUTCFullYear()%100,t,2)}function ww(e,t){return m_(e.getUTCFullYear()%1e4,t,4)}function Sw(e,t){var n=e.getUTCDay();return m_((e=n>=4||0===n?Fb(e):Fb.ceil(e)).getUTCFullYear()%1e4,t,4)}function Mw(){return"+0000"}function Dw(){return"%"}function Ew(e){return+e}function Cw(e){return Math.floor(+e/1e3)}function Aw(e){return o_=a_(e),s_=o_.format,l_=o_.parse,c_=o_.utcFormat,u_=o_.utcParse,o_}function Tw(e){return new Date(e)}function Nw(e){return e instanceof Date?+e:+new Date(+e)}function Rw(e,t,n,r,i,a,o,s,l,c){var u=ux(),h=u.invert,d=u.domain,f=c(".%L"),p=c(":%S"),m=c("%I:%M"),g=c("%I %p"),v=c("%a %d"),y=c("%b %d"),x=c("%B"),b=c("%Y");function _(e){return(l(e)<e?f:s(e)<e?p:o(e)<e?m:a(e)<e?g:r(e)<e?i(e)<e?v:y:n(e)<e?x:b)(e)}return u.invert=function(e){return new Date(h(e))},u.domain=function(e){return arguments.length?d(Array.from(e,Nw)):d().map(Tw)},u.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?_:c(t)},u.nice=function(e){var n=d();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(mx(n,e)):u},u.copy=function(){return lx(u,Rw(e,t,n,r,i,a,o,s,l,c))},u}function Pw(){return Zy.apply(Rw(e_,t_,Xb,Gb,pb,sb,rb,$x,Qx,s_).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Fw(){return Zy.apply(Rw(Jb,$b,Zb,jb,Tb,cb,ab,tb,Qx,c_).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Ow(){var e,t,n,r,i,a=0,o=1,s=ix,l=!1;function c(t){return null==t||isNaN(t=+t)?i:s(0===n?.5:(t=(r(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function u(e){return function(t){var n,r;return arguments.length?([n,r]=t,s=e(n,r),c):[s(0),s(1)]}}return c.domain=function(i){return arguments.length?([a,o]=i,e=r(a=+a),t=r(o=+o),n=e===t?0:1/(t-e),c):[a,o]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(s=e,c):s},c.range=u(Qi),c.rangeRound=u(iy),c.unknown=function(e){return arguments.length?(i=e,c):i},function(i){return r=i,e=i(a),t=i(o),n=e===t?0:1/(t-e),c}}function Iw(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Bw(){var e=dx(Ow()(ix));return e.copy=function(){return Iw(e,Bw())},Ky.apply(e,arguments)}function kw(){var e=wx(Ow()).domain([1,10]);return e.copy=function(){return Iw(e,kw()).base(e.base())},Ky.apply(e,arguments)}function Lw(){var e=Ex(Ow());return e.copy=function(){return Iw(e,Lw()).constant(e.constant())},Ky.apply(e,arguments)}function Uw(){var e=Rx(Ow());return e.copy=function(){return Iw(e,Uw()).exponent(e.exponent())},Ky.apply(e,arguments)}function zw(){return Uw.apply(null,arguments).exponent(.5)}function Hw(){var e=[],t=ix;function n(n){if(null!=n&&!isNaN(n=+n))return t((he(e,n,1)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(ne),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.range=function(){return e.map(((n,r)=>t(r/(e.length-1))))},n.quantiles=function(t){return Array.from({length:t+1},((n,r)=>bt(e,r/t)))},n.copy=function(){return Hw(t).domain(e)},Ky.apply(n,arguments)}function Vw(){var e,t,n,r,i,a,o,s=0,l=.5,c=1,u=1,h=ix,d=!1;function f(e){return isNaN(e=+e)?o:(e=.5+((e=+a(e))-t)*(u*e<u*t?r:i),h(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,h=vy(e,[n,r,i]),f):[h(0),h(.5),h(1)]}}return f.domain=function(o){return arguments.length?([s,l,c]=o,e=a(s=+s),t=a(l=+l),n=a(c=+c),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),u=t<e?-1:1,f):[s,l,c]},f.clamp=function(e){return arguments.length?(d=!!e,f):d},f.interpolator=function(e){return arguments.length?(h=e,f):h},f.range=p(Qi),f.rangeRound=p(iy),f.unknown=function(e){return arguments.length?(o=e,f):o},function(o){return a=o,e=o(s),t=o(l),n=o(c),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),u=t<e?-1:1,f}}function Gw(){var e=dx(Vw()(ix));return e.copy=function(){return Iw(e,Gw())},Ky.apply(e,arguments)}function qw(){var e=wx(Vw()).domain([.1,1,10]);return e.copy=function(){return Iw(e,qw()).base(e.base())},Ky.apply(e,arguments)}function jw(){var e=Ex(Vw());return e.copy=function(){return Iw(e,jw()).constant(e.constant())},Ky.apply(e,arguments)}function Ww(){var e=Rx(Vw());return e.copy=function(){return Iw(e,Ww()).exponent(e.exponent())},Ky.apply(e,arguments)}function Xw(){return Ww.apply(null,arguments).exponent(.5)}function Yw(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}Aw({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});const Zw=Yw("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Kw=Yw("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Qw=Yw("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Jw=Yw("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),$w=Yw("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),eS=Yw("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),tS=Yw("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),nS=Yw("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),rS=Yw("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),iS=Yw("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),aS=Yw("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),oS=e=>Ui(e[e.length-1]);var sS=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Yw);const lS=oS(sS);var cS=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Yw);const uS=oS(cS);var hS=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Yw);const dS=oS(hS);var fS=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Yw);const pS=oS(fS);var mS=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Yw);const gS=oS(mS);var vS=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Yw);const yS=oS(vS);var xS=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Yw);const bS=oS(xS);var _S=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Yw);const wS=oS(_S);var SS=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Yw);const MS=oS(SS);var DS=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Yw);const ES=oS(DS);var CS=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Yw);const AS=oS(CS);var TS=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Yw);const NS=oS(TS);var RS=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Yw);const PS=oS(RS);var FS=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Yw);const OS=oS(FS);var IS=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Yw);const BS=oS(IS);var kS=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Yw);const LS=oS(kS);var US=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Yw);const zS=oS(US);var HS=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Yw);const VS=oS(HS);var GS=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Yw);const qS=oS(GS);var jS=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Yw);const WS=oS(jS);var XS=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Yw);const YS=oS(XS);var ZS=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Yw);const KS=oS(ZS);var QS=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Yw);const JS=oS(QS);var $S=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Yw);const eM=oS($S);var tM=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Yw);const nM=oS(tM);var rM=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Yw);const iM=oS(rM);var aM=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Yw);const oM=oS(aM);function sM(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-2710.57*e)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-67.37*e)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-2475.67*e)))))))+")"}const lM=gy(pl(300,.5,0),pl(-240,.5,1));var cM=gy(pl(-100,.75,.35),pl(80,1.5,.8)),uM=gy(pl(260,.75,.35),pl(80,1.5,.8)),hM=pl();function dM(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return hM.h=360*e-100,hM.s=1.5-1.5*t,hM.l=.8-.9*t,hM+""}var fM=mi(),pM=Math.PI/3,mM=2*Math.PI/3;function gM(e){var t;return e=(.5-e)*Math.PI,fM.r=255*(t=Math.sin(e))*t,fM.g=255*(t=Math.sin(e+pM))*t,fM.b=255*(t=Math.sin(e+mM))*t,fM+""}function vM(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-14825.05*e)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+707.56*e)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-6838.66*e)))))))+")"}function yM(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}const xM=yM(Yw("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var bM=yM(Yw("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),_M=yM(Yw("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),wM=yM(Yw("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function SM(e){return zr(Er(e).call(document.documentElement))}var MM=0;function DM(){return new EM}function EM(){this._="@"+(++MM).toString(36)}function CM(e,t){return e.target&&(e=Ji(e),void 0===t&&(t=e.currentTarget),e=e.touches||[e]),Array.from(e,(e=>$i(e,t)))}function AM(e){return"string"===typeof e?new kr([document.querySelectorAll(e)],[document.documentElement]):new kr([Tn(e)],Br)}function TM(e){return function(){return e}}EM.prototype=DM.prototype={constructor:EM,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};const NM=Math.abs,RM=Math.atan2,PM=Math.cos,FM=Math.max,OM=Math.min,IM=Math.sin,BM=Math.sqrt,kM=1e-12,LM=Math.PI,UM=LM/2,zM=2*LM;function HM(e){return e>=1?UM:e<=-1?-UM:Math.asin(e)}function VM(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError("invalid digits: ".concat(n));t=e}return e},()=>new Ss(t)}function GM(e){return e.innerRadius}function qM(e){return e.outerRadius}function jM(e){return e.startAngle}function WM(e){return e.endAngle}function XM(e){return e&&e.padAngle}function YM(e,t,n,r,i,a,o){var s=e-n,l=t-r,c=(o?a:-a)/BM(s*s+l*l),u=c*l,h=-c*s,d=e+u,f=t+h,p=n+u,m=r+h,g=(d+p)/2,v=(f+m)/2,y=p-d,x=m-f,b=y*y+x*x,_=i-a,w=d*m-p*f,S=(x<0?-1:1)*BM(FM(0,_*_*b-w*w)),M=(w*x-y*S)/b,D=(-w*y-x*S)/b,E=(w*x+y*S)/b,C=(-w*y+x*S)/b,A=M-g,T=D-v,N=E-g,R=C-v;return A*A+T*T>N*N+R*R&&(M=E,D=C),{cx:M,cy:D,x01:-u,y01:-h,x11:M*(i/_-1),y11:D*(i/_-1)}}function ZM(){var e=GM,t=qM,n=TM(0),r=null,i=jM,a=WM,o=XM,s=null,l=VM(c);function c(){var c,u,h=+e.apply(this,arguments),d=+t.apply(this,arguments),f=i.apply(this,arguments)-UM,p=a.apply(this,arguments)-UM,m=NM(p-f),g=p>f;if(s||(s=c=l()),d<h&&(u=d,d=h,h=u),d>kM)if(m>zM-kM)s.moveTo(d*PM(f),d*IM(f)),s.arc(0,0,d,f,p,!g),h>kM&&(s.moveTo(h*PM(p),h*IM(p)),s.arc(0,0,h,p,f,g));else{var v,y,x=f,b=p,_=f,w=p,S=m,M=m,D=o.apply(this,arguments)/2,E=D>kM&&(r?+r.apply(this,arguments):BM(h*h+d*d)),C=OM(NM(d-h)/2,+n.apply(this,arguments)),A=C,T=C;if(E>kM){var N=HM(E/h*IM(D)),R=HM(E/d*IM(D));(S-=2*N)>kM?(_+=N*=g?1:-1,w-=N):(S=0,_=w=(f+p)/2),(M-=2*R)>kM?(x+=R*=g?1:-1,b-=R):(M=0,x=b=(f+p)/2)}var P=d*PM(x),F=d*IM(x),O=h*PM(w),I=h*IM(w);if(C>kM){var B,k=d*PM(b),L=d*IM(b),U=h*PM(_),z=h*IM(_);if(m<LM)if(B=function(e,t,n,r,i,a,o,s){var l=n-e,c=r-t,u=o-i,h=s-a,d=h*l-u*c;if(!(d*d<kM))return[e+(d=(u*(t-a)-h*(e-i))/d)*l,t+d*c]}(P,F,U,z,k,L,O,I)){var H=P-B[0],V=F-B[1],G=k-B[0],q=L-B[1],j=1/IM(function(e){return e>1?0:e<-1?LM:Math.acos(e)}((H*G+V*q)/(BM(H*H+V*V)*BM(G*G+q*q)))/2),W=BM(B[0]*B[0]+B[1]*B[1]);A=OM(C,(h-W)/(j-1)),T=OM(C,(d-W)/(j+1))}else A=T=0}M>kM?T>kM?(v=YM(U,z,P,F,d,T,g),y=YM(k,L,O,I,d,T,g),s.moveTo(v.cx+v.x01,v.cy+v.y01),T<C?s.arc(v.cx,v.cy,T,RM(v.y01,v.x01),RM(y.y01,y.x01),!g):(s.arc(v.cx,v.cy,T,RM(v.y01,v.x01),RM(v.y11,v.x11),!g),s.arc(0,0,d,RM(v.cy+v.y11,v.cx+v.x11),RM(y.cy+y.y11,y.cx+y.x11),!g),s.arc(y.cx,y.cy,T,RM(y.y11,y.x11),RM(y.y01,y.x01),!g))):(s.moveTo(P,F),s.arc(0,0,d,x,b,!g)):s.moveTo(P,F),h>kM&&S>kM?A>kM?(v=YM(O,I,k,L,h,-A,g),y=YM(P,F,U,z,h,-A,g),s.lineTo(v.cx+v.x01,v.cy+v.y01),A<C?s.arc(v.cx,v.cy,A,RM(v.y01,v.x01),RM(y.y01,y.x01),!g):(s.arc(v.cx,v.cy,A,RM(v.y01,v.x01),RM(v.y11,v.x11),!g),s.arc(0,0,h,RM(v.cy+v.y11,v.cx+v.x11),RM(y.cy+y.y11,y.cx+y.x11),g),s.arc(y.cx,y.cy,A,RM(y.y11,y.x11),RM(y.y01,y.x01),!g))):s.arc(0,0,h,w,_,g):s.lineTo(O,I)}else s.moveTo(0,0);if(s.closePath(),c)return s=null,c+""||null}return c.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-LM/2;return[PM(r)*n,IM(r)*n]},c.innerRadius=function(t){return arguments.length?(e="function"===typeof t?t:TM(+t),c):e},c.outerRadius=function(e){return arguments.length?(t="function"===typeof e?e:TM(+e),c):t},c.cornerRadius=function(e){return arguments.length?(n="function"===typeof e?e:TM(+e),c):n},c.padRadius=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:TM(+e),c):r},c.startAngle=function(e){return arguments.length?(i="function"===typeof e?e:TM(+e),c):i},c.endAngle=function(e){return arguments.length?(a="function"===typeof e?e:TM(+e),c):a},c.padAngle=function(e){return arguments.length?(o="function"===typeof e?e:TM(+e),c):o},c.context=function(e){return arguments.length?(s=null==e?null:e,c):s},c}var KM=Array.prototype.slice;function QM(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function JM(e){this._context=e}function $M(e){return new JM(e)}function eD(e){return e[0]}function tD(e){return e[1]}function nD(e,t){var n=TM(!0),r=null,i=$M,a=null,o=VM(s);function s(s){var l,c,u,h=(s=QM(s)).length,d=!1;for(null==r&&(a=i(u=o())),l=0;l<=h;++l)!(l<h&&n(c=s[l],l,s))===d&&((d=!d)?a.lineStart():a.lineEnd()),d&&a.point(+e(c,l,s),+t(c,l,s));if(u)return a=null,u+""||null}return e="function"===typeof e?e:void 0===e?eD:TM(e),t="function"===typeof t?t:void 0===t?tD:TM(t),s.x=function(t){return arguments.length?(e="function"===typeof t?t:TM(+t),s):e},s.y=function(e){return arguments.length?(t="function"===typeof e?e:TM(+e),s):t},s.defined=function(e){return arguments.length?(n="function"===typeof e?e:TM(!!e),s):n},s.curve=function(e){return arguments.length?(i=e,null!=r&&(a=i(r)),s):i},s.context=function(e){return arguments.length?(null==e?r=a=null:a=i(r=e),s):r},s}function rD(e,t,n){var r=null,i=TM(!0),a=null,o=$M,s=null,l=VM(c);function c(c){var u,h,d,f,p,m=(c=QM(c)).length,g=!1,v=new Array(m),y=new Array(m);for(null==a&&(s=o(p=l())),u=0;u<=m;++u){if(!(u<m&&i(f=c[u],u,c))===g)if(g=!g)h=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=u-1;d>=h;--d)s.point(v[d],y[d]);s.lineEnd(),s.areaEnd()}g&&(v[u]=+e(f,u,c),y[u]=+t(f,u,c),s.point(r?+r(f,u,c):v[u],n?+n(f,u,c):y[u]))}if(p)return s=null,p+""||null}function u(){return nD().defined(i).curve(o).context(a)}return e="function"===typeof e?e:void 0===e?eD:TM(+e),t="function"===typeof t?t:TM(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?tD:TM(+n),c.x=function(t){return arguments.length?(e="function"===typeof t?t:TM(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"===typeof t?t:TM(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:TM(+e),c):r},c.y=function(e){return arguments.length?(t="function"===typeof e?e:TM(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"===typeof e?e:TM(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:TM(+e),c):n},c.lineX0=c.lineY0=function(){return u().x(e).y(t)},c.lineY1=function(){return u().x(e).y(n)},c.lineX1=function(){return u().x(r).y(t)},c.defined=function(e){return arguments.length?(i="function"===typeof e?e:TM(!!e),c):i},c.curve=function(e){return arguments.length?(o=e,null!=a&&(s=o(a)),c):o},c.context=function(e){return arguments.length?(null==e?a=s=null:s=o(a=e),c):a},c}function iD(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function aD(e){return e}function oD(){var e=aD,t=iD,n=null,r=TM(0),i=TM(zM),a=TM(0);function o(o){var s,l,c,u,h,d=(o=QM(o)).length,f=0,p=new Array(d),m=new Array(d),g=+r.apply(this,arguments),v=Math.min(zM,Math.max(-zM,i.apply(this,arguments)-g)),y=Math.min(Math.abs(v)/d,a.apply(this,arguments)),x=y*(v<0?-1:1);for(s=0;s<d;++s)(h=m[p[s]=s]=+e(o[s],s,o))>0&&(f+=h);for(null!=t?p.sort((function(e,n){return t(m[e],m[n])})):null!=n&&p.sort((function(e,t){return n(o[e],o[t])})),s=0,c=f?(v-d*x)/f:0;s<d;++s,g=u)l=p[s],u=g+((h=m[l])>0?h*c:0)+x,m[l]={data:o[l],index:s,value:h,startAngle:g,endAngle:u,padAngle:y};return m}return o.value=function(t){return arguments.length?(e="function"===typeof t?t:TM(+t),o):e},o.sortValues=function(e){return arguments.length?(t=e,n=null,o):t},o.sort=function(e){return arguments.length?(n=e,t=null,o):n},o.startAngle=function(e){return arguments.length?(r="function"===typeof e?e:TM(+e),o):r},o.endAngle=function(e){return arguments.length?(i="function"===typeof e?e:TM(+e),o):i},o.padAngle=function(e){return arguments.length?(a="function"===typeof e?e:TM(+e),o):a},o}JM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var sD=cD($M);function lD(e){this._curve=e}function cD(e){function t(t){return new lD(e(t))}return t._curve=e,t}function uD(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(e){return arguments.length?t(cD(e)):t()._curve},e}function hD(){return uD(nD().curve(sD))}function dD(){var e=rD().curve(sD),t=e.curve,n=e.lineX0,r=e.lineX1,i=e.lineY0,a=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return uD(n())},delete e.lineX0,e.lineEndAngle=function(){return uD(r())},delete e.lineX1,e.lineInnerRadius=function(){return uD(i())},delete e.lineY0,e.lineOuterRadius=function(){return uD(a())},delete e.lineY1,e.curve=function(e){return arguments.length?t(cD(e)):t()._curve},e}function fD(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]}lD.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};class pD{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}class mD{constructor(e){this._context=e}lineStart(){this._point=0}lineEnd(){}point(e,t){if(e=+e,t=+t,0===this._point)this._point=1;else{const n=fD(this._x0,this._y0),r=fD(this._x0,this._y0=(this._y0+t)/2),i=fD(e,this._y0),a=fD(e,t);this._context.moveTo(...n),this._context.bezierCurveTo(...r,...i,...a)}this._x0=e,this._y0=t}}function gD(e){return new pD(e,!0)}function vD(e){return new pD(e,!1)}function yD(e){return new mD(e)}function xD(e){return e.source}function bD(e){return e.target}function _D(e){let t=xD,n=bD,r=eD,i=tD,a=null,o=null,s=VM(l);function l(){let l;const c=KM.call(arguments),u=t.apply(this,c),h=n.apply(this,c);if(null==a&&(o=e(l=s())),o.lineStart(),c[0]=u,o.point(+r.apply(this,c),+i.apply(this,c)),c[0]=h,o.point(+r.apply(this,c),+i.apply(this,c)),o.lineEnd(),l)return o=null,l+""||null}return l.source=function(e){return arguments.length?(t=e,l):t},l.target=function(e){return arguments.length?(n=e,l):n},l.x=function(e){return arguments.length?(r="function"===typeof e?e:TM(+e),l):r},l.y=function(e){return arguments.length?(i="function"===typeof e?e:TM(+e),l):i},l.context=function(t){return arguments.length?(null==t?a=o=null:o=e(a=t),l):a},l}function wD(){return _D(gD)}function SD(){return _D(vD)}function MD(){const e=_D(yD);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e}const DD=BM(3),ED={draw(e,t){const n=.59436*BM(t+OM(t/28,.75)),r=n/2,i=r*DD;e.moveTo(0,n),e.lineTo(0,-n),e.moveTo(-i,-r),e.lineTo(i,r),e.moveTo(-i,r),e.lineTo(i,-r)}},CD={draw(e,t){const n=BM(t/LM);e.moveTo(n,0),e.arc(0,0,n,0,zM)}},AD={draw(e,t){const n=BM(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},TD=BM(1/3),ND=2*TD,RD={draw(e,t){const n=BM(t/ND),r=n*TD;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},PD={draw(e,t){const n=.62625*BM(t);e.moveTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.lineTo(-n,0),e.closePath()}},FD={draw(e,t){const n=.87559*BM(t-OM(t/7,2));e.moveTo(-n,0),e.lineTo(n,0),e.moveTo(0,n),e.lineTo(0,-n)}},OD={draw(e,t){const n=BM(t),r=-n/2;e.rect(r,r,n,n)}},ID={draw(e,t){const n=.4431*BM(t);e.moveTo(n,n),e.lineTo(n,-n),e.lineTo(-n,-n),e.lineTo(-n,n),e.closePath()}},BD=IM(LM/10)/IM(7*LM/10),kD=IM(zM/10)*BD,LD=-PM(zM/10)*BD,UD={draw(e,t){const n=BM(.8908130915292852*t),r=kD*n,i=LD*n;e.moveTo(0,-n),e.lineTo(r,i);for(let a=1;a<5;++a){const t=zM*a/5,o=PM(t),s=IM(t);e.lineTo(s*n,-o*n),e.lineTo(o*r-s*i,s*r+o*i)}e.closePath()}},zD=BM(3),HD={draw(e,t){const n=-BM(t/(3*zD));e.moveTo(0,2*n),e.lineTo(-zD*n,-n),e.lineTo(zD*n,-n),e.closePath()}},VD=BM(3),GD={draw(e,t){const n=.6824*BM(t),r=n/2,i=n*VD/2;e.moveTo(0,-n),e.lineTo(i,r),e.lineTo(-i,r),e.closePath()}},qD=-.5,jD=BM(3)/2,WD=1/BM(12),XD=3*(WD/2+1),YD={draw(e,t){const n=BM(t/XD),r=n/2,i=n*WD,a=r,o=n*WD+n,s=-a,l=o;e.moveTo(r,i),e.lineTo(a,o),e.lineTo(s,l),e.lineTo(qD*r-jD*i,jD*r+qD*i),e.lineTo(qD*a-jD*o,jD*a+qD*o),e.lineTo(qD*s-jD*l,jD*s+qD*l),e.lineTo(qD*r+jD*i,qD*i-jD*r),e.lineTo(qD*a+jD*o,qD*o-jD*a),e.lineTo(qD*s+jD*l,qD*l-jD*s),e.closePath()}},ZD={draw(e,t){const n=.6189*BM(t-OM(t/6,1.7));e.moveTo(-n,-n),e.lineTo(n,n),e.moveTo(-n,n),e.lineTo(n,-n)}},KD=[CD,AD,RD,OD,UD,HD,YD],QD=[CD,FD,ZD,GD,ED,ID,PD];function JD(e,t){let n=null,r=VM(i);function i(){let i;if(n||(n=i=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return e="function"===typeof e?e:TM(e||CD),t="function"===typeof t?t:TM(void 0===t?64:+t),i.type=function(t){return arguments.length?(e="function"===typeof t?t:TM(t),i):e},i.size=function(e){return arguments.length?(t="function"===typeof e?e:TM(+e),i):t},i.context=function(e){return arguments.length?(n=null==e?null:e,i):n},i}function $D(){}function eE(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function tE(e){this._context=e}function nE(e){return new tE(e)}function rE(e){this._context=e}function iE(e){return new rE(e)}function aE(e){this._context=e}function oE(e){return new aE(e)}function sE(e,t){this._basis=new tE(e),this._beta=t}tE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:eE(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:eE(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},rE.prototype={areaStart:$D,areaEnd:$D,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:eE(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},aE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:eE(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},sE.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],a=t[0],o=e[n]-i,s=t[n]-a,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*e[l]+(1-this._beta)*(i+r*o),this._beta*t[l]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const lE=function e(t){function n(e){return 1===t?new tE(e):new sE(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function cE(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function uE(e,t){this._context=e,this._k=(1-t)/6}uE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:cE(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:cE(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const hE=function e(t){function n(e){return new uE(e,t)}return n.tension=function(t){return e(+t)},n}(0);function dE(e,t){this._context=e,this._k=(1-t)/6}dE.prototype={areaStart:$D,areaEnd:$D,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:cE(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const fE=function e(t){function n(e){return new dE(e,t)}return n.tension=function(t){return e(+t)},n}(0);function pE(e,t){this._context=e,this._k=(1-t)/6}pE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:cE(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const mE=function e(t){function n(e){return new pE(e,t)}return n.tension=function(t){return e(+t)},n}(0);function gE(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>kM){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>kM){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*c+e._x1*e._l23_2a-t*e._l12_2a)/u,o=(o*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function vE(e,t){this._context=e,this._alpha=t}vE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:gE(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const yE=function e(t){function n(e){return t?new vE(e,t):new uE(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function xE(e,t){this._context=e,this._alpha=t}xE.prototype={areaStart:$D,areaEnd:$D,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:gE(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const bE=function e(t){function n(e){return t?new xE(e,t):new dE(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function _E(e,t){this._context=e,this._alpha=t}_E.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:gE(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const wE=function e(t){function n(e){return t?new _E(e,t):new pE(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function SE(e){this._context=e}function ME(e){return new SE(e)}function DE(e){return e<0?-1:1}function EE(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(DE(a)+DE(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function CE(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function AE(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function TE(e){this._context=e}function NE(e){this._context=new RE(e)}function RE(e){this._context=e}function PE(e){return new TE(e)}function FE(e){return new NE(e)}function OE(e){this._context=e}function IE(e){var t,n,r=e.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function BE(e){return new OE(e)}function kE(e,t){this._context=e,this._t=t}function LE(e){return new kE(e,.5)}function UE(e){return new kE(e,0)}function zE(e){return new kE(e,1)}function HE(e,t){if((i=e.length)>1)for(var n,r,i,a=1,o=e[t[0]],s=o.length;a<i;++a)for(r=o,o=e[t[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function VE(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function GE(e,t){return e[t]}function qE(e){const t=[];return t.key=e,t}function jE(){var e=TM([]),t=VE,n=HE,r=GE;function i(i){var a,o,s=Array.from(e.apply(this,arguments),qE),l=s.length,c=-1;for(const e of i)for(a=0,++c;a<l;++a)(s[a][c]=[0,+r(e,s[a].key,c,i)]).data=e;for(a=0,o=QM(t(s));a<l;++a)s[o[a]].index=a;return n(s,o),s}return i.keys=function(t){return arguments.length?(e="function"===typeof t?t:TM(Array.from(t)),i):e},i.value=function(e){return arguments.length?(r="function"===typeof e?e:TM(+e),i):r},i.order=function(e){return arguments.length?(t=null==e?VE:"function"===typeof e?e:TM(Array.from(e)),i):t},i.offset=function(e){return arguments.length?(n=null==e?HE:e,i):n},i}function WE(e,t){if((r=e.length)>0){for(var n,r,i,a=0,o=e[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=e[n][a][1]||0;if(i)for(n=0;n<r;++n)e[n][a][1]/=i}HE(e,t)}}function XE(e,t){if((s=e.length)>0)for(var n,r,i,a,o,s,l=0,c=e[t[0]].length;l<c;++l)for(a=o=0,n=0;n<s;++n)(i=(r=e[t[n]][l])[1]-r[0])>0?(r[0]=a,r[1]=a+=i):i<0?(r[1]=o,r[0]=o+=i):(r[0]=0,r[1]=i)}function YE(e,t){if((n=e.length)>0){for(var n,r=0,i=e[t[0]],a=i.length;r<a;++r){for(var o=0,s=0;o<n;++o)s+=e[o][r][1]||0;i[r][1]+=i[r][0]=-s/2}HE(e,t)}}function ZE(e,t){if((i=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var s=0,l=0,c=0;s<i;++s){for(var u=e[t[s]],h=u[o][1]||0,d=(h-(u[o-1][1]||0))/2,f=0;f<s;++f){var p=e[t[f]];d+=(p[o][1]||0)-(p[o-1][1]||0)}l+=h,c+=d*h}n[o-1][1]+=n[o-1][0]=a,l&&(a-=c/l)}n[o-1][1]+=n[o-1][0]=a,HE(e,t)}}function KE(e){var t=e.map(QE);return VE(e).sort((function(e,n){return t[e]-t[n]}))}function QE(e){for(var t,n=-1,r=0,i=e.length,a=-1/0;++n<i;)(t=+e[n][1])>a&&(a=t,r=n);return r}function JE(e){var t=e.map($E);return VE(e).sort((function(e,n){return t[e]-t[n]}))}function $E(e){for(var t,n=0,r=-1,i=e.length;++r<i;)(t=+e[r][1])&&(n+=t);return n}function eC(e){return JE(e).reverse()}function tC(e){var t,n,r=e.length,i=e.map($E),a=KE(e),o=0,s=0,l=[],c=[];for(t=0;t<r;++t)n=a[t],o<s?(o+=i[n],l.push(n)):(s+=i[n],c.push(n));return c.reverse().concat(l)}function nC(e){return VE(e).reverse()}SE.prototype={areaStart:$D,areaEnd:$D,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},TE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:AE(this,this._t0,CE(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,AE(this,CE(this,n=EE(this,e,t)),n);break;default:AE(this,this._t0,n=EE(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(NE.prototype=Object.create(TE.prototype)).point=function(e,t){TE.prototype.point.call(this,t,e)},RE.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}},OE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=IE(e),i=IE(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},kE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var rC="%Y-%m-%dT%H:%M:%S.%LZ";var iC=Date.prototype.toISOString?function(e){return e.toISOString()}:c_(rC);const aC=iC;var oC=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:u_(rC);const sC=oC;function lC(e,t,n){var r=new da,i=t;return null==t?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(e,t,n){t=+t,n=null==n?ua():+n,r._restart((function a(o){o+=i,r._restart(a,i+=t,n),e(o)}),t,n)},r.restart(e,t,n),r)}const cC=e=>()=>e;function uC(e,t){let{sourceEvent:n,target:r,transform:i,dispatch:a}=t;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:a}})}function hC(e,t,n){this.k=e,this.x=t,this.y=n}hC.prototype={constructor:hC,scale:function(e){return 1===e?this:new hC(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new hC(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var dC=new hC(1,0,0);function fC(e){for(;!e.__zoom;)if(!(e=e.parentNode))return dC;return e.__zoom}function pC(e){e.stopImmediatePropagation()}function mC(e){e.preventDefault(),e.stopImmediatePropagation()}function gC(e){return(!e.ctrlKey||"wheel"===e.type)&&!e.button}function vC(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function yC(){return this.__zoom||dC}function xC(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function bC(){return navigator.maxTouchPoints||"ontouchstart"in this}function _C(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function wC(){var e,t,n,r=gC,i=vC,a=_C,o=xC,s=bC,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,h=oy,d=En("start","zoom","end"),f=0,p=10;function m(e){e.property("__zoom",yC).on("wheel.zoom",w,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",M).filter(s).on("touchstart.zoom",D).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",C).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new hC(t,e.x,e.y)}function v(e,t,n){var r=t[0]-n[0]*e.k,i=t[1]-n[1]*e.k;return r===e.x&&i===e.y?e:new hC(e.k,r,i)}function y(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function x(e,t,n,r){e.on("start.zoom",(function(){b(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){b(this,arguments).event(r).end()})).tween("zoom",(function(){var e=this,a=arguments,o=b(e,a).event(r),s=i.apply(e,a),l=null==n?y(s):"function"===typeof n?n.apply(e,a):n,c=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),u=e.__zoom,d="function"===typeof t?t.apply(e,a):t,f=h(u.invert(l).concat(c/u.k),d.invert(l).concat(c/d.k));return function(e){if(1===e)e=d;else{var t=f(e),n=c/t[2];e=new hC(n,l[0]-t[0]*n,l[1]-t[1]*n)}o.zoom(null,e)}}))}function b(e,t,n){return!n&&e.__zooming||new _(e,t)}function _(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=i.apply(e,t),this.taps=0}function w(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(r.apply(this,arguments)){var s=b(this,n).event(e),u=this.__zoom,h=Math.max(l[0],Math.min(l[1],u.k*Math.pow(2,o.apply(this,arguments)))),d=$i(e);if(s.wheel)s.mouse[0][0]===d[0]&&s.mouse[0][1]===d[1]||(s.mouse[1]=u.invert(s.mouse[0]=d)),clearTimeout(s.wheel);else{if(u.k===h)return;s.mouse=[d,u.invert(d)],Ta(this),s.start()}mC(e),s.wheel=setTimeout((function(){s.wheel=null,s.end()}),150),s.zoom("mouse",a(v(g(u,h),s.mouse[0],s.mouse[1]),s.extent,c))}}function S(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];if(!n&&r.apply(this,arguments)){var s=e.currentTarget,l=b(this,i,!0).event(e),u=zr(e.view).on("mousemove.zoom",(function(e){if(mC(e),!l.moved){var t=e.clientX-d,n=e.clientY-p;l.moved=t*t+n*n>f}l.event(e).zoom("mouse",a(v(l.that.__zoom,l.mouse[0]=$i(e,s),l.mouse[1]),l.extent,c))}),!0).on("mouseup.zoom",(function(e){u.on("mousemove.zoom mouseup.zoom",null),Wr(e.view,l.moved),mC(e),l.event(e).end()}),!0),h=$i(e,s),d=e.clientX,p=e.clientY;jr(e.view),pC(e),l.mouse=[h,this.__zoom.invert(h)],Ta(this),l.start()}}function M(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(r.apply(this,arguments)){var s=this.__zoom,l=$i(e.changedTouches?e.changedTouches[0]:e,this),h=s.invert(l),d=s.k*(e.shiftKey?.5:2),f=a(v(g(s,d),l,h),i.apply(this,n),c);mC(e),u>0?zr(this).transition().duration(u).call(x,f,l,e):zr(this).call(m.transform,f,l,e)}}function D(n){for(var i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];if(r.apply(this,arguments)){var s,l,c,u,h=n.touches,d=h.length,f=b(this,a,n.changedTouches.length===d).event(n);for(pC(n),l=0;l<d;++l)u=[u=$i(c=h[l],this),this.__zoom.invert(u),c.identifier],f.touch0?f.touch1||f.touch0[2]===u[2]||(f.touch1=u,f.taps=0):(f.touch0=u,s=!0,f.taps=1+!!e);e&&(e=clearTimeout(e)),s&&(f.taps<2&&(t=u[0],e=setTimeout((function(){e=null}),500)),Ta(this),f.start())}}function E(e){if(this.__zooming){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,o,s,l,u=b(this,n).event(e),h=e.changedTouches,d=h.length;for(mC(e),i=0;i<d;++i)s=$i(o=h[i],this),u.touch0&&u.touch0[2]===o.identifier?u.touch0[0]=s:u.touch1&&u.touch1[2]===o.identifier&&(u.touch1[0]=s);if(o=u.that.__zoom,u.touch1){var f=u.touch0[0],p=u.touch0[1],m=u.touch1[0],y=u.touch1[1],x=(x=m[0]-f[0])*x+(x=m[1]-f[1])*x,_=(_=y[0]-p[0])*_+(_=y[1]-p[1])*_;o=g(o,Math.sqrt(x/_)),s=[(f[0]+m[0])/2,(f[1]+m[1])/2],l=[(p[0]+y[0])/2,(p[1]+y[1])/2]}else{if(!u.touch0)return;s=u.touch0[0],l=u.touch0[1]}u.zoom("touch",a(v(o,s,l),u.extent,c))}}function C(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];if(this.__zooming){var o,s,l=b(this,i).event(e),c=e.changedTouches,u=c.length;for(pC(e),n&&clearTimeout(n),n=setTimeout((function(){n=null}),500),o=0;o<u;++o)s=c[o],l.touch0&&l.touch0[2]===s.identifier?delete l.touch0:l.touch1&&l.touch1[2]===s.identifier&&delete l.touch1;if(l.touch1&&!l.touch0&&(l.touch0=l.touch1,delete l.touch1),l.touch0)l.touch0[1]=this.__zoom.invert(l.touch0[0]);else if(l.end(),2===l.taps&&(s=$i(s,this),Math.hypot(t[0]-s[0],t[1]-s[1])<p)){var h=zr(this).on("dblclick.zoom");h&&h.apply(this,arguments)}}}return m.transform=function(e,t,n,r){var i=e.selection?e.selection():e;i.property("__zoom",yC),e!==i?x(e,t,n,r):i.interrupt().each((function(){b(this,arguments).event(r).start().zoom(null,"function"===typeof t?t.apply(this,arguments):t).end()}))},m.scaleBy=function(e,t,n,r){m.scaleTo(e,(function(){return this.__zoom.k*("function"===typeof t?t.apply(this,arguments):t)}),n,r)},m.scaleTo=function(e,t,n,r){m.transform(e,(function(){var e=i.apply(this,arguments),r=this.__zoom,o=null==n?y(e):"function"===typeof n?n.apply(this,arguments):n,s=r.invert(o),l="function"===typeof t?t.apply(this,arguments):t;return a(v(g(r,l),o,s),e,c)}),n,r)},m.translateBy=function(e,t,n,r){m.transform(e,(function(){return a(this.__zoom.translate("function"===typeof t?t.apply(this,arguments):t,"function"===typeof n?n.apply(this,arguments):n),i.apply(this,arguments),c)}),null,r)},m.translateTo=function(e,t,n,r,o){m.transform(e,(function(){var e=i.apply(this,arguments),o=this.__zoom,s=null==r?y(e):"function"===typeof r?r.apply(this,arguments):r;return a(dC.translate(s[0],s[1]).scale(o.k).translate("function"===typeof t?-t.apply(this,arguments):-t,"function"===typeof n?-n.apply(this,arguments):-n),e,c)}),r,o)},_.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=zr(this.that).datum();d.call(e,this.that,new uC(e,{sourceEvent:this.sourceEvent,target:m,type:e,transform:this.that.__zoom,dispatch:d}),t)}},m.wheelDelta=function(e){return arguments.length?(o="function"===typeof e?e:cC(+e),m):o},m.filter=function(e){return arguments.length?(r="function"===typeof e?e:cC(!!e),m):r},m.touchable=function(e){return arguments.length?(s="function"===typeof e?e:cC(!!e),m):s},m.extent=function(e){return arguments.length?(i="function"===typeof e?e:cC([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),m):i},m.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],m):[l[0],l[1]]},m.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],m):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},m.constrain=function(e){return arguments.length?(a=e,m):a},m.duration=function(e){return arguments.length?(u=+e,m):u},m.interpolate=function(e){return arguments.length?(h=e,m):h},m.on=function(){var e=d.on.apply(d,arguments);return e===d?m:e},m.clickDistance=function(e){return arguments.length?(f=(e=+e)*e,m):Math.sqrt(f)},m.tapDistance=function(e){return arguments.length?(p=+e,m):p},m}function SC(){return SC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},SC.apply(null,arguments)}fC.prototype=hC.prototype;var MC={relTol:1e-12,absTol:1e-15,matrix:"Matrix",number:"number",numberFallback:"number",precision:64,predictable:!1,randomSeed:null};function DC(e,t){if(CC(e,t))return e[t];if("function"===typeof e[t]&&AC(e,t))throw new Error('Cannot access method "'+t+'" as a property');throw new Error('No access to property "'+t+'"')}function EC(e,t,n){if(CC(e,t))return e[t]=n,n;throw new Error('No access to property "'+t+'"')}function CC(e,t){return!(!function(e){return"object"===typeof e&&e&&e.constructor===Object}(e)&&!Array.isArray(e))&&(!!OA(TC,t)||!(t in Object.prototype)&&!(t in Function.prototype))}function AC(e,t){return null!==e&&void 0!==e&&"function"===typeof e[t]&&(!(OA(e,t)&&Object.getPrototypeOf&&t in Object.getPrototypeOf(e))&&(!!OA(NC,t)||!(t in Object.prototype)&&!(t in Function.prototype)))}var TC={length:!0,name:!0},NC={toString:!0,valueOf:!0,toLocaleString:!0};class RC{constructor(e){this.wrappedObject=e,this[Symbol.iterator]=this.entries}keys(){return Object.keys(this.wrappedObject).filter((e=>this.has(e))).values()}get(e){return DC(this.wrappedObject,e)}set(e,t){return EC(this.wrappedObject,e,t),this}has(e){return CC(this.wrappedObject,e)&&e in this.wrappedObject}entries(){return FC(this.keys(),(e=>[e,this.get(e)]))}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){CC(this.wrappedObject,e)&&delete this.wrappedObject[e]}clear(){for(var e of this.keys())this.delete(e)}get size(){return Object.keys(this.wrappedObject).length}}class PC{constructor(e,t,n){this.a=e,this.b=t,this.bKeys=n,this[Symbol.iterator]=this.entries}get(e){return this.bKeys.has(e)?this.b.get(e):this.a.get(e)}set(e,t){return this.bKeys.has(e)?this.b.set(e,t):this.a.set(e,t),this}has(e){return this.b.has(e)||this.a.has(e)}keys(){return new Set([...this.a.keys(),...this.b.keys()])[Symbol.iterator]()}entries(){return FC(this.keys(),(e=>[e,this.get(e)]))}forEach(e){for(var t of this.keys())e(this.get(t),t,this)}delete(e){return this.bKeys.has(e)?this.b.delete(e):this.a.delete(e)}clear(){this.a.clear(),this.b.clear()}get size(){return[...this.keys()].length}}function FC(e,t){return{next:()=>{var n=e.next();return n.done?n:{value:t(n.value),done:!1}}}}function OC(){return new Map}function IC(e){if(!e)return OC();if(rA(e))return e;if(nA(e))return new RC(e);throw new Error("createMap can create maps from objects or Maps")}function BC(e){return"number"===typeof e}function kC(e){return!(!e||"object"!==typeof e||"function"!==typeof e.constructor)&&(!0===e.isBigNumber&&"object"===typeof e.constructor.prototype&&!0===e.constructor.prototype.isBigNumber||"function"===typeof e.constructor.isDecimal&&!0===e.constructor.isDecimal(e))}function LC(e){return"bigint"===typeof e}function UC(e){return e&&"object"===typeof e&&!0===Object.getPrototypeOf(e).isComplex||!1}function zC(e){return e&&"object"===typeof e&&!0===Object.getPrototypeOf(e).isFraction||!1}function HC(e){return e&&!0===e.constructor.prototype.isUnit||!1}function VC(e){return"string"===typeof e}var GC=Array.isArray;function qC(e){return e&&!0===e.constructor.prototype.isMatrix||!1}function jC(e){return Array.isArray(e)||qC(e)}function WC(e){return e&&e.isDenseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function XC(e){return e&&e.isSparseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function YC(e){return e&&!0===e.constructor.prototype.isRange||!1}function ZC(e){return e&&!0===e.constructor.prototype.isIndex||!1}function KC(e){return"boolean"===typeof e}function QC(e){return e&&!0===e.constructor.prototype.isResultSet||!1}function JC(e){return e&&!0===e.constructor.prototype.isHelp||!1}function $C(e){return"function"===typeof e}function eA(e){return e instanceof Date}function tA(e){return e instanceof RegExp}function nA(e){return!(!e||"object"!==typeof e||e.constructor!==Object||UC(e)||zC(e))}function rA(e){return!!e&&(e instanceof Map||e instanceof RC||"function"===typeof e.set&&"function"===typeof e.get&&"function"===typeof e.keys&&"function"===typeof e.has)}function iA(e){return rA(e)&&rA(e.a)&&rA(e.b)}function aA(e){return rA(e)&&nA(e.wrappedObject)}function oA(e){return null===e}function sA(e){return void 0===e}function lA(e){return e&&!0===e.isAccessorNode&&!0===e.constructor.prototype.isNode||!1}function cA(e){return e&&!0===e.isArrayNode&&!0===e.constructor.prototype.isNode||!1}function uA(e){return e&&!0===e.isAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function hA(e){return e&&!0===e.isBlockNode&&!0===e.constructor.prototype.isNode||!1}function dA(e){return e&&!0===e.isConditionalNode&&!0===e.constructor.prototype.isNode||!1}function fA(e){return e&&!0===e.isConstantNode&&!0===e.constructor.prototype.isNode||!1}function pA(e){return fA(e)||bA(e)&&1===e.args.length&&fA(e.args[0])&&"-+~".includes(e.op)}function mA(e){return e&&!0===e.isFunctionAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function gA(e){return e&&!0===e.isFunctionNode&&!0===e.constructor.prototype.isNode||!1}function vA(e){return e&&!0===e.isIndexNode&&!0===e.constructor.prototype.isNode||!1}function yA(e){return e&&!0===e.isNode&&!0===e.constructor.prototype.isNode||!1}function xA(e){return e&&!0===e.isObjectNode&&!0===e.constructor.prototype.isNode||!1}function bA(e){return e&&!0===e.isOperatorNode&&!0===e.constructor.prototype.isNode||!1}function _A(e){return e&&!0===e.isParenthesisNode&&!0===e.constructor.prototype.isNode||!1}function wA(e){return e&&!0===e.isRangeNode&&!0===e.constructor.prototype.isNode||!1}function SA(e){return e&&!0===e.isRelationalNode&&!0===e.constructor.prototype.isNode||!1}function MA(e){return e&&!0===e.isSymbolNode&&!0===e.constructor.prototype.isNode||!1}function DA(e){return e&&!0===e.constructor.prototype.isChain||!1}function EA(e){var t=typeof e;return"object"===t?null===e?"null":kC(e)?"BigNumber":e.constructor&&e.constructor.name?e.constructor.name:"Object":t}function CA(e){var t=typeof e;if("number"===t||"bigint"===t||"string"===t||"boolean"===t||null===e||void 0===e)return e;if("function"===typeof e.clone)return e.clone();if(Array.isArray(e))return e.map((function(e){return CA(e)}));if(e instanceof Date)return new Date(e.valueOf());if(kC(e))return e;if(nA(e))return function(e,t){var n={};for(var r in e)OA(e,r)&&(n[r]=t(e[r]));return n}(e,CA);if("function"===t)return e;throw new TypeError("Cannot clone: unknown type of value (value: ".concat(e,")"))}function AA(e,t){for(var n in t)OA(t,n)&&(e[n]=t[n]);return e}function TA(e,t){if(Array.isArray(t))throw new TypeError("Arrays are not supported by deepExtend");for(var n in t)if(OA(t,n)&&!(n in Object.prototype)&&!(n in Function.prototype))if(t[n]&&t[n].constructor===Object)void 0===e[n]&&(e[n]={}),e[n]&&e[n].constructor===Object?TA(e[n],t[n]):e[n]=t[n];else{if(Array.isArray(t[n]))throw new TypeError("Arrays are not supported by deepExtend");e[n]=t[n]}return e}function NA(e,t){var n,r,i;if(Array.isArray(e)){if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(r=0,i=e.length;r<i;r++)if(!NA(e[r],t[r]))return!1;return!0}if("function"===typeof e)return e===t;if(e instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(n in e)if(!(n in t)||!NA(e[n],t[n]))return!1;for(n in t)if(!(n in e))return!1;return!0}return e===t}function RA(e){var t={};return PA(e,t),t}function PA(e,t){for(var n in e)if(OA(e,n)){var r=e[n];"object"===typeof r&&null!==r?PA(r,t):t[n]=r}}function FA(e,t,n){var r,i=!0;Object.defineProperty(e,t,{get:function(){return i&&(r=n(),i=!1),r},set:function(e){r=e,i=!1},configurable:!0,enumerable:!0})}function OA(e,t){return e&&Object.hasOwnProperty.call(e,t)}var IA=["Matrix","Array"],BA=["number","BigNumber","Fraction"];function kA(e,t){function n(r){if(r){if(void 0!==r.epsilon){console.warn('Warning: The configuration option "epsilon" is deprecated. Use "relTol" and "absTol" instead.');var i=CA(r);return i.relTol=r.epsilon,i.absTol=.001*r.epsilon,delete i.epsilon,n(i)}var a=CA(e);LA(r,"matrix",IA),LA(r,"number",BA),TA(e,r);var o=CA(e),s=CA(r);return t("config",o,a,s),o}return CA(e)}return n.MATRIX_OPTIONS=IA,n.NUMBER_OPTIONS=BA,Object.keys(MC).forEach((t=>{Object.defineProperty(n,t,{get:()=>e[t],enumerable:!0,configurable:!0})})),n}function LA(e,t,n){void 0===e[t]||n.includes(e[t])||console.warn('Warning: Unknown value "'+e[t]+'" for configuration option "'+t+'". Available options: '+n.map((e=>JSON.stringify(e))).join(", ")+".")}var UA=function(e){if(e)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(MC)};SC(UA,MC,{MATRIX_OPTIONS:IA,NUMBER_OPTIONS:BA});var zA,HA,VA=9e15,GA=1e9,qA="0123456789abcdef",jA="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",WA="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",XA={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-VA,maxE:VA,crypto:!1},YA=!0,ZA="[DecimalError] ",KA=ZA+"Invalid argument: ",QA=ZA+"Precision limit exceeded",JA=ZA+"crypto unavailable",$A="[object Decimal]",eT=Math.floor,tT=Math.pow,nT=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,rT=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,iT=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,aT=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,oT=1e7,sT=jA.length-1,lT=WA.length-1,cT={toStringTag:$A};function uT(e){var t,n,r,i=e.length-1,a="",o=e[0];if(i>0){for(a+=o,t=1;t<i;t++)(n=7-(r=e[t]+"").length)&&(a+=_T(n)),a+=r;(n=7-(r=(o=e[t])+"").length)&&(a+=_T(n))}else if(0===o)return"0";for(;o%10===0;)o/=10;return a+o}function hT(e,t,n){if(e!==~~e||e<t||e>n)throw Error(KA+e)}function dT(e,t,n,r){var i,a,o,s;for(a=e[0];a>=10;a/=10)--t;return--t<0?(t+=7,i=0):(i=Math.ceil((t+1)/7),t%=7),a=tT(10,7-t),s=e[i]%a|0,null==r?t<3?(0==t?s=s/100|0:1==t&&(s=s/10|0),o=n<4&&99999==s||n>3&&49999==s||5e4==s||0==s):o=(n<4&&s+1==a||n>3&&s+1==a/2)&&(e[i+1]/a/100|0)==tT(10,t-2)-1||(s==a/2||0==s)&&0==(e[i+1]/a/100|0):t<4?(0==t?s=s/1e3|0:1==t?s=s/100|0:2==t&&(s=s/10|0),o=(r||n<4)&&9999==s||!r&&n>3&&4999==s):o=((r||n<4)&&s+1==a||!r&&n>3&&s+1==a/2)&&(e[i+1]/a/1e3|0)==tT(10,t-3)-1,o}function fT(e,t,n){for(var r,i,a=[0],o=0,s=e.length;o<s;){for(i=a.length;i--;)a[i]*=t;for(a[0]+=qA.indexOf(e.charAt(o++)),r=0;r<a.length;r++)a[r]>n-1&&(void 0===a[r+1]&&(a[r+1]=0),a[r+1]+=a[r]/n|0,a[r]%=n)}return a.reverse()}cT.absoluteValue=cT.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),mT(e)},cT.ceil=function(){return mT(new this.constructor(this),this.e+1,2)},cT.clampedTo=cT.clamp=function(e,t){var n=this,r=n.constructor;if(e=new r(e),t=new r(t),!e.s||!t.s)return new r(NaN);if(e.gt(t))throw Error(KA+t);return n.cmp(e)<0?e:n.cmp(t)>0?t:new r(n)},cT.comparedTo=cT.cmp=function(e){var t,n,r,i,a=this,o=a.d,s=(e=new a.constructor(e)).d,l=a.s,c=e.s;if(!o||!s)return l&&c?l!==c?l:o===s?0:!o^l<0?1:-1:NaN;if(!o[0]||!s[0])return o[0]?l:s[0]?-c:0;if(l!==c)return l;if(a.e!==e.e)return a.e>e.e^l<0?1:-1;for(t=0,n=(r=o.length)<(i=s.length)?r:i;t<n;++t)if(o[t]!==s[t])return o[t]>s[t]^l<0?1:-1;return r===i?0:r>i^l<0?1:-1},cT.cosine=cT.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?i=(1/RT(4,n=Math.ceil(r/3))).toString():(n=16,i="2.3283064365386962890625e-10");e.precision+=n,t=NT(e,1,t.times(i),new e(1));for(var a=n;a--;){var o=t.times(t);t=o.times(o).minus(o).times(8).plus(1)}return e.precision-=n,t}(r,PT(r,n)),r.precision=e,r.rounding=t,mT(2==HA||3==HA?n.neg():n,e,t,!0)):new r(1):new r(NaN)},cT.cubeRoot=cT.cbrt=function(){var e,t,n,r,i,a,o,s,l,c,u=this,h=u.constructor;if(!u.isFinite()||u.isZero())return new h(u);for(YA=!1,(a=u.s*tT(u.s*u,1/3))&&Math.abs(a)!=1/0?r=new h(a.toString()):(n=uT(u.d),(a=((e=u.e)-n.length+1)%3)&&(n+=1==a||-2==a?"0":"00"),a=tT(n,1/3),e=eT((e+1)/3)-(e%3==(e<0?-1:2)),(r=new h(n=a==1/0?"5e"+e:(n=a.toExponential()).slice(0,n.indexOf("e")+1)+e)).s=u.s),o=(e=h.precision)+3;;)if(c=(l=(s=r).times(s).times(s)).plus(u),r=pT(c.plus(u).times(s),c.plus(l),o+2,1),uT(s.d).slice(0,o)===(n=uT(r.d)).slice(0,o)){if("9999"!=(n=n.slice(o-3,o+1))&&(i||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(mT(r,e+1,1),t=!r.times(r).times(r).eq(u));break}if(!i&&(mT(s,e+1,0),s.times(s).times(s).eq(u))){r=s;break}o+=4,i=1}return YA=!0,mT(r,e,h.rounding,t)},cT.decimalPlaces=cT.dp=function(){var e,t=this.d,n=NaN;if(t){if(n=7*((e=t.length-1)-eT(this.e/7)),e=t[e])for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},cT.dividedBy=cT.div=function(e){return pT(this,new this.constructor(e))},cT.dividedToIntegerBy=cT.divToInt=function(e){var t=this.constructor;return mT(pT(this,new t(e),0,1,1),t.precision,t.rounding)},cT.equals=cT.eq=function(e){return 0===this.cmp(e)},cT.floor=function(){return mT(new this.constructor(this),this.e+1,3)},cT.greaterThan=cT.gt=function(e){return this.cmp(e)>0},cT.greaterThanOrEqualTo=cT.gte=function(e){var t=this.cmp(e);return 1==t||0===t},cT.hyperbolicCosine=cT.cosh=function(){var e,t,n,r,i,a=this,o=a.constructor,s=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return s;n=o.precision,r=o.rounding,o.precision=n+Math.max(a.e,a.sd())+4,o.rounding=1,(i=a.d.length)<32?t=(1/RT(4,e=Math.ceil(i/3))).toString():(e=16,t="2.3283064365386962890625e-10"),a=NT(o,1,a.times(t),new o(1),!0);for(var l,c=e,u=new o(8);c--;)l=a.times(a),a=s.minus(l.times(u.minus(l.times(u))));return mT(a,o.precision=n,o.rounding=r,!0)},cT.hyperbolicSine=cT.sinh=function(){var e,t,n,r,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(t=a.precision,n=a.rounding,a.precision=t+Math.max(i.e,i.sd())+4,a.rounding=1,(r=i.d.length)<3)i=NT(a,2,i,i,!0);else{e=(e=1.4*Math.sqrt(r))>16?16:0|e,i=NT(a,2,i=i.times(1/RT(5,e)),i,!0);for(var o,s=new a(5),l=new a(16),c=new a(20);e--;)o=i.times(i),i=i.times(s.plus(o.times(l.times(o).plus(c))))}return a.precision=t,a.rounding=n,mT(i,t,n,!0)},cT.hyperbolicTangent=cT.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,pT(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)},cT.inverseCosine=cT.acos=function(){var e=this,t=e.constructor,n=e.abs().cmp(1),r=t.precision,i=t.rounding;return-1!==n?0===n?e.isNeg()?xT(t,r,i):new t(0):new t(NaN):e.isZero()?xT(t,r+4,i).times(.5):(t.precision=r+6,t.rounding=1,e=new t(1).minus(e).div(e.plus(1)).sqrt().atan(),t.precision=r,t.rounding=i,e.times(2))},cT.inverseHyperbolicCosine=cT.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,YA=!1,n=n.times(n).minus(1).sqrt().plus(n),YA=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)},cT.inverseHyperbolicSine=cT.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,YA=!1,n=n.times(n).plus(1).sqrt().plus(n),YA=!0,r.precision=e,r.rounding=t,n.ln())},cT.inverseHyperbolicTangent=cT.atanh=function(){var e,t,n,r,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=a.precision,t=a.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?mT(new a(i),e,t,!0):(a.precision=n=r-i.e,i=pT(i.plus(1),new a(1).minus(i),n+e,1),a.precision=e+4,a.rounding=1,i=i.ln(),a.precision=e,a.rounding=t,i.times(.5))):new a(NaN)},cT.inverseSine=cT.asin=function(){var e,t,n,r,i=this,a=i.constructor;return i.isZero()?new a(i):(t=i.abs().cmp(1),n=a.precision,r=a.rounding,-1!==t?0===t?((e=xT(a,n+4,r).times(.5)).s=i.s,e):new a(NaN):(a.precision=n+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=n,a.rounding=r,i.times(2)))},cT.inverseTangent=cT.atan=function(){var e,t,n,r,i,a,o,s,l,c=this,u=c.constructor,h=u.precision,d=u.rounding;if(c.isFinite()){if(c.isZero())return new u(c);if(c.abs().eq(1)&&h+4<=lT)return(o=xT(u,h+4,d).times(.25)).s=c.s,o}else{if(!c.s)return new u(NaN);if(h+4<=lT)return(o=xT(u,h+4,d).times(.5)).s=c.s,o}for(u.precision=s=h+10,u.rounding=1,e=n=Math.min(28,s/7+2|0);e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(YA=!1,t=Math.ceil(s/7),r=1,l=c.times(c),o=new u(c),i=c;-1!==e;)if(i=i.times(l),a=o.minus(i.div(r+=2)),i=i.times(l),void 0!==(o=a.plus(i.div(r+=2))).d[t])for(e=t;o.d[e]===a.d[e]&&e--;);return n&&(o=o.times(2<<n-1)),YA=!0,mT(o,u.precision=h,u.rounding=d,!0)},cT.isFinite=function(){return!!this.d},cT.isInteger=cT.isInt=function(){return!!this.d&&eT(this.e/7)>this.d.length-2},cT.isNaN=function(){return!this.s},cT.isNegative=cT.isNeg=function(){return this.s<0},cT.isPositive=cT.isPos=function(){return this.s>0},cT.isZero=function(){return!!this.d&&0===this.d[0]},cT.lessThan=cT.lt=function(e){return this.cmp(e)<0},cT.lessThanOrEqualTo=cT.lte=function(e){return this.cmp(e)<1},cT.logarithm=cT.log=function(e){var t,n,r,i,a,o,s,l,c=this,u=c.constructor,h=u.precision,d=u.rounding;if(null==e)e=new u(10),t=!0;else{if(n=(e=new u(e)).d,e.s<0||!n||!n[0]||e.eq(1))return new u(NaN);t=e.eq(10)}if(n=c.d,c.s<0||!n||!n[0]||c.eq(1))return new u(n&&!n[0]?-1/0:1!=c.s?NaN:n?0:1/0);if(t)if(n.length>1)a=!0;else{for(i=n[0];i%10===0;)i/=10;a=1!==i}if(YA=!1,o=ET(c,s=h+5),r=t?yT(u,s+10):ET(e,s),dT((l=pT(o,r,s,1)).d,i=h,d))do{if(o=ET(c,s+=10),r=t?yT(u,s+10):ET(e,s),l=pT(o,r,s,1),!a){+uT(l.d).slice(i+1,i+15)+1==1e14&&(l=mT(l,h+1,0));break}}while(dT(l.d,i+=10,d));return YA=!0,mT(l,h,d)},cT.minus=cT.sub=function(e){var t,n,r,i,a,o,s,l,c,u,h,d,f=this,p=f.constructor;if(e=new p(e),!f.d||!e.d)return f.s&&e.s?f.d?e.s=-e.s:e=new p(e.d||f.s!==e.s?f:NaN):e=new p(NaN),e;if(f.s!=e.s)return e.s=-e.s,f.plus(e);if(c=f.d,d=e.d,s=p.precision,l=p.rounding,!c[0]||!d[0]){if(d[0])e.s=-e.s;else{if(!c[0])return new p(3===l?-0:0);e=new p(f)}return YA?mT(e,s,l):e}if(n=eT(e.e/7),u=eT(f.e/7),c=c.slice(),a=u-n){for((h=a<0)?(t=c,a=-a,o=d.length):(t=d,n=u,o=c.length),a>(r=Math.max(Math.ceil(s/7),o)+2)&&(a=r,t.length=1),t.reverse(),r=a;r--;)t.push(0);t.reverse()}else{for((h=(r=c.length)<(o=d.length))&&(o=r),r=0;r<o;r++)if(c[r]!=d[r]){h=c[r]<d[r];break}a=0}for(h&&(t=c,c=d,d=t,e.s=-e.s),o=c.length,r=d.length-o;r>0;--r)c[o++]=0;for(r=d.length;r>a;){if(c[--r]<d[r]){for(i=r;i&&0===c[--i];)c[i]=oT-1;--c[i],c[r]+=oT}c[r]-=d[r]}for(;0===c[--o];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(e.d=c,e.e=vT(c,n),YA?mT(e,s,l):e):new p(3===l?-0:0)},cT.modulo=cT.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?mT(new r(n),r.precision,r.rounding):(YA=!1,9==r.modulo?(t=pT(n,e.abs(),0,3,1)).s*=e.s:t=pT(n,e,0,r.modulo,1),t=t.times(e),YA=!0,n.minus(t))},cT.naturalExponential=cT.exp=function(){return DT(this)},cT.naturalLogarithm=cT.ln=function(){return ET(this)},cT.negated=cT.neg=function(){var e=new this.constructor(this);return e.s=-e.s,mT(e)},cT.plus=cT.add=function(e){var t,n,r,i,a,o,s,l,c,u,h=this,d=h.constructor;if(e=new d(e),!h.d||!e.d)return h.s&&e.s?h.d||(e=new d(e.d||h.s===e.s?h:NaN)):e=new d(NaN),e;if(h.s!=e.s)return e.s=-e.s,h.minus(e);if(c=h.d,u=e.d,s=d.precision,l=d.rounding,!c[0]||!u[0])return u[0]||(e=new d(h)),YA?mT(e,s,l):e;if(a=eT(h.e/7),r=eT(e.e/7),c=c.slice(),i=a-r){for(i<0?(n=c,i=-i,o=u.length):(n=u,r=a,o=c.length),i>(o=(a=Math.ceil(s/7))>o?a+1:o+1)&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for((o=c.length)-(i=u.length)<0&&(i=o,n=u,u=c,c=n),t=0;i;)t=(c[--i]=c[i]+u[i]+t)/oT|0,c[i]%=oT;for(t&&(c.unshift(t),++r),o=c.length;0==c[--o];)c.pop();return e.d=c,e.e=vT(c,r),YA?mT(e,s,l):e},cT.precision=cT.sd=function(e){var t,n=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(KA+e);return n.d?(t=bT(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},cT.round=function(){var e=this,t=e.constructor;return mT(new t(e),e.e+1,t.rounding)},cT.sine=cT.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:NT(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:0|n,t=t.times(1/RT(5,n)),t=NT(e,2,t,t);for(var i,a=new e(5),o=new e(16),s=new e(20);n--;)i=t.times(t),t=t.times(a.plus(i.times(o.times(i).minus(s))));return t}(r,PT(r,n)),r.precision=e,r.rounding=t,mT(HA>2?n.neg():n,e,t,!0)):new r(NaN)},cT.squareRoot=cT.sqrt=function(){var e,t,n,r,i,a,o=this,s=o.d,l=o.e,c=o.s,u=o.constructor;if(1!==c||!s||!s[0])return new u(!c||c<0&&(!s||s[0])?NaN:s?o:1/0);for(YA=!1,0==(c=Math.sqrt(+o))||c==1/0?(((t=uT(s)).length+l)%2==0&&(t+="0"),c=Math.sqrt(t),l=eT((l+1)/2)-(l<0||l%2),r=new u(t=c==1/0?"5e"+l:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+l)):r=new u(c.toString()),n=(l=u.precision)+3;;)if(r=(a=r).plus(pT(o,a,n+2,1)).times(.5),uT(a.d).slice(0,n)===(t=uT(r.d)).slice(0,n)){if("9999"!=(t=t.slice(n-3,n+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(mT(r,l+1,1),e=!r.times(r).eq(o));break}if(!i&&(mT(a,l+1,0),a.times(a).eq(o))){r=a;break}n+=4,i=1}return YA=!0,mT(r,l,u.rounding,e)},cT.tangent=cT.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,(n=n.sin()).s=1,n=pT(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,mT(2==HA||4==HA?n.neg():n,e,t,!0)):new r(NaN)},cT.times=cT.mul=function(e){var t,n,r,i,a,o,s,l,c,u=this,h=u.constructor,d=u.d,f=(e=new h(e)).d;if(e.s*=u.s,!d||!d[0]||!f||!f[0])return new h(!e.s||d&&!d[0]&&!f||f&&!f[0]&&!d?NaN:d&&f?0*e.s:e.s/0);for(n=eT(u.e/7)+eT(e.e/7),(l=d.length)<(c=f.length)&&(a=d,d=f,f=a,o=l,l=c,c=o),a=[],r=o=l+c;r--;)a.push(0);for(r=c;--r>=0;){for(t=0,i=l+r;i>r;)s=a[i]+f[r]*d[i-r-1]+t,a[i--]=s%oT|0,t=s/oT|0;a[i]=(a[i]+t)%oT|0}for(;!a[--o];)a.pop();return t?++n:a.shift(),e.d=a,e.e=vT(a,n),YA?mT(e,h.precision,h.rounding):e},cT.toBinary=function(e,t){return FT(this,2,e,t)},cT.toDecimalPlaces=cT.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(hT(e,0,GA),void 0===t?t=r.rounding:hT(t,0,8),mT(n,e+n.e+1,t))},cT.toExponential=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=gT(r,!0):(hT(e,0,GA),void 0===t?t=i.rounding:hT(t,0,8),n=gT(r=mT(new i(r),e+1,t),!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n},cT.toFixed=function(e,t){var n,r,i=this,a=i.constructor;return void 0===e?n=gT(i):(hT(e,0,GA),void 0===t?t=a.rounding:hT(t,0,8),n=gT(r=mT(new a(i),e+i.e+1,t),!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n},cT.toFraction=function(e){var t,n,r,i,a,o,s,l,c,u,h,d,f=this,p=f.d,m=f.constructor;if(!p)return new m(f);if(c=n=new m(1),r=l=new m(0),o=(a=(t=new m(r)).e=bT(p)-f.e-1)%7,t.d[0]=tT(10,o<0?7+o:o),null==e)e=a>0?t:c;else{if(!(s=new m(e)).isInt()||s.lt(c))throw Error(KA+s);e=s.gt(t)?a>0?t:c:s}for(YA=!1,s=new m(uT(p)),u=m.precision,m.precision=a=7*p.length*2;h=pT(s,t,0,1,1),1!=(i=n.plus(h.times(r))).cmp(e);)n=r,r=i,i=c,c=l.plus(h.times(i)),l=i,i=t,t=s.minus(h.times(i)),s=i;return i=pT(e.minus(n),r,0,1,1),l=l.plus(i.times(c)),n=n.plus(i.times(r)),l.s=c.s=f.s,d=pT(c,r,a,1).minus(f).abs().cmp(pT(l,n,a,1).minus(f).abs())<1?[c,r]:[l,n],m.precision=u,YA=!0,d},cT.toHexadecimal=cT.toHex=function(e,t){return FT(this,16,e,t)},cT.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),null==e){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),void 0===t?t=r.rounding:hT(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(YA=!1,n=pT(n,e,0,t,1).times(e),YA=!0,mT(n)):(e.s=n.s,n=e),n},cT.toNumber=function(){return+this},cT.toOctal=function(e,t){return FT(this,8,e,t)},cT.toPower=cT.pow=function(e){var t,n,r,i,a,o,s=this,l=s.constructor,c=+(e=new l(e));if(!s.d||!e.d||!s.d[0]||!e.d[0])return new l(tT(+s,c));if((s=new l(s)).eq(1))return s;if(r=l.precision,a=l.rounding,e.eq(1))return mT(s,r,a);if((t=eT(e.e/7))>=e.d.length-1&&(n=c<0?-c:c)<=9007199254740991)return i=wT(l,s,n,r),e.s<0?new l(1).div(i):mT(i,r,a);if((o=s.s)<0){if(t<e.d.length-1)return new l(NaN);if(0==(1&e.d[t])&&(o=1),0==s.e&&1==s.d[0]&&1==s.d.length)return s.s=o,s}return(t=0!=(n=tT(+s,c))&&isFinite(n)?new l(n+"").e:eT(c*(Math.log("0."+uT(s.d))/Math.LN10+s.e+1)))>l.maxE+1||t<l.minE-1?new l(t>0?o/0:0):(YA=!1,l.rounding=s.s=1,n=Math.min(12,(t+"").length),(i=DT(e.times(ET(s,r+n)),r)).d&&dT((i=mT(i,r+5,1)).d,r,a)&&(t=r+10,+uT((i=mT(DT(e.times(ET(s,t+n)),t),t+5,1)).d).slice(r+1,r+15)+1==1e14&&(i=mT(i,r+1,0))),i.s=o,YA=!0,l.rounding=a,mT(i,r,a))},cT.toPrecision=function(e,t){var n,r=this,i=r.constructor;return void 0===e?n=gT(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(hT(e,1,GA),void 0===t?t=i.rounding:hT(t,0,8),n=gT(r=mT(new i(r),e,t),e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n},cT.toSignificantDigits=cT.toSD=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(hT(e,1,GA),void 0===t?t=n.rounding:hT(t,0,8)),mT(new n(this),e,t)},cT.toString=function(){var e=this,t=e.constructor,n=gT(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},cT.truncated=cT.trunc=function(){return mT(new this.constructor(this),this.e+1,1)},cT.valueOf=cT.toJSON=function(){var e=this,t=e.constructor,n=gT(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};var pT=function(){function e(e,t,n){var r,i=0,a=e.length;for(e=e.slice();a--;)r=e[a]*t+i,e[a]=r%n|0,i=r/n|0;return i&&e.unshift(i),e}function t(e,t,n,r){var i,a;if(n!=r)a=n>r?1:-1;else for(i=a=0;i<n;i++)if(e[i]!=t[i]){a=e[i]>t[i]?1:-1;break}return a}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,i,a,o,s,l){var c,u,h,d,f,p,m,g,v,y,x,b,_,w,S,M,D,E,C,A,T=r.constructor,N=r.s==i.s?1:-1,R=r.d,P=i.d;if(!R||!R[0]||!P||!P[0])return new T(r.s&&i.s&&(R?!P||R[0]!=P[0]:P)?R&&0==R[0]||!P?0*N:N/0:NaN);for(l?(f=1,u=r.e-i.e):(l=oT,f=7,u=eT(r.e/f)-eT(i.e/f)),C=P.length,D=R.length,y=(v=new T(N)).d=[],h=0;P[h]==(R[h]||0);h++);if(P[h]>(R[h]||0)&&u--,null==a?(w=a=T.precision,o=T.rounding):w=s?a+(r.e-i.e)+1:a,w<0)y.push(1),p=!0;else{if(w=w/f+2|0,h=0,1==C){for(d=0,P=P[0],w++;(h<D||d)&&w--;h++)S=d*l+(R[h]||0),y[h]=S/P|0,d=S%P|0;p=d||h<D}else{for((d=l/(P[0]+1)|0)>1&&(P=e(P,d,l),R=e(R,d,l),C=P.length,D=R.length),M=C,b=(x=R.slice(0,C)).length;b<C;)x[b++]=0;(A=P.slice()).unshift(0),E=P[0],P[1]>=l/2&&++E;do{d=0,(c=t(P,x,C,b))<0?(_=x[0],C!=b&&(_=_*l+(x[1]||0)),(d=_/E|0)>1?(d>=l&&(d=l-1),1==(c=t(m=e(P,d,l),x,g=m.length,b=x.length))&&(d--,n(m,C<g?A:P,g,l))):(0==d&&(c=d=1),m=P.slice()),(g=m.length)<b&&m.unshift(0),n(x,m,b,l),-1==c&&(c=t(P,x,C,b=x.length))<1&&(d++,n(x,C<b?A:P,b,l)),b=x.length):0===c&&(d++,x=[0]),y[h++]=d,c&&x[0]?x[b++]=R[M]||0:(x=[R[M]],b=1)}while((M++<D||void 0!==x[0])&&w--);p=void 0!==x[0]}y[0]||y.shift()}if(1==f)v.e=u,zA=p;else{for(h=1,d=y[0];d>=10;d/=10)h++;v.e=h+u*f-1,mT(v,s?a+v.e+1:a,o,p)}return v}}();function mT(e,t,n,r){var i,a,o,s,l,c,u,h,d,f=e.constructor;e:if(null!=t){if(!(h=e.d))return e;for(i=1,s=h[0];s>=10;s/=10)i++;if((a=t-i)<0)a+=7,o=t,l=(u=h[d=0])/tT(10,i-o-1)%10|0;else if((d=Math.ceil((a+1)/7))>=(s=h.length)){if(!r)break e;for(;s++<=d;)h.push(0);u=l=0,i=1,o=(a%=7)-7+1}else{for(u=s=h[d],i=1;s>=10;s/=10)i++;l=(o=(a%=7)-7+i)<0?0:u/tT(10,i-o-1)%10|0}if(r=r||t<0||void 0!==h[d+1]||(o<0?u:u%tT(10,i-o-1)),c=n<4?(l||r)&&(0==n||n==(e.s<0?3:2)):l>5||5==l&&(4==n||r||6==n&&(a>0?o>0?u/tT(10,i-o):0:h[d-1])%10&1||n==(e.s<0?8:7)),t<1||!h[0])return h.length=0,c?(t-=e.e+1,h[0]=tT(10,(7-t%7)%7),e.e=-t||0):h[0]=e.e=0,e;if(0==a?(h.length=d,s=1,d--):(h.length=d+1,s=tT(10,7-a),h[d]=o>0?(u/tT(10,i-o)%tT(10,o)|0)*s:0),c)for(;;){if(0==d){for(a=1,o=h[0];o>=10;o/=10)a++;for(o=h[0]+=s,s=1;o>=10;o/=10)s++;a!=s&&(e.e++,h[0]==oT&&(h[0]=1));break}if(h[d]+=s,h[d]!=oT)break;h[d--]=0,s=1}for(a=h.length;0===h[--a];)h.pop()}return YA&&(e.e>f.maxE?(e.d=null,e.e=NaN):e.e<f.minE&&(e.e=0,e.d=[0])),e}function gT(e,t,n){if(!e.isFinite())return CT(e);var r,i=e.e,a=uT(e.d),o=a.length;return t?(n&&(r=n-o)>0?a=a.charAt(0)+"."+a.slice(1)+_T(r):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(e.e<0?"e":"e+")+e.e):i<0?(a="0."+_T(-i-1)+a,n&&(r=n-o)>0&&(a+=_T(r))):i>=o?(a+=_T(i+1-o),n&&(r=n-i-1)>0&&(a=a+"."+_T(r))):((r=i+1)<o&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(a+="."),a+=_T(r))),a}function vT(e,t){var n=e[0];for(t*=7;n>=10;n/=10)t++;return t}function yT(e,t,n){if(t>sT)throw YA=!0,n&&(e.precision=n),Error(QA);return mT(new e(jA),t,1,!0)}function xT(e,t,n){if(t>lT)throw Error(QA);return mT(new e(WA),t,n,!0)}function bT(e){var t=e.length-1,n=7*t+1;if(t=e[t]){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function _T(e){for(var t="";e--;)t+="0";return t}function wT(e,t,n,r){var i,a=new e(1),o=Math.ceil(r/7+4);for(YA=!1;;){if(n%2&&OT((a=a.times(t)).d,o)&&(i=!0),0===(n=eT(n/2))){n=a.d.length-1,i&&0===a.d[n]&&++a.d[n];break}OT((t=t.times(t)).d,o)}return YA=!0,a}function ST(e){return 1&e.d[e.d.length-1]}function MT(e,t,n){for(var r,i,a=new e(t[0]),o=0;++o<t.length;){if(!(i=new e(t[o])).s){a=i;break}((r=a.cmp(i))===n||0===r&&a.s===n)&&(a=i)}return a}function DT(e,t){var n,r,i,a,o,s,l,c=0,u=0,h=0,d=e.constructor,f=d.rounding,p=d.precision;if(!e.d||!e.d[0]||e.e>17)return new d(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(YA=!1,l=p):l=t,s=new d(.03125);e.e>-2;)e=e.times(s),h+=5;for(l+=r=Math.log(tT(2,h))/Math.LN10*2+5|0,n=a=o=new d(1),d.precision=l;;){if(a=mT(a.times(e),l,1),n=n.times(++u),uT((s=o.plus(pT(a,n,l,1))).d).slice(0,l)===uT(o.d).slice(0,l)){for(i=h;i--;)o=mT(o.times(o),l,1);if(null!=t)return d.precision=p,o;if(!(c<3&&dT(o.d,l-r,f,c)))return mT(o,d.precision=p,f,YA=!0);d.precision=l+=10,n=a=s=new d(1),u=0,c++}o=s}}function ET(e,t){var n,r,i,a,o,s,l,c,u,h,d,f=1,p=e,m=p.d,g=p.constructor,v=g.rounding,y=g.precision;if(p.s<0||!m||!m[0]||!p.e&&1==m[0]&&1==m.length)return new g(m&&!m[0]?-1/0:1!=p.s?NaN:m?0:p);if(null==t?(YA=!1,u=y):u=t,g.precision=u+=10,r=(n=uT(m)).charAt(0),!(Math.abs(a=p.e)<15e14))return c=yT(g,u+2,y).times(a+""),p=ET(new g(r+"."+n.slice(1)),u-10).plus(c),g.precision=y,null==t?mT(p,y,v,YA=!0):p;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=uT((p=p.times(e)).d)).charAt(0),f++;for(a=p.e,r>1?(p=new g("0."+n),a++):p=new g(r+"."+n.slice(1)),h=p,l=o=p=pT(p.minus(1),p.plus(1),u,1),d=mT(p.times(p),u,1),i=3;;){if(o=mT(o.times(d),u,1),uT((c=l.plus(pT(o,new g(i),u,1))).d).slice(0,u)===uT(l.d).slice(0,u)){if(l=l.times(2),0!==a&&(l=l.plus(yT(g,u+2,y).times(a+""))),l=pT(l,new g(f),u,1),null!=t)return g.precision=y,l;if(!dT(l.d,u-10,v,s))return mT(l,g.precision=y,v,YA=!0);g.precision=u+=10,c=o=p=pT(h.minus(1),h.plus(1),u,1),d=mT(p.times(p),u,1),i=s=1}l=c,i+=2}}function CT(e){return String(e.s*e.s/0)}function AT(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);r++);for(i=t.length;48===t.charCodeAt(i-1);--i);if(t=t.slice(r,i)){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%7,n<0&&(r+=7),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=7;r<i;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=i;for(;r--;)t+="0";e.d.push(+t),YA&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function TT(e,t){var n,r,i,a,o,s,l,c,u;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),aT.test(t))return AT(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(rT.test(t))n=16,t=t.toLowerCase();else if(nT.test(t))n=2;else{if(!iT.test(t))throw Error(KA+t);n=8}for((a=t.search(/p/i))>0?(l=+t.slice(a+1),t=t.substring(2,a)):t=t.slice(2),o=(a=t.indexOf("."))>=0,r=e.constructor,o&&(a=(s=(t=t.replace(".","")).length)-a,i=wT(r,new r(n),a,2*a)),a=u=(c=fT(t,n,oT)).length-1;0===c[a];--a)c.pop();return a<0?new r(0*e.s):(e.e=vT(c,u),e.d=c,YA=!1,o&&(e=pT(e,i,4*s)),l&&(e=e.times(Math.abs(l)<54?tT(2,l):_N.pow(2,l))),YA=!0,e)}function NT(e,t,n,r,i){var a,o,s,l,c=e.precision,u=Math.ceil(c/7);for(YA=!1,l=n.times(n),s=new e(r);;){if(o=pT(s.times(l),new e(t++*t++),c,1),s=i?r.plus(o):r.minus(o),r=pT(o.times(l),new e(t++*t++),c,1),void 0!==(o=s.plus(r)).d[u]){for(a=u;o.d[a]===s.d[a]&&a--;);if(-1==a)break}a=s,s=r,r=o,o=a}return YA=!0,o.d.length=u+1,o}function RT(e,t){for(var n=e;--t;)n*=e;return n}function PT(e,t){var n,r=t.s<0,i=xT(e,e.precision,1),a=i.times(.5);if((t=t.abs()).lte(a))return HA=r?4:1,t;if((n=t.divToInt(i)).isZero())HA=r?3:2;else{if((t=t.minus(n.times(i))).lte(a))return HA=ST(n)?r?2:3:r?4:1,t;HA=ST(n)?r?1:4:r?3:2}return t.minus(i).abs()}function FT(e,t,n,r){var i,a,o,s,l,c,u,h,d,f=e.constructor,p=void 0!==n;if(p?(hT(n,1,GA),void 0===r?r=f.rounding:hT(r,0,8)):(n=f.precision,r=f.rounding),e.isFinite()){for(p?(i=2,16==t?n=4*n-3:8==t&&(n=3*n-2)):i=t,(o=(u=gT(e)).indexOf("."))>=0&&(u=u.replace(".",""),(d=new f(1)).e=u.length-o,d.d=fT(gT(d),10,i),d.e=d.d.length),a=l=(h=fT(u,10,i)).length;0==h[--l];)h.pop();if(h[0]){if(o<0?a--:((e=new f(e)).d=h,e.e=a,h=(e=pT(e,d,n,r,0,i)).d,a=e.e,c=zA),o=h[n],s=i/2,c=c||void 0!==h[n+1],c=r<4?(void 0!==o||c)&&(0===r||r===(e.s<0?3:2)):o>s||o===s&&(4===r||c||6===r&&1&h[n-1]||r===(e.s<0?8:7)),h.length=n,c)for(;++h[--n]>i-1;)h[n]=0,n||(++a,h.unshift(1));for(l=h.length;!h[l-1];--l);for(o=0,u="";o<l;o++)u+=qA.charAt(h[o]);if(p){if(l>1)if(16==t||8==t){for(o=16==t?4:3,--l;l%o;l++)u+="0";for(l=(h=fT(u,i,t)).length;!h[l-1];--l);for(o=1,u="1.";o<l;o++)u+=qA.charAt(h[o])}else u=u.charAt(0)+"."+u.slice(1);u=u+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)u="0"+u;u="0."+u}else if(++a>l)for(a-=l;a--;)u+="0";else a<l&&(u=u.slice(0,a)+"."+u.slice(a))}else u=p?"0p+0":"0";u=(16==t?"0x":2==t?"0b":8==t?"0o":"")+u}else u=CT(e);return e.s<0?"-"+u:u}function OT(e,t){if(e.length>t)return e.length=t,!0}function IT(e){return new this(e).abs()}function BT(e){return new this(e).acos()}function kT(e){return new this(e).acosh()}function LT(e,t){return new this(e).plus(t)}function UT(e){return new this(e).asin()}function zT(e){return new this(e).asinh()}function HT(e){return new this(e).atan()}function VT(e){return new this(e).atanh()}function GT(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,a=r+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(n=t.s<0?xT(this,r,i):new this(0)).s=e.s:!e.d||t.isZero()?(n=xT(this,a,1).times(.5)).s=e.s:t.s<0?(this.precision=a,this.rounding=1,n=this.atan(pT(e,t,a,1)),t=xT(this,a,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(pT(e,t,a,1)):(n=xT(this,a,1).times(t.s>0?.25:.75)).s=e.s:n=new this(NaN),n}function qT(e){return new this(e).cbrt()}function jT(e){return mT(e=new this(e),e.e+1,2)}function WT(e,t,n){return new this(e).clamp(t,n)}function XT(e){if(!e||"object"!==typeof e)throw Error(ZA+"Object expected");var t,n,r,i=!0===e.defaults,a=["precision",1,GA,"rounding",0,8,"toExpNeg",-VA,0,"toExpPos",0,VA,"maxE",0,VA,"minE",-VA,0,"modulo",0,9];for(t=0;t<a.length;t+=3)if(n=a[t],i&&(this[n]=XA[n]),void 0!==(r=e[n])){if(!(eT(r)===r&&r>=a[t+1]&&r<=a[t+2]))throw Error(KA+n+": "+r);this[n]=r}if(n="crypto",i&&(this[n]=XA[n]),void 0!==(r=e[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(KA+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(JA);this[n]=!0}else this[n]=!1}return this}function YT(e){return new this(e).cos()}function ZT(e){return new this(e).cosh()}function KT(e,t){return new this(e).div(t)}function QT(e){return new this(e).exp()}function JT(e){return mT(e=new this(e),e.e+1,3)}function $T(){var e,t,n=new this(0);for(YA=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return YA=!0,new this(1/0);n=t}return YA=!0,n.sqrt()}function eN(e){return e instanceof _N||e&&e.toStringTag===$A||!1}function tN(e){return new this(e).ln()}function nN(e,t){return new this(e).log(t)}function rN(e){return new this(e).log(2)}function iN(e){return new this(e).log(10)}function aN(){return MT(this,arguments,-1)}function oN(){return MT(this,arguments,1)}function sN(e,t){return new this(e).mod(t)}function lN(e,t){return new this(e).mul(t)}function cN(e,t){return new this(e).pow(t)}function uN(e){var t,n,r,i,a=0,o=new this(1),s=[];if(void 0===e?e=this.precision:hT(e,1,GA),r=Math.ceil(e/7),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));a<r;)(i=t[a])>=429e7?t[a]=crypto.getRandomValues(new Uint32Array(1))[0]:s[a++]=i%1e7;else{if(!crypto.randomBytes)throw Error(JA);for(t=crypto.randomBytes(r*=4);a<r;)(i=t[a]+(t[a+1]<<8)+(t[a+2]<<16)+((127&t[a+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,a):(s.push(i%1e7),a+=4);a=r/4}else for(;a<r;)s[a++]=1e7*Math.random()|0;for(e%=7,(r=s[--a])&&e&&(i=tT(10,7-e),s[a]=(r/i|0)*i);0===s[a];a--)s.pop();if(a<0)n=0,s=[0];else{for(n=-1;0===s[0];n-=7)s.shift();for(r=1,i=s[0];i>=10;i/=10)r++;r<7&&(n-=7-r)}return o.e=n,o.d=s,o}function hN(e){return mT(e=new this(e),e.e+1,this.rounding)}function dN(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function fN(e){return new this(e).sin()}function pN(e){return new this(e).sinh()}function mN(e){return new this(e).sqrt()}function gN(e,t){return new this(e).sub(t)}function vN(){var e=0,t=arguments,n=new this(t[e]);for(YA=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return YA=!0,mT(n,this.precision,this.rounding)}function yN(e){return new this(e).tan()}function xN(e){return new this(e).tanh()}function bN(e){return mT(e=new this(e),e.e+1,1)}cT[Symbol.for("nodejs.util.inspect.custom")]=cT.toString,cT[Symbol.toStringTag]="Decimal";var _N=cT.constructor=function e(t){var n,r,i;function a(e){var t,n,r,i=this;if(!(i instanceof a))return new a(e);if(i.constructor=a,eN(e))return i.s=e.s,void(YA?!e.d||e.e>a.maxE?(i.e=NaN,i.d=null):e.e<a.minE?(i.e=0,i.d=[0]):(i.e=e.e,i.d=e.d.slice()):(i.e=e.e,i.d=e.d?e.d.slice():e.d));if("number"===(r=typeof e)){if(0===e)return i.s=1/e<0?-1:1,i.e=0,void(i.d=[0]);if(e<0?(e=-e,i.s=-1):i.s=1,e===~~e&&e<1e7){for(t=0,n=e;n>=10;n/=10)t++;return void(YA?t>a.maxE?(i.e=NaN,i.d=null):t<a.minE?(i.e=0,i.d=[0]):(i.e=t,i.d=[e]):(i.e=t,i.d=[e]))}return 0*e!==0?(e||(i.s=NaN),i.e=NaN,void(i.d=null)):AT(i,e.toString())}if("string"===r)return 45===(n=e.charCodeAt(0))?(e=e.slice(1),i.s=-1):(43===n&&(e=e.slice(1)),i.s=1),aT.test(e)?AT(i,e):TT(i,e);if("bigint"===r)return e<0?(e=-e,i.s=-1):i.s=1,AT(i,e.toString());throw Error(KA+e)}if(a.prototype=cT,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.EUCLID=9,a.config=a.set=XT,a.clone=e,a.isDecimal=eN,a.abs=IT,a.acos=BT,a.acosh=kT,a.add=LT,a.asin=UT,a.asinh=zT,a.atan=HT,a.atanh=VT,a.atan2=GT,a.cbrt=qT,a.ceil=jT,a.clamp=WT,a.cos=YT,a.cosh=ZT,a.div=KT,a.exp=QT,a.floor=JT,a.hypot=$T,a.ln=tN,a.log=nN,a.log10=iN,a.log2=rN,a.max=aN,a.min=oN,a.mod=sN,a.mul=lN,a.pow=cN,a.random=uN,a.round=hN,a.sign=dN,a.sin=fN,a.sinh=pN,a.sqrt=mN,a.sub=gN,a.sum=vN,a.tan=yN,a.tanh=xN,a.trunc=bN,void 0===t&&(t={}),t&&!0!==t.defaults)for(i=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<i.length;)t.hasOwnProperty(r=i[n++])||(t[r]=this[r]);return a.config(t),a}(XA);jA=new _N(jA),WA=new _N(WA);const wN=_N;function SN(e,t,n,r){function i(r){var i=function(e,t){for(var n={},r=0;r<t.length;r++){var i=t[r],a=e[i];void 0!==a&&(n[i]=a)}return n}(r,t.map(DN));return function(e,t,n){var r=t.filter((e=>!function(e){return e&&"?"===e[0]}(e))).every((e=>void 0!==n[e]));if(!r){var i=t.filter((e=>void 0===n[e]));throw new Error('Cannot create function "'.concat(e,'", ')+"some dependencies are missing: ".concat(i.map((e=>'"'.concat(e,'"'))).join(", "),"."))}}(e,t,r),n(i)}return i.isFactory=!0,i.fn=e,i.dependencies=t.slice().sort(),r&&(i.meta=r),i}function MN(e){return"function"===typeof e&&"string"===typeof e.fn&&Array.isArray(e.dependencies)}function DN(e){return e&&"?"===e[0]?e.slice(1):e}var EN=SN("BigNumber",["?on","config"],(e=>{var{on:t,config:n}=e,r=wN.clone({precision:n.precision,modulo:wN.EUCLID});return r.prototype=Object.create(r.prototype),r.prototype.type="BigNumber",r.prototype.isBigNumber=!0,r.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},r.fromJSON=function(e){return new r(e.value)},t&&t("config",(function(e,t){e.precision!==t.precision&&r.config({precision:e.precision})})),r}),{isClass:!0});const CN=Math.cosh||function(e){return Math.abs(e)<1e-9?1-e:.5*(Math.exp(e)+Math.exp(-e))},AN=Math.sinh||function(e){return Math.abs(e)<1e-9?e:.5*(Math.exp(e)-Math.exp(-e))},TN=function(e,t){return(e=Math.abs(e))<(t=Math.abs(t))&&([e,t]=[t,e]),e<1e8?Math.sqrt(e*e+t*t):(t/=e,e*Math.sqrt(1+t*t))},NN=function(){throw SyntaxError("Invalid Param")};function RN(e,t){const n=Math.abs(e),r=Math.abs(t);return 0===e?Math.log(r):0===t?Math.log(n):n<3e3&&r<3e3?.5*Math.log(e*e+t*t):(e*=.5,t*=.5,.5*Math.log(e*e+t*t)+Math.LN2)}const PN={re:0,im:0},FN=function(e,t){const n=PN;if(void 0===e||null===e)n.re=n.im=0;else if(void 0!==t)n.re=e,n.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)n.re=e.re,n.im=e.im;else if("abs"in e&&"arg"in e){if(!isFinite(e.abs)&&isFinite(e.arg))return ON.INFINITY;n.re=e.abs*Math.cos(e.arg),n.im=e.abs*Math.sin(e.arg)}else if("r"in e&&"phi"in e){if(!isFinite(e.r)&&isFinite(e.phi))return ON.INFINITY;n.re=e.r*Math.cos(e.phi),n.im=e.r*Math.sin(e.phi)}else 2===e.length?(n.re=e[0],n.im=e[1]):NN();break;case"string":n.im=n.re=0;const t=e.replace(/_/g,"").match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g);let r=1,i=0;null===t&&NN();for(let e=0;e<t.length;e++){const a=t[e];" "===a||"\t"===a||"\n"===a||("+"===a?r++:"-"===a?i++:"i"===a||"I"===a?(r+i===0&&NN()," "===t[e+1]||isNaN(t[e+1])?n.im+=parseFloat((i%2?"-":"")+"1"):(n.im+=parseFloat((i%2?"-":"")+t[e+1]),e++),r=i=0):((r+i===0||isNaN(a))&&NN(),"i"===t[e+1]||"I"===t[e+1]?(n.im+=parseFloat((i%2?"-":"")+a),e++):n.re+=parseFloat((i%2?"-":"")+a),r=i=0))}r+i>0&&NN();break;case"number":n.im=0,n.re=e;break;default:NN()}return isNaN(n.re)||isNaN(n.im),n};function ON(e,t){if(!(this instanceof ON))return new ON(e,t);const n=FN(e,t);this.re=n.re,this.im=n.im}function IN(e){return"boolean"===typeof e||!!isFinite(e)&&e===Math.round(e)}function BN(e,t){if("bigint"===t.number)try{BigInt(e)}catch(n){return t.numberFallback}return t.number}ON.prototype={re:0,im:0,sign:function(){const e=TN(this.re,this.im);return new ON(this.re/e,this.im/e)},add:function(e,t){const n=FN(e,t),r=this.isInfinite(),i=!(isFinite(n.re)&&isFinite(n.im));return r||i?r&&i?ON.NAN:ON.INFINITY:new ON(this.re+n.re,this.im+n.im)},sub:function(e,t){const n=FN(e,t),r=this.isInfinite(),i=!(isFinite(n.re)&&isFinite(n.im));return r||i?r&&i?ON.NAN:ON.INFINITY:new ON(this.re-n.re,this.im-n.im)},mul:function(e,t){const n=FN(e,t),r=this.isInfinite(),i=!(isFinite(n.re)&&isFinite(n.im)),a=0===this.re&&0===this.im,o=0===n.re&&0===n.im;return r&&o||i&&a?ON.NAN:r||i?ON.INFINITY:0===n.im&&0===this.im?new ON(this.re*n.re,0):new ON(this.re*n.re-this.im*n.im,this.re*n.im+this.im*n.re)},div:function(e,t){const n=FN(e,t),r=this.isInfinite(),i=!(isFinite(n.re)&&isFinite(n.im)),a=0===this.re&&0===this.im,o=0===n.re&&0===n.im;if(a&&o||r&&i)return ON.NAN;if(o||r)return ON.INFINITY;if(a||i)return ON.ZERO;if(0===n.im)return new ON(this.re/n.re,this.im/n.re);if(Math.abs(n.re)<Math.abs(n.im)){const e=n.re/n.im,t=n.re*e+n.im;return new ON((this.re*e+this.im)/t,(this.im*e-this.re)/t)}{const e=n.im/n.re,t=n.im*e+n.re;return new ON((this.re+this.im*e)/t,(this.im-this.re*e)/t)}},pow:function(e,t){const n=FN(e,t),r=0===this.re&&0===this.im;if(0===n.re&&0===n.im)return ON.ONE;if(0===n.im){if(0===this.im&&this.re>0)return new ON(Math.pow(this.re,n.re),0);if(0===this.re)switch((n.re%4+4)%4){case 0:return new ON(Math.pow(this.im,n.re),0);case 1:return new ON(0,Math.pow(this.im,n.re));case 2:return new ON(-Math.pow(this.im,n.re),0);case 3:return new ON(0,-Math.pow(this.im,n.re))}}if(r&&n.re>0)return ON.ZERO;const i=Math.atan2(this.im,this.re),a=RN(this.re,this.im);let o=Math.exp(n.re*a-n.im*i),s=n.im*a+n.re*i;return new ON(o*Math.cos(s),o*Math.sin(s))},sqrt:function(){const e=this.re,t=this.im;if(0===t)return e>=0?new ON(Math.sqrt(e),0):new ON(0,Math.sqrt(-e));const n=TN(e,t);let r=Math.sqrt(.5*(n+Math.abs(e))),i=Math.abs(t)/(2*r);return e>=0?new ON(r,t<0?-i:i):new ON(i,t<0?-r:r)},exp:function(){const e=Math.exp(this.re);return 0===this.im?new ON(e,0):new ON(e*Math.cos(this.im),e*Math.sin(this.im))},expm1:function(){const e=this.re,t=this.im;return new ON(Math.expm1(e)*Math.cos(t)+function(e){const t=Math.PI/4;if(-t>e||e>t)return Math.cos(e)-1;const n=e*e;return n*(n*(n*(n*(n*(n*(n*(n/20922789888e3-1/87178291200)+1/479001600)-1/3628800)+1/40320)-1/720)+1/24)-.5)}(t),Math.exp(e)*Math.sin(t))},log:function(){const e=this.re,t=this.im;return 0===t&&e>0?new ON(Math.log(e),0):new ON(RN(e,t),Math.atan2(t,e))},abs:function(){return TN(this.re,this.im)},arg:function(){return Math.atan2(this.im,this.re)},sin:function(){const e=this.re,t=this.im;return new ON(Math.sin(e)*CN(t),Math.cos(e)*AN(t))},cos:function(){const e=this.re,t=this.im;return new ON(Math.cos(e)*CN(t),-Math.sin(e)*AN(t))},tan:function(){const e=2*this.re,t=2*this.im,n=Math.cos(e)+CN(t);return new ON(Math.sin(e)/n,AN(t)/n)},cot:function(){const e=2*this.re,t=2*this.im,n=Math.cos(e)-CN(t);return new ON(-Math.sin(e)/n,AN(t)/n)},sec:function(){const e=this.re,t=this.im,n=.5*CN(2*t)+.5*Math.cos(2*e);return new ON(Math.cos(e)*CN(t)/n,Math.sin(e)*AN(t)/n)},csc:function(){const e=this.re,t=this.im,n=.5*CN(2*t)-.5*Math.cos(2*e);return new ON(Math.sin(e)*CN(t)/n,-Math.cos(e)*AN(t)/n)},asin:function(){const e=this.re,t=this.im,n=new ON(t*t-e*e+1,-2*e*t).sqrt(),r=new ON(n.re-t,n.im+e).log();return new ON(r.im,-r.re)},acos:function(){const e=this.re,t=this.im,n=new ON(t*t-e*e+1,-2*e*t).sqrt(),r=new ON(n.re-t,n.im+e).log();return new ON(Math.PI/2-r.im,r.re)},atan:function(){const e=this.re,t=this.im;if(0===e){if(1===t)return new ON(0,1/0);if(-1===t)return new ON(0,-1/0)}const n=e*e+(1-t)*(1-t),r=new ON((1-t*t-e*e)/n,-2*e/n).log();return new ON(-.5*r.im,.5*r.re)},acot:function(){const e=this.re,t=this.im;if(0===t)return new ON(Math.atan2(1,e),0);const n=e*e+t*t;return 0!==n?new ON(e/n,-t/n).atan():new ON(0!==e?e/0:0,0!==t?-t/0:0).atan()},asec:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new ON(0,1/0);const n=e*e+t*t;return 0!==n?new ON(e/n,-t/n).acos():new ON(0!==e?e/0:0,0!==t?-t/0:0).acos()},acsc:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new ON(Math.PI/2,1/0);const n=e*e+t*t;return 0!==n?new ON(e/n,-t/n).asin():new ON(0!==e?e/0:0,0!==t?-t/0:0).asin()},sinh:function(){const e=this.re,t=this.im;return new ON(AN(e)*Math.cos(t),CN(e)*Math.sin(t))},cosh:function(){const e=this.re,t=this.im;return new ON(CN(e)*Math.cos(t),AN(e)*Math.sin(t))},tanh:function(){const e=2*this.re,t=2*this.im,n=CN(e)+Math.cos(t);return new ON(AN(e)/n,Math.sin(t)/n)},coth:function(){const e=2*this.re,t=2*this.im,n=CN(e)-Math.cos(t);return new ON(AN(e)/n,-Math.sin(t)/n)},csch:function(){const e=this.re,t=this.im,n=Math.cos(2*t)-CN(2*e);return new ON(-2*AN(e)*Math.cos(t)/n,2*CN(e)*Math.sin(t)/n)},sech:function(){const e=this.re,t=this.im,n=Math.cos(2*t)+CN(2*e);return new ON(2*CN(e)*Math.cos(t)/n,-2*AN(e)*Math.sin(t)/n)},asinh:function(){let e=this.im;this.im=-this.re,this.re=e;const t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){const e=this.acos();if(e.im<=0){const t=e.re;e.re=-e.im,e.im=t}else{const t=e.im;e.im=-e.re,e.re=t}return e},atanh:function(){const e=this.re,t=this.im,n=e>1&&0===t,r=1-e,i=1+e,a=r*r+t*t,o=0!==a?new ON((i*r-t*t)/a,(t*r+i*t)/a):new ON(-1!==e?e/0:0,0!==t?t/0:0),s=o.re;return o.re=RN(o.re,o.im)/2,o.im=Math.atan2(o.im,s)/2,n&&(o.im=-o.im),o},acoth:function(){const e=this.re,t=this.im;if(0===e&&0===t)return new ON(0,Math.PI/2);const n=e*e+t*t;return 0!==n?new ON(e/n,-t/n).atanh():new ON(0!==e?e/0:0,0!==t?-t/0:0).atanh()},acsch:function(){const e=this.re,t=this.im;if(0===t)return new ON(0!==e?Math.log(e+Math.sqrt(e*e+1)):1/0,0);const n=e*e+t*t;return 0!==n?new ON(e/n,-t/n).asinh():new ON(0!==e?e/0:0,0!==t?-t/0:0).asinh()},asech:function(){const e=this.re,t=this.im;if(this.isZero())return ON.INFINITY;const n=e*e+t*t;return 0!==n?new ON(e/n,-t/n).acosh():new ON(0!==e?e/0:0,0!==t?-t/0:0).acosh()},inverse:function(){if(this.isZero())return ON.INFINITY;if(this.isInfinite())return ON.ZERO;const e=this.re,t=this.im,n=e*e+t*t;return new ON(e/n,-t/n)},conjugate:function(){return new ON(this.re,-this.im)},neg:function(){return new ON(-this.re,-this.im)},ceil:function(e){return e=Math.pow(10,e||0),new ON(Math.ceil(this.re*e)/e,Math.ceil(this.im*e)/e)},floor:function(e){return e=Math.pow(10,e||0),new ON(Math.floor(this.re*e)/e,Math.floor(this.im*e)/e)},round:function(e){return e=Math.pow(10,e||0),new ON(Math.round(this.re*e)/e,Math.round(this.im*e)/e)},equals:function(e,t){const n=FN(e,t);return Math.abs(n.re-this.re)<=ON.EPSILON&&Math.abs(n.im-this.im)<=ON.EPSILON},clone:function(){return new ON(this.re,this.im)},toString:function(){let e=this.re,t=this.im,n="";return this.isNaN()?"NaN":this.isInfinite()?"Infinity":(Math.abs(e)<ON.EPSILON&&(e=0),Math.abs(t)<ON.EPSILON&&(t=0),0===t?n+e:(0!==e?(n+=e,n+=" ",t<0?(t=-t,n+="-"):n+="+",n+=" "):t<0&&(t=-t,n+="-"),1!==t&&(n+=t),n+"i"))},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return 0===this.im&&0===this.re},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!this.isFinite()}},ON.ZERO=new ON(0,0),ON.ONE=new ON(1,0),ON.I=new ON(0,1),ON.PI=new ON(Math.PI,0),ON.E=new ON(Math.E,0),ON.INFINITY=new ON(1/0,1/0),ON.NAN=new ON(NaN,NaN),ON.EPSILON=1e-15;var kN=Math.sign||function(e){return e>0?1:e<0?-1:0},LN=Math.log2||function(e){return Math.log(e)/Math.LN2},UN=Math.log10||function(e){return Math.log(e)/Math.LN10},zN=Math.log1p||function(e){return Math.log(e+1)},HN=Math.cbrt||function(e){if(0===e)return e;var t,n=e<0;return n&&(e=-e),t=isFinite(e)?(e/((t=Math.exp(Math.log(e)/3))*t)+2*t)/3:e,n?-t:t},VN=Math.expm1||function(e){return e>=2e-4||e<=-2e-4?Math.exp(e)-1:e+e*e/2+e*e*e/6};function GN(e,t,n){var r={2:"0b",8:"0o",16:"0x"}[t],i="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!IN(n))throw new Error("size must be an integer");if(e>2**(n-1)-1||e<-(2**(n-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!IN(e))throw new Error("Value must be an integer");e<0&&(e+=2**n),i="i".concat(n)}var a="";return e<0&&(e=-e,a="-"),"".concat(a).concat(r).concat(e.toString(t)).concat(i)}function qN(e,t){if("function"===typeof t)return t(e);if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(isNaN(e))return"NaN";var{notation:n,precision:r,wordSize:i}=jN(t);switch(n){case"fixed":return XN(e,r);case"exponential":return YN(e,r);case"engineering":return function(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=WN(e),r=ZN(n,t),i=r.exponent,a=r.coefficients,o=i%3===0?i:i<0?i-3-i%3:i-i%3;if(BC(t))for(;t>a.length||i-o+1>a.length;)a.push(0);else for(var s=Math.abs(i-o)-(a.length-1),l=0;l<s;l++)a.push(0);var c=Math.abs(i-o),u=1;for(;c>0;)u++,c--;var h=a.slice(u).join(""),d=BC(t)&&h.length||h.match(/[1-9]/)?"."+h:"",f=a.slice(0,u).join("")+d+"e"+(i>=0?"+":"")+o.toString();return r.sign+f}(e,r);case"bin":return GN(e,2,i);case"oct":return GN(e,8,i);case"hex":return GN(e,16,i);case"auto":return function(e,t,n){if(isNaN(e)||!isFinite(e))return String(e);var r=aR(null===n||void 0===n?void 0:n.lowerExp,-3),i=aR(null===n||void 0===n?void 0:n.upperExp,5),a=WN(e),o=t?ZN(a,t):a;if(o.exponent<r||o.exponent>=i)return YN(e,t);var s=o.coefficients,l=o.exponent;s.length<t&&(s=s.concat(KN(t-s.length))),s=s.concat(KN(l-s.length+1+(s.length<t?t-s.length:0)));var c=l>0?l:0;return c<(s=KN(-l).concat(s)).length-1&&s.splice(c+1,0,"."),o.sign+s.join("")}(e,r,t).replace(/((\.\d*?)(0+))($|e)/,(function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t}));default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function jN(e){var t,n,r="auto";if(void 0!==e)if(BC(e))t=e;else if(kC(e))t=e.toNumber();else{if(!nA(e))throw new Error("Unsupported type of options, number, BigNumber, or object expected");void 0!==e.precision&&(t=iR(e.precision,(()=>{throw new Error('Option "precision" must be a number or BigNumber')}))),void 0!==e.wordSize&&(n=iR(e.wordSize,(()=>{throw new Error('Option "wordSize" must be a number or BigNumber')}))),e.notation&&(r=e.notation)}return{notation:r,precision:t,wordSize:n}}function WN(e){var t=String(e).toLowerCase().match(/^(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var n=t[1],r=t[2],i=parseFloat(t[4]||"0"),a=r.indexOf(".");i+=-1!==a?a-1:r.length-1;var o=r.replace(".","").replace(/^0*/,(function(e){return i-=e.length,""})).replace(/0*$/,"").split("").map((function(e){return parseInt(e)}));return 0===o.length&&(o.push(0),i++),{sign:n,coefficients:o,exponent:i}}function XN(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=WN(e),r="number"===typeof t?ZN(n,n.exponent+1+t):n,i=r.coefficients,a=r.exponent+1,o=a+(t||0);return i.length<o&&(i=i.concat(KN(o-i.length))),a<0&&(i=KN(1-a).concat(i),a=1),a<i.length&&i.splice(a,0,0===a?"0.":"."),r.sign+i.join("")}function YN(e,t){if(isNaN(e)||!isFinite(e))return String(e);var n=WN(e),r=t?ZN(n,t):n,i=r.coefficients,a=r.exponent;i.length<t&&(i=i.concat(KN(t-i.length)));var o=i.shift();return r.sign+o+(i.length>0?"."+i.join(""):"")+"e"+(a>=0?"+":"")+a}function ZN(e,t){for(var n={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},r=n.coefficients;t<=0;)r.unshift(0),n.exponent++,t++;if(r.length>t&&r.splice(t,r.length-t)[0]>=5){var i=t-1;for(r[i]++;10===r[i];)r.pop(),0===i&&(r.unshift(0),n.exponent++,i++),r[--i]++}return n}function KN(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}function QN(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(n<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return!isNaN(e)&&!isNaN(t)&&(isFinite(e)&&isFinite(t)?e===t||Math.abs(e-t)<=Math.max(n*Math.max(Math.abs(e),Math.abs(t)),r):e===t)}var JN=Math.acosh||function(e){return Math.log(Math.sqrt(e*e-1)+e)},$N=Math.asinh||function(e){return Math.log(Math.sqrt(e*e+1)+e)},eR=Math.atanh||function(e){return Math.log((1+e)/(1-e))/2},tR=Math.cosh||function(e){return(Math.exp(e)+Math.exp(-e))/2},nR=Math.sinh||function(e){return(Math.exp(e)-Math.exp(-e))/2},rR=Math.tanh||function(e){var t=Math.exp(2*e);return(t-1)/(t+1)};function iR(e,t){return BC(e)?e:kC(e)?e.toNumber():void t()}function aR(e,t){return BC(e)?e:kC(e)?e.toNumber():t}var oR=SN("Complex",[],(()=>(Object.defineProperty(ON,"name",{value:"Complex"}),ON.prototype.constructor=ON,ON.prototype.type="Complex",ON.prototype.isComplex=!0,ON.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},ON.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},ON.prototype.format=function(e){var t=this.im,n=this.re,r=qN(this.re,e),i=qN(this.im,e),a=BC(e)?e:e?e.precision:null;if(null!==a){var o=Math.pow(10,-a);Math.abs(n/t)<o&&(n=0),Math.abs(t/n)<o&&(t=0)}return 0===t?r:0===n?1===t?"i":-1===t?"-i":i+"i":t<0?-1===t?r+" - i":r+" - "+i.substring(1)+"i":1===t?r+" + i":r+" + "+i+"i"},ON.fromPolar=function(e){switch(arguments.length){case 1:var t=arguments[0];if("object"===typeof t)return ON(t);throw new TypeError("Input has to be an object with r and phi keys.");case 2:var n=arguments[0],r=arguments[1];if(BC(n)){if(HC(r)&&r.hasBase("ANGLE")&&(r=r.toNumber("rad")),BC(r))return new ON({r:n,phi:r});throw new TypeError("Phi is not a number nor an angle unit.")}throw new TypeError("Radius r is not a number.");default:throw new SyntaxError("Wrong number of arguments in function fromPolar")}},ON.prototype.valueOf=ON.prototype.toString,ON.fromJSON=function(e){return new ON(e)},ON.compare=function(e,t){return e.re>t.re?1:e.re<t.re?-1:e.im>t.im?1:e.im<t.im?-1:0},ON)),{isClass:!0});function sR(e){var t=0,n=1,r=Object.create(null),i=Object.create(null),a=0,o=function(e){var o=i[e];if(o&&(delete r[o],delete i[e],--t,n===o)){if(!t)return a=0,void(n=1);for(;!Object.prototype.hasOwnProperty.call(r,++n););}};return e=Math.abs(e),{hit:function(s){var l=i[s],c=++a;if(r[c]=s,i[s]=c,!l){if(++t<=e)return;return s=r[n],o(s),s}if(delete r[l],n===l)for(;!Object.prototype.hasOwnProperty.call(r,++n););},delete:o,clear:function(){t=a=0,n=1,r=Object.create(null),i=Object.create(null)}}}function lR(e){var{hasher:t,limit:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=null==n?Number.POSITIVE_INFINITY:n,t=null==t?JSON.stringify:t,function r(){"object"!==typeof r.cache&&(r.cache={values:new Map,lru:sR(n||Number.POSITIVE_INFINITY)});for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=t(i);if(r.cache.values.has(o))return r.cache.lru.hit(o),r.cache.values.get(o);var s=e.apply(e,i);return r.cache.values.set(o,s),r.cache.values.delete(r.cache.lru.hit(o)),s}}var cR=lR((function(e){return new e(1).exp()}),{hasher:fR}),uR=lR((function(e){return new e(1).plus(new e(5).sqrt()).div(2)}),{hasher:fR}),hR=lR((function(e){return e.acos(-1)}),{hasher:fR}),dR=lR((function(e){return hR(e).times(2)}),{hasher:fR});function fR(e){return e[0].precision}var pR=Math.PI,mR=2*Math.PI,gR=Math.E,vR=SN("true",[],(()=>!0)),yR=SN("false",[],(()=>!1)),xR=SN("null",[],(()=>null)),bR=BR("Infinity",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(1/0):1/0})),_R=BR("NaN",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(NaN):NaN})),wR=BR("pi",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?hR(n):pR})),SR=BR("tau",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?dR(n):mR})),MR=BR("e",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?cR(n):gR})),DR=BR("phi",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?uR(n):1.618033988749895})),ER=BR("LN2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(2).ln():Math.LN2})),CR=BR("LN10",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(10).ln():Math.LN10})),AR=BR("LOG2E",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(1).div(new n(2).ln()):Math.LOG2E})),TR=BR("LOG10E",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(1).div(new n(10).ln()):Math.LOG10E})),NR=BR("SQRT1_2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n("0.5").sqrt():Math.SQRT1_2})),RR=BR("SQRT2",["config","?BigNumber"],(e=>{var{config:t,BigNumber:n}=e;return"BigNumber"===t.number?new n(2).sqrt():Math.SQRT2})),PR=BR("i",["Complex"],(e=>{var{Complex:t}=e;return t.I})),FR=SN("PI",["pi"],(e=>{var{pi:t}=e;return t})),OR=SN("E",["e"],(e=>{var{e:t}=e;return t})),IR=SN("version",[],(()=>"14.4.0"));function BR(e,t,n){return SN(e,t,n,{recreateOnConfigChange:!0})}var kR=FP("speedOfLight","299792458","m s^-1"),LR=FP("gravitationConstant","6.67430e-11","m^3 kg^-1 s^-2"),UR=FP("planckConstant","6.62607015e-34","J s"),zR=FP("reducedPlanckConstant","1.0545718176461565e-34","J s"),HR=FP("magneticConstant","1.25663706212e-6","N A^-2"),VR=FP("electricConstant","8.8541878128e-12","F m^-1"),GR=FP("vacuumImpedance","376.730313667","ohm"),qR=FP("coulomb","8.987551792261171e9","N m^2 C^-2"),jR=FP("elementaryCharge","1.602176634e-19","C"),WR=FP("bohrMagneton","9.2740100783e-24","J T^-1"),XR=FP("conductanceQuantum","7.748091729863649e-5","S"),YR=FP("inverseConductanceQuantum","12906.403729652257","ohm"),ZR=FP("magneticFluxQuantum","2.0678338484619295e-15","Wb"),KR=FP("nuclearMagneton","5.0507837461e-27","J T^-1"),QR=FP("klitzing","25812.807459304513","ohm"),JR=FP("bohrRadius","5.29177210903e-11","m"),$R=FP("classicalElectronRadius","2.8179403262e-15","m"),eP=FP("electronMass","9.1093837015e-31","kg"),tP=FP("fermiCoupling","1.1663787e-5","GeV^-2"),nP=OP("fineStructure",.0072973525693),rP=FP("hartreeEnergy","4.3597447222071e-18","J"),iP=FP("protonMass","1.67262192369e-27","kg"),aP=FP("deuteronMass","3.3435830926e-27","kg"),oP=FP("neutronMass","1.6749271613e-27","kg"),sP=FP("quantumOfCirculation","3.6369475516e-4","m^2 s^-1"),lP=FP("rydberg","10973731.568160","m^-1"),cP=FP("thomsonCrossSection","6.6524587321e-29","m^2"),uP=OP("weakMixingAngle",.2229),hP=OP("efimovFactor",22.7),dP=FP("atomicMass","1.66053906660e-27","kg"),fP=FP("avogadro","6.02214076e23","mol^-1"),pP=FP("boltzmann","1.380649e-23","J K^-1"),mP=FP("faraday","96485.33212331001","C mol^-1"),gP=FP("firstRadiation","3.7417718521927573e-16","W m^2"),vP=FP("loschmidt","2.686780111798444e25","m^-3"),yP=FP("gasConstant","8.31446261815324","J K^-1 mol^-1"),xP=FP("molarPlanckConstant","3.990312712893431e-10","J s mol^-1"),bP=FP("molarVolume","0.022413969545014137","m^3 mol^-1"),_P=OP("sackurTetrode",-1.16487052358),wP=FP("secondRadiation","0.014387768775039337","m K"),SP=FP("stefanBoltzmann","5.67037441918443e-8","W m^-2 K^-4"),MP=FP("wienDisplacement","2.897771955e-3","m K"),DP=FP("molarMass","0.99999999965e-3","kg mol^-1"),EP=FP("molarMassC12","11.9999999958e-3","kg mol^-1"),CP=FP("gravity","9.80665","m s^-2"),AP=FP("planckLength","1.616255e-35","m"),TP=FP("planckMass","2.176435e-8","kg"),NP=FP("planckTime","5.391245e-44","s"),RP=FP("planckCharge","1.87554603778e-18","C"),PP=FP("planckTemperature","1.416785e+32","K");function FP(e,t,n){return SN(e,["config","Unit","BigNumber"],(e=>{var{config:r,Unit:i,BigNumber:a}=e,o=new i("BigNumber"===r.number?new a(t):parseFloat(t),n);return o.fixPrefix=!0,o}))}function OP(e,t){return SN(e,["config","BigNumber"],(e=>{var{config:n,BigNumber:r}=e;return"BigNumber"===n.number?new r(t):t}))}"undefined"===typeof BigInt&&(BigInt=function(e){if(isNaN(e))throw new Error("");return e});const IP=BigInt(0),BP=BigInt(1),kP=BigInt(2),LP=BigInt(5),UP=BigInt(10),zP={s:BP,n:IP,d:BP};function HP(e,t){try{e=BigInt(e)}catch(gR){throw KP()}return e*t}function VP(e){return"bigint"===typeof e?e:Math.floor(e)}function GP(e,t){if(t===IP)throw ZP();const n=Object.create(YP.prototype);n.s=e<IP?-BP:BP;const r=XP(e=e<IP?-e:e,t);return n.n=e/r,n.d=t/r,n}function qP(e){const t={};let n=e,r=kP,i=LP-BP;for(;i<=n;){for(;n%r===IP;)n/=r,t[r]=(t[r]||IP)+BP;i+=BP+kP*r++}return n!==e?n>1&&(t[n]=(t[n]||IP)+BP):t[e]=(t[e]||IP)+BP,t}const jP=function(e,t){let n=IP,r=BP,i=BP;if(void 0===e||null===e);else if(void 0!==t){if("bigint"===typeof e)n=e;else{if(isNaN(e))throw KP();if(e%1!==0)throw QP();n=BigInt(e)}if("bigint"===typeof t)r=t;else{if(isNaN(t))throw KP();if(t%1!==0)throw QP();r=BigInt(t)}i=n*r}else if("object"===typeof e){if("d"in e&&"n"in e)n=BigInt(e.n),r=BigInt(e.d),"s"in e&&(n*=BigInt(e.s));else if(0 in e)n=BigInt(e[0]),1 in e&&(r=BigInt(e[1]));else{if("bigint"!==typeof e)throw KP();n=e}i=n*r}else if("number"===typeof e){if(isNaN(e))throw KP();if(e<0&&(i=-BP,e=-e),e%1===0)n=BigInt(e);else{let t=1,i=0,a=1,o=1,s=1,l=1e7;for(e>=1&&(t=10**Math.floor(1+Math.log10(e)),e/=t);a<=l&&s<=l;){let t=(i+o)/(a+s);if(e===t){a+s<=l?(n=i+o,r=a+s):s>a?(n=o,r=s):(n=i,r=a);break}e>t?(i+=o,a+=s):(o+=i,s+=a),a>l?(n=o,r=s):(n=i,r=a)}n=BigInt(n)*BigInt(t),r=BigInt(r)}}else if("string"===typeof e){let t=0,a=IP,o=IP,s=IP,l=BP,c=BP,u=e.replace(/_/g,"").match(/\d+|./g);if(null===u)throw KP();if("-"===u[t]?(i=-BP,t++):"+"===u[t]&&t++,u.length===t+1?o=HP(u[t++],i):"."===u[t+1]||"."===u[t]?("."!==u[t]&&(a=HP(u[t++],i)),t++,(t+1===u.length||"("===u[t+1]&&")"===u[t+3]||"'"===u[t+1]&&"'"===u[t+3])&&(o=HP(u[t],i),l=UP**BigInt(u[t].length),t++),("("===u[t]&&")"===u[t+2]||"'"===u[t]&&"'"===u[t+2])&&(s=HP(u[t+1],i),c=UP**BigInt(u[t+1].length)-BP,t+=3)):"/"===u[t+1]||":"===u[t+1]?(o=HP(u[t],i),l=HP(u[t+2],BP),t+=3):"/"===u[t+3]&&" "===u[t+1]&&(a=HP(u[t],i),o=HP(u[t+2],i),l=HP(u[t+4],BP),t+=5),!(u.length<=t))throw KP();r=l*c,i=n=s+r*a+c*o}else{if("bigint"!==typeof e)throw KP();n=e,i=e,r=BP}if(r===IP)throw ZP();zP.s=i<IP?-BP:BP,zP.n=n<IP?-n:n,zP.d=r<IP?-r:r};function WP(e,t,n){let r=BP,i=function(e,t,n){let r=BP;for(;t>IP;e=e*e%n,t>>=BP)t&BP&&(r=r*e%n);return r}(UP,n,t);for(let a=0;a<300;a++){if(r===i)return BigInt(a);r=r*UP%t,i=i*UP%t}return 0}function XP(e,t){if(!e)return t;if(!t)return e;for(;;){if(!(e%=t))return t;if(!(t%=e))return e}}function YP(e,t){if(jP(e,t),!(this instanceof YP))return GP(zP.s*zP.n,zP.d);e=XP(zP.d,zP.n),this.s=zP.s,this.n=zP.n/e,this.d=zP.d/e}var ZP=function(){return new Error("Division by Zero")},KP=function(){return new Error("Invalid argument")},QP=function(){return new Error("Parameters must be integer")};YP.prototype={s:BP,n:IP,d:BP,abs:function(){return GP(this.n,this.d)},neg:function(){return GP(-this.s*this.n,this.d)},add:function(e,t){return jP(e,t),GP(this.s*this.n*zP.d+zP.s*this.d*zP.n,this.d*zP.d)},sub:function(e,t){return jP(e,t),GP(this.s*this.n*zP.d-zP.s*this.d*zP.n,this.d*zP.d)},mul:function(e,t){return jP(e,t),GP(this.s*zP.s*this.n*zP.n,this.d*zP.d)},div:function(e,t){return jP(e,t),GP(this.s*zP.s*this.n*zP.d,this.d*zP.n)},clone:function(){return GP(this.s*this.n,this.d)},mod:function(e,t){if(void 0===e)return GP(this.s*this.n%this.d,BP);if(jP(e,t),IP===zP.n*this.d)throw ZP();return GP(this.s*(zP.d*this.n)%(zP.n*this.d),zP.d*this.d)},gcd:function(e,t){return jP(e,t),GP(XP(zP.n,this.n)*XP(zP.d,this.d),zP.d*this.d)},lcm:function(e,t){return jP(e,t),zP.n===IP&&this.n===IP?GP(IP,BP):GP(zP.n*this.n,XP(zP.n,this.n)*XP(zP.d,this.d))},inverse:function(){return GP(this.s*this.d,this.n)},pow:function(e,t){if(jP(e,t),zP.d===BP)return zP.s<IP?GP((this.s*this.d)**zP.n,this.n**zP.n):GP((this.s*this.n)**zP.n,this.d**zP.n);if(this.s<IP)return null;let n=qP(this.n),r=qP(this.d),i=BP,a=BP;for(let o in n)if("1"!==o){if("0"===o){i=IP;break}if(n[o]*=zP.n,n[o]%zP.d!==IP)return null;n[o]/=zP.d,i*=BigInt(o)**n[o]}for(let o in r)if("1"!==o){if(r[o]*=zP.n,r[o]%zP.d!==IP)return null;r[o]/=zP.d,a*=BigInt(o)**r[o]}return zP.s<IP?GP(a,i):GP(i,a)},log:function(e,t){if(jP(e,t),this.s<=IP||zP.s<=IP)return null;const n={},r=qP(zP.n),i=qP(zP.d),a=qP(this.n),o=qP(this.d);for(const c in i)r[c]=(r[c]||IP)-i[c];for(const c in o)a[c]=(a[c]||IP)-o[c];for(const c in r)"1"!==c&&(n[c]=!0);for(const c in a)"1"!==c&&(n[c]=!0);let s=null,l=null;for(const c in n){const e=r[c]||IP,t=a[c]||IP;if(e===IP){if(t!==IP)return null;continue}let n=t,i=e;const o=XP(n,i);if(n/=o,i/=o,null===s&&null===l)s=n,l=i;else if(n*l!==s*i)return null}return null!==s&&null!==l?GP(s,l):null},equals:function(e,t){return jP(e,t),this.s*this.n*zP.d===zP.s*zP.n*this.d},lt:function(e,t){return jP(e,t),this.s*this.n*zP.d<zP.s*zP.n*this.d},lte:function(e,t){return jP(e,t),this.s*this.n*zP.d<=zP.s*zP.n*this.d},gt:function(e,t){return jP(e,t),this.s*this.n*zP.d>zP.s*zP.n*this.d},gte:function(e,t){return jP(e,t),this.s*this.n*zP.d>=zP.s*zP.n*this.d},compare:function(e,t){jP(e,t);let n=this.s*this.n*zP.d-zP.s*zP.n*this.d;return(IP<n)-(n<IP)},ceil:function(e){return e=UP**BigInt(e||0),GP(VP(this.s*e*this.n/this.d)+(e*this.n%this.d>IP&&this.s>=IP?BP:IP),e)},floor:function(e){return e=UP**BigInt(e||0),GP(VP(this.s*e*this.n/this.d)-(e*this.n%this.d>IP&&this.s<IP?BP:IP),e)},round:function(e){return e=UP**BigInt(e||0),GP(VP(this.s*e*this.n/this.d)+this.s*((this.s>=IP?BP:IP)+kP*(e*this.n%this.d)>this.d?BP:IP),e)},roundTo:function(e,t){jP(e,t);const n=this.n*zP.d,r=this.d*zP.n,i=n%r;let a=VP(n/r);return i+i>=r&&a++,GP(this.s*a*zP.n,zP.d)},divisible:function(e,t){return jP(e,t),!(!(zP.n*this.d)||this.n*zP.d%(zP.n*this.d))},valueOf:function(){return Number(this.s*this.n)/Number(this.d)},toString:function(e){let t=this.n,n=this.d;e=e||15;let r=function(e,t){for(;t%kP===IP;t/=kP);for(;t%LP===IP;t/=LP);if(t===BP)return IP;let n=UP%t,r=1;for(;n!==BP;r++)if(n=n*UP%t,r>2e3)return IP;return BigInt(r)}(0,n),i=WP(0,n,r),a=this.s<IP?"-":"";if(a+=VP(t/n),t%=n,t*=UP,t&&(a+="."),r){for(let e=i;e--;)a+=VP(t/n),t%=n,t*=UP;a+="(";for(let e=r;e--;)a+=VP(t/n),t%=n,t*=UP;a+=")"}else for(let o=e;t&&o--;)a+=VP(t/n),t%=n,t*=UP;return a},toFraction:function(e){let t=this.n,n=this.d,r=this.s<IP?"-":"";if(n===BP)r+=t;else{let i=VP(t/n);e&&i>IP&&(r+=i,r+=" ",t%=n),r+=t,r+="/",r+=n}return r},toLatex:function(e){let t=this.n,n=this.d,r=this.s<IP?"-":"";if(n===BP)r+=t;else{let i=VP(t/n);e&&i>IP&&(r+=i,t%=n),r+="\\frac{",r+=t,r+="}{",r+=n,r+="}"}return r},toContinued:function(){let e=this.n,t=this.d,n=[];do{n.push(VP(e/t));let r=e%t;e=t,t=r}while(e!==BP);return n},simplify:function(e){const t=BigInt(1/(e||.001)|0),n=this.abs(),r=n.toContinued();for(let i=1;i<r.length;i++){let e=GP(r[i-1],BP);for(let t=i-2;t>=0;t--)e=e.inverse().add(r[t]);let a=e.sub(n);if(a.n*t<a.d)return e.mul(this.s)}return this}};var JP=SN("Fraction",[],(()=>(Object.defineProperty(YP,"name",{value:"Fraction"}),YP.prototype.constructor=YP,YP.prototype.type="Fraction",YP.prototype.isFraction=!0,YP.prototype.toJSON=function(){return{mathjs:"Fraction",n:String(this.s*this.n),d:String(this.d)}},YP.fromJSON=function(e){return new YP(e)},YP)),{isClass:!0}),$P=SN("Matrix",[],(()=>{function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator")}return e.prototype.type="Matrix",e.prototype.isMatrix=!0,e.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},e.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},e.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},e.prototype.subset=function(e,t,n){throw new Error("Cannot invoke subset on a Matrix interface")},e.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},e.prototype.set=function(e,t,n){throw new Error("Cannot invoke set on a Matrix interface")},e.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},e.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},e.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},e.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},e.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},e.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},e.prototype[Symbol.iterator]=function(){throw new Error("Cannot iterate a Matrix interface")},e.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},e.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},e.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},e.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},e}),{isClass:!0}),eF=SN("Range",[],(()=>{function e(t,n,r){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");var i=null!==t&&void 0!==t,a=null!==n&&void 0!==n,o=null!==r&&void 0!==r;if(i)if(kC(t))t=t.toNumber();else if("number"!==typeof t&&!LC(t))throw new TypeError("Parameter start must be a number or bigint");if(a)if(kC(n))n=n.toNumber();else if("number"!==typeof n&&!LC(n))throw new TypeError("Parameter end must be a number or bigint");if(o)if(kC(r))r=r.toNumber();else if("number"!==typeof r&&!LC(r))throw new TypeError("Parameter step must be a number or bigint");this.start=i?parseFloat(t):0,this.end=a?parseFloat(n):0,this.step=o?parseFloat(r):1}return e.prototype.type="Range",e.prototype.isRange=!0,e.parse=function(t){if("string"!==typeof t)return null;var n=t.split(":").map((function(e){return parseFloat(e)}));if(n.some((function(e){return isNaN(e)})))return null;switch(n.length){case 2:return new e(n[0],n[1]);case 3:return new e(n[0],n[2],n[1]);default:return null}},e.prototype.clone=function(){return new e(this.start,this.end,this.step)},e.prototype.size=function(){var e=0,t=this.start,n=this.step,r=this.end-t;return kN(n)===kN(r)?e=Math.ceil(r/n):0===r&&(e=0),isNaN(e)&&(e=0),[e]},e.prototype.min=function(){var e=this.size()[0];return e>0?this.step>0?this.start:this.start+(e-1)*this.step:void 0},e.prototype.max=function(){var e=this.size()[0];return e>0?this.step>0?this.start+(e-1)*this.step:this.start:void 0},e.prototype.forEach=function(e){var t=this.start,n=this.step,r=this.end,i=0;if(n>0)for(;t<r;)e(t,[i],this),t+=n,i++;else if(n<0)for(;t>r;)e(t,[i],this),t+=n,i++},e.prototype.map=function(e){var t=[];return this.forEach((function(n,r,i){t[r[0]]=e(n,r,i)})),t},e.prototype.toArray=function(){var e=[];return this.forEach((function(t,n){e[n[0]]=t})),e},e.prototype.valueOf=function(){return this.toArray()},e.prototype.format=function(e){var t=qN(this.start,e);return 1!==this.step&&(t+=":"+qN(this.step,e)),t+=":"+qN(this.end,e)},e.prototype.toString=function(){return this.format()},e.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},e.fromJSON=function(t){return new e(t.start,t.end,t.step)},e}),{isClass:!0}),tF=SN("ResultSet",[],(()=>{function e(t){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator");this.entries=t||[]}return e.prototype.type="ResultSet",e.prototype.isResultSet=!0,e.prototype.valueOf=function(){return this.entries},e.prototype.toString=function(){return"["+this.entries.map(String).join(", ")+"]"},e.prototype.toJSON=function(){return{mathjs:"ResultSet",entries:this.entries}},e.fromJSON=function(t){return new e(t.entries)},e}),{isClass:!0});function nF(e,t,n){var r=new(0,e.constructor)(2),i="";if(n){if(n<1)throw new Error("size must be in greater than 0");if(!IN(n))throw new Error("size must be an integer");if(e.greaterThan(r.pow(n-1).sub(1))||e.lessThan(r.pow(n-1).mul(-1)))throw new Error("Value must be in range [-2^".concat(n-1,", 2^").concat(n-1,"-1]"));if(!e.isInteger())throw new Error("Value must be an integer");e.lessThan(0)&&(e=e.add(r.pow(n))),i="i".concat(n)}switch(t){case 2:return"".concat(e.toBinary()).concat(i);case 8:return"".concat(e.toOctal()).concat(i);case 16:return"".concat(e.toHexadecimal()).concat(i);default:throw new Error("Base ".concat(t," not supported "))}}function rF(e,t){if("function"===typeof t)return t(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var{notation:n,precision:r,wordSize:i}=jN(t);switch(n){case"fixed":return function(e,t){return e.toFixed(t)}(e,r);case"exponential":return iF(e,r);case"engineering":return function(e,t){var n=e.e,r=n%3===0?n:n<0?n-3-n%3:n-n%3,i=e.mul(Math.pow(10,-r)),a=i.toPrecision(t);if(a.includes("e")){a=new(0,e.constructor)(a).toFixed()}return a+"e"+(n>=0?"+":"")+r.toString()}(e,r);case"bin":return nF(e,2,i);case"oct":return nF(e,8,i);case"hex":return nF(e,16,i);case"auto":var a=aF(null===t||void 0===t?void 0:t.lowerExp,-3),o=aF(null===t||void 0===t?void 0:t.upperExp,5);if(e.isZero())return"0";var s=e.toSignificantDigits(r),l=s.e;return(l>=a&&l<o?s.toFixed():iF(e,r)).replace(/((\.\d*?)(0+))($|e)/,(function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t}));default:throw new Error('Unknown notation "'+n+'". Choose "auto", "exponential", "fixed", "bin", "oct", or "hex.')}}function iF(e,t){return void 0!==t?e.toExponential(t-1):e.toExponential()}function aF(e,t){return BC(e)?e:kC(e)?e.toNumber():t}function oF(e,t){var n=e.length-t.length,r=e.length;return e.substring(n,r)===t}function sF(e,t){var n=function(e,t){if("number"===typeof e)return qN(e,t);if(kC(e))return rF(e,t);if(function(e){return e&&"object"===typeof e&&"bigint"===typeof e.s&&"bigint"===typeof e.n&&"bigint"===typeof e.d||!1}(e))return t&&"decimal"===t.fraction?e.toString():"".concat(e.s*e.n,"/").concat(e.d);if(Array.isArray(e))return hF(e,t);if(VC(e))return lF(e);if("function"===typeof e)return e.syntax?String(e.syntax):"function";if(e&&"object"===typeof e){return"function"===typeof e.format?e.format(t):e&&e.toString(t)!=={}.toString()?e.toString(t):"{"+Object.keys(e).map((n=>lF(n)+": "+sF(e[n],t))).join(", ")+"}"}return String(e)}(e,t);return t&&"object"===typeof t&&"truncate"in t&&n.length>t.truncate?n.substring(0,t.truncate-3)+"...":n}function lF(e){for(var t=String(e),n="",r=0;r<t.length;){var i=t.charAt(r);n+=i in cF?cF[i]:i,r++}return'"'+n+'"'}var cF={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"};function uF(e){var t=String(e);return t=t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function hF(e,t){if(Array.isArray(e)){for(var n="[",r=e.length,i=0;i<r;i++)0!==i&&(n+=", "),n+=hF(e[i],t);return n+="]"}return sF(e,t)}function dF(e,t){if(!VC(e))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+EA(e)+", index: 0)");if(!VC(t))throw new TypeError("Unexpected type of argument in function compareText (expected: string or Array or Matrix, actual: "+EA(t)+", index: 1)");return e===t?0:e>t?1:-1}function fF(e,t,n){if(!(this instanceof fF))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=(new Error).stack}function pF(e,t,n){if(!(this instanceof pF))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=n),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}function mF(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t}function gF(e,t,n){var r,i=e.length;if(i!==t[n])throw new fF(i,t[n]);if(n<t.length-1){var a=n+1;for(r=0;r<i;r++){var o=e[r];if(!Array.isArray(o))throw new fF(t.length-1,t.length,"<");gF(e[r],t,a)}}else for(r=0;r<i;r++)if(Array.isArray(e[r]))throw new fF(t.length+1,t.length,">")}function vF(e,t){if(0===t.length){if(Array.isArray(e))throw new fF(e.length,0)}else gF(e,t,0)}function yF(e,t){var n=e.isMatrix?e._size:mF(e);t._sourceSize.forEach(((e,t)=>{if(null!==e&&e!==n[t])throw new fF(e,n[t])}))}function xF(e,t){if(void 0!==e){if(!BC(e)||!IN(e))throw new TypeError("Index must be an integer (value: "+e+")");if(e<0||"number"===typeof t&&e>=t)throw new pF(e,t)}}function bF(e){for(var t=0;t<e._dimensions.length;++t){var n=e._dimensions[t];if(n._data&&GC(n._data)){if(0===n._size[0])return!0}else if(n.isRange){if(n.start===n.end)return!0}else if(VC(n)&&0===n.length)return!0}return!1}function _F(e,t,n){if(!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new Error("Resizing to scalar is not supported");return t.forEach((function(e){if(!BC(e)||!IN(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+sF(t)+")")})),(BC(e)||kC(e))&&(e=[e]),wF(e,t,0,void 0!==n?n:0),e}function wF(e,t,n,r){var i,a,o=e.length,s=t[n],l=Math.min(o,s);if(e.length=s,n<t.length-1){var c=n+1;for(i=0;i<l;i++)a=e[i],Array.isArray(a)||(a=[a],e[i]=a),wF(a,t,c,r);for(i=l;i<s;i++)a=[],e[i]=a,wF(a,t,c,r)}else{for(i=0;i<l;i++)for(;Array.isArray(e[i]);)e[i]=e[i][0];for(i=l;i<s;i++)e[i]=r}}function SF(e,t){var n=NF(e,!0),r=n.length;if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new fF(0,r,"!=");var i=DF(t=MF(t,r));if(r!==i)throw new fF(i,r,"!=");try{return function(e,t){for(var n,r=e,i=t.length-1;i>0;i--){var a=t[i];n=[];for(var o=r.length/a,s=0;s<o;s++)n.push(r.slice(s*a,(s+1)*a));r=n}return r}(n,t)}catch(gR){if(gR instanceof fF)throw new fF(i,r,"!=");throw gR}}function MF(e,t){var n=DF(e),r=e.slice(),i=e.indexOf(-1);if(e.indexOf(-1,i+1)>=0)throw new Error("More than one wildcard in sizes");if(i>=0){if(!(t%n===0))throw new Error("Could not replace wildcard, since "+t+" is no multiple of "+-n);r[i]=-t/n}return r}function DF(e){return e.reduce(((e,t)=>e*t),1)}function EF(e,t){for(var n=t||mF(e);Array.isArray(e)&&1===e.length;)e=e[0],n.shift();for(var r=n.length;1===n[r-1];)r--;return r<n.length&&(e=CF(e,r,0),n.length=r),e}function CF(e,t,n){var r,i;if(n<t){var a=n+1;for(r=0,i=e.length;r<i;r++)e[r]=CF(e[r],t,a)}else for(;Array.isArray(e);)e=e[0];return e}function AF(e,t,n,r){var i=r||mF(e);if(n)for(var a=0;a<n;a++)e=[e],i.unshift(1);for(e=TF(e,t,0);i.length<t;)i.push(1);return e}function TF(e,t,n){var r,i;if(Array.isArray(e)){var a=n+1;for(r=0,i=e.length;r<i;r++)e[r]=TF(e[r],t,a)}else for(var o=n;o<t;o++)e=[e];return e}function NF(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!Array.isArray(e))return e;if("boolean"!==typeof t)throw new TypeError("Boolean expected for second argument of flatten");var n=[];return t?function e(t){if(Array.isArray(t[0]))for(var r=0;r<t.length;r++)e(t[r]);else for(var i=0;i<t.length;i++)n.push(t[i])}(e):function e(t){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?e(i):n.push(i)}}(e),n}function RF(e,t){return Array.prototype.map.call(e,t)}function PF(e,t){Array.prototype.forEach.call(e,t)}function FF(e,t){if(1!==mF(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,t)}function OF(e,t){if(1!==mF(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,(e=>t.test(e)))}function IF(e,t){return Array.prototype.join.call(e,t)}function BF(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;var t=[],n=0;t[0]={value:e[0],identifier:0};for(var r=1;r<e.length;r++)e[r]===e[r-1]?n++:n=0,t.push({value:e[r],identifier:n});return t}function kF(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;for(var t=[],n=0;n<e.length;n++)t.push(e[n].value);return t}function LF(e,t){for(var n,r=0,i=0;i<e.length;i++){var a=e[i],o=Array.isArray(a);if(0===i&&o&&(r=a.length),o&&a.length!==r)return;var s=o?LF(a,t):t(a);if(void 0===n)n=s;else if(n!==s)return"mixed"}return n}function UF(e,t,n,r){if(r<n){if(e.length!==t.length)throw new fF(e.length,t.length);for(var i=[],a=0;a<e.length;a++)i[a]=UF(e[a],t[a],n,r+1);return i}return e.concat(t)}function zF(){var e=Array.prototype.slice.call(arguments,0,-1),t=Array.prototype.slice.call(arguments,-1);if(1===e.length)return e[0];if(e.length>1)return e.slice(1).reduce((function(e,n){return UF(e,n,t,0)}),e[0]);throw new Error("Wrong number of arguments in function concat")}function HF(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=t.map((e=>e.length)),i=Math.max(...r),a=new Array(i).fill(null),o=0;o<t.length;o++)for(var s=t[o],l=r[o],c=0;c<l;c++){var u=i-l+c;s[c]>a[u]&&(a[u]=s[c])}for(var h=0;h<t.length;h++)VF(t[h],a);return a}function VF(e,t){for(var n=t.length,r=e.length,i=0;i<r;i++){var a=n-r+i;if(e[i]<t[a]&&e[i]>1||e[i]>t[a])throw new Error("shape mismatch: mismatch is found in arg with shape (".concat(e,") not possible to broadcast dimension ").concat(r," with size ").concat(e[i]," to size ").concat(t[a]))}}function GF(e,t){var n=mF(e);if(NA(n,t))return e;VF(n,t);var r,i,a,o=HF(n,t),s=o.length,l=[...Array(s-n.length).fill(1),...n],c=function(e){return SC([],e)}(e);n.length<s&&(n=mF(c=SF(c,l)));for(var u=0;u<s;u++)n[u]<o[u]&&(r=c,i=o[u],a=u,n=mF(c=zF(...Array(i).fill(r),a)));return c}function qF(e,t){if(!Array.isArray(e))throw new Error("Array expected");var n=mF(e);if(t.length!==n.length)throw new fF(t.length,n.length);for(var r=0;r<t.length;r++)xF(t[r],n[r]);return t.reduce(((e,t)=>e[t]),e)}function jF(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return[];if(n)return function e(n){if(Array.isArray(n)){for(var r=n.length,i=Array(r),a=0;a<r;a++)i[a]=e(n[a]);return i}return t(n)}(e);var r=[];return function n(i,a){if(Array.isArray(i)){for(var o=i.length,s=Array(o),l=0;l<o;l++)r[a]=l,s[l]=n(i[l],a+1);return s}return t(i,r.slice(0,a),e)}(e,0)}function WF(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==e.length)if(n)(function e(n){if(Array.isArray(n))for(var r=n.length,i=0;i<r;i++)e(n[i]);else t(n)})(e);else{var r=[];!function n(i,a){if(Array.isArray(i))for(var o=i.length,s=0;s<o;s++)r[a]=s,n(i[s],a+1);else t(i,r.slice(0,a),e)}(e,0)}}fF.prototype=new RangeError,fF.prototype.constructor=RangeError,fF.prototype.name="DimensionError",fF.prototype.isDimensionError=!0,pF.prototype=new RangeError,pF.prototype.constructor=RangeError,pF.prototype.name="IndexError",pF.prototype.isIndexError=!0;var XF=n(5422);function YF(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(XF.isTypedFunction(e)){var i,a;if(r)i=1;else{var o=(t.isMatrix?t.size():mF(t)).map((()=>0)),s=t.isMatrix?t.get(o):qF(t,o);i=function(e,t,n,r){for(var i=[t,n,r],a=3;a>0;a--){var o=i.slice(0,a);if(null!==XF.resolve(e,o))return a}}(e,s,o,t)}if(t.isMatrix&&"mixed"!==t.dataType&&void 0!==t.dataType){var l=function(e,t){var n=[];if(Object.entries(e.signatures).forEach((e=>{var[r,i]=e;r.split(",").length===t&&n.push(i)})),1===n.length)return n[0]}(e,i);a=void 0!==l?l:e}else a=e;return i>=1&&i<=3?{isUnary:1===i,fn:function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return KF(a,r.slice(0,i),n,e.name)}}:{isUnary:!1,fn:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return KF(a,r,n,e.name)}}}return void 0===r?{isUnary:ZF(e),fn:e}:{isUnary:r,fn:e}}function ZF(e){if(1!==e.length)return!1;var t=e.toString();if(/arguments/.test(t))return!1;var n=t.match(/\(.*?\)/);return!/\.\.\./.test(n)}function KF(e,t,n,r){try{return e(...t)}catch(i){!function(e,t,n,r){var i;if(e instanceof TypeError&&"wrongType"===(null===(i=e.data)||void 0===i?void 0:i.category)){var a=[];throw a.push("value: ".concat(EA(t[0]))),t.length>=2&&a.push("index: ".concat(EA(t[1]))),t.length>=3&&a.push("array: ".concat(EA(t[2]))),new TypeError("Function ".concat(n," cannot apply callback arguments ")+"".concat(r,"(").concat(a.join(", "),") at index ").concat(JSON.stringify(t[1])))}throw new TypeError("Function ".concat(n," cannot apply callback arguments ")+"to function ".concat(r,": ").concat(e.message))}(i,t,n,r)}}var QF=SN("DenseMatrix",["Matrix"],(e=>{var{Matrix:t}=e;function n(e,t){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!VC(t))throw new Error("Invalid datatype: "+t);if(qC(e))"DenseMatrix"===e.type?(this._data=CA(e._data),this._size=CA(e._size),this._datatype=t||e._datatype):(this._data=e.toArray(),this._size=e.size(),this._datatype=t||e._datatype);else if(e&&GC(e.data)&&GC(e.size))this._data=e.data,this._size=e.size,vF(this._data,this._size),this._datatype=t||e.datatype;else if(GC(e))this._data=s(e),this._size=mF(this._data),vF(this._data,this._size),this._datatype=t;else{if(e)throw new TypeError("Unsupported type of data ("+EA(e)+")");this._data=[],this._size=[0],this._datatype=t}}function r(e,t,n,i){var a=i===n-1,o=t.dimension(i);return a?o.map((function(t){return xF(t,e.length),e[t]})).valueOf():o.map((function(a){return xF(a,e.length),r(e[a],t,n,i+1)})).valueOf()}function i(e,t,n,r,a){var o=a===r-1,s=t.dimension(a);o?s.forEach((function(t,r){xF(t),e[t]=n[r[0]]})):s.forEach((function(o,s){xF(o),i(e[o],t,n[s[0]],r,a+1)}))}function a(e,t,n){if(0===t.length){for(var r=e._data;GC(r);)r=r[0];return r}return e._size=t.slice(0),e._data=_F(e._data,e._size,n),e}function o(e,t,n){for(var r=e._size.slice(0),i=!1;r.length<t.length;)r.push(0),i=!0;for(var o=0,s=t.length;o<s;o++)t[o]>r[o]&&(r[o]=t[o],i=!0);i&&a(e,r,n)}function s(e){return qC(e)?s(e.valueOf()):GC(e)?e.map(s):e}return n.prototype=new t,n.prototype.createDenseMatrix=function(e,t){return new n(e,t)},Object.defineProperty(n,"name",{value:"DenseMatrix"}),n.prototype.constructor=n,n.prototype.type="DenseMatrix",n.prototype.isDenseMatrix=!0,n.prototype.getDataType=function(){return LF(this._data,EA)},n.prototype.storage=function(){return"dense"},n.prototype.datatype=function(){return this._datatype},n.prototype.create=function(e,t){return new n(e,t)},n.prototype.subset=function(e,t,a){switch(arguments.length){case 1:return function(e,t){if(!ZC(t))throw new TypeError("Invalid index");var i=t.isScalar();if(i)return e.get(t.min());var a=t.size();if(a.length!==e._size.length)throw new fF(a.length,e._size.length);for(var o=t.min(),s=t.max(),l=0,c=e._size.length;l<c;l++)xF(o[l],e._size[l]),xF(s[l],e._size[l]);return new n(r(e._data,t,a.length,0),e._datatype)}(this,e);case 2:case 3:return function(e,t,n,r){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var a,s=t.size(),l=t.isScalar();qC(n)?(a=n.size(),n=n.valueOf()):a=mF(n);if(l){if(0!==a.length)throw new TypeError("Scalar expected");e.set(t.min(),n,r)}else{if(!NA(a,s))try{a=mF(n=0===a.length?GF([n],s):GF(n,s))}catch(p){}if(s.length<e._size.length)throw new fF(s.length,e._size.length,"<");if(a.length<s.length){for(var c=0,u=0;1===s[c]&&1===a[c];)c++;for(;1===s[c];)u++,c++;n=AF(n,s.length,u,a)}if(!NA(s,a))throw new fF(s,a,">");var h=t.max().map((function(e){return e+1}));o(e,h,r);var d=s.length,f=0;i(e._data,t,n,d,f)}return e}(this,e,t,a);default:throw new SyntaxError("Wrong number of arguments")}},n.prototype.get=function(e){return qF(this._data,e)},n.prototype.set=function(e,t,n){if(!GC(e))throw new TypeError("Array expected");if(e.length<this._size.length)throw new fF(e.length,this._size.length,"<");var r,i,a,s=e.map((function(e){return e+1}));o(this,s,n);var l=this._data;for(r=0,i=e.length-1;r<i;r++)xF(a=e[r],l.length),l=l[a];return xF(a=e[e.length-1],l.length),l[a]=t,this},n.prototype.resize=function(e,t,n){if(!jC(e))throw new TypeError("Array or Matrix expected");var r=e.valueOf().map((e=>Array.isArray(e)&&1===e.length?e[0]:e));return a(n?this.clone():this,r,t)},n.prototype.reshape=function(e,t){var n=t?this.clone():this;n._data=SF(n._data,e);var r=n._size.reduce(((e,t)=>e*t));return n._size=MF(e,r),n},n.prototype.clone=function(){return new n({data:CA(this._data),size:CA(this._size),datatype:this._datatype})},n.prototype.size=function(){return this._size.slice(0)},n.prototype._forEach=function(e){var t=2===e.length,n=this._size.length-1;if(!(n<0))if(t)(function t(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(i<n)for(var a=0;a<r.length;a++)t(r[a],i+1);else for(var o=0;o<r.length;o++)e(r,o)})(this._data);else if(0!==n){var r=new Array(n+1);!function t(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(a<n)for(var o=0;o<i.length;o++)r[a]=o,t(i[o],a+1);else for(var s=0;s<i.length;s++)r[a]=s,e(i,s,r.slice())}(this._data)}else for(var i=0;i<this._data.length;i++)e(this._data,i,[i])},n.prototype.map=function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=new n(r),a=YF(e,r._data,"map",t),o=t||a.isUnary?(e,t)=>{e[t]=a.fn(e[t])}:(e,t,n)=>{e[t]=a.fn(e[t],n,r)};return i._forEach(o),i},n.prototype.forEach=function(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this,r=YF(e,n._data,"map",t),i=t||r.isUnary?(e,t)=>{r.fn(e[t])}:(e,t,i)=>{r.fn(e[t],i,n)};n._forEach(i)},n.prototype[Symbol.iterator]=function*(){var e=this._size.length-1;if(!(e<0))if(0!==e){var t=[],n=function*(r,i){if(i<e)for(var a=0;a<r.length;a++)t[i]=a,yield*n(r[a],i+1);else for(var o=0;o<r.length;o++)t[i]=o,yield{value:r[o],index:t.slice()}};yield*n(this._data,0)}else for(var r=0;r<this._data.length;r++)yield{value:this._data[r],index:[r]}},n.prototype.rows=function(){var e=[];if(2!==this.size().length)throw new TypeError("Rows can only be returned for a 2D matrix.");var t=this._data;for(var r of t)e.push(new n([r],this._datatype));return e},n.prototype.columns=function(){var e=this,t=[],r=this.size();if(2!==r.length)throw new TypeError("Rows can only be returned for a 2D matrix.");for(var i=this._data,a=function(r){var a=i.map((e=>[e[r]]));t.push(new n(a,e._datatype))},o=0;o<r[1];o++)a(o);return t},n.prototype.toArray=function(){return CA(this._data)},n.prototype.valueOf=function(){return this._data},n.prototype.format=function(e){return sF(this._data,e)},n.prototype.toString=function(){return sF(this._data)},n.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},n.prototype.diagonal=function(e){if(e){if(kC(e)&&(e=e.toNumber()),!BC(e)||!IN(e))throw new TypeError("The parameter k must be an integer number")}else e=0;for(var t=e>0?e:0,r=e<0?-e:0,i=this._size[0],a=this._size[1],o=Math.min(i-r,a-t),s=[],l=0;l<o;l++)s[l]=this._data[l+r][l+t];return new n({data:s,size:[o],datatype:this._datatype})},n.diagonal=function(e,t,r,i){if(!GC(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map((function(e){if(kC(e)&&(e=e.toNumber()),!BC(e)||!IN(e)||e<1)throw new Error("Size values must be positive integers");return e})),r){if(kC(r)&&(r=r.toNumber()),!BC(r)||!IN(r))throw new TypeError("The parameter k must be an integer number")}else r=0;var a,o=r>0?r:0,s=r<0?-r:0,l=e[0],c=e[1],u=Math.min(l-s,c-o);if(GC(t)){if(t.length!==u)throw new Error("Invalid value array length");a=function(e){return t[e]}}else if(qC(t)){var h=t.size();if(1!==h.length||h[0]!==u)throw new Error("Invalid matrix length");a=function(e){return t.get([e])}}else a=function(){return t};i||(i=kC(a(0))?a(0).mul(0):0);var d=[];if(e.length>0){d=_F(d,e,i);for(var f=0;f<u;f++)d[f+s][f+o]=a(f)}return new n({data:d,size:[l,c]})},n.fromJSON=function(e){return new n(e)},n.prototype.swapRows=function(e,t){if(!BC(e)||!IN(e)||!BC(t)||!IN(t))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return xF(e,this._size[0]),xF(t,this._size[0]),n._swapRows(e,t,this._data),this},n._swapRows=function(e,t,n){var r=n[e];n[e]=n[t],n[t]=r},n}),{isClass:!0}),JF=SN("replacer",[],(()=>function(e,t){return"number"!==typeof t||isFinite(t)&&!isNaN(t)?"bigint"===typeof t?{mathjs:"bigint",value:String(t)}:t:{mathjs:"number",value:String(t)}})),$F=function(){return $F=XF.create,XF},eO=SN("typed",["?BigNumber","?Complex","?DenseMatrix","?Fraction"],(function(e){var{BigNumber:t,Complex:n,DenseMatrix:r,Fraction:i}=e,a=$F();return a.clear(),a.addTypes([{name:"number",test:BC},{name:"Complex",test:UC},{name:"BigNumber",test:kC},{name:"bigint",test:LC},{name:"Fraction",test:zC},{name:"Unit",test:HC},{name:"identifier",test:e=>VC&&/^(?:[A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])*$/.test(e)},{name:"string",test:VC},{name:"Chain",test:DA},{name:"Array",test:GC},{name:"Matrix",test:qC},{name:"DenseMatrix",test:WC},{name:"SparseMatrix",test:XC},{name:"Range",test:YC},{name:"Index",test:ZC},{name:"boolean",test:KC},{name:"ResultSet",test:QC},{name:"Help",test:JC},{name:"function",test:$C},{name:"Date",test:eA},{name:"RegExp",test:tA},{name:"null",test:oA},{name:"undefined",test:sA},{name:"AccessorNode",test:lA},{name:"ArrayNode",test:cA},{name:"AssignmentNode",test:uA},{name:"BlockNode",test:hA},{name:"ConditionalNode",test:dA},{name:"ConstantNode",test:fA},{name:"FunctionNode",test:gA},{name:"FunctionAssignmentNode",test:mA},{name:"IndexNode",test:vA},{name:"Node",test:yA},{name:"ObjectNode",test:xA},{name:"OperatorNode",test:bA},{name:"ParenthesisNode",test:_A},{name:"RangeNode",test:wA},{name:"RelationalNode",test:SA},{name:"SymbolNode",test:MA},{name:"Map",test:rA},{name:"Object",test:nA}]),a.addConversions([{from:"number",to:"BigNumber",convert:function(e){if(t||tO(e),function(e){return e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}(e)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+e+"). Use function bignumber(x) to convert to BigNumber.");return new t(e)}},{from:"number",to:"Complex",convert:function(e){return n||nO(e),new n(e,0)}},{from:"BigNumber",to:"Complex",convert:function(e){return n||nO(e),new n(e.toNumber(),0)}},{from:"bigint",to:"number",convert:function(e){if(e>Number.MAX_SAFE_INTEGER)throw new TypeError("Cannot implicitly convert bigint to number: value exceeds the max safe integer value (value: "+e+")");return Number(e)}},{from:"bigint",to:"BigNumber",convert:function(e){return t||tO(e),new t(e.toString())}},{from:"bigint",to:"Fraction",convert:function(e){return i||rO(e),new i(e)}},{from:"Fraction",to:"BigNumber",convert:function(e){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(e){return n||nO(e),new n(e.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(e){i||rO(e);var t=new i(e);if(t.valueOf()!==e)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+e+"). Use function fraction(x) to convert to Fraction.");return t}},{from:"string",to:"number",convert:function(e){var t=Number(e);if(isNaN(t))throw new Error('Cannot convert "'+e+'" to a number');return t}},{from:"string",to:"BigNumber",convert:function(e){t||tO(e);try{return new t(e)}catch(n){throw new Error('Cannot convert "'+e+'" to BigNumber')}}},{from:"string",to:"bigint",convert:function(e){try{return BigInt(e)}catch(t){throw new Error('Cannot convert "'+e+'" to BigInt')}}},{from:"string",to:"Fraction",convert:function(e){i||rO(e);try{return new i(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(e){n||nO(e);try{return new n(e)}catch(t){throw new Error('Cannot convert "'+e+'" to Complex')}}},{from:"boolean",to:"number",convert:function(e){return+e}},{from:"boolean",to:"BigNumber",convert:function(e){return t||tO(e),new t(+e)}},{from:"boolean",to:"bigint",convert:function(e){return BigInt(+e)}},{from:"boolean",to:"Fraction",convert:function(e){return i||rO(e),new i(+e)}},{from:"boolean",to:"string",convert:function(e){return String(e)}},{from:"Array",to:"Matrix",convert:function(e){return r||function(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}(),new r(e)}},{from:"Matrix",to:"Array",convert:function(e){return e.valueOf()}}]),a.onMismatch=(e,t,n)=>{var r=a.createError(e,t,n);if(["wrongType","mismatch"].includes(r.data.category)&&1===t.length&&jC(t[0])&&n.some((e=>!e.params.includes(",")))){var i=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw i.data=r.data,i}throw r},a.onMismatch=(e,t,n)=>{var r=a.createError(e,t,n);if(["wrongType","mismatch"].includes(r.data.category)&&1===t.length&&jC(t[0])&&n.some((e=>!e.params.includes(",")))){var i=new TypeError("Function '".concat(e,"' doesn't apply to matrices. To call it ")+"elementwise on a matrix 'M', try 'map(M, ".concat(e,")'."));throw i.data=r.data,i}throw r},a}));function tO(e){throw new Error("Cannot convert value ".concat(e," into a BigNumber: no class 'BigNumber' provided"))}function nO(e){throw new Error("Cannot convert value ".concat(e," into a Complex number: no class 'Complex' provided"))}function rO(e){throw new Error("Cannot convert value ".concat(e," into a Fraction, no class 'Fraction' provided."))}function iO(e){var t,n,r=e.length,i=e[0].length,a=[];for(n=0;n<i;n++){var o=[];for(t=0;t<r;t++)o.push(e[t][n]);a.push(o)}return a}function aO(e){for(var t=0;t<e.length;t++)if(jC(e[t]))return!0;return!1}function oO(e,t){qC(e)?e.forEach((e=>t(e)),!1,!0):WF(e,t,!0)}function sO(e,t,n){if(!n)return qC(e)?e.map((e=>t(e)),!1,!0):jF(e,t,!0);var r=e=>0===e?e:t(e);return qC(e)?e.map((e=>r(e)),!1,!0):jF(e,r,!0)}function lO(e,t,n){var r=Array.isArray(e)?mF(e):e.size();if(t<0||t>=r.length)throw new pF(t,r.length);return qC(e)?e.create(cO(e.valueOf(),t,n),e.datatype()):cO(e,t,n)}function cO(e,t,n){var r,i,a,o;if(t<=0){if(Array.isArray(e[0])){for(o=iO(e),i=[],r=0;r<o.length;r++)i[r]=cO(o[r],t-1,n);return i}for(a=e[0],r=1;r<e.length;r++)a=n(a,e[r]);return a}for(i=[],r=0;r<e.length;r++)i[r]=cO(e[r],t-1,n);return i}function uO(e,t,n,r,i,a,o,s,l,c,u){var h,d,f,p,m=e._values,g=e._index,v=e._ptr;if(r)for(d=v[t],f=v[t+1],h=d;h<f;h++)n[p=g[h]]!==a?(n[p]=a,o.push(p),c?(r[p]=l?s(m[h],u):s(u,m[h]),i[p]=a):r[p]=m[h]):(r[p]=l?s(m[h],r[p]):s(r[p],m[h]),i[p]=a);else for(d=v[t],f=v[t+1],h=d;h<f;h++)n[p=g[h]]!==a?(n[p]=a,o.push(p)):i[p]=a}var hO="number",dO="number, number";function fO(e){return Math.abs(e)}function pO(e,t){return e+t}function mO(e,t){return e-t}function gO(e,t){return e*t}function vO(e){return-e}function yO(e){return e}function xO(e){return HN(e)}function bO(e){return e*e*e}function _O(e){return Math.exp(e)}function wO(e){return VN(e)}function SO(e,t){if(!IN(e)||!IN(t))throw new Error("Parameters in function lcm must be integer numbers");if(0===e||0===t)return 0;for(var n,r=e*t;0!==t;)t=e%(n=t),e=n;return Math.abs(r/e)}function MO(e,t){return t?Math.log(e)/Math.log(t):Math.log(e)}function DO(e){return UN(e)}function EO(e){return LN(e)}function CO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t<0;if(n&&(t=-t),0===t)throw new Error("Root must be non-zero");if(e<0&&Math.abs(t)%2!==1)throw new Error("Root must be odd when a is negative.");if(0===e)return n?1/0:0;if(!isFinite(e))return n?0:e;var r=Math.pow(Math.abs(e),1/t);return r=e<0?-r:r,n?1/r:r}function AO(e){return kN(e)}function TO(e){return e*e}function NO(e,t){var n,r,i,a=0,o=1,s=1,l=0;if(!IN(e)||!IN(t))throw new Error("Parameters in function xgcd must be integer numbers");for(;t;)i=e-(r=Math.floor(e/t))*t,n=a,a=o-r*a,o=n,n=s,s=l-r*s,l=n,e=t,t=i;return e<0?[-e,-o,-l]:[e,e?o:0,l]}function RO(e,t){return e*e<1&&t===1/0||e*e>1&&t===-1/0?0:Math.pow(e,t)}function PO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!IN(t)||t<0||t>15)throw new Error("Number of decimals in function round must be an integer from 0 to 15 inclusive");return parseFloat(XN(e,t))}fO.signature=hO,pO.signature=dO,mO.signature=dO,gO.signature=dO,vO.signature=hO,yO.signature=hO,xO.signature=hO,bO.signature=hO,_O.signature=hO,wO.signature=hO,SO.signature=dO,DO.signature=hO,EO.signature=hO,AO.signature=hO,TO.signature=hO,NO.signature=dO,RO.signature=dO;var FO=SN("abs",["typed"],(e=>{var{typed:t}=e;return t("abs",{number:fO,"Complex | BigNumber | Fraction | Unit":e=>e.abs(),bigint:e=>e<0n?-e:e,"Array | Matrix":t.referToSelf((e=>t=>sO(t,e,!0)))})})),OO="acos",IO=SN(OO,["typed","config","Complex"],(e=>{var{typed:t,config:n,Complex:r}=e;return t(OO,{number:function(e){return e>=-1&&e<=1||n.predictable?Math.acos(e):new r(e,0).acos()},Complex:function(e){return e.acos()},BigNumber:function(e){return e.acos()}})})),BO="number";function kO(e){return JN(e)}function LO(e){return Math.atan(1/e)}function UO(e){return isFinite(e)?(Math.log((e+1)/e)+Math.log(e/(e-1)))/2:0}function zO(e){return Math.asin(1/e)}function HO(e){var t=1/e;return Math.log(t+Math.sqrt(t*t+1))}function VO(e){return Math.acos(1/e)}function GO(e){var t=1/e,n=Math.sqrt(t*t-1);return Math.log(n+t)}function qO(e){return $N(e)}function jO(e){return eR(e)}function WO(e){return 1/Math.tan(e)}function XO(e){var t=Math.exp(2*e);return(t+1)/(t-1)}function YO(e){return 1/Math.sin(e)}function ZO(e){return 0===e?Number.POSITIVE_INFINITY:Math.abs(2/(Math.exp(e)-Math.exp(-e)))*kN(e)}function KO(e){return 1/Math.cos(e)}function QO(e){return 2/(Math.exp(e)+Math.exp(-e))}function JO(e){return nR(e)}kO.signature=BO,LO.signature=BO,UO.signature=BO,zO.signature=BO,HO.signature=BO,VO.signature=BO,GO.signature=BO,qO.signature=BO,jO.signature=BO,WO.signature=BO,XO.signature=BO,YO.signature=BO,ZO.signature=BO,KO.signature=BO,QO.signature=BO,JO.signature=BO;var $O="acot",eI=SN($O,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t($O,{number:LO,Complex:function(e){return e.acot()},BigNumber:function(e){return new n(1).div(e).atan()}})})),tI="acsc",nI=SN(tI,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:n,Complex:r,BigNumber:i}=e;return t(tI,{number:function(e){return e<=-1||e>=1||n.predictable?zO(e):new r(e,0).acsc()},Complex:function(e){return e.acsc()},BigNumber:function(e){return new i(1).div(e).asin()}})})),rI="addScalar",iI=SN(rI,["typed"],(e=>{var{typed:t}=e;return t(rI,{"number, number":pO,"Complex, Complex":function(e,t){return e.add(t)},"BigNumber, BigNumber":function(e,t){return e.plus(t)},"bigint, bigint":function(e,t){return e+t},"Fraction, Fraction":function(e,t){return e.add(t)},"Unit, Unit":t.referToSelf((e=>(n,r)=>{if(null===n.value||void 0===n.value)throw new Error("Parameter x contains a unit with undefined value");if(null===r.value||void 0===r.value)throw new Error("Parameter y contains a unit with undefined value");if(!n.equalBase(r))throw new Error("Units do not match");var i=n.clone();return i.value=t.find(e,[i.valueType(),r.valueType()])(i.value,r.value),i.fixPrefix=!1,i}))})})),aI=SN("arg",["typed"],(e=>{var{typed:t}=e;return t("arg",{number:function(e){return Math.atan2(0,e)},BigNumber:function(e){return e.constructor.atan2(0,e)},Complex:function(e){return e.arg()},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),oI="asech",sI=SN(oI,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:n,Complex:r,BigNumber:i}=e;return t(oI,{number:function(e){if(e<=1&&e>=-1||n.predictable){var t=1/e;if(t>0||n.predictable)return GO(e);var i=Math.sqrt(t*t-1);return new r(Math.log(i-t),Math.PI)}return new r(e,0).asech()},Complex:function(e){return e.asech()},BigNumber:function(e){return new i(1).div(e).acosh()}})})),lI=SN("asinh",["typed"],(e=>{var{typed:t}=e;return t("asinh",{number:qO,Complex:function(e){return e.asinh()},BigNumber:function(e){return e.asinh()}})})),cI=SN("atan",["typed"],(e=>{var{typed:t}=e;return t("atan",{number:function(e){return Math.atan(e)},Complex:function(e){return e.atan()},BigNumber:function(e){return e.atan()}})})),uI="atanh",hI=SN(uI,["typed","config","Complex"],(e=>{var{typed:t,config:n,Complex:r}=e;return t(uI,{number:function(e){return e<=1&&e>=-1||n.predictable?jO(e):new r(e,0).atanh()},Complex:function(e){return e.atanh()},BigNumber:function(e){return e.atanh()}})})),dI=SN("bigint",["typed"],(e=>{var{typed:t}=e,n=t("bigint",{"":function(){return 0n},bigint:function(e){return e},number:function(e){return BigInt(e.toFixed())},BigNumber:function(e){return BigInt(e.round().toString())},Fraction:function(e){return BigInt(e.valueOf().toFixed())},"string | boolean":function(e){return BigInt(e)},null:function(e){return 0n},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))});return n.fromJSON=function(e){return BigInt(e.value)},n}));function fI(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitAnd");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);if(e.isZero()||t.eq(-1)||e.eq(t))return e;if(t.isZero()||e.eq(-1))return t;if(!e.isFinite()||!t.isFinite()){if(!e.isFinite()&&!t.isFinite())return e.isNegative()===t.isNegative()?e:new n(0);if(!e.isFinite())return t.isNegative()?e:e.isNegative()?new n(0):t;if(!t.isFinite())return e.isNegative()?t:t.isNegative()?new n(0):e}return gI(e,t,(function(e,t){return e&t}))}function pI(e){if(e.isFinite()&&!e.isInteger())throw new Error("Integer expected in function bitNot");var t=e.constructor,n=t.precision;t.config({precision:1e9});var r=e.plus(new t(1));return r.s=-r.s||null,t.config({precision:n}),r}function mI(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitOr");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);var r=new n(-1);return e.isZero()||t.eq(r)||e.eq(t)?t:t.isZero()||e.eq(r)?e:e.isFinite()&&t.isFinite()?gI(e,t,(function(e,t){return e|t})):!e.isFinite()&&!e.isNegative()&&t.isNegative()||e.isNegative()&&!t.isNegative()&&!t.isFinite()?r:e.isNegative()&&t.isNegative()?e.isFinite()?e:t:e.isFinite()?t:e}function gI(e,t,n){var r,i,a,o,s,l=e.constructor,c=+(e.s<0),u=+(t.s<0);if(c){r=vI(pI(e));for(var h=0;h<r.length;++h)r[h]^=1}else r=vI(e);if(u){i=vI(pI(t));for(var d=0;d<i.length;++d)i[d]^=1}else i=vI(t);r.length<=i.length?(a=r,o=i,s=c):(a=i,o=r,s=u);var f=a.length,p=o.length,m=1^n(c,u),g=new l(1^m),v=new l(1),y=new l(2),x=l.precision;for(l.config({precision:1e9});f>0;)n(a[--f],o[--p])===m&&(g=g.plus(v)),v=v.times(y);for(;p>0;)n(s,o[--p])===m&&(g=g.plus(v)),v=v.times(y);return l.config({precision:x}),0===m&&(g.s=-g.s),g}function vI(e){for(var t=e.d,n=t[0]+"",r=1;r<t.length;++r){for(var i=t[r]+"",a=7-i.length;a--;)i="0"+i;n+=i}for(var o=n.length;"0"===n.charAt(o);)o--;var s=e.e,l=n.slice(0,o+1||1),c=l.length;if(s>0)if(++s>c)for(s-=c;s--;)l+="0";else s<c&&(l=l.slice(0,s)+"."+l.slice(s));for(var u=[0],h=0;h<l.length;){for(var d=u.length;d--;)u[d]*=10;u[0]+=parseInt(l.charAt(h++));for(var f=0;f<u.length;++f)u[f]>1&&(null!==u[f+1]&&void 0!==u[f+1]||(u[f+1]=0),u[f+1]+=u[f]>>1,u[f]&=1)}return u.reverse()}function yI(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function bitXor");var n=e.constructor;if(e.isNaN()||t.isNaN())return new n(NaN);if(e.isZero())return t;if(t.isZero())return e;if(e.eq(t))return new n(0);var r=new n(-1);return e.eq(r)?pI(t):t.eq(r)?pI(e):e.isFinite()&&t.isFinite()?gI(e,t,(function(e,t){return e^t})):e.isFinite()||t.isFinite()?new n(e.isNegative()===t.isNegative()?1/0:-1/0):r}function xI(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function leftShift");var n=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new n(NaN):e.isZero()||t.isZero()?e:e.isFinite()||t.isFinite()?t.lt(55)?e.times(Math.pow(2,t.toNumber())+""):e.times(new n(2).pow(t)):new n(NaN)}function bI(e,t){if(e.isFinite()&&!e.isInteger()||t.isFinite()&&!t.isInteger())throw new Error("Integers expected in function rightArithShift");var n=e.constructor;return e.isNaN()||t.isNaN()||t.isNegative()&&!t.isZero()?new n(NaN):e.isZero()||t.isZero()?e:t.isFinite()?t.lt(55)?e.div(Math.pow(2,t.toNumber())+"").floor():e.div(new n(2).pow(t)).floor():e.isNegative()?new n(-1):e.isFinite()?new n(0):new n(NaN)}var _I="number, number";function wI(e,t){if(!IN(e)||!IN(t))throw new Error("Integers expected in function bitAnd");return e&t}function SI(e){if(!IN(e))throw new Error("Integer expected in function bitNot");return~e}function MI(e,t){if(!IN(e)||!IN(t))throw new Error("Integers expected in function bitOr");return e|t}function DI(e,t){if(!IN(e)||!IN(t))throw new Error("Integers expected in function bitXor");return e^t}function EI(e,t){if(!IN(e)||!IN(t))throw new Error("Integers expected in function leftShift");return e<<t}function CI(e,t){if(!IN(e)||!IN(t))throw new Error("Integers expected in function rightArithShift");return e>>t}function AI(e,t){if(!IN(e)||!IN(t))throw new Error("Integers expected in function rightLogShift");return e>>>t}wI.signature=_I,SI.signature="number",MI.signature=_I,DI.signature=_I,EI.signature=_I,CI.signature=_I,AI.signature=_I;var TI="bitNot",NI=SN(TI,["typed"],(e=>{var{typed:t}=e;return t(TI,{number:SI,BigNumber:pI,bigint:e=>~e,"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),RI="boolean",PI=SN(RI,["typed"],(e=>{var{typed:t}=e;return t(RI,{"":function(){return!1},boolean:function(e){return e},number:function(e){return!!e},null:function(e){return!1},BigNumber:function(e){return!e.isZero()},string:function(e){var t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1;var n=Number(e);if(""!==e&&!isNaN(n))return!!n;throw new Error('Cannot convert "'+e+'" to a boolean')},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),FI="clone",OI=SN(FI,["typed"],(e=>{var{typed:t}=e;return t(FI,{any:CA})}));function II(e,t){if(t<e)return 1;if(t===e)return t;var n=t+e>>1;return II(e,n)*II(n+1,t)}function BI(e,t){if(!IN(e)||e<0)throw new TypeError("Positive integer value expected in function combinations");if(!IN(t)||t<0)throw new TypeError("Positive integer value expected in function combinations");if(t>e)throw new TypeError("k must be less than or equal to n");for(var n=e-t,r=1,i=2,a=t<n?t:n,o=t<n?n+1:t+1;o<=e;++o)for(r*=o;i<=a&&r%i===0;)r/=i,++i;return i<=a&&(r/=II(i,a)),r}BI.signature="number, number";var kI="combinations",LI=SN(kI,["typed"],(e=>{var{typed:t}=e;return t(kI,{"number, number":BI,"BigNumber, BigNumber":function(e,t){var n,r,i=e.constructor,a=e.minus(t),o=new i(1);if(!UI(e)||!UI(t))throw new TypeError("Positive integer value expected in function combinations");if(t.gt(e))throw new TypeError("k must be less than n in function combinations");if(n=o,t.lt(a))for(r=o;r.lte(a);r=r.plus(o))n=n.times(t.plus(r)).dividedBy(r);else for(r=o;r.lte(t);r=r.plus(o))n=n.times(a.plus(r)).dividedBy(r);return n}})}));function UI(e){return e.isInteger()&&e.gte(0)}var zI=SN("complex",["typed","Complex"],(e=>{var{typed:t,Complex:n}=e;return t("complex",{"":function(){return n.ZERO},number:function(e){return new n(e,0)},"number, number":function(e,t){return new n(e,t)},"BigNumber, BigNumber":function(e,t){return new n(e.toNumber(),t.toNumber())},Fraction:function(e){return new n(e.valueOf(),0)},Complex:function(e){return e.clone()},string:function(e){return n(e)},null:function(e){return n(0)},Object:function(e){if("re"in e&&"im"in e)return new n(e.re,e.im);if("r"in e&&"phi"in e||"abs"in e&&"arg"in e)return new n(e);throw new Error("Expected object with properties (re and im) or (r and phi) or (abs and arg)")},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),HI="conj",VI=SN(HI,["typed"],(e=>{var{typed:t}=e;return t(HI,{"number | BigNumber | Fraction":e=>e,Complex:e=>e.conjugate(),"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),GI=SN("trigUnit",["typed"],(e=>{var{typed:t}=e;return{Unit:t.referToSelf((e=>n=>{if(!n.hasBase(n.constructor.BASE_UNITS.ANGLE))throw new TypeError("Unit in function cot is no angle");return t.find(e,n.valueType())(n.value)}))}})),qI=SN("cos",["typed"],(e=>{var{typed:t}=e,n=GI({typed:t});return t("cos",{number:Math.cos,"Complex | BigNumber":e=>e.cos()},n)})),jI=SN("cot",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t("cot",{number:WO,Complex:e=>e.cot(),BigNumber:e=>new n(1).div(e.tan())},GI({typed:t}))})),WI=SN("csc",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t("csc",{number:YO,Complex:e=>e.csc(),BigNumber:e=>new n(1).div(e.sin())},GI({typed:t}))})),XI="cube",YI=SN(XI,["typed"],(e=>{var{typed:t}=e;return t(XI,{number:bO,Complex:function(e){return e.mul(e).mul(e)},BigNumber:function(e){return e.times(e).times(e)},bigint:function(e){return e*e*e},Fraction:function(e){return e.pow(3)},Unit:function(e){return e.pow(3)}})}));function ZI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e-9,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(n<=0)throw new Error("Relative tolerance must be greater than 0");if(r<0)throw new Error("Absolute tolerance must be at least 0");return!e.isNaN()&&!t.isNaN()&&(e.isFinite()&&t.isFinite()?!!e.eq(t)||e.minus(t).abs().lte(e.constructor.max(e.constructor.max(e.abs(),t.abs()).mul(n),r)):e.eq(t))}var KI=SN("compareUnits",["typed"],(e=>{var{typed:t}=e;return{"Unit, Unit":t.referToSelf((e=>(n,r)=>{if(!n.equalBase(r))throw new Error("Cannot compare units with different base");return t.find(e,[n.valueType(),r.valueType()])(n.value,r.value)}))}})),QI="equalScalar",JI=SN(QI,["typed","config"],(e=>{var{typed:t,config:n}=e,r=KI({typed:t});return t(QI,{"boolean, boolean":function(e,t){return e===t},"number, number":function(e,t){return QN(e,t,n.relTol,n.absTol)},"BigNumber, BigNumber":function(e,t){return e.eq(t)||ZI(e,t,n.relTol,n.absTol)},"bigint, bigint":function(e,t){return e===t},"Fraction, Fraction":function(e,t){return e.equals(t)},"Complex, Complex":function(e,t){return function(e,t,n,r){return QN(e.re,t.re,n,r)&&QN(e.im,t.im,n,r)}(e,t,n.relTol,n.absTol)}},r)})),$I=(SN(QI,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(QI,{"number, number":function(e,t){return QN(e,t,n.relTol,n.absTol)}})})),SN("erf",["typed"],(e=>{var{typed:t}=e;return t("name",{number:function(e){var t=Math.abs(e);return t>=iB?kN(e):t<=eB?kN(e)*function(e){var t,n=e*e,r=nB[0][4]*n,i=n;for(t=0;t<3;t+=1)r=(r+nB[0][t])*n,i=(i+rB[0][t])*n;return e*(r+nB[0][3])/(i+rB[0][3])}(t):t<=4?kN(e)*(1-function(e){var t,n=nB[1][8]*e,r=e;for(t=0;t<7;t+=1)n=(n+nB[1][t])*e,r=(r+rB[1][t])*e;var i=(n+nB[1][7])/(r+rB[1][7]),a=parseInt(16*e)/16,o=(e-a)*(e+a);return Math.exp(-a*a)*Math.exp(-o)*i}(t)):kN(e)*(1-function(e){var t,n=1/(e*e),r=nB[2][5]*n,i=n;for(t=0;t<4;t+=1)r=(r+nB[2][t])*n,i=(i+rB[2][t])*n;var a=n*(r+nB[2][4])/(i+rB[2][4]);a=(tB-a)/e,n=parseInt(16*e)/16;var o=(e-n)*(e+n);return Math.exp(-n*n)*Math.exp(-o)*a}(t))},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})}))),eB=.46875,tB=.5641895835477563,nB=[[3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694,.18577770618460315],[.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972,2.1531153547440383e-8],[.30532663496123236,.36034489994980445,.12578172611122926,.016083785148742275,.0006587491615298378,.016315387137302097]],rB=[[23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171],[15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495],[2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]],iB=Math.pow(2,53),aB=SN("exp",["typed"],(e=>{var{typed:t}=e;return t("exp",{number:_O,Complex:function(e){return e.exp()},BigNumber:function(e){return e.exp()}})})),oB="expm1",sB=SN(oB,["typed","Complex"],(e=>{var{typed:t,Complex:n}=e;return t(oB,{number:wO,Complex:function(e){var t=Math.exp(e.re);return new n(t*Math.cos(e.im)-1,t*Math.sin(e.im))},BigNumber:function(e){return e.exp().minus(1)}})})),lB=SN("filter",["typed"],(e=>{var{typed:t}=e;return t("filter",{"Array, function":cB,"Matrix, function":function(e,t){return e.create(cB(e.valueOf(),t),e.datatype())},"Array, RegExp":OF,"Matrix, RegExp":function(e,t){return e.create(OF(e.valueOf(),t),e.datatype())}})}));function cB(e,t){var n=YF(t,e,"filter");return n.isUnary?FF(e,n.fn):FF(e,(function(e,t,r){return n.fn(e,[t],r)}))}var uB="flatten",hB=SN(uB,["typed"],(e=>{var{typed:t}=e;return t(uB,{Array:function(e){return NF(e)},Matrix:function(e){return e.create(NF(e.valueOf(),!0),e.datatype())}})})),dB="forEach",fB=SN(dB,["typed"],(e=>{var{typed:t}=e;return t(dB,{"Array, function":pB,"Matrix, function":function(e,t){e.forEach(t)}})}));function pB(e,t){var n=YF(t,e,dB);WF(e,n.fn,n.isUnary)}var mB="format",gB=SN(mB,["typed"],(e=>{var{typed:t}=e;return t(mB,{any:sF,"any, Object | function | number | BigNumber":sF})})),vB="getMatrixDataType",yB=SN(vB,["typed"],(e=>{var{typed:t}=e;return t(vB,{Array:function(e){return LF(e,EA)},Matrix:function(e){return e.getDataType()}})})),xB=SN("hex",["typed","format"],(e=>{var{typed:t,format:n}=e;return t("hex",{"number | BigNumber":function(e){return n(e,{notation:"hex"})},"number | BigNumber, number | BigNumber":function(e,t){return n(e,{notation:"hex",wordSize:t})}})})),bB=SN("im",["typed"],(e=>{var{typed:t}=e;return t("im",{number:()=>0,"BigNumber | Fraction":e=>e.mul(0),Complex:e=>e.im,"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),_B="isInteger",wB=SN(_B,["typed"],(e=>{var{typed:t}=e;return t(_B,{number:IN,BigNumber:function(e){return e.isInt()},bigint:function(e){return!0},Fraction:function(e){return 1n===e.d},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),SB="number";function MB(e){return e<0}function DB(e){return e>0}function EB(e){return Number.isNaN(e)}MB.signature=SB,DB.signature=SB,EB.signature=SB;var CB="isNegative",AB=SN(CB,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(CB,{number:e=>!QN(e,0,n.relTol,n.absTol)&&MB(e),BigNumber:e=>!ZI(e,new e.constructor(0),n.relTol,n.absTol)&&(e.isNeg()&&!e.isZero()&&!e.isNaN()),bigint:e=>e<0n,Fraction:e=>e.s<0n,Unit:t.referToSelf((e=>n=>t.find(e,n.valueType())(n.value))),"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),TB="isPositive",NB=SN(TB,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(TB,{number:e=>!QN(e,0,n.relTol,n.absTol)&&DB(e),BigNumber:e=>!ZI(e,new e.constructor(0),n.relTol,n.absTol)&&(!e.isNeg()&&!e.isZero()&&!e.isNaN()),bigint:e=>e>0n,Fraction:e=>e.s>0n&&e.n>0n,Unit:t.referToSelf((e=>n=>t.find(e,n.valueType())(n.value))),"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),RB="isZero",PB=SN(RB,["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return t(RB,{"number | BigNumber | Complex | Fraction":e=>n(e,0),bigint:e=>0n===e,Unit:t.referToSelf((e=>n=>t.find(e,n.valueType())(n.value))),"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})}));function FB(e){var t;if(IN(e))return e<=0?isFinite(e)?1/0:NaN:e>171?1/0:II(1,e-1);if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*FB(1-e));if(e>=171.35)return 1/0;if(e>85){var n=e*e,r=n*e,i=r*e,a=i*e;return Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*n)-139/(51840*r)-571/(2488320*i)+163879/(209018880*a)+5246819/(75246796800*a*e))}--e,t=IB[0];for(var o=1;o<IB.length;++o)t+=IB[o]/(e+o);var s=e+OB+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,e+.5)*Math.exp(-s)*t}FB.signature="number";var OB=4.7421875,IB=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],BB=.9189385332046728,kB=[1.000000000190015,76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function LB(e){if(e<0)return NaN;if(0===e)return 1/0;if(!isFinite(e))return e;if(e<.5)return Math.log(Math.PI/Math.sin(Math.PI*e))-LB(1-e);for(var t=(e-=1)+5+.5,n=kB[0],r=6;r>=1;r--)n+=kB[r]/(e+r);return BB+(e+.5)*Math.log(t)-t+Math.log(n)}LB.signature="number";var UB="lgamma",zB=SN(UB,["Complex","typed"],(e=>{var{Complex:t,typed:n}=e,r=[-.029550653594771242,.00641025641025641,-.0019175269175269176,.0008417508417508417,-.0005952380952380953,.0007936507936507937,-.002777777777777778,.08333333333333333];return n(UB,{number:LB,Complex:function e(n){if(n.isNaN())return new t(NaN,NaN);if(0===n.im)return new t(LB(n.re),0);if(n.re>=7||Math.abs(n.im)>=7)return i(n);if(n.re<=.1){var r=function(e,t){return(e>0||!(e<0)&&1/e===1/0)^(t>0||!(t<0)&&1/t===1/0)?-e:e}(6.283185307179586,n.im)*Math.floor(.5*n.re+.25),o=n.mul(Math.PI).sin().log(),s=e(new t(1-n.re,-n.im));return new t(1.1447298858494002,r).sub(o).sub(s)}return n.im>=0?a(n):a(n.conjugate()).conjugate()},BigNumber:function(){throw new Error("mathjs doesn't yet provide an implementation of the algorithm lgamma for BigNumber")}});function i(e){for(var n=e.sub(.5).mul(e.log()).sub(e).add(BB),i=new t(1,0).div(e),a=i.div(e),o=r[0],s=r[1],l=2*a.re,c=a.re*a.re+a.im*a.im,u=2;u<8;u++){var h=s;s=-c*o+r[u],o=l*o+h}var d=i.mul(a.mul(o).add(s));return n.add(d)}function a(e){var n=0,r=0,a=e;for(e=e.add(1);e.re<=7;){var o=(a=a.mul(e)).im<0?1:0;0!==o&&0===r&&n++,r=o,e=e.add(1)}return i(e).sub(a.log()).sub(new t(0,2*n*Math.PI*1))}}));function HB(e,t,n,r){return function(i){if(i>0||n.predictable){if(i<=0)return NaN;var a=i.toString(16),o=a.substring(0,15);return e*(a.length-o.length)+t(Number("0x"+o))}return r(i.toNumber())}}var VB="log10",GB=["typed","config","Complex"],qB=DO(16),jB=SN(VB,GB,(e=>{var{typed:t,config:n,Complex:r}=e;function i(e){return e.log().div(Math.LN10)}function a(e){return i(new r(e,0))}return t(VB,{number:function(e){return e>=0||n.predictable?DO(e):a(e)},bigint:HB(qB,DO,n,a),Complex:i,BigNumber:function(e){return!e.isNegative()||n.predictable?e.log():a(e.toNumber())},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),WB="log2",XB=SN(WB,["typed","config","Complex"],(e=>{var{typed:t,config:n,Complex:r}=e;function i(e){return a(new r(e,0))}return t(WB,{number:function(e){return e>=0||n.predictable?EO(e):i(e)},bigint:HB(4,EO,n,i),Complex:a,BigNumber:function(e){return!e.isNegative()||n.predictable?e.log(2):i(e.toNumber())},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))});function a(e){var t=Math.sqrt(e.re*e.re+e.im*e.im);return new r(Math.log2?Math.log2(t):Math.log(t)/Math.LN2,Math.atan2(e.im,e.re)/Math.LN2)}})),YB="map",ZB=SN(YB,["typed"],(e=>{var{typed:t}=e;return t(YB,{"Array, function":n,"Matrix, function":function(e,t){return e.map(t)},"Array|Matrix, Array|Matrix, ...Array|Matrix|function":(e,r,i)=>function(e,r){if("function"!==typeof r)throw new Error("Last argument must be a callback function");var i,a=e[0].isMatrix,o=HF(...e.map((e=>e.isMatrix?e.size():mF(e)))),s=a?(e,t)=>e.get(t):qF,l=a?e.map((t=>t.isMatrix?t.create(GF(t.toArray(),o),t.datatype()):e[0].create(GF(t.valueOf(),o)))):e.map((e=>e.isMatrix?GF(e.toArray(),o):GF(e,o)));if(t.isTypedFunction(r)){var c=o.map((()=>0)),u=l.map((e=>s(e,c))),h=v(r,u,c,l);i=m(h)}else{var d=e.length,f=g(r,d);i=m(f)}var p=(e,t)=>i([e,...l.slice(1).map((e=>s(e,t)))],t);return a?l[0].map(p):n(l[0],p);function m(e){switch(e){case 0:return e=>r(...e);case 1:return(e,t)=>r(...e,t);case 2:return(e,t)=>r(...e,t,...l)}}function g(e,t){return e.length>t+1?2:e.length===t+1?1:0}function v(e,n,r,i){return null!==t.resolve(e,[...n,r,...i])?2:null!==t.resolve(e,[...n,r])?1:(t.resolve(e,n),0)}}([e,r,...i.slice(0,i.length-1)],i[i.length-1])});function n(e,t){var n=YF(t,e,YB);return jF(e,n.fn,n.isUnary)}})),KB=SN("multiplyScalar",["typed"],(e=>{var{typed:t}=e;return t("multiplyScalar",{"number, number":gO,"Complex, Complex":function(e,t){return e.mul(t)},"BigNumber, BigNumber":function(e,t){return e.times(t)},"bigint, bigint":function(e,t){return e*t},"Fraction, Fraction":function(e,t){return e.mul(t)},"number | Fraction | BigNumber | Complex, Unit":(e,t)=>t.multiply(e),"Unit, number | Fraction | BigNumber | Complex | Unit":(e,t)=>e.multiply(t)})})),QB="number, number";function JB(e){return!e}function $B(e,t){return!(!e&&!t)}function ek(e,t){return!!e!==!!t}function tk(e,t){return!(!e||!t)}JB.signature="number",$B.signature=QB,ek.signature=QB,tk.signature=QB;var nk=SN("not",["typed"],(e=>{var{typed:t}=e;return t("not",{"null | undefined":()=>!0,number:JB,Complex:function(e){return 0===e.re&&0===e.im},BigNumber:function(e){return e.isZero()||e.isNaN()},bigint:e=>!e,Unit:t.referToSelf((e=>n=>t.find(e,n.valueType())(n.value))),"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})}));var rk=SN("number",["typed"],(e=>{var{typed:t}=e,n=t("number",{"":function(){return 0},number:function(e){return e},string:function(e){if("NaN"===e)return NaN;var t=function(e){var t=e.match(/(0[box])([0-9a-fA-F]*)\.([0-9a-fA-F]*)/);return t?{input:e,radix:{"0b":2,"0o":8,"0x":16}[t[1]],integerPart:t[2],fractionalPart:t[3]}:null}(e);if(t)return function(e){for(var t=parseInt(e.integerPart,e.radix),n=0,r=0;r<e.fractionalPart.length;r++)n+=parseInt(e.fractionalPart[r],e.radix)/Math.pow(e.radix,r+1);var i=t+n;if(isNaN(i))throw new SyntaxError('String "'+e.input+'" is not a valid number');return i}(t);var n=0,r=e.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);r&&(n=Number(r[2]),e=r[1]);var i=Number(e);if(isNaN(i))throw new SyntaxError('String "'+e+'" is not a valid number');if(r){if(i>2**n-1)throw new SyntaxError('String "'.concat(e,'" is out of range'));i>=2**(n-1)&&(i-=2**n)}return i},BigNumber:function(e){return e.toNumber()},bigint:function(e){return Number(e)},Fraction:function(e){return e.valueOf()},Unit:t.referToSelf((e=>t=>{var n=t.clone();return n.value=e(t.value),n})),null:function(e){return 0},"Unit, string | Unit":function(e,t){return e.toNumber(t)},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))});return n.fromJSON=function(e){return parseFloat(e.value)},n})),ik=SN("oct",["typed","format"],(e=>{var{typed:t,format:n}=e;return t("oct",{"number | BigNumber":function(e){return n(e,{notation:"oct"})},"number | BigNumber, number | BigNumber":function(e,t){return n(e,{notation:"oct",wordSize:t})}})})),ak=n(4334),ok=ak(Date.now());function sk(e){var t,n;return t=null===(n=e)?ok:ak(String(n)),function(){return t()}}var lk="pickRandom",ck=SN(lk,["typed","config","?on"],(e=>{var{typed:t,config:n,on:r}=e,i=sk(n.randomSeed);return r&&r("config",(function(e,t){e.randomSeed!==t.randomSeed&&(i=sk(e.randomSeed))})),t(lk,{"Array | Matrix":function(e){return a(e,{})},"Array | Matrix, Object":function(e,t){return a(e,t)},"Array | Matrix, number":function(e,t){return a(e,{number:t})},"Array | Matrix, Array | Matrix":function(e,t){return a(e,{weights:t})},"Array | Matrix, Array | Matrix, number":function(e,t,n){return a(e,{number:n,weights:t})},"Array | Matrix, number, Array | Matrix":function(e,t,n){return a(e,{number:t,weights:n})}});function a(e,t){var{number:n,weights:r,elementWise:a=!0}=t,o="undefined"===typeof n;o&&(n=1);var s=qC(e)?e.create:qC(r)?r.create:null;e=e.valueOf(),r&&(r=r.valueOf()),!0===a&&(e=NF(e),r=NF(r));var l=0;if("undefined"!==typeof r){if(r.length!==e.length)throw new Error("Weights must have the same length as possibles");for(var c=0,u=r.length;c<u;c++){if(!BC(r[c])||r[c]<0)throw new Error("Weights must be an array of positive numbers");l+=r[c]}}for(var h,d=e.length,f=[];f.length<n;){if("undefined"===typeof r)h=e[Math.floor(i()*d)];else for(var p=i()*l,m=0,g=e.length;m<g;m++)if((p-=r[m])<0){h=e[m];break}f.push(h)}return o?f[0]:s?s(f):f}})),uk=/\$([\w.]+)/g,hk="print",dk=SN(hk,["typed"],(e=>{var{typed:t}=e;return t(hk,{"string, Object | Array":fk,"string, Object | Array, number | Object":fk})}));function fk(e,t,n){return e.replace(uk,(function(e,r){var i=r.split("."),a=t[i.shift()];for(void 0!==a&&a.isMatrix&&(a=a.toArray());i.length&&void 0!==a;){var o=i.shift();a=o?a[o]:a+"."}return void 0!==a?VC(a)?a:sF(a,n):e}))}function pk(e,t){var n=[];if((e=e.slice(0)).length>1)for(var r=0,i=e.shift();r<i;r++)n.push(pk(e,t));else for(var a=0,o=e.shift();a<o;a++)n.push(t());return n}var mk="random",gk=SN(mk,["typed","config","?on"],(e=>{var{typed:t,config:n,on:r}=e,i=sk(n.randomSeed);return r&&r("config",(function(e,t){e.randomSeed!==t.randomSeed&&(i=sk(e.randomSeed))})),t(mk,{"":()=>o(0,1),number:e=>o(0,e),"number, number":(e,t)=>o(e,t),"Array | Matrix":e=>a(e,0,1),"Array | Matrix, number":(e,t)=>a(e,0,t),"Array | Matrix, number, number":(e,t,n)=>a(e,t,n)});function a(e,t,n){var r=pk(e.valueOf(),(()=>o(t,n)));return qC(e)?e.create(r,"number"):r}function o(e,t){return e+i()*(t-e)}})),vk=SN("re",["typed"],(e=>{var{typed:t}=e;return t("re",{"number | BigNumber | Fraction":e=>e,Complex:e=>e.re,"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),yk=SN("sec",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t("sec",{number:KO,Complex:e=>e.sec(),BigNumber:e=>new n(1).div(e.cos())},GI({typed:t}))})),xk="sign",bk=SN(xk,["typed","BigNumber","Fraction","complex"],(e=>{var{typed:t,BigNumber:n,complex:r,Fraction:i}=e;return t(xk,{number:AO,Complex:function(e){return 0===e.im?r(AO(e.re)):e.sign()},BigNumber:function(e){return new n(e.cmp(0))},bigint:function(e){return e>0n?1n:e<0n?-1n:0n},Fraction:function(e){return new i(e.s)},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e,!0))),Unit:t.referToSelf((e=>n=>{if(!n._isDerived()&&0!==n.units[0].unit.offset)throw new TypeError("sign is ambiguous for units with offset");return t.find(e,n.valueType())(n.value)}))})})),_k=SN("sin",["typed"],(e=>{var{typed:t}=e,n=GI({typed:t});return t("sin",{number:Math.sin,"Complex | BigNumber":e=>e.sin()},n)})),wk=SN("SparseMatrix",["typed","equalScalar","Matrix"],(e=>{var{typed:t,equalScalar:n,Matrix:r}=e;function i(e,t){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!VC(t))throw new Error("Invalid datatype: "+t);if(qC(e))!function(e,t,n){"SparseMatrix"===t.type?(e._values=t._values?CA(t._values):void 0,e._index=CA(t._index),e._ptr=CA(t._ptr),e._size=CA(t._size),e._datatype=n||t._datatype):a(e,t.valueOf(),n||t._datatype)}(this,e,t);else if(e&&GC(e.index)&&GC(e.ptr)&&GC(e.size))this._values=e.values,this._index=e.index,this._ptr=e.ptr,this._size=e.size,this._datatype=t||e.datatype;else if(GC(e))a(this,e,t);else{if(e)throw new TypeError("Unsupported type of data ("+EA(e)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=t}}function a(e,r,i){e._values=[],e._index=[],e._ptr=[],e._datatype=i;var a=r.length,o=0,s=n,l=0;if(VC(i)&&(s=t.find(n,[i,i])||n,l=t.convert(0,i)),a>0){var c=0;do{e._ptr.push(e._index.length);for(var u=0;u<a;u++){var h=r[u];if(GC(h)){if(0===c&&o<h.length&&(o=h.length),c<h.length){var d=h[c];s(d,l)||(e._values.push(d),e._index.push(u))}}else 0===c&&o<1&&(o=1),s(h,l)||(e._values.push(h),e._index.push(u))}c++}while(c<o)}e._ptr.push(e._index.length),e._size=[a,o]}function o(e,t,n,r){if(n-t===0)return n;for(var i=t;i<n;i++)if(r[i]===e)return i;return t}function s(e,t,n,r,i,a,o){i.splice(e,0,r),a.splice(e,0,t);for(var s=n+1;s<o.length;s++)o[s]++}function l(e,r,i,a){var o=a||0,s=n,l=0;VC(e._datatype)&&(s=t.find(n,[e._datatype,e._datatype])||n,l=t.convert(0,e._datatype),o=t.convert(o,e._datatype));var c,u,h,d=!s(o,l),f=e._size[0],p=e._size[1];if(i>p){for(u=p;u<i;u++)if(e._ptr[u]=e._values.length,d)for(c=0;c<f;c++)e._values.push(o),e._index.push(c);e._ptr[i]=e._values.length}else i<p&&(e._ptr.splice(i+1,p-i),e._values.splice(e._ptr[i],e._values.length),e._index.splice(e._ptr[i],e._index.length));if(p=i,r>f){if(d){var m=0;for(u=0;u<p;u++){e._ptr[u]=e._ptr[u]+m,h=e._ptr[u+1]+m;var g=0;for(c=f;c<r;c++,g++)e._values.splice(h+g,0,o),e._index.splice(h+g,0,c),m++}e._ptr[p]=e._values.length}}else if(r<f){var v=0;for(u=0;u<p;u++){e._ptr[u]=e._ptr[u]-v;var y=e._ptr[u],x=e._ptr[u+1]-v;for(h=y;h<x;h++)(c=e._index[h])>r-1&&(e._values.splice(h,1),e._index.splice(h,1),v++)}e._ptr[u]=e._values.length}return e._size[0]=r,e._size[1]=i,e}function c(e,t,n,r,i){var a,o,s=r[0],l=r[1],c=[];for(a=0;a<s;a++)for(c[a]=[],o=0;o<l;o++)c[a][o]=0;for(o=0;o<l;o++)for(var u=n[o],h=n[o+1],d=u;d<h;d++)c[a=t[d]][o]=e?i?CA(e[d]):e[d]:1;return c}return i.prototype=new r,i.prototype.createSparseMatrix=function(e,t){return new i(e,t)},Object.defineProperty(i,"name",{value:"SparseMatrix"}),i.prototype.constructor=i,i.prototype.type="SparseMatrix",i.prototype.isSparseMatrix=!0,i.prototype.getDataType=function(){return LF(this._values,EA)},i.prototype.storage=function(){return"sparse"},i.prototype.datatype=function(){return this._datatype},i.prototype.create=function(e,t){return new i(e,t)},i.prototype.density=function(){var e=this._size[0],t=this._size[1];return 0!==e&&0!==t?this._index.length/(e*t):0},i.prototype.subset=function(e,t,n){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return function(e,t){if(!ZC(t))throw new TypeError("Invalid index");if(t.isScalar())return e.get(t.min());var n,r,a,o,s=t.size();if(s.length!==e._size.length)throw new fF(s.length,e._size.length);var l=t.min(),c=t.max();for(n=0,r=e._size.length;n<r;n++)xF(l[n],e._size[n]),xF(c[n],e._size[n]);var u=e._values,h=e._index,d=e._ptr,f=t.dimension(0),p=t.dimension(1),m=[],g=[];f.forEach((function(e,t){g[e]=t[0],m[e]=!0}));var v=u?[]:void 0,y=[],x=[];return p.forEach((function(e){for(x.push(y.length),a=d[e],o=d[e+1];a<o;a++)n=h[a],!0===m[n]&&(y.push(g[n]),v&&v.push(u[a]))})),x.push(y.length),new i({values:v,index:y,ptr:x,size:s,datatype:e._datatype})}(this,e);case 2:case 3:return function(e,t,n,r){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var i,a=t.size(),o=t.isScalar();qC(n)?(i=n.size(),n=n.toArray()):i=mF(n);if(o){if(0!==i.length)throw new TypeError("Scalar expected");e.set(t.min(),n,r)}else{if(1!==a.length&&2!==a.length)throw new fF(a.length,e._size.length,"<");if(i.length<a.length){for(var s=0,l=0;1===a[s]&&1===i[s];)s++;for(;1===a[s];)l++,s++;n=AF(n,a.length,l,i)}if(!NA(a,i))throw new fF(a,i,">");if(1===a.length){t.dimension(0).forEach((function(t,i){xF(t),e.set([t,0],n[i[0]],r)}))}else{var c=t.dimension(0),u=t.dimension(1);c.forEach((function(t,i){xF(t),u.forEach((function(a,o){xF(a),e.set([t,a],n[i[0]][o[0]],r)}))}))}}return e}(this,e,t,n);default:throw new SyntaxError("Wrong number of arguments")}},i.prototype.get=function(e){if(!GC(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new fF(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var t=e[0],n=e[1];xF(t,this._size[0]),xF(n,this._size[1]);var r=o(t,this._ptr[n],this._ptr[n+1],this._index);return r<this._ptr[n+1]&&this._index[r]===t?this._values[r]:0},i.prototype.set=function(e,r,i){if(!GC(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new fF(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var a=e[0],c=e[1],u=this._size[0],h=this._size[1],d=n,f=0;VC(this._datatype)&&(d=t.find(n,[this._datatype,this._datatype])||n,f=t.convert(0,this._datatype)),(a>u-1||c>h-1)&&(l(this,Math.max(a+1,u),Math.max(c+1,h),i),u=this._size[0],h=this._size[1]),xF(a,u),xF(c,h);var p=o(a,this._ptr[c],this._ptr[c+1],this._index);return p<this._ptr[c+1]&&this._index[p]===a?d(r,f)?function(e,t,n,r,i){n.splice(e,1),r.splice(e,1);for(var a=t+1;a<i.length;a++)i[a]--}(p,c,this._values,this._index,this._ptr):this._values[p]=r:d(r,f)||s(p,a,c,r,this._values,this._index,this._ptr),this},i.prototype.resize=function(e,t,n){if(!jC(e))throw new TypeError("Array or Matrix expected");var r=e.valueOf().map((e=>Array.isArray(e)&&1===e.length?e[0]:e));if(2!==r.length)throw new Error("Only two dimensions matrix are supported");return r.forEach((function(e){if(!BC(e)||!IN(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+sF(r)+")")})),l(n?this.clone():this,r[0],r[1],t)},i.prototype.reshape=function(e,t){if(!GC(e))throw new TypeError("Array expected");if(2!==e.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");e.forEach((function(t){if(!BC(t)||!IN(t)||t<=-2||0===t)throw new TypeError("Invalid size, must contain positive integers or -1 (size: "+sF(e)+")")}));var n=this._size[0]*this._size[1];if(n!==(e=MF(e,n))[0]*e[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var r=t?this.clone():this;if(this._size[0]===e[0]&&this._size[1]===e[1])return r;for(var i=[],a=0;a<r._ptr.length;a++)for(var l=0;l<r._ptr[a+1]-r._ptr[a];l++)i.push(a);for(var c=r._values.slice(),u=r._index.slice(),h=0;h<r._index.length;h++){var d=u[h],f=i[h],p=d*r._size[1]+f;i[h]=p%e[1],u[h]=Math.floor(p/e[1])}r._values.length=0,r._index.length=0,r._ptr.length=e[1]+1,r._size=e.slice();for(var m=0;m<r._ptr.length;m++)r._ptr[m]=0;for(var g=0;g<c.length;g++){var v=u[g],y=i[g],x=c[g];s(o(v,r._ptr[y],r._ptr[y+1],r._index),v,y,x,r._values,r._index,r._ptr)}return r},i.prototype.clone=function(){return new i({values:this._values?CA(this._values):void 0,index:CA(this._index),ptr:CA(this._ptr),size:CA(this._size),datatype:this._datatype})},i.prototype.size=function(){return this._size.slice(0)},i.prototype.map=function(e,r){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var a=this,o=this._size[0],s=this._size[1],l=YF(e,a,"map");return function(e,r,a,o,s,l,c){var u=[],h=[],d=[],f=n,p=0;VC(e._datatype)&&(f=t.find(n,[e._datatype,e._datatype])||n,p=t.convert(0,e._datatype));for(var m=function(e,t,n){var r=l(e,t,n);f(r,p)||(u.push(r),h.push(t))},g=o;g<=s;g++){d.push(u.length);var v=e._ptr[g],y=e._ptr[g+1];if(c)for(var x=v;x<y;x++){var b=e._index[x];b>=r&&b<=a&&m(e._values[x],b-r,g-o)}else{for(var _={},w=v;w<y;w++){_[e._index[w]]=e._values[w]}for(var S=r;S<=a;S++){m(S in _?_[S]:0,S-r,g-o)}}}return d.push(u.length),new i({values:u,index:h,ptr:d,size:[a-r+1,s-o+1]})}(this,0,o-1,0,s-1,(function(e,t,n){return l.fn(e,[t,n],a)}),r)},i.prototype.forEach=function(e,t){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var n=this,r=this._size[0],i=this._size[1],a=YF(e,n,"forEach"),o=0;o<i;o++){var s=this._ptr[o],l=this._ptr[o+1];if(t)for(var c=s;c<l;c++){var u=this._index[c];a.fn(this._values[c],[u,o],n)}else{for(var h={},d=s;d<l;d++){h[this._index[d]]=this._values[d]}for(var f=0;f<r;f++){var p=f in h?h[f]:0;a.fn(p,[f,o],n)}}}},i.prototype[Symbol.iterator]=function*(){if(!this._values)throw new Error("Cannot iterate a Pattern only matrix");for(var e=this._size[1],t=0;t<e;t++)for(var n=this._ptr[t],r=this._ptr[t+1],i=n;i<r;i++){var a=this._index[i];yield{value:this._values[i],index:[a,t]}}},i.prototype.toArray=function(){return c(this._values,this._index,this._ptr,this._size,!0)},i.prototype.valueOf=function(){return c(this._values,this._index,this._ptr,this._size,!1)},i.prototype.format=function(e){for(var t=this._size[0],n=this._size[1],r=this.density(),i="Sparse Matrix ["+sF(t,e)+" x "+sF(n,e)+"] density: "+sF(r,e)+"\n",a=0;a<n;a++)for(var o=this._ptr[a],s=this._ptr[a+1],l=o;l<s;l++){i+="\n    ("+sF(this._index[l],e)+", "+sF(a,e)+") ==> "+(this._values?sF(this._values[l],e):"X")}return i},i.prototype.toString=function(){return sF(this.toArray())},i.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},i.prototype.diagonal=function(e){if(e){if(kC(e)&&(e=e.toNumber()),!BC(e)||!IN(e))throw new TypeError("The parameter k must be an integer number")}else e=0;var t=e>0?e:0,n=e<0?-e:0,r=this._size[0],a=this._size[1],o=Math.min(r-n,a-t),s=[],l=[],c=[];c[0]=0;for(var u=t;u<a&&s.length<o;u++)for(var h=this._ptr[u],d=this._ptr[u+1],f=h;f<d;f++){var p=this._index[f];if(p===u-t+n){s.push(this._values[f]),l[s.length-1]=p-n;break}}return c.push(s.length),new i({values:s,index:l,ptr:c,size:[o,1]})},i.fromJSON=function(e){return new i(e)},i.diagonal=function(e,r,a,o,s){if(!GC(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map((function(e){if(kC(e)&&(e=e.toNumber()),!BC(e)||!IN(e)||e<1)throw new Error("Size values must be positive integers");return e})),a){if(kC(a)&&(a=a.toNumber()),!BC(a)||!IN(a))throw new TypeError("The parameter k must be an integer number")}else a=0;var l=n,c=0;VC(s)&&(l=t.find(n,[s,s])||n,c=t.convert(0,s));var u,h=a>0?a:0,d=a<0?-a:0,f=e[0],p=e[1],m=Math.min(f-d,p-h);if(GC(r)){if(r.length!==m)throw new Error("Invalid value array length");u=function(e){return r[e]}}else if(qC(r)){var g=r.size();if(1!==g.length||g[0]!==m)throw new Error("Invalid matrix length");u=function(e){return r.get([e])}}else u=function(){return r};for(var v=[],y=[],x=[],b=0;b<p;b++){x.push(v.length);var _=b-h;if(_>=0&&_<m){var w=u(_);l(w,c)||(y.push(_+d),v.push(w))}}return x.push(v.length),new i({values:v,index:y,ptr:x,size:[f,p]})},i.prototype.swapRows=function(e,t){if(!BC(e)||!IN(e)||!BC(t)||!IN(t))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return xF(e,this._size[0]),xF(t,this._size[0]),i._swapRows(e,t,this._size[1],this._values,this._index,this._ptr),this},i._forEachRow=function(e,t,n,r,i){for(var a=r[e],o=r[e+1],s=a;s<o;s++)i(n[s],t[s])},i._swapRows=function(e,t,n,r,i,a){for(var s=0;s<n;s++){var l=a[s],c=a[s+1],u=o(e,l,c,i),h=o(t,l,c,i);if(u<c&&h<c&&i[u]===e&&i[h]===t){if(r){var d=r[u];r[u]=r[h],r[h]=d}}else if(u<c&&i[u]===e&&(h>=c||i[h]!==t)){var f=r?r[u]:void 0;i.splice(h,0,t),r&&r.splice(h,0,f),i.splice(h<=u?u+1:u,1),r&&r.splice(h<=u?u+1:u,1)}else if(h<c&&i[h]===t&&(u>=c||i[u]!==e)){var p=r?r[h]:void 0;i.splice(u,0,e),r&&r.splice(u,0,p),i.splice(u<=h?h+1:h,1),r&&r.splice(u<=h?h+1:h,1)}}},i}),{isClass:!0}),Sk="splitUnit",Mk=SN(Sk,["typed"],(e=>{var{typed:t}=e;return t(Sk,{"Unit, Array":function(e,t){return e.splitUnit(t)}})})),Dk="square",Ek=SN(Dk,["typed"],(e=>{var{typed:t}=e;return t(Dk,{number:TO,Complex:function(e){return e.mul(e)},BigNumber:function(e){return e.times(e)},bigint:function(e){return e*e},Fraction:function(e){return e.mul(e)},Unit:function(e){return e.pow(2)}})})),Ck="string",Ak=SN(Ck,["typed"],(e=>{var{typed:t}=e;return t(Ck,{"":function(){return""},number:qN,null:function(e){return"null"},boolean:function(e){return e+""},string:function(e){return e},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e))),any:function(e){return String(e)}})})),Tk="subtractScalar",Nk=SN(Tk,["typed"],(e=>{var{typed:t}=e;return t(Tk,{"number, number":mO,"Complex, Complex":function(e,t){return e.sub(t)},"BigNumber, BigNumber":function(e,t){return e.minus(t)},"bigint, bigint":function(e,t){return e-t},"Fraction, Fraction":function(e,t){return e.sub(t)},"Unit, Unit":t.referToSelf((e=>(n,r)=>{if(null===n.value||void 0===n.value)throw new Error("Parameter x contains a unit with undefined value");if(null===r.value||void 0===r.value)throw new Error("Parameter y contains a unit with undefined value");if(!n.equalBase(r))throw new Error("Units do not match");var i=n.clone();return i.value=t.find(e,[i.valueType(),r.valueType()])(i.value,r.value),i.fixPrefix=!1,i}))})})),Rk=SN("tan",["typed"],(e=>{var{typed:t}=e,n=GI({typed:t});return t("tan",{number:Math.tan,"Complex | BigNumber":e=>e.tan()},n)})),Pk="typeOf",Fk=SN(Pk,["typed"],(e=>{var{typed:t}=e;return t(Pk,{any:EA})})),Ok="acosh",Ik=SN(Ok,["typed","config","Complex"],(e=>{var{typed:t,config:n,Complex:r}=e;return t(Ok,{number:function(e){return e>=1||n.predictable?kO(e):e<=-1?new r(Math.log(Math.sqrt(e*e-1)-e),Math.PI):new r(e,0).acosh()},Complex:function(e){return e.acosh()},BigNumber:function(e){return e.acosh()}})})),Bk="acsch",kk=SN(Bk,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t(Bk,{number:HO,Complex:function(e){return e.acsch()},BigNumber:function(e){return new n(1).div(e).asinh()}})})),Lk="asec",Uk=SN(Lk,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:n,Complex:r,BigNumber:i}=e;return t(Lk,{number:function(e){return e<=-1||e>=1||n.predictable?VO(e):new r(e,0).asec()},Complex:function(e){return e.asec()},BigNumber:function(e){return new i(1).div(e).acos()}})})),zk=SN("bignumber",["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t("bignumber",{"":function(){return new n(0)},number:function(e){return new n(e+"")},string:function(e){var t=e.match(/(0[box][0-9a-fA-F]*)i([0-9]*)/);if(t){var r=t[2],i=n(t[1]),a=new n(2).pow(Number(r));if(i.gt(a.sub(1)))throw new SyntaxError('String "'.concat(e,'" is out of range'));var o=new n(2).pow(Number(r)-1);return i.gte(o)?i.sub(a):i}return new n(e)},BigNumber:function(e){return e},bigint:function(e){return new n(e.toString())},Unit:t.referToSelf((e=>t=>{var n=t.clone();return n.value=e(t.value),n})),Fraction:function(e){return new n(String(e.n)).div(String(e.d)).times(String(e.s))},null:function(e){return new n(0)},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),Hk="combinationsWithRep",Vk=SN(Hk,["typed"],(e=>{var{typed:t}=e;return t(Hk,{"number, number":function(e,t){if(!IN(e)||e<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(!IN(t)||t<0)throw new TypeError("Positive integer value expected in function combinationsWithRep");if(e<1)throw new TypeError("k must be less than or equal to n + k - 1");return t<e-1?II(e,e+t-1)/II(1,t):II(t+1,e+t-1)/II(1,e-1)},"BigNumber, BigNumber":function(e,t){var n,r,i=new(0,e.constructor)(1),a=e.minus(i);if(!Gk(e)||!Gk(t))throw new TypeError("Positive integer value expected in function combinationsWithRep");if(e.lt(i))throw new TypeError("k must be less than or equal to n + k - 1 in function combinationsWithRep");if(n=i,t.lt(a))for(r=i;r.lte(a);r=r.plus(i))n=n.times(t.plus(r)).dividedBy(r);else for(r=i;r.lte(t);r=r.plus(i))n=n.times(a.plus(r)).dividedBy(r);return n}})}));function Gk(e){return e.isInteger()&&e.gte(0)}var qk="cosh",jk=SN(qk,["typed"],(e=>{var{typed:t}=e;return t(qk,{number:tR,"Complex | BigNumber":e=>e.cosh()})})),Wk="csch",Xk=SN(Wk,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t(Wk,{number:ZO,Complex:e=>e.csch(),BigNumber:e=>new n(1).div(e.sinh())})})),Yk="isNaN",Zk=SN(Yk,["typed"],(e=>{var{typed:t}=e;return t(Yk,{number:EB,BigNumber:function(e){return e.isNaN()},bigint:function(e){return!1},Fraction:function(e){return!1},Complex:function(e){return e.isNaN()},Unit:function(e){return Number.isNaN(e.value)},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),Kk="isPrime",Qk=SN(Kk,["typed"],(e=>{var{typed:t}=e;return t(Kk,{number:function(e){if(e<=3)return e>1;if(e%2===0||e%3===0)return!1;for(var t=5;t*t<=e;t+=6)if(e%t===0||e%(t+2)===0)return!1;return!0},bigint:function(e){if(e<=3n)return e>1n;if(e%2n===0n||e%3n===0n)return!1;for(var t=5n;t*t<=e;t+=6n)if(e%t===0n||e%(t+2n)===0n)return!1;return!0},BigNumber:function(e){if(e.lte(3))return e.gt(1);if(e.mod(2).eq(0)||e.mod(3).eq(0))return!1;if(e.lt(Math.pow(2,32))){for(var t=e.toNumber(),n=5;n*n<=t;n+=6)if(t%n===0||t%(n+2)===0)return!1;return!0}function r(e,t,n){for(var r=1;!t.eq(0);)t.mod(2).eq(0)?(t=t.div(2),e=e.mul(e).mod(n)):(t=t.sub(1),r=e.mul(r).mod(n));return r}for(var i=e.constructor.clone({precision:2*e.toFixed(0).length}),a=0,o=(e=new i(e)).sub(1);o.mod(2).eq(0);)o=o.div(2),a+=1;var s=null;if(e.lt("3317044064679887385961981"))s=[2,3,5,7,11,13,17,19,23,29,31,37,41].filter((t=>t<e));else{var l=Math.min(e.toNumber()-2,Math.floor(2*Math.pow(e.toFixed(0).length*Math.log(10),2)));s=[];for(var c=2;c<=l;c+=1)s.push(l)}for(var u=0;u<s.length;u+=1){var h=s[u],d=r(e.sub(e).add(h),o,e);if(!d.eq(1))for(var f=0,p=d;!p.eq(e.sub(1));f+=1,p=p.mul(p).mod(e))if(f===a-1)return!1}return!0},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),Jk="mapSlices",$k=SN(Jk,["typed","isInteger"],(e=>{var{typed:t,isInteger:n}=e;return t(Jk,{"Array | Matrix, number | BigNumber, function":function(e,t,r){if(!n(t))throw new TypeError("Integer number expected for dimension");var i=Array.isArray(e)?mF(e):e.size();if(t<0||t>=i.length)throw new pF(t,i.length);return qC(e)?e.create(eL(e.valueOf(),t,r),e.datatype()):eL(e,t,r)}})}),{formerly:"apply"});function eL(e,t,n){var r,i,a;if(t<=0){if(Array.isArray(e[0])){for(a=function(e){var t,n,r=e.length,i=e[0].length,a=[];for(n=0;n<i;n++){var o=[];for(t=0;t<r;t++)o.push(e[t][n]);a.push(o)}return a}(e),i=[],r=0;r<a.length;r++)i[r]=eL(a[r],t-1,n);return i}return n(e)}for(i=[],r=0;r<e.length;r++)i[r]=eL(e[r],t-1,n);return i}var tL="matrix",nL=SN(tL,["typed","Matrix","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,Matrix:n,DenseMatrix:r,SparseMatrix:i}=e;return t(tL,{"":function(){return a([])},string:function(e){return a([],e)},"string, string":function(e,t){return a([],e,t)},Array:function(e){return a(e)},Matrix:function(e){return a(e,e.storage())},"Array | Matrix, string":a,"Array | Matrix, string, string":a});function a(e,t,n){if("dense"===t||"default"===t||void 0===t)return new r(e,n);if("sparse"===t)return new i(e,n);throw new TypeError("Unknown matrix type "+JSON.stringify(t)+".")}})),rL="matrixFromFunction",iL=SN(rL,["typed","matrix","isZero"],(e=>{var{typed:t,matrix:n,isZero:r}=e;return t(rL,{"Array | Matrix, function, string, string":function(e,t,n,r){return i(e,t,n,r)},"Array | Matrix, function, string":function(e,t,n){return i(e,t,n)},"Matrix, function":function(e,t){return i(e,t,"dense")},"Array, function":function(e,t){return i(e,t,"dense").toArray()},"Array | Matrix, string, function":function(e,t,n){return i(e,n,t)},"Array | Matrix, string, string, function":function(e,t,n,r){return i(e,r,t,n)}});function i(e,t,i,a){var o;return(o=void 0!==a?n(i,a):n(i)).resize(e),o.forEach((function(e,n){var i=t(n);r(i)||o.set(n,i)})),o}})),aL=SN("ones",["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:n,matrix:r,BigNumber:i}=e;return t("ones",{"":function(){return"Array"===n.matrix?a([]):a([],"default")},"...number | BigNumber | string":function(e){if("string"===typeof e[e.length-1]){var t=e.pop();return a(e,t)}return"Array"===n.matrix?a(e):a(e,"default")},Array:a,Matrix:function(e){var t=e.storage();return a(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return a(e.valueOf(),t)}});function a(e,t){var n=function(e){var t=!1;return e.forEach((function(e,n,r){kC(e)&&(t=!0,r[n]=e.toNumber())})),t}(e),a=n?new i(1):1;if(function(e){e.forEach((function(e){if("number"!==typeof e||!IN(e)||e<0)throw new Error("Parameters in function ones must be positive integers")}))}(e),t){var o=r(t);return e.length>0?o.resize(e,a):o}var s=[];return e.length>0?_F(s,e,a):s}})),oL="randomInt",sL=2n**30n,lL=SN(oL,["typed","config","log2","?on"],(e=>{var{typed:t,config:n,log2:r,on:i}=e,a=sk(n.randomSeed);return i&&i("config",(function(e,t){e.randomSeed!==t.randomSeed&&(a=sk(e.randomSeed))})),t(oL,{"":()=>s(0,2),number:e=>s(0,e),"number, number":(e,t)=>s(e,t),bigint:e=>l(0n,e),"bigint, bigint":l,"Array | Matrix":e=>o(e,0,1),"Array | Matrix, number":(e,t)=>o(e,0,t),"Array | Matrix, number, number":(e,t,n)=>o(e,t,n)});function o(e,t,n){var r=pk(e.valueOf(),(()=>s(t,n)));return qC(e)?e.create(r,"number"):r}function s(e,t){return Math.floor(e+a()*(t-e))}function l(e,t){var n=t-e;if(n<=sL)return e+BigInt(s(0,Number(n)));for(var i=r(n),o=n;o>=n;){o=0n;for(var l=0;l<i;++l)o=2n*o+(a()<.5?0n:1n)}return e+o}})),cL="reshape",uL=SN(cL,["typed","isInteger","matrix"],(e=>{var{typed:t,isInteger:n}=e;return t(cL,{"Matrix, Array":function(e,t){return e.reshape(t,!0)},"Array, Array":function(e,t){return t.forEach((function(e){if(!n(e))throw new TypeError("Invalid size for dimension: "+e)})),SF(e,t)}})})),hL="sech",dL=SN(hL,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t(hL,{number:QO,Complex:e=>e.sech(),BigNumber:e=>new n(1).div(e.cosh())})})),fL="sinh",pL=SN(fL,["typed"],(e=>{var{typed:t}=e;return t(fL,{number:JO,"Complex | BigNumber":e=>e.sinh()})})),mL="sparse",gL=SN(mL,["typed","SparseMatrix"],(e=>{var{typed:t,SparseMatrix:n}=e;return t(mL,{"":function(){return new n([])},string:function(e){return new n([],e)},"Array | Matrix":function(e){return new n(e)},"Array | Matrix, string":function(e,t){return new n(e,t)}})})),vL=SN("sqrt",["config","typed","Complex"],(e=>{var{config:t,typed:n,Complex:r}=e;return n("sqrt",{number:i,Complex:function(e){return e.sqrt()},BigNumber:function(e){return!e.isNegative()||t.predictable?e.sqrt():i(e.toNumber())},Unit:function(e){return e.pow(.5)}});function i(e){return isNaN(e)?NaN:e>=0||t.predictable?Math.sqrt(e):new r(e,0).sqrt()}})),yL="squeeze",xL=SN(yL,["typed"],(e=>{var{typed:t}=e;return t(yL,{Array:function(e){return EF(CA(e))},Matrix:function(e){var t=EF(e.toArray());return Array.isArray(t)?e.create(t,e.datatype()):t},any:function(e){return CA(e)}})})),bL=SN("tanh",["typed"],(e=>{var{typed:t}=e;return t("tanh",{number:rR,"Complex | BigNumber":e=>e.tanh()})})),_L="transpose",wL=SN(_L,["typed","matrix"],(e=>{var{typed:t,matrix:n}=e;return t(_L,{Array:e=>r(n(e)).valueOf(),Matrix:r,any:CA});function r(e){var t,n=e.size();switch(n.length){case 1:t=e.clone();break;case 2:var r=n[0],i=n[1];if(0===i)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+sF(n)+")");switch(e.storage()){case"dense":t=function(e,t,n){for(var r,i=e._data,a=[],o=0;o<n;o++){r=a[o]=[];for(var s=0;s<t;s++)r[s]=CA(i[s][o])}return e.createDenseMatrix({data:a,size:[n,t],datatype:e._datatype})}(e,r,i);break;case"sparse":t=function(e,t,n){for(var r,i,a,o=e._values,s=e._index,l=e._ptr,c=o?[]:void 0,u=[],h=[],d=[],f=0;f<t;f++)d[f]=0;for(r=0,i=s.length;r<i;r++)d[s[r]]++;for(var p=0,m=0;m<t;m++)h.push(p),p+=d[m],d[m]=h[m];for(h.push(p),a=0;a<n;a++)for(var g=l[a],v=l[a+1],y=g;y<v;y++){var x=d[s[y]]++;u[x]=a,o&&(c[x]=CA(o[y]))}return e.createSparseMatrix({values:c,index:u,ptr:h,size:[n,t],datatype:e._datatype})}(e,r,i)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+sF(n)+")")}return t}})),SL="xgcd",ML=SN(SL,["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:n,matrix:r,BigNumber:i}=e;return t(SL,{"number, number":function(e,t){var i=NO(e,t);return"Array"===n.matrix?i:r(i)},"BigNumber, BigNumber":function(e,t){var a,o,s,l,c=new i(0),u=new i(1),h=c,d=u,f=u,p=c;if(!e.isInt()||!t.isInt())throw new Error("Parameters in function xgcd must be integer numbers");for(;!t.isZero();)o=e.div(t).floor(),s=e.mod(t),a=h,h=d.minus(o.times(h)),d=a,a=f,f=p.minus(o.times(f)),p=a,e=t,t=s;l=e.lt(c)?[e.neg(),d.neg(),p.neg()]:[e,e.isZero()?0:d,p];return"Array"===n.matrix?l:r(l)}})})),DL="zeros",EL=SN(DL,["typed","config","matrix","BigNumber"],(e=>{var{typed:t,config:n,matrix:r,BigNumber:i}=e;return t(DL,{"":function(){return"Array"===n.matrix?a([]):a([],"default")},"...number | BigNumber | string":function(e){if("string"===typeof e[e.length-1]){var t=e.pop();return a(e,t)}return"Array"===n.matrix?a(e):a(e,"default")},Array:a,Matrix:function(e){var t=e.storage();return a(e.valueOf(),t)},"Array | Matrix, string":function(e,t){return a(e.valueOf(),t)}});function a(e,t){var n=function(e){var t=!1;return e.forEach((function(e,n,r){kC(e)&&(t=!0,r[n]=e.toNumber())})),t}(e),a=n?new i(0):0;if(function(e){e.forEach((function(e){if("number"!==typeof e||!IN(e)||e<0)throw new Error("Parameters in function zeros must be positive integers")}))}(e),t){var o=r(t);return e.length>0?o.resize(e,a):o}var s=[];return e.length>0?_F(s,e,a):s}})),CL="acoth",AL=SN(CL,["typed","config","Complex","BigNumber"],(e=>{var{typed:t,config:n,Complex:r,BigNumber:i}=e;return t(CL,{number:function(e){return e>=1||e<=-1||n.predictable?UO(e):new r(e,0).acoth()},Complex:function(e){return e.acoth()},BigNumber:function(e){return new i(1).div(e).atanh()}})})),TL="asin",NL=SN(TL,["typed","config","Complex"],(e=>{var{typed:t,config:n,Complex:r}=e;return t(TL,{number:function(e){return e>=-1&&e<=1||n.predictable?Math.asin(e):new r(e,0).asin()},Complex:function(e){return e.asin()},BigNumber:function(e){return e.asin()}})})),RL=SN("bin",["typed","format"],(e=>{var{typed:t,format:n}=e;return t("bin",{"number | BigNumber":function(e){return n(e,{notation:"bin"})},"number | BigNumber, number | BigNumber":function(e,t){return n(e,{notation:"bin",wordSize:t})}})})),PL="concat",FL=SN(PL,["typed","matrix","isInteger"],(e=>{var{typed:t,matrix:n,isInteger:r}=e;return t(PL,{"...Array | Matrix | number | BigNumber":function(e){var t,i,a=e.length,o=-1,s=!1,l=[];for(t=0;t<a;t++){var c=e[t];if(qC(c)&&(s=!0),BC(c)||kC(c)){if(t!==a-1)throw new Error("Dimension must be specified as last argument");if(i=o,o=c.valueOf(),!r(o))throw new TypeError("Integer number expected for dimension");if(o<0||t>0&&o>i)throw new pF(o,i+1)}else{var u=CA(c).valueOf(),h=mF(u);if(l[t]=u,i=o,o=h.length-1,t>0&&o!==i)throw new fF(i+1,o+1)}}if(0===l.length)throw new SyntaxError("At least one matrix expected");for(var d=l.shift();l.length;)d=zF(d,l.shift(),o);return s?n(d):d},"...string":function(e){return e.join("")}})})),OL="coth",IL=SN(OL,["typed","BigNumber"],(e=>{var{typed:t,BigNumber:n}=e;return t(OL,{number:XO,Complex:e=>e.coth(),BigNumber:e=>new n(1).div(e.tanh())})})),BL="ctranspose",kL=SN(BL,["typed","transpose","conj"],(e=>{var{typed:t,transpose:n,conj:r}=e;return t(BL,{any:function(e){return r(n(e))}})})),LL="diag",UL=SN(LL,["typed","matrix","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,matrix:n,DenseMatrix:r,SparseMatrix:i}=e;return t(LL,{Array:function(e){return a(e,0,mF(e),null)},"Array, number":function(e,t){return a(e,t,mF(e),null)},"Array, BigNumber":function(e,t){return a(e,t.toNumber(),mF(e),null)},"Array, string":function(e,t){return a(e,0,mF(e),t)},"Array, number, string":function(e,t,n){return a(e,t,mF(e),n)},"Array, BigNumber, string":function(e,t,n){return a(e,t.toNumber(),mF(e),n)},Matrix:function(e){return a(e,0,e.size(),e.storage())},"Matrix, number":function(e,t){return a(e,t,e.size(),e.storage())},"Matrix, BigNumber":function(e,t){return a(e,t.toNumber(),e.size(),e.storage())},"Matrix, string":function(e,t){return a(e,0,e.size(),t)},"Matrix, number, string":function(e,t,n){return a(e,t,e.size(),n)},"Matrix, BigNumber, string":function(e,t,n){return a(e,t.toNumber(),e.size(),n)}});function a(e,t,a,o){if(!IN(t))throw new TypeError("Second parameter in function diag must be an integer");var s=t>0?t:0,l=t<0?-t:0;switch(a.length){case 1:return function(e,t,n,a,o,s){var l=[a+o,a+s];if(n&&"sparse"!==n&&"dense"!==n)throw new TypeError("Unknown matrix type ".concat(n,'"'));var c="sparse"===n?i.diagonal(l,e,t):r.diagonal(l,e,t);return null!==n?c:c.valueOf()}(e,t,o,a[0],l,s);case 2:return function(e,t,r,i,a,o){if(qC(e)){var s=e.diagonal(t);return null!==r?r!==s.storage()?n(s,r):s:s.valueOf()}for(var l=Math.min(i[0]-a,i[1]-o),c=[],u=0;u<l;u++)c[u]=e[u+a][u+o];return null!==r?n(c):c}(e,t,o,a,l,s)}throw new RangeError("Matrix for function diag must be 2 dimensional")}})),zL=SN("matAlgo02xDS0",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i,a){var o=e._data,s=e._size,l=e._datatype||e.getDataType(),c=r._values,u=r._index,h=r._ptr,d=r._size,f=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(s.length!==d.length)throw new fF(s.length,d.length);if(s[0]!==d[0]||s[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+d+")");if(!c)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p,m=s[0],g=s[1],v=n,y=0,x=i;"string"===typeof l&&l===f&&"mixed"!==l&&(p=l,v=t.find(n,[p,p]),y=t.convert(0,p),x=t.find(i,[p,p]));for(var b=[],_=[],w=[],S=0;S<g;S++){w[S]=_.length;for(var M=h[S],D=h[S+1],E=M;E<D;E++){var C=u[E],A=a?x(c[E],o[C][S]):x(o[C][S],c[E]);v(A,y)||(_.push(C),b.push(A))}}return w[g]=_.length,r.createSparseMatrix({values:b,index:_,ptr:w,size:[m,g],datatype:l===e._datatype&&f===r._datatype?p:void 0})}})),HL=SN("matAlgo09xS0Sf",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i){var a=e._values,o=e._index,s=e._ptr,l=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=r._values,h=r._index,d=r._ptr,f=r._size,p=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(l.length!==f.length)throw new fF(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var m,g=l[0],v=l[1],y=n,x=0,b=i;"string"===typeof c&&c===p&&"mixed"!==c&&(m=c,y=t.find(n,[m,m]),x=t.convert(0,m),b=t.find(i,[m,m]));var _,w,S,M,D,E=a&&u?[]:void 0,C=[],A=[],T=E?[]:void 0,N=[];for(w=0;w<v;w++){A[w]=C.length;var R=w+1;if(T)for(M=d[w],D=d[w+1],S=M;S<D;S++)N[_=h[S]]=R,T[_]=u[S];for(M=s[w],D=s[w+1],S=M;S<D;S++)if(_=o[S],T){var P=N[_]===R?T[_]:x,F=b(a[S],P);y(F,x)||(C.push(_),E.push(F))}else C.push(_)}return A[v]=C.length,e.createSparseMatrix({values:E,index:C,ptr:A,size:[g,v],datatype:c===e._datatype&&p===r._datatype?m:void 0})}})),VL=SN("matAlgo11xS0s",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i,a){var o=e._values,s=e._index,l=e._ptr,c=e._size,u=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,d=c[0],f=c[1],p=n,m=0,g=i;"string"===typeof u&&(h=u,p=t.find(n,[h,h]),m=t.convert(0,h),r=t.convert(r,h),g=t.find(i,[h,h]));for(var v=[],y=[],x=[],b=0;b<f;b++){x[b]=y.length;for(var _=l[b],w=l[b+1],S=_;S<w;S++){var M=s[S],D=a?g(r,o[S]):g(o[S],r);p(D,m)||(y.push(M),v.push(D))}}return x[f]=y.length,e.createSparseMatrix({values:v,index:y,ptr:x,size:[d,f],datatype:h})}})),GL=SN("matAlgo13xDD",["typed"],(e=>{var{typed:t}=e;return function(e,r,i){var a,o=e._data,s=e._size,l=e._datatype,c=r._data,u=r._size,h=r._datatype,d=[];if(s.length!==u.length)throw new fF(s.length,u.length);for(var f=0;f<s.length;f++){if(s[f]!==u[f])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+u+")");d[f]=s[f]}var p=i;"string"===typeof l&&l===h&&(a=l,p=t.find(i,[a,a]));var m=d.length>0?n(p,0,d,d[0],o,c):[];return e.createDenseMatrix({data:m,size:d,datatype:a})};function n(e,t,r,i,a,o){var s=[];if(t===r.length-1)for(var l=0;l<i;l++)s[l]=e(a[l],o[l]);else for(var c=0;c<i;c++)s[c]=n(e,t+1,r,r[t+1],a[c],o[c]);return s}})),qL=SN("matAlgo14xDs",["typed"],(e=>{var{typed:t}=e;return function(e,r,i,a){var o,s=e._data,l=e._size,c=e._datatype,u=i;"string"===typeof c&&(o=c,r=t.convert(r,o),u=t.find(i,[o,o]));var h=l.length>0?n(u,0,l,l[0],s,r,a):[];return e.createDenseMatrix({data:h,size:CA(l),datatype:o})};function n(e,t,r,i,a,o,s){var l=[];if(t===r.length-1)for(var c=0;c<i;c++)l[c]=s?e(o,a[c]):e(a[c],o);else for(var u=0;u<i;u++)l[u]=n(e,t+1,r,r[t+1],a[u],o,s);return l}}));function jL(e,t){if(NA(e.size(),t.size()))return[e,t];var n=HF(e.size(),t.size());return[e,t].map((e=>function(e,t){if(NA(e.size(),t))return e;return e.create(GF(e.valueOf(),t),e.datatype())}(e,n)))}var WL=SN("matrixAlgorithmSuite",["typed","matrix"],(e=>{var{typed:t,matrix:n}=e,r=GL({typed:t}),i=qL({typed:t});return function(e){var a,o=e.elop,s=e.SD||e.DS;o?(a={"DenseMatrix, DenseMatrix":(e,t)=>r(...jL(e,t),o),"Array, Array":(e,t)=>r(...jL(n(e),n(t)),o).valueOf(),"Array, DenseMatrix":(e,t)=>r(...jL(n(e),t),o),"DenseMatrix, Array":(e,t)=>r(...jL(e,n(t)),o)},e.SS&&(a["SparseMatrix, SparseMatrix"]=(t,n)=>e.SS(...jL(t,n),o,!1)),e.DS&&(a["DenseMatrix, SparseMatrix"]=(t,n)=>e.DS(...jL(t,n),o,!1),a["Array, SparseMatrix"]=(t,r)=>e.DS(...jL(n(t),r),o,!1)),s&&(a["SparseMatrix, DenseMatrix"]=(e,t)=>s(...jL(t,e),o,!0),a["SparseMatrix, Array"]=(e,t)=>s(...jL(n(t),e),o,!0))):(a={"DenseMatrix, DenseMatrix":t.referToSelf((e=>(t,n)=>r(...jL(t,n),e))),"Array, Array":t.referToSelf((e=>(t,i)=>r(...jL(n(t),n(i)),e).valueOf())),"Array, DenseMatrix":t.referToSelf((e=>(t,i)=>r(...jL(n(t),i),e))),"DenseMatrix, Array":t.referToSelf((e=>(t,i)=>r(...jL(t,n(i)),e)))},e.SS&&(a["SparseMatrix, SparseMatrix"]=t.referToSelf((t=>(n,r)=>e.SS(...jL(n,r),t,!1)))),e.DS&&(a["DenseMatrix, SparseMatrix"]=t.referToSelf((t=>(n,r)=>e.DS(...jL(n,r),t,!1))),a["Array, SparseMatrix"]=t.referToSelf((t=>(r,i)=>e.DS(...jL(n(r),i),t,!1)))),s&&(a["SparseMatrix, DenseMatrix"]=t.referToSelf((e=>(t,n)=>s(...jL(n,t),e,!0))),a["SparseMatrix, Array"]=t.referToSelf((e=>(t,r)=>s(...jL(n(r),t),e,!0)))));var l=e.scalar||"any";(e.Ds||e.Ss)&&(o?(a["DenseMatrix,"+l]=(e,t)=>i(e,t,o,!1),a[l+", DenseMatrix"]=(e,t)=>i(t,e,o,!0),a["Array,"+l]=(e,t)=>i(n(e),t,o,!1).valueOf(),a[l+", Array"]=(e,t)=>i(n(t),e,o,!0).valueOf()):(a["DenseMatrix,"+l]=t.referToSelf((e=>(t,n)=>i(t,n,e,!1))),a[l+", DenseMatrix"]=t.referToSelf((e=>(t,n)=>i(n,t,e,!0))),a["Array,"+l]=t.referToSelf((e=>(t,r)=>i(n(t),r,e,!1).valueOf())),a[l+", Array"]=t.referToSelf((e=>(t,r)=>i(n(r),t,e,!0).valueOf()))));var c=void 0!==e.sS?e.sS:e.Ss;return o?(e.Ss&&(a["SparseMatrix,"+l]=(t,n)=>e.Ss(t,n,o,!1)),c&&(a[l+", SparseMatrix"]=(e,t)=>c(t,e,o,!0))):(e.Ss&&(a["SparseMatrix,"+l]=t.referToSelf((t=>(n,r)=>e.Ss(n,r,t,!1)))),c&&(a[l+", SparseMatrix"]=t.referToSelf((e=>(t,n)=>c(n,t,e,!0))))),o&&o.signatures&&AA(a,o.signatures),a}})),XL="dotMultiply",YL=SN(XL,["typed","matrix","equalScalar","multiplyScalar","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,multiplyScalar:i,concat:a}=e,o=zL({typed:t,equalScalar:r}),s=HL({typed:t,equalScalar:r}),l=VL({typed:t,equalScalar:r}),c=WL({typed:t,matrix:n,concat:a});return t(XL,c({elop:i,SS:s,DS:o,Ss:l}))})),ZL=SN("matAlgo03xDSf",["typed"],(e=>{var{typed:t}=e;return function(e,n,r,i){var a=e._data,o=e._size,s=e._datatype||e.getDataType(),l=n._values,c=n._index,u=n._ptr,h=n._size,d=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(o.length!==h.length)throw new fF(o.length,h.length);if(o[0]!==h[0]||o[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+h+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,p=o[0],m=o[1],g=0,v=r;"string"===typeof s&&s===d&&"mixed"!==s&&(f=s,g=t.convert(0,f),v=t.find(r,[f,f]));for(var y=[],x=0;x<p;x++)y[x]=[];for(var b=[],_=[],w=0;w<m;w++){for(var S=w+1,M=u[w],D=u[w+1],E=M;E<D;E++){var C=c[E];b[C]=i?v(l[E],a[C][w]):v(a[C][w],l[E]),_[C]=S}for(var A=0;A<p;A++)_[A]===S?y[A][w]=b[A]:y[A][w]=i?v(g,a[A][w]):v(a[A][w],g)}return e.createDenseMatrix({data:y,size:[p,m],datatype:s===e._datatype&&d===n._datatype?f:void 0})}})),KL=SN("matAlgo07xSSf",["typed","SparseMatrix"],(e=>{var{typed:t,SparseMatrix:n}=e;return function(e,i,a){var o=e._size,s=e._datatype||void 0===e._data?e._datatype:e.getDataType(),l=i._size,c=i._datatype||void 0===i._data?i._datatype:i.getDataType();if(o.length!==l.length)throw new fF(o.length,l.length);if(o[0]!==l[0]||o[1]!==l[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+l+")");var u,h=o[0],d=o[1],f=0,p=a;"string"===typeof s&&s===c&&"mixed"!==s&&(u=s,f=t.convert(0,u),p=t.find(a,[u,u]));for(var m=[],g=[],v=new Array(d+1).fill(0),y=[],x=[],b=[],_=[],w=0;w<d;w++){var S=w+1,M=0;r(e,w,b,y,S),r(i,w,_,x,S);for(var D=0;D<h;D++){var E=p(b[D]===S?y[D]:f,_[D]===S?x[D]:f);0!==E&&!1!==E&&(g.push(D),m.push(E),M++)}v[w+1]=v[w]+M}return new n({values:m,index:g,ptr:v,size:[h,d],datatype:s===e._datatype&&c===i._datatype?u:void 0})};function r(e,t,n,r,i){for(var a=e._values,o=e._index,s=e._ptr,l=s[t],c=s[t+1];l<c;l++){var u=o[l];n[u]=i,r[u]=a[l]}}})),QL=SN("matAlgo12xSfs",["typed","DenseMatrix"],(e=>{var{typed:t,DenseMatrix:n}=e;return function(e,r,i,a){var o=e._values,s=e._index,l=e._ptr,c=e._size,u=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,d=c[0],f=c[1],p=i;"string"===typeof u&&(h=u,r=t.convert(r,h),p=t.find(i,[h,h]));for(var m=[],g=[],v=[],y=0;y<f;y++){for(var x=y+1,b=l[y],_=l[y+1],w=b;w<_;w++){var S=s[w];g[S]=o[w],v[S]=x}for(var M=0;M<d;M++)0===y&&(m[M]=[]),v[M]===x?m[M][y]=a?p(r,g[M]):p(g[M],r):m[M][y]=a?p(r,0):p(0,r)}return new n({data:m,size:[d,f],datatype:h})}})),JL="equal",$L=SN(JL,["typed","matrix","equalScalar","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:a,SparseMatrix:o}=e,s=ZL({typed:t}),l=KL({typed:t,SparseMatrix:o}),c=QL({typed:t,DenseMatrix:i}),u=WL({typed:t,matrix:n,concat:a});return t(JL,eU({typed:t,equalScalar:r}),u({elop:r,SS:l,DS:s,Ss:c}))})),eU=SN(JL,["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return t(JL,{"any, any":function(e,t){return null===e?null===t:null===t?null===e:void 0===e?void 0===t:void 0===t?void 0===e:n(e,t)}})})),tU=SN("fraction",["typed","Fraction"],(e=>{var{typed:t,Fraction:n}=e;return t("fraction",{number:function(e){if(!isFinite(e)||isNaN(e))throw new Error(e+" cannot be represented as a fraction");return new n(e)},string:function(e){return new n(e)},"number, number":function(e,t){return new n(e,t)},"bigint, bigint":function(e,t){return new n(e,t)},null:function(e){return new n(0)},BigNumber:function(e){return new n(e.toString())},bigint:function(e){return new n(e.toString())},Fraction:function(e){return e},Unit:t.referToSelf((e=>t=>{var n=t.clone();return n.value=e(t.value),n})),Object:function(e){return new n(e)},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),nU="identity",rU=SN(nU,["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],(e=>{var{typed:t,config:n,matrix:r,BigNumber:i,DenseMatrix:a,SparseMatrix:o}=e;return t(nU,{"":function(){return"Matrix"===n.matrix?r([]):[]},string:function(e){return r(e)},"number | BigNumber":function(e){return l(e,e,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber, string":function(e,t){return l(e,e,t)},"number | BigNumber, number | BigNumber":function(e,t){return l(e,t,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(e,t,n){return l(e,t,n)},Array:function(e){return s(e)},"Array, string":function(e,t){return s(e,t)},Matrix:function(e){return s(e.valueOf(),e.storage())},"Matrix, string":function(e,t){return s(e.valueOf(),t)}});function s(e,t){switch(e.length){case 0:return t?r(t):[];case 1:return l(e[0],e[0],t);case 2:return l(e[0],e[1],t);default:throw new Error("Vector containing two values expected")}}function l(e,t,n){var r=kC(e)||kC(t)?i:null;if(kC(e)&&(e=e.toNumber()),kC(t)&&(t=t.toNumber()),!IN(e)||e<1)throw new Error("Parameters in function identity must be positive integers");if(!IN(t)||t<1)throw new Error("Parameters in function identity must be positive integers");var s=r?new i(1):1,l=r?new r(0):0,c=[e,t];if(n){if("sparse"===n)return o.diagonal(c,s,0,l);if("dense"===n)return a.diagonal(c,s,0,l);throw new TypeError('Unknown matrix type "'.concat(n,'"'))}for(var u=_F([],c,l),h=e<t?e:t,d=0;d<h;d++)u[d][d]=s;return u}})),iU="isNumeric",aU=SN(iU,["typed"],(e=>{var{typed:t}=e;return t(iU,{"number | BigNumber | bigint | Fraction | boolean":()=>!0,"Complex | Unit | string | null | undefined | Node":()=>!1,"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),oU="kron",sU=SN(oU,["typed","matrix","multiplyScalar"],(e=>{var{typed:t,matrix:n,multiplyScalar:r}=e;return t(oU,{"Matrix, Matrix":function(e,t){return n(i(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return n(i(e.toArray(),t))},"Array, Matrix":function(e,t){return n(i(e,t.toArray()))},"Array, Array":i});function i(e,t){if(1===mF(e).length&&(e=[e]),1===mF(t).length&&(t=[t]),mF(e).length>2||mF(t).length>2)throw new RangeError("Vectors with dimensions greater then 2 are not supported expected (Size x = "+JSON.stringify(e.length)+", y = "+JSON.stringify(t.length)+")");var n=[],i=[];return e.map((function(e){return t.map((function(t){return i=[],n.push(i),e.map((function(e){return t.map((function(t){return i.push(r(e,t))}))}))}))}))&&n}})),lU="largerEq",cU=SN(lU,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:n,matrix:r,DenseMatrix:i,concat:a,SparseMatrix:o}=e,s=ZL({typed:t}),l=KL({typed:t,SparseMatrix:o}),c=QL({typed:t,DenseMatrix:i}),u=WL({typed:t,matrix:r,concat:a}),h=KI({typed:t});return t(lU,uU({typed:t,config:n}),{"boolean, boolean":(e,t)=>e>=t,"BigNumber, BigNumber":function(e,t){return e.gte(t)||ZI(e,t,n.relTol,n.absTol)},"bigint, bigint":function(e,t){return e>=t},"Fraction, Fraction":(e,t)=>-1!==e.compare(t),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},h,u({SS:l,DS:s,Ss:c}))})),uU=SN(lU,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(lU,{"number, number":function(e,t){return e>=t||QN(e,t,n.relTol,n.absTol)}})})),hU=SN("matAlgo01xDSid",["typed"],(e=>{var{typed:t}=e;return function(e,n,r,i){var a=e._data,o=e._size,s=e._datatype||e.getDataType(),l=n._values,c=n._index,u=n._ptr,h=n._size,d=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(o.length!==h.length)throw new fF(o.length,h.length);if(o[0]!==h[0]||o[1]!==h[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+h+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var f,p,m=o[0],g=o[1],v="string"===typeof s&&"mixed"!==s&&s===d?s:void 0,y=v?t.find(r,[v,v]):r,x=[];for(f=0;f<m;f++)x[f]=[];var b=[],_=[];for(p=0;p<g;p++){for(var w=p+1,S=u[p],M=u[p+1],D=S;D<M;D++)b[f=c[D]]=i?y(l[D],a[f][p]):y(a[f][p],l[D]),_[f]=w;for(f=0;f<m;f++)_[f]===w?x[f][p]=b[f]:x[f][p]=a[f][p]}return e.createDenseMatrix({data:x,size:[m,g],datatype:s===e._datatype&&d===n._datatype?v:void 0})}})),dU=SN("matAlgo10xSids",["typed","DenseMatrix"],(e=>{var{typed:t,DenseMatrix:n}=e;return function(e,r,i,a){var o=e._values,s=e._index,l=e._ptr,c=e._size,u=e._datatype;if(!o)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,d=c[0],f=c[1],p=i;"string"===typeof u&&(h=u,r=t.convert(r,h),p=t.find(i,[h,h]));for(var m=[],g=[],v=[],y=0;y<f;y++){for(var x=y+1,b=l[y],_=l[y+1],w=b;w<_;w++){var S=s[w];g[S]=o[w],v[S]=x}for(var M=0;M<d;M++)0===y&&(m[M]=[]),v[M]===x?m[M][y]=a?p(r,g[M]):p(g[M],r):m[M][y]=r}return new n({data:m,size:[d,f],datatype:h})}})),fU=SN("matAlgo08xS0Sid",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i){var a=e._values,o=e._index,s=e._ptr,l=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=r._values,h=r._index,d=r._ptr,f=r._size,p=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(l.length!==f.length)throw new fF(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");if(!a||!u)throw new Error("Cannot perform operation on Pattern Sparse Matrices");var m,g=l[0],v=l[1],y=n,x=0,b=i;"string"===typeof c&&c===p&&"mixed"!==c&&(m=c,y=t.find(n,[m,m]),x=t.convert(0,m),b=t.find(i,[m,m]));for(var _,w,S,M,D=[],E=[],C=[],A=[],T=[],N=0;N<v;N++){C[N]=E.length;var R=N+1;for(w=s[N],S=s[N+1],_=w;_<S;_++)T[M=o[_]]=R,A[M]=a[_],E.push(M);for(w=d[N],S=d[N+1],_=w;_<S;_++)T[M=h[_]]===R&&(A[M]=b(A[M],u[_]));for(_=C[N];_<E.length;){var P=A[M=E[_]];y(P,x)?E.splice(_,1):(D.push(P),_++)}}return C[v]=E.length,e.createSparseMatrix({values:D,index:E,ptr:C,size:[g,v],datatype:c===e._datatype&&p===r._datatype?m:void 0})}})),pU=SN("useMatrixForArrayScalar",["typed","matrix"],(e=>{var{typed:t,matrix:n}=e;return{"Array, number":t.referTo("DenseMatrix, number",(e=>(t,r)=>e(n(t),r).valueOf())),"Array, BigNumber":t.referTo("DenseMatrix, BigNumber",(e=>(t,r)=>e(n(t),r).valueOf())),"number, Array":t.referTo("number, DenseMatrix",(e=>(t,r)=>e(t,n(r)).valueOf())),"BigNumber, Array":t.referTo("BigNumber, DenseMatrix",(e=>(t,r)=>e(t,n(r)).valueOf()))}})),mU="leftShift",gU=SN(mU,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,DenseMatrix:a,concat:o}=e,s=hU({typed:t}),l=zL({typed:t,equalScalar:r}),c=fU({typed:t,equalScalar:r}),u=dU({typed:t,DenseMatrix:a}),h=VL({typed:t,equalScalar:r}),d=qL({typed:t}),f=WL({typed:t,matrix:n,concat:o}),p=pU({typed:t,matrix:n});return t(mU,{"number, number":EI,"BigNumber, BigNumber":xI,"bigint, bigint":(e,t)=>e<<t,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():h(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():d(t,n,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):u(n,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):d(n,t,e,!0)))},p,f({SS:c,DS:s,SD:l}))})),vU="mode",yU=SN(vU,["typed","isNaN","isNumeric"],(e=>{var{typed:t,isNaN:n,isNumeric:r}=e;return t(vU,{"Array | Matrix":i,"...":function(e){return i(e)}});function i(e){if(0===(e=NF(e.valueOf())).length)throw new Error("Cannot calculate mode of an empty array");for(var t={},i=[],a=0,o=0;o<e.length;o++){var s=e[o];if(r(s)&&n(s))throw new Error("Cannot calculate mode of an array containing NaN values");s in t||(t[s]=0),t[s]++,t[s]===a?i.push(s):t[s]>a&&(a=t[s],i=[s])}return i}})),xU=SN("matAlgo06xS0S0",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i){var a=e._values,o=e._size,s=e._datatype||void 0===e._data?e._datatype:e.getDataType(),l=r._values,c=r._size,u=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(o.length!==c.length)throw new fF(o.length,c.length);if(o[0]!==c[0]||o[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+c+")");var h,d=o[0],f=o[1],p=n,m=0,g=i;"string"===typeof s&&s===u&&"mixed"!==s&&(h=s,p=t.find(n,[h,h]),m=t.convert(0,h),g=t.find(i,[h,h]));for(var v=a&&l?[]:void 0,y=[],x=[],b=v?[]:void 0,_=[],w=[],S=0;S<f;S++){x[S]=y.length;var M=S+1;if(uO(e,S,_,b,w,M,y,g),uO(r,S,_,b,w,M,y,g),b)for(var D=x[S];D<y.length;){var E=y[D];if(w[E]===M){var C=b[E];p(C,m)?y.splice(D,1):(v.push(C),D++)}else y.splice(D,1)}else for(var A=x[S];A<y.length;){w[y[A]]!==M?y.splice(A,1):A++}}return x[f]=y.length,e.createSparseMatrix({values:v,index:y,ptr:x,size:[d,f],datatype:s===e._datatype&&u===r._datatype?h:void 0})}})),bU="nthRoot",_U=SN(bU,["typed","matrix","equalScalar","BigNumber","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,BigNumber:i,concat:a}=e,o=hU({typed:t}),s=zL({typed:t,equalScalar:r}),l=xU({typed:t,equalScalar:r}),c=VL({typed:t,equalScalar:r}),u=WL({typed:t,matrix:n,concat:a});function h(){throw new Error("Complex number not supported in function nthRoot. Use nthRoots instead.")}return t(bU,{number:CO,"number, number":CO,BigNumber:e=>d(e,new i(2)),"BigNumber, BigNumber":d,Complex:h,"Complex, number":h,Array:t.referTo("DenseMatrix,number",(e=>t=>e(n(t),2).valueOf())),DenseMatrix:t.referTo("DenseMatrix,number",(e=>t=>e(t,2))),SparseMatrix:t.referTo("SparseMatrix,number",(e=>t=>e(t,2))),"SparseMatrix, SparseMatrix":t.referToSelf((e=>(t,n)=>{if(1===n.density())return l(t,n,e);throw new Error("Root must be non-zero")})),"DenseMatrix, SparseMatrix":t.referToSelf((e=>(t,n)=>{if(1===n.density())return o(t,n,e,!1);throw new Error("Root must be non-zero")})),"Array, SparseMatrix":t.referTo("DenseMatrix,SparseMatrix",(e=>(t,r)=>e(n(t),r))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,n)=>{if(1===n.density())return c(n,t,e,!0);throw new Error("Root must be non-zero")}))},u({scalar:"number | BigNumber",SD:s,Ss:c,sS:!1}));function d(e,t){var n=i.precision,r=i.clone({precision:n+2}),a=new i(0),o=new r(1),s=t.isNegative();if(s&&(t=t.neg()),t.isZero())throw new Error("Root must be non-zero");if(e.isNegative()&&!t.abs().mod(2).equals(1))throw new Error("Root must be odd when a is negative.");if(e.isZero())return s?new r(1/0):0;if(!e.isFinite())return s?a:e;var l=e.abs().pow(o.div(t));return l=e.isNeg()?l.neg():l,new i((s?o.div(l):l).toPrecision(n))}}));function wU(){throw new Error('No "bignumber" implementation available')}function SU(){throw new Error('No "fraction" implementation available')}function MU(){throw new Error('No "matrix" implementation available')}var DU=SN("numeric",["number","?bignumber","?fraction"],(e=>{var{number:t,bignumber:n,fraction:r}=e,i={string:!0,number:!0,BigNumber:!0,Fraction:!0},a={number:e=>t(e),BigNumber:n?e=>n(e):wU,bigint:e=>BigInt(e),Fraction:r?e=>r(e):SU};return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"number";if(void 0!==(arguments.length>2?arguments[2]:void 0))throw new SyntaxError("numeric() takes one or two arguments");var n=EA(e);if(!(n in i))throw new TypeError("Cannot convert "+e+' of type "'+n+'"; valid input types are '+Object.keys(i).join(", "));if(!(t in a))throw new TypeError("Cannot convert "+e+' to type "'+t+'"; valid output types are '+Object.keys(a).join(", "));return t===n?e:a[t](e)}}));function EU(e,t,n){var r;return String(e).includes("Unexpected type")?(r=arguments.length>2?" (type: "+EA(n)+", value: "+JSON.stringify(n)+")":" (type: "+e.data.actual+")",new TypeError("Cannot calculate "+t+", unexpected type of argument"+r)):String(e).includes("complex numbers")?(r=arguments.length>2?" (type: "+EA(n)+", value: "+JSON.stringify(n)+")":"",new TypeError("Cannot calculate "+t+", no ordering relation is defined for complex numbers"+r)):e}var CU="prod",AU=SN(CU,["typed","config","multiplyScalar","numeric"],(e=>{var{typed:t,config:n,multiplyScalar:r,numeric:i}=e;return t(CU,{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("prod(A, dim) is not yet supported")},"...":function(e){return a(e)}});function a(e){var t;if(oO(e,(function(e){try{t=void 0===t?e:r(t,e)}catch(n){throw EU(n,"prod",e)}})),"string"===typeof t&&(t=i(t,BN(t,n))),void 0===t)throw new Error("Cannot calculate prod of an empty array");return t}}));function TU(e,t,n,r){if(!(this instanceof TU))throw new SyntaxError("Constructor must be called with the new operator");this.fn=e,this.count=t,this.min=n,this.max=r,this.message="Wrong number of arguments in function "+e+" ("+t+" provided, "+n+(void 0!==r&&null!==r?"-"+r:"")+" expected)",this.stack=(new Error).stack}TU.prototype=new Error,TU.prototype.constructor=Error,TU.prototype.name="ArgumentsError",TU.prototype.isArgumentsError=!0;var NU=SN("resize",["config","matrix"],(e=>{var{config:t,matrix:n}=e;return function(e,r,i){if(2!==arguments.length&&3!==arguments.length)throw new TU("resize",arguments.length,2,3);if(qC(r)&&(r=r.valueOf()),kC(r[0])&&(r=r.map((function(e){return kC(e)?e.toNumber():e}))),qC(e))return e.resize(r,i,!0);if("string"===typeof e)return function(e,t,n){if(void 0!==n){if("string"!==typeof n||1!==n.length)throw new TypeError("Single character expected as defaultValue")}else n=" ";if(1!==t.length)throw new fF(t.length,1);var r=t[0];if("number"!==typeof r||!IN(r))throw new TypeError("Invalid size, must contain positive integers (size: "+sF(t)+")");if(e.length>r)return e.substring(0,r);if(e.length<r){for(var i=e,a=0,o=r-e.length;a<o;a++)i+=n;return i}return e}(e,r,i);var a=!Array.isArray(e)&&"Array"!==t.matrix;if(0===r.length){for(;Array.isArray(e);)e=e[0];return CA(e)}Array.isArray(e)||(e=[e]);var o=_F(e=CA(e),r,i);return a?n(o):o}})),RU="rightArithShift",PU=SN(RU,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,DenseMatrix:a,concat:o}=e,s=hU({typed:t}),l=zL({typed:t,equalScalar:r}),c=fU({typed:t,equalScalar:r}),u=dU({typed:t,DenseMatrix:a}),h=VL({typed:t,equalScalar:r}),d=qL({typed:t}),f=WL({typed:t,matrix:n,concat:o}),p=pU({typed:t,matrix:n});return t(RU,{"number, number":CI,"BigNumber, BigNumber":bI,"bigint, bigint":(e,t)=>e>>t,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():h(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():d(t,n,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):u(n,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):d(n,t,e,!0)))},p,f({SS:c,DS:s,SD:l}))})),FU="Number of decimals in function round must be an integer",OU="round",IU=SN(OU,["typed","config","matrix","equalScalar","zeros","BigNumber","DenseMatrix"],(e=>{var{typed:t,config:n,matrix:r,equalScalar:i,zeros:a,BigNumber:o,DenseMatrix:s}=e,l=VL({typed:t,equalScalar:i}),c=QL({typed:t,DenseMatrix:s}),u=qL({typed:t});function h(e){return Math.abs(WN(e).exponent)}return t(OU,{number:function(e){var t=PO(e,h(n.relTol));return PO(QN(e,t,n.relTol,n.absTol)?t:e)},"number, number":function(e,t){var r=h(n.relTol);if(t>=r)return PO(e,t);var i=PO(e,r);return PO(QN(e,i,n.relTol,n.absTol)?i:e,t)},"number, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(FU);return new o(e).toDecimalPlaces(t.toNumber())},Complex:function(e){return e.round()},"Complex, number":function(e,t){if(t%1)throw new TypeError(FU);return e.round(t)},"Complex, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(FU);var n=t.toNumber();return e.round(n)},BigNumber:function(e){var t=new o(e).toDecimalPlaces(h(n.relTol));return(ZI(e,t,n.relTol,n.absTol)?t:e).toDecimalPlaces(0)},"BigNumber, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(FU);var r=h(n.relTol);if(t>=r)return e.toDecimalPlaces(t.toNumber());var i=e.toDecimalPlaces(r);return(ZI(e,i,n.relTol,n.absTol)?i:e).toDecimalPlaces(t.toNumber())},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.round()},"Fraction, number":function(e,t){if(t%1)throw new TypeError(FU);return e.round(t)},"Fraction, BigNumber":function(e,t){if(!t.isInteger())throw new TypeError(FU);return e.round(t.toNumber())},"Unit, number, Unit":t.referToSelf((e=>function(t,n,r){var i=t.toNumeric(r);return r.multiply(e(i,n))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>e(t,n.toNumber(),r))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>sO(t,(t=>e(t,n,r)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,n)=>e(t,0,n))),"Array | Matrix":t.referToSelf((e=>t=>sO(t,e,!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>l(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>u(t,n,e,!1))),"Array, number | BigNumber":t.referToSelf((e=>(t,n)=>u(r(t),n,e,!1).valueOf())),"number | Complex | BigNumber | Fraction, SparseMatrix":t.referToSelf((e=>(t,n)=>i(t,0)?a(n.size(),n.storage()):c(n,t,e,!0))),"number | Complex | BigNumber | Fraction, DenseMatrix":t.referToSelf((e=>(t,n)=>i(t,0)?a(n.size(),n.storage()):u(n,t,e,!0))),"number | Complex | BigNumber | Fraction, Array":t.referToSelf((e=>(t,n)=>u(r(n),t,e,!0).valueOf()))})})),BU="size",kU=SN(BU,["typed","config","?matrix"],(e=>{var{typed:t,config:n,matrix:r}=e;return t(BU,{Matrix:function(e){return e.create(e.size(),"number")},Array:mF,string:function(e){return"Array"===n.matrix?[e.length]:r([e.length],"dense","number")},"number | Complex | BigNumber | Unit | boolean | null":function(e){return"Array"===n.matrix?[]:r?r([],"dense","number"):MU()}})})),LU="smaller",UU=SN(LU,["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:n,bignumber:r,matrix:i,DenseMatrix:a,concat:o,SparseMatrix:s}=e,l=ZL({typed:t}),c=KL({typed:t,SparseMatrix:s}),u=QL({typed:t,DenseMatrix:a}),h=WL({typed:t,matrix:i,concat:o}),d=KI({typed:t});function f(e,t){return e.lt(t)&&!ZI(e,t,n.relTol,n.absTol)}return t(LU,zU({typed:t,config:n}),{"boolean, boolean":(e,t)=>e<t,"BigNumber, BigNumber":f,"bigint, bigint":(e,t)=>e<t,"Fraction, Fraction":(e,t)=>-1===e.compare(t),"Fraction, BigNumber":function(e,t){return f(r(e),t)},"BigNumber, Fraction":function(e,t){return f(e,r(t))},"Complex, Complex":function(e,t){throw new TypeError("No ordering relation is defined for complex numbers")}},d,h({SS:c,DS:l,Ss:u}))})),zU=SN(LU,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(LU,{"number, number":function(e,t){return e<t&&!QN(e,t,n.relTol,n.absTol)}})})),HU=SN("to",["typed","matrix","concat"],(e=>{var{typed:t,matrix:n,concat:r}=e;return t("to",{"Unit, Unit | string":(e,t)=>e.to(t)},WL({typed:t,matrix:n,concat:r})({Ds:!0}))})),VU="unaryMinus",GU=SN(VU,["typed"],(e=>{var{typed:t}=e;return t(VU,{number:vO,"Complex | BigNumber | Fraction":e=>e.neg(),bigint:e=>-e,Unit:t.referToSelf((e=>n=>{var r=n.clone();return r.value=t.find(e,r.valueType())(n.value),r})),"Array | Matrix":t.referToSelf((e=>t=>sO(t,e,!0)))})})),qU="unequal",jU=SN(qU,["typed","config","equalScalar","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:n,equalScalar:r,matrix:i,DenseMatrix:a,concat:o,SparseMatrix:s}=e,l=ZL({typed:t}),c=KL({typed:t,SparseMatrix:s}),u=QL({typed:t,DenseMatrix:a}),h=WL({typed:t,matrix:i,concat:o});return t(qU,WU({typed:t,equalScalar:r}),h({elop:function(e,t){return!r(e,t)},SS:c,DS:l,Ss:u}))})),WU=SN(qU,["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return t(qU,{"any, any":function(e,t){return null===e?null!==t:null===t?null!==e:void 0===e?void 0!==t:void 0===t?void 0!==e:!n(e,t)}})})),XU=SN("xor",["typed","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:n,DenseMatrix:r,concat:i,SparseMatrix:a}=e,o=ZL({typed:t}),s=KL({typed:t,SparseMatrix:a}),l=QL({typed:t,DenseMatrix:r}),c=WL({typed:t,matrix:n,concat:i});return t("xor",{"number, number":ek,"Complex, Complex":function(e,t){return(0!==e.re||0!==e.im)!==(0!==t.re||0!==t.im)},"bigint, bigint":ek,"BigNumber, BigNumber":function(e,t){return(!e.isZero()&&!e.isNaN())!==(!t.isZero()&&!t.isNaN())},"Unit, Unit":t.referToSelf((e=>(t,n)=>e(t.value||0,n.value||0)))},c({SS:s,DS:o,Ss:l}))})),YU=SN("matAlgo04xSidSid",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i){var a=e._values,o=e._index,s=e._ptr,l=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=r._values,h=r._index,d=r._ptr,f=r._size,p=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(l.length!==f.length)throw new fF(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var m,g=l[0],v=l[1],y=n,x=0,b=i;"string"===typeof c&&c===p&&"mixed"!==c&&(m=c,y=t.find(n,[m,m]),x=t.convert(0,m),b=t.find(i,[m,m]));var _,w,S,M,D,E=a&&u?[]:void 0,C=[],A=[],T=a&&u?[]:void 0,N=a&&u?[]:void 0,R=[],P=[];for(w=0;w<v;w++){A[w]=C.length;var F=w+1;for(M=s[w],D=s[w+1],S=M;S<D;S++)_=o[S],C.push(_),R[_]=F,T&&(T[_]=a[S]);for(M=d[w],D=d[w+1],S=M;S<D;S++)if(R[_=h[S]]===F){if(T){var O=b(T[_],u[S]);y(O,x)?R[_]=null:T[_]=O}}else C.push(_),P[_]=F,N&&(N[_]=u[S]);if(T&&N)for(S=A[w];S<C.length;)R[_=C[S]]===F?(E[S]=T[_],S++):P[_]===F?(E[S]=N[_],S++):C.splice(S,1)}return A[v]=C.length,e.createSparseMatrix({values:E,index:C,ptr:A,size:[g,v],datatype:c===e._datatype&&p===r._datatype?m:void 0})}})),ZU=SN("add",["typed","matrix","addScalar","equalScalar","DenseMatrix","SparseMatrix","concat"],(e=>{var{typed:t,matrix:n,addScalar:r,equalScalar:i,DenseMatrix:a,SparseMatrix:o,concat:s}=e,l=hU({typed:t}),c=YU({typed:t,equalScalar:i}),u=dU({typed:t,DenseMatrix:a}),h=WL({typed:t,matrix:n,concat:s});return t("add",{"any, any":r,"any, any, ...any":t.referToSelf((e=>(t,n,r)=>{for(var i=e(t,n),a=0;a<r.length;a++)i=e(i,r[a]);return i}))},h({elop:r,DS:l,SS:c,Ss:u}))})),KU="atan2",QU=SN(KU,["typed","matrix","equalScalar","BigNumber","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,BigNumber:i,DenseMatrix:a,concat:o}=e,s=zL({typed:t,equalScalar:r}),l=ZL({typed:t}),c=HL({typed:t,equalScalar:r}),u=VL({typed:t,equalScalar:r}),h=QL({typed:t,DenseMatrix:a}),d=WL({typed:t,matrix:n,concat:o});return t(KU,{"number, number":Math.atan2,"BigNumber, BigNumber":(e,t)=>i.atan2(e,t)},d({scalar:"number | BigNumber",SS:c,DS:l,SD:s,Ss:u,sS:h}))})),JU="bitAnd",$U=SN(JU,["typed","matrix","equalScalar","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,concat:i}=e,a=zL({typed:t,equalScalar:r}),o=xU({typed:t,equalScalar:r}),s=VL({typed:t,equalScalar:r}),l=WL({typed:t,matrix:n,concat:i});return t(JU,{"number, number":wI,"BigNumber, BigNumber":fI,"bigint, bigint":(e,t)=>e&t},l({SS:o,DS:a,Ss:s}))})),ez="bitOr",tz=SN(ez,["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:a}=e,o=hU({typed:t}),s=YU({typed:t,equalScalar:r}),l=dU({typed:t,DenseMatrix:i}),c=WL({typed:t,matrix:n,concat:a});return t(ez,{"number, number":MI,"BigNumber, BigNumber":mI,"bigint, bigint":(e,t)=>e|t},c({SS:s,DS:o,Ss:l}))})),nz="bitXor",rz=SN(nz,["typed","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:n,DenseMatrix:r,concat:i,SparseMatrix:a}=e,o=ZL({typed:t}),s=KL({typed:t,SparseMatrix:a}),l=QL({typed:t,DenseMatrix:r}),c=WL({typed:t,matrix:n,concat:i});return t(nz,{"number, number":DI,"BigNumber, BigNumber":yI,"bigint, bigint":(e,t)=>e^t},c({SS:s,DS:o,Ss:l}))})),iz="cbrt",az=SN(iz,["config","typed","isNegative","unaryMinus","matrix","Complex","BigNumber","Fraction"],(e=>{var{config:t,typed:n,isNegative:r,unaryMinus:i,matrix:a,Complex:o,BigNumber:s,Fraction:l}=e;return n(iz,{number:xO,Complex:c,"Complex, boolean":c,BigNumber:function(e){return e.cbrt()},Unit:function(e){if(e.value&&UC(e.value)){var t=e.clone();return t.value=1,(t=t.pow(1/3)).value=c(e.value),t}var n,a=r(e.value);a&&(e.value=i(e.value)),n=kC(e.value)?new s(1).div(3):zC(e.value)?new l(1,3):1/3;var o=e.pow(n);return a&&(o.value=i(o.value)),o}});function c(e,n){var r=e.arg()/3,i=e.abs(),s=new o(xO(i),0).mul(new o(0,r).exp());if(n){var l=[s,new o(xO(i),0).mul(new o(0,r+2*Math.PI/3).exp()),new o(xO(i),0).mul(new o(0,r-2*Math.PI/3).exp())];return"Array"===t.matrix?l:a(l)}return s}})),oz=SN("matAlgo05xSfSf",["typed","equalScalar"],(e=>{var{typed:t,equalScalar:n}=e;return function(e,r,i){var a=e._values,o=e._index,s=e._ptr,l=e._size,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=r._values,h=r._index,d=r._ptr,f=r._size,p=r._datatype||void 0===r._data?r._datatype:r.getDataType();if(l.length!==f.length)throw new fF(l.length,f.length);if(l[0]!==f[0]||l[1]!==f[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+f+")");var m,g=l[0],v=l[1],y=n,x=0,b=i;"string"===typeof c&&c===p&&"mixed"!==c&&(m=c,y=t.find(n,[m,m]),x=t.convert(0,m),b=t.find(i,[m,m]));var _,w,S,M,D=a&&u?[]:void 0,E=[],C=[],A=D?[]:void 0,T=D?[]:void 0,N=[],R=[];for(w=0;w<v;w++){C[w]=E.length;var P=w+1;for(S=s[w],M=s[w+1];S<M;S++)_=o[S],E.push(_),N[_]=P,A&&(A[_]=a[S]);for(S=d[w],M=d[w+1];S<M;S++)N[_=h[S]]!==P&&E.push(_),R[_]=P,T&&(T[_]=u[S]);if(D)for(S=C[w];S<E.length;){var F=N[_=E[S]],O=R[_];if(F===P||O===P){var I=b(F===P?A[_]:x,O===P?T[_]:x);y(I,x)?E.splice(S,1):(D.push(I),S++)}}}return C[v]=E.length,e.createSparseMatrix({values:D,index:E,ptr:C,size:[g,v],datatype:c===e._datatype&&p===r._datatype?m:void 0})}})),sz="compare",lz=SN(sz,["typed","config","matrix","equalScalar","BigNumber","Fraction","DenseMatrix","concat"],(e=>{var{typed:t,config:n,equalScalar:r,matrix:i,BigNumber:a,Fraction:o,DenseMatrix:s,concat:l}=e,c=ZL({typed:t}),u=oz({typed:t,equalScalar:r}),h=QL({typed:t,DenseMatrix:s}),d=WL({typed:t,matrix:i,concat:l}),f=KI({typed:t});return t(sz,cz({typed:t,config:n}),{"boolean, boolean":function(e,t){return e===t?0:e>t?1:-1},"BigNumber, BigNumber":function(e,t){return ZI(e,t,n.relTol,n.absTol)?new a(0):new a(e.cmp(t))},"bigint, bigint":function(e,t){return e===t?0n:e>t?1n:-1n},"Fraction, Fraction":function(e,t){return new o(e.compare(t))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},f,d({SS:u,DS:c,Ss:h}))})),cz=SN(sz,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(sz,{"number, number":function(e,t){return QN(e,t,n.relTol,n.absTol)?0:e>t?1:-1}})})),uz="compareText",hz=["typed","matrix","concat"];dF.signature="any, any";var dz=SN(uz,hz,(e=>{var{typed:t,matrix:n,concat:r}=e,i=WL({typed:t,matrix:n,concat:r});return t(uz,dF,i({elop:dF,Ds:!0}))})),fz="count",pz=SN(fz,["typed","size","prod"],(e=>{var{typed:t,size:n,prod:r}=e;return t(fz,{string:function(e){return e.length},"Matrix | Array":function(e){return r(n(e))}})})),mz="deepEqual",gz=SN(mz,["typed","equal"],(e=>{var{typed:t,equal:n}=e;return t(mz,{"any, any":function(e,t){return r(e.valueOf(),t.valueOf())}});function r(e,t){if(Array.isArray(e)){if(Array.isArray(t)){var i=e.length;if(i!==t.length)return!1;for(var a=0;a<i;a++)if(!r(e[a],t[a]))return!1;return!0}return!1}return!Array.isArray(t)&&n(e,t)}})),vz="divideScalar",yz=SN(vz,["typed","numeric"],(e=>{var{typed:t,numeric:n}=e;return t(vz,{"number, number":function(e,t){return e/t},"Complex, Complex":function(e,t){return e.div(t)},"BigNumber, BigNumber":function(e,t){return e.div(t)},"bigint, bigint":function(e,t){return e/t},"Fraction, Fraction":function(e,t){return e.div(t)},"Unit, number | Complex | Fraction | BigNumber | Unit":(e,t)=>e.divide(t),"number | Fraction | Complex | BigNumber, Unit":(e,t)=>t.divideInto(e)})})),xz="dotDivide",bz=SN(xz,["typed","matrix","equalScalar","divideScalar","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,matrix:n,equalScalar:r,divideScalar:i,DenseMatrix:a,concat:o,SparseMatrix:s}=e,l=zL({typed:t,equalScalar:r}),c=ZL({typed:t}),u=KL({typed:t,SparseMatrix:s}),h=VL({typed:t,equalScalar:r}),d=QL({typed:t,DenseMatrix:a}),f=WL({typed:t,matrix:n,concat:o});return t(xz,f({elop:i,SS:u,DS:c,SD:l,Ss:h,sS:d}))})),_z="equalText",wz=SN(_z,["typed","compareText","isZero"],(e=>{var{typed:t,compareText:n,isZero:r}=e;return t(_z,{"any, any":function(e,t){return r(n(e,t))}})})),Sz="floor",Mz=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],Dz=new wN(10),Ez=SN(Sz,["typed","config","round"],(e=>{var{typed:t,config:n,round:r}=e;function i(e){var t=Math.floor(e),i=r(e);return t===i?t:QN(e,i,n.relTol,n.absTol)&&!QN(e,t,n.relTol,n.absTol)?i:t}return t(Sz,{number:i,"number, number":function(e,t){if(!IN(t))throw new RangeError("number of decimals in function floor must be an integer");if(t<0||t>15)throw new RangeError("number of decimals in floor number must be in range 0 - 15");var n=10**t;return i(e*n)/n}})})),Cz=SN(Sz,Mz,(e=>{var{typed:t,config:n,round:r,matrix:i,equalScalar:a,zeros:o,DenseMatrix:s}=e,l=VL({typed:t,equalScalar:a}),c=QL({typed:t,DenseMatrix:s}),u=qL({typed:t}),h=Ez({typed:t,config:n,round:r});function d(e){var t=(e,t)=>ZI(e,t,n.relTol,n.absTol),i=e.floor(),a=r(e);return i.eq(a)?i:t(e,a)&&!t(e,i)?a:i}return t("floor",{number:h.signatures.number,"number,number":h.signatures["number,number"],Complex:function(e){return e.floor()},"Complex, number":function(e,t){return e.floor(t)},"Complex, BigNumber":function(e,t){return e.floor(t.toNumber())},BigNumber:d,"BigNumber, BigNumber":function(e,t){var n=Dz.pow(t);return d(e.mul(n)).div(n)},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.floor()},"Fraction, number":function(e,t){return e.floor(t)},"Fraction, BigNumber":function(e,t){return e.floor(t.toNumber())},"Unit, number, Unit":t.referToSelf((e=>function(t,n,r){var i=t.toNumeric(r);return r.multiply(e(i,n))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>e(t,n.toNumber(),r))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>sO(t,(t=>e(t,n,r)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,n)=>e(t,0,n))),"Array | Matrix":t.referToSelf((e=>t=>sO(t,e,!0))),"Array, number | BigNumber":t.referToSelf((e=>(t,n)=>sO(t,(t=>e(t,n)),!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>l(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>u(t,n,e,!1))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,n)=>u(i(n),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,n)=>a(t,0)?o(n.size(),n.storage()):"dense"===n.storage()?u(n,t,e,!0):c(n,t,e,!0)))})})),Az=SN("mod",["typed","config","round","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,config:n,round:r,matrix:i,equalScalar:a,zeros:o,DenseMatrix:s,concat:l}=e,c=Cz({typed:t,config:n,round:r,matrix:i,equalScalar:a,zeros:o,DenseMatrix:s}),u=zL({typed:t,equalScalar:a}),h=ZL({typed:t}),d=oz({typed:t,equalScalar:a}),f=VL({typed:t,equalScalar:a}),p=QL({typed:t,DenseMatrix:s});return t("mod",{"number, number":function(e,t){return 0===t?e:e-t*c(e/t)},"BigNumber, BigNumber":function(e,t){return t.isZero()?e:e.sub(t.mul(c(e.div(t))))},"bigint, bigint":function(e,t){if(0n===t)return e;if(e<0){var n=e%t;return 0n===n?n:n+t}return e%t},"Fraction, Fraction":function(e,t){return t.equals(0)?e:e.sub(t.mul(c(e.div(t))))}},WL({typed:t,matrix:i,concat:l})({SS:d,DS:h,SD:u,Ss:f,sS:p}))})),Tz=["typed","config","round","matrix","equalScalar","zeros","BigNumber","DenseMatrix","concat"],Nz="number | BigNumber | Fraction | Matrix | Array",Rz="".concat(Nz,", ").concat(Nz,", ...").concat(Nz);function Pz(e){return!e.some((e=>Array.isArray(e)))}var Fz=SN("gcd",Tz,(e=>{var{typed:t,matrix:n,config:r,round:i,equalScalar:a,zeros:o,BigNumber:s,DenseMatrix:l,concat:c}=e,u=Az({typed:t,config:r,round:i,matrix:n,equalScalar:a,zeros:o,DenseMatrix:l,concat:c}),h=hU({typed:t}),d=YU({typed:t,equalScalar:a}),f=dU({typed:t,DenseMatrix:l});return t("gcd",{"number, number":function(e,t){if(!IN(e)||!IN(t))throw new Error("Parameters in function gcd must be integer numbers");var n;for(;0!==t;)n=u(e,t),e=t,t=n;return e<0?-e:e},"BigNumber, BigNumber":function(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function gcd must be integer numbers");var n=new s(0);for(;!t.isZero();){var r=u(e,t);e=t,t=r}return e.lt(n)?e.neg():e},"Fraction, Fraction":(e,t)=>e.gcd(t)},WL({typed:t,matrix:n,concat:c})({SS:d,DS:h,Ss:f}),{[Rz]:t.referToSelf((e=>(t,n,r)=>{for(var i=e(t,n),a=0;a<r.length;a++)i=e(i,r[a]);return i})),Array:t.referToSelf((e=>t=>{if(1===t.length&&Array.isArray(t[0])&&Pz(t[0]))return e(...t[0]);if(Pz(t))return e(...t);throw new TU("gcd() supports only 1d matrices!")})),Matrix:t.referToSelf((e=>t=>e(t.toArray())))})})),Oz="hasNumericValue",Iz=SN(Oz,["typed","isNumeric"],(e=>{var{typed:t,isNumeric:n}=e;return t(Oz,{boolean:()=>!0,string:function(e){return e.trim().length>0&&!isNaN(Number(e))},any:function(e){return n(e)}})})),Bz="hypot",kz=SN(Bz,["typed","abs","addScalar","divideScalar","multiplyScalar","sqrt","smaller","isPositive"],(e=>{var{typed:t,abs:n,addScalar:r,divideScalar:i,multiplyScalar:a,sqrt:o,smaller:s,isPositive:l}=e;return t(Bz,{"... number | BigNumber":c,Array:c,Matrix:e=>c(NF(e.toArray(),!0))});function c(e){for(var t=0,c=0,u=0;u<e.length;u++){if(UC(e[u]))throw new TypeError("Unexpected type of argument to hypot");var h=n(e[u]);s(c,h)?(t=a(t,a(i(c,h),i(c,h))),t=r(t,1),c=h):t=r(t,l(h)?a(i(h,c),i(h,c)):h)}return a(c,o(t))}})),Lz=SN("ImmutableDenseMatrix",["smaller","DenseMatrix"],(e=>{var{smaller:t,DenseMatrix:n}=e;function r(e,t){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");if(t&&!VC(t))throw new Error("Invalid datatype: "+t);if(qC(e)||GC(e)){var i=new n(e,t);this._data=i._data,this._size=i._size,this._datatype=i._datatype,this._min=null,this._max=null}else if(e&&GC(e.data)&&GC(e.size))this._data=e.data,this._size=e.size,this._datatype=e.datatype,this._min="undefined"!==typeof e.min?e.min:null,this._max="undefined"!==typeof e.max?e.max:null;else{if(e)throw new TypeError("Unsupported type of data ("+EA(e)+")");this._data=[],this._size=[0],this._datatype=t,this._min=null,this._max=null}}return r.prototype=new n,r.prototype.type="ImmutableDenseMatrix",r.prototype.isImmutableDenseMatrix=!0,r.prototype.subset=function(e){switch(arguments.length){case 1:var t=n.prototype.subset.call(this,e);return qC(t)?new r({data:t._data,size:t._size,datatype:t._datatype}):t;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},r.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},r.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},r.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},r.prototype.clone=function(){return new r({data:CA(this._data),size:CA(this._size),datatype:this._datatype})},r.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},r.fromJSON=function(e){return new r(e)},r.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},r.prototype.min=function(){if(null===this._min){var e=null;this.forEach((function(n){(null===e||t(n,e))&&(e=n)})),this._min=null!==e?e:void 0}return this._min},r.prototype.max=function(){if(null===this._max){var e=null;this.forEach((function(n){(null===e||t(e,n))&&(e=n)})),this._max=null!==e?e:void 0}return this._max},r}),{isClass:!0}),Uz=SN("Index",["ImmutableDenseMatrix","getMatrixDataType"],(e=>{var{ImmutableDenseMatrix:t,getMatrixDataType:n}=e;function r(e){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._sourceSize=[],this._isScalar=!0;for(var t=0,a=arguments.length;t<a;t++){var o=arguments[t],s=GC(o),l=qC(o),c=typeof o,u=null;if(YC(o))this._dimensions.push(o),this._isScalar=!1;else if(s||l){var h=void 0;"boolean"===n(o)?(s&&(h=i(zz(o).valueOf())),l&&(h=i(zz(o._data).valueOf())),u=o.valueOf().length):h=i(o.valueOf()),this._dimensions.push(h);var d=h.size();1===d.length&&1===d[0]&&null===u||(this._isScalar=!1)}else if("number"===c)this._dimensions.push(i([o]));else if("bigint"===c)this._dimensions.push(i([Number(o)]));else{if("string"!==c)throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");this._dimensions.push(o)}this._sourceSize.push(u)}}function i(e){for(var n=0,r=e.length;n<r;n++)if("number"!==typeof e[n]||!IN(e[n]))throw new TypeError("Index parameters must be positive integer numbers");return new t(e)}return r.prototype.type="Index",r.prototype.isIndex=!0,r.prototype.clone=function(){var e=new r;return e._dimensions=CA(this._dimensions),e._isScalar=this._isScalar,e._sourceSize=this._sourceSize,e},r.create=function(e){var t=new r;return r.apply(t,e),t},r.prototype.size=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"===typeof r?1:r.size()[0]}return e},r.prototype.max=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"===typeof r?r:r.max()}return e},r.prototype.min=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"===typeof r?r:r.min()}return e},r.prototype.forEach=function(e){for(var t=0,n=this._dimensions.length;t<n;t++)e(this._dimensions[t],t,this)},r.prototype.dimension=function(e){return"number"!==typeof e?null:this._dimensions[e]||null},r.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"===typeof this._dimensions[0]},r.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},r.prototype.isScalar=function(){return this._isScalar},r.prototype.toArray=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e.push("string"===typeof r?r:r.toArray())}return e},r.prototype.valueOf=r.prototype.toArray,r.prototype.toString=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];"string"===typeof r?e.push(JSON.stringify(r)):e.push(r.toString())}return"["+e.join(", ")+"]"},r.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},r.fromJSON=function(e){return r.create(e.dimensions)},r}),{isClass:!0});function zz(e){var t=[];return e.forEach(((e,n)=>{e&&t.push(n)})),t}var Hz="larger",Vz=SN(Hz,["typed","config","bignumber","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:n,bignumber:r,matrix:i,DenseMatrix:a,concat:o,SparseMatrix:s}=e,l=ZL({typed:t}),c=KL({typed:t,SparseMatrix:s}),u=QL({typed:t,DenseMatrix:a}),h=WL({typed:t,matrix:i,concat:o}),d=KI({typed:t});function f(e,t){return e.gt(t)&&!ZI(e,t,n.relTol,n.absTol)}return t(Hz,Gz({typed:t,config:n}),{"boolean, boolean":(e,t)=>e>t,"BigNumber, BigNumber":f,"bigint, bigint":(e,t)=>e>t,"Fraction, Fraction":(e,t)=>1===e.compare(t),"Fraction, BigNumber":function(e,t){return f(r(e),t)},"BigNumber, Fraction":function(e,t){return f(e,r(t))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},d,h({SS:c,DS:l,Ss:u}))})),Gz=SN(Hz,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(Hz,{"number, number":function(e,t){return e>t&&!QN(e,t,n.relTol,n.absTol)}})})),qz=["config","typed","typeOf","divideScalar","Complex"],jz=Math.log(16),Wz=SN("log",qz,(e=>{var{typed:t,typeOf:n,config:r,divideScalar:i,Complex:a}=e;function o(e){return e.log()}function s(e){return o(new a(e,0))}return t("log",{number:function(e){return e>=0||r.predictable?MO(e):s(e)},bigint:HB(jz,MO,r,s),Complex:o,BigNumber:function(e){return!e.isNegative()||r.predictable?e.ln():s(e.toNumber())},"any, any":t.referToSelf((e=>(t,r)=>{if("Fraction"===n(t)&&"Fraction"===n(r)){var a=t.log(r);if(null!==a)return a}return i(e(t),e(r))}))})}));function Xz(e){var{DenseMatrix:t}=e;return function(e,n,r){var i=e.size();if(2!==i.length)throw new RangeError("Matrix must be two dimensional (size: "+sF(i)+")");var a=i[0];if(a!==i[1])throw new RangeError("Matrix must be square (size: "+sF(i)+")");var o=[];if(qC(n)){var s=n.size(),l=n._data;if(1===s.length){if(s[0]!==a)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var c=0;c<a;c++)o[c]=[l[c]];return new t({data:o,size:[a,1],datatype:n._datatype})}if(2===s.length){if(s[0]!==a||1!==s[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");if(WC(n)){if(r){o=[];for(var u=0;u<a;u++)o[u]=[l[u][0]];return new t({data:o,size:[a,1],datatype:n._datatype})}return n}if(XC(n)){for(var h=0;h<a;h++)o[h]=[0];for(var d=n._values,f=n._index,p=n._ptr,m=p[1],g=p[0];g<m;g++){o[f[g]][0]=d[g]}return new t({data:o,size:[a,1],datatype:n._datatype})}}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}if(GC(n)){var v=mF(n);if(1===v.length){if(v[0]!==a)throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var y=0;y<a;y++)o[y]=[n[y]];return new t({data:o,size:[a,1]})}if(2===v.length){if(v[0]!==a||1!==v[1])throw new RangeError("Dimension mismatch. Matrix columns must match vector length.");for(var x=0;x<a;x++)o[x]=[n[x][0]];return new t({data:o,size:[a,1]})}throw new RangeError("Dimension mismatch. The right side has to be either 1- or 2-dimensional vector.")}}}var Yz="lsolve",Zz=SN(Yz,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=e,l=Xz({DenseMatrix:s});return t(Yz,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=(t=l(e,t,!0))._data,c=e._size[0],u=e._size[1],h=e._values,d=e._index,f=e._ptr,p=[],m=0;m<u;m++){var g=n[m][0]||0;if(o(g,0))p[m]=[0];else{for(var v=0,y=[],x=[],b=f[m],_=f[m+1],w=b;w<_;w++){var S=d[w];S===m?v=h[w]:S>m&&(y.push(h[w]),x.push(S))}if(o(v,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var M=r(g,v),D=0,E=x.length;D<E;D++){var C=x[D];n[C]=[a(n[C][0]||0,i(M,y[D]))]}p[m]=[M]}}return new s({data:p,size:[c,1]})}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).valueOf()}});function c(e,t){for(var n=(t=l(e,t,!0))._data,c=e._size[0],u=e._size[1],h=[],d=e._data,f=0;f<u;f++){var p=n[f][0]||0,m=void 0;if(o(p,0))m=0;else{var g=d[f][f];if(o(g,0))throw new Error("Linear system cannot be solved since matrix is singular");m=r(p,g);for(var v=f+1;v<c;v++)n[v]=[a(n[v][0]||0,i(m,d[v][f]))]}h[f]=[m]}return new s({data:h,size:[c,1]})}})),Kz="matrixFromColumns",Qz=SN(Kz,["typed","matrix","flatten","size"],(e=>{var{typed:t,matrix:n,flatten:r,size:i}=e;return t(Kz,{"...Array":function(e){return a(e)},"...Matrix":function(e){return n(a(e.map((e=>e.toArray()))))}});function a(e){if(0===e.length)throw new TypeError("At least one column is needed to construct a matrix.");for(var t=o(e[0]),n=[],i=0;i<t;i++)n[i]=[];for(var a of e){var s=o(a);if(s!==t)throw new TypeError("The vectors had different length: "+(0|t)+" \u2260 "+(0|s));for(var l=r(a),c=0;c<t;c++)n[c].push(l[c])}return n}function o(e){var t=i(e);if(1===t.length)return t[0];if(2===t.length){if(1===t[0])return t[1];if(1===t[1])return t[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}})),Jz=SN("max",["typed","config","numeric","larger","isNaN"],(e=>{var{typed:t,config:n,numeric:r,larger:i,isNaN:a}=e;return t("max",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(e,t){return lO(e,t.valueOf(),o)},"...":function(e){if(aO(e))throw new TypeError("Scalar values expected in function max");return s(e)}});function o(e,t){try{return i(e,t)?e:t}catch(n){throw EU(n,"max",t)}}function s(e){var t;if(oO(e,(function(e){try{(a(e)||void 0===t||i(e,t))&&(t=e)}catch(n){throw EU(n,"max",e)}})),void 0===t)throw new Error("Cannot calculate max of an empty array");return"string"===typeof t&&(t=r(t,BN(t,n))),t}})),$z=SN("min",["typed","config","numeric","smaller","isNaN"],(e=>{var{typed:t,config:n,numeric:r,smaller:i,isNaN:a}=e;return t("min",{"Array | Matrix":s,"Array | Matrix, number | BigNumber":function(e,t){return lO(e,t.valueOf(),o)},"...":function(e){if(aO(e))throw new TypeError("Scalar values expected in function min");return s(e)}});function o(e,t){try{return i(e,t)?e:t}catch(n){throw EU(n,"min",t)}}function s(e){var t;if(oO(e,(function(e){try{(a(e)||void 0===t||i(e,t))&&(t=e)}catch(n){throw EU(n,"min",e)}})),void 0===t)throw new Error("Cannot calculate min of an empty array");return"string"===typeof t&&(t=r(t,BN(t,n))),t}})),eH="nthRoots",tH=SN(eH,["config","typed","divideScalar","Complex"],(e=>{var{typed:t,config:n,divideScalar:r,Complex:i}=e,a=[function(e){return new i(e,0)},function(e){return new i(0,e)},function(e){return new i(-e,0)},function(e){return new i(0,-e)}];function o(e,t){if(t<0)throw new Error("Root must be greater than zero");if(0===t)throw new Error("Root must be non-zero");if(t%1!==0)throw new Error("Root must be an integer");if(0===e||0===e.abs())return[new i(0,0)];var n,r="number"===typeof e;(r||0===e.re||0===e.im)&&(n=r?2*+(e<0):0===e.im?2*+(e.re<0):2*+(e.im<0)+1);for(var o=e.arg(),s=e.abs(),l=[],c=Math.pow(s,1/t),u=0;u<t;u++){var h=(n+4*u)/t;h!==Math.round(h)?l.push(new i({r:c,phi:(o+2*Math.PI*u)/t})):l.push(a[h%4](c))}return l}return t(eH,{Complex:function(e){return o(e,2)},"Complex, number":o})})),nH=SN("or",["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:a}=e,o=ZL({typed:t}),s=oz({typed:t,equalScalar:r}),l=QL({typed:t,DenseMatrix:i}),c=WL({typed:t,matrix:n,concat:a});return t("or",{"number, number":$B,"Complex, Complex":function(e,t){return 0!==e.re||0!==e.im||0!==t.re||0!==t.im},"BigNumber, BigNumber":function(e,t){return!e.isZero()&&!e.isNaN()||!t.isZero()&&!t.isNaN()},"bigint, bigint":$B,"Unit, Unit":t.referToSelf((e=>(t,n)=>e(t.value||0,n.value||0)))},c({SS:s,DS:o,Ss:l}))})),rH="partitionSelect",iH=SN(rH,["typed","isNumeric","isNaN","compare"],(e=>{var{typed:t,isNumeric:n,isNaN:r,compare:i}=e,a=i,o=(e,t)=>-i(e,t);return t(rH,{"Array | Matrix, number":function(e,t){return s(e,t,a)},"Array | Matrix, number, string":function(e,t,n){if("asc"===n)return s(e,t,a);if("desc"===n)return s(e,t,o);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":s});function s(e,t,n){if(!IN(t)||t<0)throw new Error("k must be a non-negative integer");if(qC(e)){if(e.size().length>1)throw new Error("Only one dimensional matrices supported");return l(e.valueOf(),t,n)}if(Array.isArray(e))return l(e,t,n)}function l(e,t,i){if(t>=e.length)throw new Error("k out of bounds");for(var a=0;a<e.length;a++)if(n(e[a])&&r(e[a]))return e[a];for(var o=0,s=e.length-1;o<s;){for(var l=o,c=s,u=e[Math.floor(Math.random()*(s-o+1))+o];l<c;)if(i(e[l],u)>=0){var h=e[c];e[c]=e[l],e[l]=h,--c}else++l;i(e[l],u)>0&&--l,t<=l?s=l:o=l+1}return e[t]}})),aH=SN("qr",["typed","matrix","zeros","identity","isZero","equal","sign","sqrt","conj","unaryMinus","addScalar","divideScalar","multiplyScalar","subtractScalar","complex"],(e=>{var{typed:t,matrix:n,zeros:r,identity:i,isZero:a,equal:o,sign:s,sqrt:l,conj:c,unaryMinus:u,addScalar:h,divideScalar:d,multiplyScalar:f,subtractScalar:p,complex:m}=e;return SC(t("qr",{DenseMatrix:function(e){return v(e)},SparseMatrix:function(e){return function(){throw new Error("qr not implemented for sparse matrices yet")}()},Array:function(e){var t=v(n(e));return{Q:t.Q.valueOf(),R:t.R.valueOf()}}}),{_denseQRimpl:g});function g(e){var t,n,m,g=e._size[0],v=e._size[1],y=i([g],"dense"),x=y._data,b=e.clone(),_=b._data,w=r([g],"");for(m=0;m<Math.min(v,g);++m){var S=_[m][m],M=u(o(S,0)?1:s(S)),D=c(M),E=0;for(t=m;t<g;t++)E=h(E,f(_[t][m],c(_[t][m])));var C=f(M,l(E));if(!a(C)){var A=p(S,C);for(w[m]=1,t=m+1;t<g;t++)w[t]=d(_[t][m],A);var T=u(c(d(A,C))),N=void 0;for(n=m;n<v;n++){for(N=0,t=m;t<g;t++)N=h(N,f(c(w[t]),_[t][n]));for(N=f(N,T),t=m;t<g;t++)_[t][n]=f(p(_[t][n],f(w[t],N)),D)}for(t=0;t<g;t++){for(N=0,n=m;n<g;n++)N=h(N,f(x[t][n],w[n]));for(N=f(N,T),n=m;n<g;++n)x[t][n]=d(p(x[t][n],f(N,c(w[n]))),D)}}}return{Q:y,R:b,toString:function(){return"Q: "+this.Q.toString()+"\nR: "+this.R.toString()}}}function v(e){var t=g(e),n=t.R._data;if(e._data.length>0)for(var r="Complex"===n[0][0].type?m(0):0,i=0;i<n.length;++i)for(var a=0;a<i&&a<(n[0]||[]).length;++a)n[i][a]=r;return t}})),oH="rightLogShift",sH=SN(oH,["typed","matrix","equalScalar","zeros","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,DenseMatrix:a,concat:o}=e,s=hU({typed:t}),l=zL({typed:t,equalScalar:r}),c=fU({typed:t,equalScalar:r}),u=dU({typed:t,DenseMatrix:a}),h=VL({typed:t,equalScalar:r}),d=qL({typed:t}),f=WL({typed:t,matrix:n,concat:o}),p=pU({typed:t,matrix:n});return t(oH,{"number, number":AI,"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():h(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>r(n,0)?t.clone():d(t,n,e,!1))),"number | BigNumber, SparseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):u(n,t,e,!0))),"number | BigNumber, DenseMatrix":t.referToSelf((e=>(t,n)=>r(t,0)?i(n.size(),n.storage()):d(n,t,e,!0)))},p,f({SS:c,DS:s,SD:l}))})),lH="smallerEq",cH=SN(lH,["typed","config","matrix","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,config:n,matrix:r,DenseMatrix:i,concat:a,SparseMatrix:o}=e,s=ZL({typed:t}),l=KL({typed:t,SparseMatrix:o}),c=QL({typed:t,DenseMatrix:i}),u=WL({typed:t,matrix:r,concat:a}),h=KI({typed:t});return t(lH,uH({typed:t,config:n}),{"boolean, boolean":(e,t)=>e<=t,"BigNumber, BigNumber":function(e,t){return e.lte(t)||ZI(e,t,n.relTol,n.absTol)},"bigint, bigint":(e,t)=>e<=t,"Fraction, Fraction":(e,t)=>1!==e.compare(t),"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")}},h,u({SS:l,DS:s,Ss:c}))})),uH=SN(lH,["typed","config"],(e=>{var{typed:t,config:n}=e;return t(lH,{"number, number":function(e,t){return e<=t||QN(e,t,n.relTol,n.absTol)}})})),hH="subset",dH=SN(hH,["typed","matrix","zeros","add"],(e=>{var{typed:t,matrix:n,zeros:r,add:i}=e;return t(hH,{"Matrix, Index":function(e,t){return bF(t)?n():(yF(e,t),e.subset(t))},"Array, Index":t.referTo("Matrix, Index",(function(e){return function(t,r){var i=e(n(t),r);return r.isScalar()?i:i.valueOf()}})),"Object, Index":mH,"string, Index":fH,"Matrix, Index, any, any":function(e,t,n,a){return bF(t)?e:(yF(e,t),e.clone().subset(t,function(e,t){if("string"===typeof e)throw new Error("can't boradcast a string");if(t._isScalar)return e;var n=t.size();if(!n.every((e=>e>0)))return e;try{return i(e,r(n))}catch(a){return e}}(n,t),a))},"Array, Index, any, any":t.referTo("Matrix, Index, any, any",(function(e){return function(t,r,i,a){var o=e(n(t),r,i,a);return o.isMatrix?o.valueOf():o}})),"Array, Index, any":t.referTo("Matrix, Index, any, any",(function(e){return function(t,r,i){return e(n(t),r,i,void 0).valueOf()}})),"Matrix, Index, any":t.referTo("Matrix, Index, any, any",(function(e){return function(t,n,r){return e(t,n,r,void 0)}})),"string, Index, string":pH,"string, Index, string, string":pH,"Object, Index, any":gH})}));function fH(e,t){if(!ZC(t))throw new TypeError("Index expected");if(bF(t))return"";if(yF(Array.from(e),t),1!==t.size().length)throw new fF(t.size().length,1);var n=e.length;xF(t.min()[0],n),xF(t.max()[0],n);var r=t.dimension(0),i="";return r.forEach((function(t){i+=e.charAt(t)})),i}function pH(e,t,n,r){if(!t||!0!==t.isIndex)throw new TypeError("Index expected");if(bF(t))return e;if(yF(Array.from(e),t),1!==t.size().length)throw new fF(t.size().length,1);if(void 0!==r){if("string"!==typeof r||1!==r.length)throw new TypeError("Single character expected as defaultValue")}else r=" ";var i=t.dimension(0);if(i.size()[0]!==n.length)throw new fF(i.size()[0],n.length);var a=e.length;xF(t.min()[0]),xF(t.max()[0]);for(var o=[],s=0;s<a;s++)o[s]=e.charAt(s);if(i.forEach((function(e,t){o[e]=n.charAt(t[0])})),o.length>a)for(var l=a-1,c=o.length;l<c;l++)o[l]||(o[l]=r);return o.join("")}function mH(e,t){if(!bF(t)){if(1!==t.size().length)throw new fF(t.size(),1);var n=t.dimension(0);if("string"!==typeof n)throw new TypeError("String expected as index to retrieve an object property");return DC(e,n)}}function gH(e,t,n){if(bF(t))return e;if(1!==t.size().length)throw new fF(t.size(),1);var r=t.dimension(0);if("string"!==typeof r)throw new TypeError("String expected as index to retrieve an object property");var i=CA(e);return EC(i,r,n),i}var vH="subtract",yH=SN(vH,["typed","matrix","equalScalar","subtractScalar","unaryMinus","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,subtractScalar:i,unaryMinus:a,DenseMatrix:o,concat:s}=e,l=hU({typed:t}),c=ZL({typed:t}),u=oz({typed:t,equalScalar:r}),h=dU({typed:t,DenseMatrix:o}),d=QL({typed:t,DenseMatrix:o}),f=WL({typed:t,matrix:n,concat:s});return t(vH,{"any, any":i},f({elop:i,SS:u,DS:l,SD:c,Ss:d,sS:h}))})),xH=SN("trace",["typed","matrix","add"],(e=>{var{typed:t,matrix:n,add:r}=e;return t("trace",{Array:function(e){return i(n(e))},SparseMatrix:function(e){var t=e._values,n=e._index,i=e._ptr,a=e._size,o=a[0],s=a[1];if(o===s){var l=0;if(t.length>0)for(var c=0;c<s;c++)for(var u=i[c],h=i[c+1],d=u;d<h;d++){var f=n[d];if(f===c){l=r(l,t[d]);break}if(f>c)break}return l}throw new RangeError("Matrix must be square (size: "+sF(a)+")")},DenseMatrix:i,any:CA});function i(e){var t=e._size,n=e._data;switch(t.length){case 1:if(1===t[0])return CA(n[0]);throw new RangeError("Matrix must be square (size: "+sF(t)+")");case 2:var i=t[0];if(i===t[1]){for(var a=0,o=0;o<i;o++)a=r(a,n[o][o]);return a}throw new RangeError("Matrix must be square (size: "+sF(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+sF(t)+")")}}})),bH="usolve",_H=SN(bH,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=e,l=Xz({DenseMatrix:s});return t(bH,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=(t=l(e,t,!0))._data,c=e._size[0],u=e._size[1],h=e._values,d=e._index,f=e._ptr,p=[],m=u-1;m>=0;m--){var g=n[m][0]||0;if(o(g,0))p[m]=[0];else{for(var v=0,y=[],x=[],b=f[m],_=f[m+1]-1;_>=b;_--){var w=d[_];w===m?v=h[_]:w<m&&(y.push(h[_]),x.push(w))}if(o(v,0))throw new Error("Linear system cannot be solved since matrix is singular");for(var S=r(g,v),M=0,D=x.length;M<D;M++){var E=x[M];n[E]=[a(n[E][0],i(S,y[M]))]}p[m]=[S]}}return new s({data:p,size:[c,1]})}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).valueOf()}});function c(e,t){for(var n=(t=l(e,t,!0))._data,c=e._size[0],u=e._size[1],h=[],d=e._data,f=u-1;f>=0;f--){var p=n[f][0]||0,m=void 0;if(o(p,0))m=0;else{var g=d[f][f];if(o(g,0))throw new Error("Linear system cannot be solved since matrix is singular");m=r(p,g);for(var v=f-1;v>=0;v--)n[v]=[a(n[v][0]||0,i(m,d[v][f]))]}h[f]=[m]}return new s({data:h,size:[c,1]})}})),wH="catalan",SH=SN(wH,["typed","addScalar","divideScalar","multiplyScalar","combinations","isNegative","isInteger"],(e=>{var{typed:t,addScalar:n,divideScalar:r,multiplyScalar:i,combinations:a,isNegative:o,isInteger:s}=e;return t(wH,{"number | BigNumber":function(e){if(!s(e)||o(e))throw new TypeError("Non-negative integer value expected in function catalan");return r(a(i(e,2),e),n(e,1))}})})),MH=n(5939),DH="compareNatural",EH=SN(DH,["typed","compare"],(e=>{var{typed:t,compare:n}=e,r=n.signatures["boolean,boolean"];return t(DH,{"any, any":function e(t,o){var s,l=EA(t),c=EA(o);if(("number"===l||"BigNumber"===l||"Fraction"===l)&&("number"===c||"BigNumber"===c||"Fraction"===c))return"0"!==(s=n(t,o)).toString()?s>0?1:-1:MH(l,c);var u=["Array","DenseMatrix","SparseMatrix"];if(u.includes(l)||u.includes(c))return 0!==(s=i(e,t,o))?s:MH(l,c);if(l!==c)return MH(l,c);if("Complex"===l)return function(e,t){if(e.re>t.re)return 1;if(e.re<t.re)return-1;if(e.im>t.im)return 1;if(e.im<t.im)return-1;return 0}(t,o);if("Unit"===l)return t.equalBase(o)?e(t.value,o.value):a(e,t.formatUnits(),o.formatUnits());if("boolean"===l)return r(t,o);if("string"===l)return MH(t,o);if("Object"===l)return function(e,t,n){var r=Object.keys(t),i=Object.keys(n);r.sort(MH),i.sort(MH);var o=a(e,r,i);if(0!==o)return o;for(var s=0;s<r.length;s++){var l=e(t[r[s]],n[i[s]]);if(0!==l)return l}return 0}(e,t,o);if("null"===l)return 0;if("undefined"===l)return 0;throw new TypeError('Unsupported type of value "'+l+'"')}});function i(e,t,n){return XC(t)&&XC(n)?a(e,t.toJSON().values,n.toJSON().values):XC(t)?i(e,t.toArray(),n):XC(n)?i(e,t,n.toArray()):WC(t)?i(e,t.toJSON().data,n):WC(n)?i(e,t,n.toJSON().data):Array.isArray(t)?Array.isArray(n)?a(e,t,n):i(e,t,[n]):i(e,[t],n)}function a(e,t,n){for(var r=0,i=Math.min(t.length,n.length);r<i;r++){var a=e(t[r],n[r]);if(0!==a)return a}return t.length>n.length?1:t.length<n.length?-1:0}}));var CH="composition",AH=SN(CH,["typed","addScalar","combinations","isNegative","isPositive","isInteger","larger"],(e=>{var{typed:t,addScalar:n,combinations:r,isPositive:i,isNegative:a,isInteger:o,larger:s}=e;return t(CH,{"number | BigNumber, number | BigNumber":function(e,t){if(!(o(e)&&i(e)&&o(t)&&i(t)))throw new TypeError("Positive integer value expected in function composition");if(s(t,e))throw new TypeError("k must be less than or equal to n in function composition");return r(n(e,-1),n(t,-1))}})})),TH="diff",NH=SN(TH,["typed","matrix","subtract","number"],(e=>{var{typed:t,matrix:n,subtract:r,number:i}=e;return t(TH,{"Array | Matrix":function(e){return qC(e)?n(o(e.toArray())):o(e)},"Array | Matrix, number":function(e,t){if(!IN(t))throw new RangeError("Dimension must be a whole number");return qC(e)?n(a(e.toArray(),t)):a(e,t)},"Array, BigNumber":t.referTo("Array,number",(e=>(t,n)=>e(t,i(n)))),"Matrix, BigNumber":t.referTo("Matrix,number",(e=>(t,n)=>e(t,i(n))))});function a(e,t){if(qC(e)&&(e=e.toArray()),!Array.isArray(e))throw RangeError("Array/Matrix does not have that many dimensions");if(t>0){var n=[];return e.forEach((e=>{n.push(a(e,t-1))})),n}if(0===t)return o(e);throw RangeError("Cannot have negative dimension")}function o(e){for(var t=[],n=e.length,r=1;r<n;r++)t.push(s(e[r-1],e[r]));return t}function s(e,t){qC(e)&&(e=e.toArray()),qC(t)&&(t=t.toArray());var n=Array.isArray(e),i=Array.isArray(t);if(n&&i)return function(e,t){if(e.length!==t.length)throw RangeError("Not all sub-arrays have the same length");for(var n=[],r=e.length,i=0;i<r;i++)n.push(s(e[i],t[i]));return n}(e,t);if(!n&&!i)return r(t,e);throw TypeError("Cannot calculate difference between 1 array and 1 non-array")}})),RH="distance",PH=SN(RH,["typed","addScalar","subtractScalar","divideScalar","multiplyScalar","deepEqual","sqrt","abs"],(e=>{var{typed:t,addScalar:n,subtractScalar:r,multiplyScalar:i,divideScalar:a,deepEqual:o,sqrt:s,abs:l}=e;return t(RH,{"Array, Array, Array":function(e,t,n){if(2===e.length&&2===t.length&&2===n.length){if(!u(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!u(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!u(n))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(o(t,n))throw new TypeError("LinePoint1 should not be same with LinePoint2");var a=r(n[1],t[1]),s=r(t[0],n[0]),l=r(i(n[0],t[1]),i(t[0],n[1]));return m(e[0],e[1],a,s,l)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object, Object":function(e,t,n){if(2===Object.keys(e).length&&2===Object.keys(t).length&&2===Object.keys(n).length){if(!u(e))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!u(t))throw new TypeError("Values of lineOnePtX and lineOnePtY should be numbers or BigNumbers");if(!u(n))throw new TypeError("Values of lineTwoPtX and lineTwoPtY should be numbers or BigNumbers");if(o(p(t),p(n)))throw new TypeError("LinePoint1 should not be same with LinePoint2");if("pointX"in e&&"pointY"in e&&"lineOnePtX"in t&&"lineOnePtY"in t&&"lineTwoPtX"in n&&"lineTwoPtY"in n){var a=r(n.lineTwoPtY,t.lineOnePtY),s=r(t.lineOnePtX,n.lineTwoPtX),l=r(i(n.lineTwoPtX,t.lineOnePtY),i(t.lineOnePtX,n.lineTwoPtY));return m(e.pointX,e.pointY,a,s,l)}throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},"Array, Array":function(e,t){if(2===e.length&&3===t.length){if(!u(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!h(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");return m(e[0],e[1],t[0],t[1],t[2])}if(3===e.length&&6===t.length){if(!h(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!f(t))throw new TypeError("Array with 6 numbers or BigNumbers expected for second argument");return g(e[0],e[1],e[2],t[0],t[1],t[2],t[3],t[4],t[5])}if(e.length===t.length&&e.length>0){if(!d(e))throw new TypeError("All values of an array should be numbers or BigNumbers");if(!d(t))throw new TypeError("All values of an array should be numbers or BigNumbers");return v(e,t)}throw new TypeError("Invalid Arguments: Try again")},"Object, Object":function(e,t){if(2===Object.keys(e).length&&3===Object.keys(t).length){if(!u(e))throw new TypeError("Values of pointX and pointY should be numbers or BigNumbers");if(!h(t))throw new TypeError("Values of xCoeffLine, yCoeffLine and constant should be numbers or BigNumbers");if("pointX"in e&&"pointY"in e&&"xCoeffLine"in t&&"yCoeffLine"in t&&"constant"in t)return m(e.pointX,e.pointY,t.xCoeffLine,t.yCoeffLine,t.constant);throw new TypeError("Key names do not match")}if(3===Object.keys(e).length&&6===Object.keys(t).length){if(!h(e))throw new TypeError("Values of pointX, pointY and pointZ should be numbers or BigNumbers");if(!f(t))throw new TypeError("Values of x0, y0, z0, a, b and c should be numbers or BigNumbers");if("pointX"in e&&"pointY"in e&&"x0"in t&&"y0"in t&&"z0"in t&&"a"in t&&"b"in t&&"c"in t)return g(e.pointX,e.pointY,e.pointZ,t.x0,t.y0,t.z0,t.a,t.b,t.c);throw new TypeError("Key names do not match")}if(2===Object.keys(e).length&&2===Object.keys(t).length){if(!u(e))throw new TypeError("Values of pointOneX and pointOneY should be numbers or BigNumbers");if(!u(t))throw new TypeError("Values of pointTwoX and pointTwoY should be numbers or BigNumbers");if("pointOneX"in e&&"pointOneY"in e&&"pointTwoX"in t&&"pointTwoY"in t)return v([e.pointOneX,e.pointOneY],[t.pointTwoX,t.pointTwoY]);throw new TypeError("Key names do not match")}if(3===Object.keys(e).length&&3===Object.keys(t).length){if(!h(e))throw new TypeError("Values of pointOneX, pointOneY and pointOneZ should be numbers or BigNumbers");if(!h(t))throw new TypeError("Values of pointTwoX, pointTwoY and pointTwoZ should be numbers or BigNumbers");if("pointOneX"in e&&"pointOneY"in e&&"pointOneZ"in e&&"pointTwoX"in t&&"pointTwoY"in t&&"pointTwoZ"in t)return v([e.pointOneX,e.pointOneY,e.pointOneZ],[t.pointTwoX,t.pointTwoY,t.pointTwoZ]);throw new TypeError("Key names do not match")}throw new TypeError("Invalid Arguments: Try again")},Array:function(e){if(!function(e){if(2===e[0].length&&c(e[0][0])&&c(e[0][1])){if(e.some((e=>2!==e.length||!c(e[0])||!c(e[1]))))return!1}else{if(!(3===e[0].length&&c(e[0][0])&&c(e[0][1])&&c(e[0][2])))return!1;if(e.some((e=>3!==e.length||!c(e[0])||!c(e[1])||!c(e[2]))))return!1}return!0}(e))throw new TypeError("Incorrect array format entered for pairwise distance calculation");return function(e){for(var t=[],n=[],r=[],i=0;i<e.length-1;i++)for(var a=i+1;a<e.length;a++)2===e[0].length?(n=[e[i][0],e[i][1]],r=[e[a][0],e[a][1]]):3===e[0].length&&(n=[e[i][0],e[i][1],e[i][2]],r=[e[a][0],e[a][1],e[a][2]]),t.push(v(n,r));return t}(e)}});function c(e){return"number"===typeof e||kC(e)}function u(e){return e.constructor!==Array&&(e=p(e)),c(e[0])&&c(e[1])}function h(e){return e.constructor!==Array&&(e=p(e)),c(e[0])&&c(e[1])&&c(e[2])}function d(e){return Array.isArray(e)||(e=p(e)),e.every(c)}function f(e){return e.constructor!==Array&&(e=p(e)),c(e[0])&&c(e[1])&&c(e[2])&&c(e[3])&&c(e[4])&&c(e[5])}function p(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;r++)n.push(e[t[r]]);return n}function m(e,t,r,o,c){var u=l(n(n(i(r,e),i(o,t)),c)),h=s(n(i(r,r),i(o,o)));return a(u,h)}function g(e,t,o,l,c,u,h,d,f){var p=[r(i(r(c,t),f),i(r(u,o),d)),r(i(r(u,o),h),i(r(l,e),f)),r(i(r(l,e),d),i(r(c,t),h))];p=s(n(n(i(p[0],p[0]),i(p[1],p[1])),i(p[2],p[2])));var m=s(n(n(i(h,h),i(d,d)),i(f,f)));return a(p,m)}function v(e,t){for(var a=e.length,o=0,l=0,c=0;c<a;c++)l=r(e[c],t[c]),o=n(i(l,l),o);return s(o)}})),FH=SN("dot",["typed","addScalar","multiplyScalar","conj","size"],(e=>{var{typed:t,addScalar:n,multiplyScalar:r,conj:i,size:a}=e;return t("dot",{"Array | DenseMatrix, Array | DenseMatrix":function(e,a){var l=o(e,a),c=qC(e)?e._data:e,u=qC(e)?e._datatype||e.getDataType():void 0,h=qC(a)?a._data:a,d=qC(a)?a._datatype||a.getDataType():void 0,f=2===s(e).length,p=2===s(a).length,m=n,g=r;if(u&&d&&u===d&&"string"===typeof u&&"mixed"!==u){var v=u;m=t.find(n,[v,v]),g=t.find(r,[v,v])}if(!f&&!p){for(var y=g(i(c[0]),h[0]),x=1;x<l;x++)y=m(y,g(i(c[x]),h[x]));return y}if(!f&&p){for(var b=g(i(c[0]),h[0][0]),_=1;_<l;_++)b=m(b,g(i(c[_]),h[_][0]));return b}if(f&&!p){for(var w=g(i(c[0][0]),h[0]),S=1;S<l;S++)w=m(w,g(i(c[S][0]),h[S]));return w}if(f&&p){for(var M=g(i(c[0][0]),h[0][0]),D=1;D<l;D++)M=m(M,g(i(c[D][0]),h[D][0]));return M}},"SparseMatrix, SparseMatrix":function(e,t){o(e,t);var i=e._index,a=e._values,s=t._index,l=t._values,c=0,u=n,h=r,d=0,f=0;for(;d<i.length&&f<s.length;){var p=i[d],m=s[f];p<m?d++:p>m?f++:p===m&&(c=u(c,h(a[d],l[f])),d++,f++)}return c}});function o(e,t){var n,r,i=s(e),a=s(t);if(1===i.length)n=i[0];else{if(2!==i.length||1!==i[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");n=i[0]}if(1===a.length)r=a[0];else{if(2!==a.length||1!==a[1])throw new RangeError("Expected a column vector, instead got a matrix of size ("+a.join(", ")+")");r=a[0]}if(n!==r)throw new RangeError("Vectors must have equal length ("+n+" != "+r+")");if(0===n)throw new RangeError("Cannot calculate the dot product of empty vectors");return n}function s(e){return qC(e)?e.size():a(e)}})),OH=SN("FibonacciHeap",["smaller","larger"],(e=>{var{smaller:t,larger:n}=e,r=1/Math.log((1+Math.sqrt(5))/2);function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function a(e,t,n){t.left.right=t.right,t.right.left=t.left,n.degree--,n.child===t&&(n.child=t.right),0===n.degree&&(n.child=null),t.left=e,t.right=e.right,e.right=t,t.right.left=t,t.parent=null,t.mark=!1}function o(e,t){var n=t.parent;n&&(t.mark?(a(e,t,n),o(n)):t.mark=!0)}i.prototype.type="FibonacciHeap",i.prototype.isFibonacciHeap=!0,i.prototype.insert=function(e,n){var r={key:e,value:n,degree:0};if(this._minimum){var i=this._minimum;r.left=i,r.right=i.right,i.right=r,r.right.left=r,t(e,i.key)&&(this._minimum=r)}else r.left=r,r.right=r,this._minimum=r;return this._size++,r},i.prototype.size=function(){return this._size},i.prototype.clear=function(){this._minimum=null,this._size=0},i.prototype.isEmpty=function(){return 0===this._size},i.prototype.extractMinimum=function(){var e=this._minimum;if(null===e)return e;for(var i=this._minimum,a=e.degree,o=e.child;a>0;){var l=o.right;o.left.right=o.right,o.right.left=o.left,o.left=i,o.right=i.right,i.right=o,o.right.left=o,o.parent=null,o=l,a--}return e.left.right=e.right,e.right.left=e.left,i=e===e.right?null:function(e,i){var a,o=Math.floor(Math.log(i)*r)+1,l=new Array(o),c=0,u=e;if(u)for(c++,u=u.right;u!==e;)c++,u=u.right;for(;c>0;){for(var h=u.degree,d=u.right;a=l[h];){if(n(u.key,a.key)){var f=a;a=u,u=f}s(a,u),l[h]=null,h++}l[h]=u,u=d,c--}e=null;for(var p=0;p<o;p++)(a=l[p])&&(e?(a.left.right=a.right,a.right.left=a.left,a.left=e,a.right=e.right,e.right=a,a.right.left=a,t(a.key,e.key)&&(e=a)):e=a);return e}(i=e.right,this._size),this._size--,this._minimum=i,e},i.prototype.remove=function(e){this._minimum=function(e,n,r){n.key=r;var i=n.parent;i&&t(n.key,i.key)&&(a(e,n,i),o(e,i));t(n.key,e.key)&&(e=n);return e}(this._minimum,e,-1),this.extractMinimum()};var s=function(e,t){e.left.right=e.right,e.right.left=e.left,e.parent=t,t.child?(e.left=t.child,e.right=t.child.right,t.child.right=e,e.right.left=e):(t.child=e,e.right=e,e.left=e),t.degree++,e.mark=!1};return i}),{isClass:!0}),IH="index",BH=SN(IH,["typed","Index"],(e=>{var{typed:t,Index:n}=e;return t(IH,{"...number | string | BigNumber | Range | Array | Matrix":function(e){var t=e.map((function(e){return kC(e)?e.toNumber():GC(e)||qC(e)?e.map((function(e){return kC(e)?e.toNumber():e})):e})),r=new n;return n.apply(r,t),r}})})),kH="invmod",LH=SN(kH,["typed","config","BigNumber","xgcd","equal","smaller","mod","add","isInteger"],(e=>{var{typed:t,config:n,BigNumber:r,xgcd:i,equal:a,smaller:o,mod:s,add:l,isInteger:c}=e;return t(kH,{"number, number":u,"BigNumber, BigNumber":u});function u(e,t){if(!c(e)||!c(t))throw new Error("Parameters in function invmod must be integer numbers");if(e=s(e,t),a(t,0))throw new Error("Divisor must be non zero");var n=i(e,t);n=n.valueOf();var[u,h]=n;return a(u,r(1))?(h=s(h,t),o(h,r(0))&&(h=l(h,t)),h):NaN}})),UH=SN("lcm",["typed","matrix","equalScalar","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,concat:i}=e,a=zL({typed:t,equalScalar:r}),o=xU({typed:t,equalScalar:r}),s=VL({typed:t,equalScalar:r}),l=WL({typed:t,matrix:n,concat:i}),c="number | BigNumber | Fraction | Matrix | Array",u={};return u["".concat(c,", ").concat(c,", ...").concat(c)]=t.referToSelf((e=>(t,n,r)=>{for(var i=e(t,n),a=0;a<r.length;a++)i=e(i,r[a]);return i})),t("lcm",{"number, number":SO,"BigNumber, BigNumber":function(e,t){if(!e.isInt()||!t.isInt())throw new Error("Parameters in function lcm must be integer numbers");if(e.isZero())return e;if(t.isZero())return t;var n=e.times(t);for(;!t.isZero();){var r=t;t=e.mod(r),e=r}return n.div(e).abs()},"Fraction, Fraction":(e,t)=>e.lcm(t)},l({SS:o,DS:a,Ss:s}),u)})),zH="log1p",HH=SN(zH,["typed","config","divideScalar","log","Complex"],(e=>{var{typed:t,config:n,divideScalar:r,log:i,Complex:a}=e;return t(zH,{number:function(e){return e>=-1||n.predictable?zN(e):o(new a(e,0))},Complex:o,BigNumber:function(e){var t=e.plus(1);return!t.isNegative()||n.predictable?t.ln():o(new a(e.toNumber(),0))},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e))),"any, any":t.referToSelf((e=>(t,n)=>r(e(t),i(n))))});function o(e){var t=e.re+1;return new a(Math.log(Math.sqrt(t*t+e.im*e.im)),Math.atan2(e.im,t))}})),VH="lsolveAll",GH=SN(VH,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=e,l=Xz({DenseMatrix:s});return t(VH,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=[l(e,t,!0)._data.map((e=>e[0]))],c=e._size[0],u=e._size[1],h=e._values,d=e._index,f=e._ptr,p=0;p<u;p++)for(var m=n.length,g=0;g<m;g++){for(var v=n[g],y=[],x=[],b=f[p],_=f[p+1],w=0,S=b;S<_;S++){var M=d[S];M===p?w=h[S]:M>p&&(y.push(h[S]),x.push(M))}if(o(w,0))if(o(v[p],0)){if(0===g){var D=[...v];D[p]=1;for(var E=0,C=x.length;E<C;E++){var A=x[E];D[A]=a(D[A],y[E])}n.push(D)}}else{if(0===g)return[];n.splice(g,1),g-=1,m-=1}else{v[p]=r(v[p],w);for(var T=0,N=x.length;T<N;T++){var R=x[T];v[R]=a(v[R],i(v[p],y[T]))}}}return n.map((e=>new s({data:e.map((e=>[e])),size:[c,1]})))}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).map((e=>e.valueOf()))}});function c(e,t){for(var n=[l(e,t,!0)._data.map((e=>e[0]))],c=e._data,u=e._size[0],h=e._size[1],d=0;d<h;d++)for(var f=n.length,p=0;p<f;p++){var m=n[p];if(o(c[d][d],0))if(o(m[d],0)){if(0===p){var g=[...m];g[d]=1;for(var v=d+1;v<h;v++)g[v]=a(g[v],c[v][d]);n.push(g)}}else{if(0===p)return[];n.splice(p,1),p-=1,f-=1}else{m[d]=r(m[d],c[d][d]);for(var y=d+1;y<h;y++)m[y]=a(m[y],i(m[d],c[y][d]))}}return n.map((e=>new s({data:e.map((e=>[e])),size:[u,1]})))}})),qH="matrixFromRows",jH=SN(qH,["typed","matrix","flatten","size"],(e=>{var{typed:t,matrix:n,flatten:r,size:i}=e;return t(qH,{"...Array":function(e){return a(e)},"...Matrix":function(e){return n(a(e.map((e=>e.toArray()))))}});function a(e){if(0===e.length)throw new TypeError("At least one row is needed to construct a matrix.");var t=o(e[0]),n=[];for(var i of e){var a=o(i);if(a!==t)throw new TypeError("The vectors had different length: "+(0|t)+" \u2260 "+(0|a));n.push(r(i))}return n}function o(e){var t=i(e);if(1===t.length)return t[0];if(2===t.length){if(1===t[0])return t[1];if(1===t[1])return t[0];throw new TypeError("At least one of the arguments is not a vector.")}throw new TypeError("Only one- or two-dimensional vectors are supported.")}})),WH="multiply",XH=SN(WH,["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],(e=>{var{typed:t,matrix:n,addScalar:r,multiplyScalar:i,equalScalar:a,dot:o}=e,s=VL({typed:t,equalScalar:a}),l=qL({typed:t});function c(e,t){switch(e.length){case 1:switch(t.length){case 1:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+e[0]+") must match Matrix rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;case 2:switch(t.length){case 1:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+e[1]+") must match Vector length ("+t[0]+")");break;case 2:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+e[1]+") must match Matrix B rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+e.length+" dimensions)")}}function u(e,n){if("dense"!==n.storage())throw new Error("Support for SparseMatrix not implemented");return function(e,n){var a,o=e._data,s=e._size,l=e._datatype||e.getDataType(),c=n._data,u=n._size,h=n._datatype||n.getDataType(),d=s[0],f=u[1],p=r,m=i;l&&h&&l===h&&"string"===typeof l&&"mixed"!==l&&(a=l,p=t.find(r,[a,a]),m=t.find(i,[a,a]));for(var g=[],v=0;v<f;v++){for(var y=m(o[0],c[0][v]),x=1;x<d;x++)y=p(y,m(o[x],c[x][v]));g[v]=y}return e.createDenseMatrix({data:g,size:[f],datatype:l===e._datatype&&h===n._datatype?a:void 0})}(e,n)}var h=t("_multiplyMatrixVector",{"DenseMatrix, any":function(e,n){var a,o=e._data,s=e._size,l=e._datatype||e.getDataType(),c=n._data,u=n._datatype||n.getDataType(),h=s[0],d=s[1],f=r,p=i;l&&u&&l===u&&"string"===typeof l&&"mixed"!==l&&(a=l,f=t.find(r,[a,a]),p=t.find(i,[a,a]));for(var m=[],g=0;g<h;g++){for(var v=o[g],y=p(v[0],c[0]),x=1;x<d;x++)y=f(y,p(v[x],c[x]));m[g]=y}return e.createDenseMatrix({data:m,size:[h],datatype:l===e._datatype&&u===n._datatype?a:void 0})},"SparseMatrix, any":function(e,n){var o=e._values,s=e._index,l=e._ptr,c=e._datatype||void 0===e._data?e._datatype:e.getDataType();if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var u,h=n._data,d=n._datatype||n.getDataType(),f=e._size[0],p=n._size[0],m=[],g=[],v=[],y=r,x=i,b=a,_=0;c&&d&&c===d&&"string"===typeof c&&"mixed"!==c&&(u=c,y=t.find(r,[u,u]),x=t.find(i,[u,u]),b=t.find(a,[u,u]),_=t.convert(0,u));var w=[],S=[];v[0]=0;for(var M=0;M<p;M++){var D=h[M];if(!b(D,_))for(var E=l[M],C=l[M+1],A=E;A<C;A++){var T=s[A];S[T]?w[T]=y(w[T],x(D,o[A])):(S[T]=!0,g.push(T),w[T]=x(D,o[A]))}}for(var N=g.length,R=0;R<N;R++){var P=g[R];m[R]=w[P]}return v[1]=g.length,e.createSparseMatrix({values:m,index:g,ptr:v,size:[f,1],datatype:c===e._datatype&&d===n._datatype?u:void 0})}}),d=t("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(e,n){var a,o=e._data,s=e._size,l=e._datatype||e.getDataType(),c=n._data,u=n._size,h=n._datatype||n.getDataType(),d=s[0],f=s[1],p=u[1],m=r,g=i;l&&h&&l===h&&"string"===typeof l&&"mixed"!==l&&"mixed"!==l&&(a=l,m=t.find(r,[a,a]),g=t.find(i,[a,a]));for(var v=[],y=0;y<d;y++){var x=o[y];v[y]=[];for(var b=0;b<p;b++){for(var _=g(x[0],c[0][b]),w=1;w<f;w++)_=m(_,g(x[w],c[w][b]));v[y][b]=_}}return e.createDenseMatrix({data:v,size:[d,p],datatype:l===e._datatype&&h===n._datatype?a:void 0})},"DenseMatrix, SparseMatrix":function(e,n){var o=e._data,s=e._size,l=e._datatype||e.getDataType(),c=n._values,u=n._index,h=n._ptr,d=n._size,f=n._datatype||void 0===n._data?n._datatype:n.getDataType();if(!c)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var p,m=s[0],g=d[1],v=r,y=i,x=a,b=0;l&&f&&l===f&&"string"===typeof l&&"mixed"!==l&&(p=l,v=t.find(r,[p,p]),y=t.find(i,[p,p]),x=t.find(a,[p,p]),b=t.convert(0,p));for(var _=[],w=[],S=[],M=n.createSparseMatrix({values:_,index:w,ptr:S,size:[m,g],datatype:l===e._datatype&&f===n._datatype?p:void 0}),D=0;D<g;D++){S[D]=w.length;var E=h[D],C=h[D+1];if(C>E)for(var A=0,T=0;T<m;T++){for(var N=T+1,R=void 0,P=E;P<C;P++){var F=u[P];A!==N?(R=y(o[T][F],c[P]),A=N):R=v(R,y(o[T][F],c[P]))}A!==N||x(R,b)||(w.push(T),_.push(R))}}return S[g]=w.length,M},"SparseMatrix, DenseMatrix":function(e,n){var o=e._values,s=e._index,l=e._ptr,c=e._datatype||void 0===e._data?e._datatype:e.getDataType();if(!o)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var u,h=n._data,d=n._datatype||n.getDataType(),f=e._size[0],p=n._size[0],m=n._size[1],g=r,v=i,y=a,x=0;c&&d&&c===d&&"string"===typeof c&&"mixed"!==c&&(u=c,g=t.find(r,[u,u]),v=t.find(i,[u,u]),y=t.find(a,[u,u]),x=t.convert(0,u));for(var b=[],_=[],w=[],S=e.createSparseMatrix({values:b,index:_,ptr:w,size:[f,m],datatype:c===e._datatype&&d===n._datatype?u:void 0}),M=[],D=[],E=0;E<m;E++){w[E]=_.length;for(var C=E+1,A=0;A<p;A++){var T=h[A][E];if(!y(T,x))for(var N=l[A],R=l[A+1],P=N;P<R;P++){var F=s[P];D[F]!==C?(D[F]=C,_.push(F),M[F]=v(T,o[P])):M[F]=g(M[F],v(T,o[P]))}}for(var O=w[E],I=_.length,B=O;B<I;B++){var k=_[B];b[B]=M[k]}}return w[m]=_.length,S},"SparseMatrix, SparseMatrix":function(e,n){var a,o=e._values,s=e._index,l=e._ptr,c=e._datatype||void 0===e._data?e._datatype:e.getDataType(),u=n._values,h=n._index,d=n._ptr,f=n._datatype||void 0===n._data?n._datatype:n.getDataType(),p=e._size[0],m=n._size[1],g=o&&u,v=r,y=i;c&&f&&c===f&&"string"===typeof c&&"mixed"!==c&&(a=c,v=t.find(r,[a,a]),y=t.find(i,[a,a]));for(var x,b,_,w,S,M,D,E,C=g?[]:void 0,A=[],T=[],N=e.createSparseMatrix({values:C,index:A,ptr:T,size:[p,m],datatype:c===e._datatype&&f===n._datatype?a:void 0}),R=g?[]:void 0,P=[],F=0;F<m;F++){T[F]=A.length;var O=F+1;for(S=d[F],M=d[F+1],w=S;w<M;w++)if(E=h[w],g)for(b=l[E],_=l[E+1],x=b;x<_;x++)P[D=s[x]]!==O?(P[D]=O,A.push(D),R[D]=y(u[w],o[x])):R[D]=v(R[D],y(u[w],o[x]));else for(b=l[E],_=l[E+1],x=b;x<_;x++)P[D=s[x]]!==O&&(P[D]=O,A.push(D));if(g)for(var I=T[F],B=A.length,k=I;k<B;k++){var L=A[k];C[k]=R[L]}}return T[m]=A.length,N}});return t(WH,i,{"Array, Array":t.referTo("Matrix, Matrix",(e=>(t,r)=>{c(mF(t),mF(r));var i=e(n(t),n(r));return qC(i)?i.valueOf():i})),"Matrix, Matrix":function(e,t){var n=e.size(),r=t.size();return c(n,r),1===n.length?1===r.length?function(e,t,n){if(0===n)throw new Error("Cannot multiply two empty vectors");return o(e,t)}(e,t,n[0]):u(e,t):1===r.length?h(e,t):d(e,t)},"Matrix, Array":t.referTo("Matrix,Matrix",(e=>(t,r)=>e(t,n(r)))),"Array, Matrix":t.referToSelf((e=>(t,r)=>e(n(t,r.storage()),r))),"SparseMatrix, any":function(e,t){return s(e,t,i,!1)},"DenseMatrix, any":function(e,t){return l(e,t,i,!1)},"any, SparseMatrix":function(e,t){return s(t,e,i,!0)},"any, DenseMatrix":function(e,t){return l(t,e,i,!0)},"Array, any":function(e,t){return l(n(e),t,i,!1).valueOf()},"any, Array":function(e,t){return l(n(t),e,i,!0).valueOf()},"any, any":i,"any, any, ...any":t.referToSelf((e=>(t,n,r)=>{for(var i=e(t,n),a=0;a<r.length;a++)i=e(i,r[a]);return i}))})})),YH="range",ZH=SN(YH,["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],(e=>{var{typed:t,config:n,matrix:r,bignumber:i,smaller:a,smallerEq:o,larger:s,largerEq:l,add:c,isPositive:u}=e;return t(YH,{string:d,"string, boolean":d,number:function(e){throw new TypeError("Too few arguments to function range(): ".concat(e))},boolean:function(e){throw new TypeError("Unexpected type of argument 1 to function range(): ".concat(e,", number|bigint|BigNumber|Fraction"))},"number, number":function(e,t){return h(f(e,t,1,!1))},"number, number, number":function(e,t,n){return h(f(e,t,n,!1))},"number, number, boolean":function(e,t,n){return h(f(e,t,1,n))},"number, number, number, boolean":function(e,t,n,r){return h(f(e,t,n,r))},"bigint, bigint|number":function(e,t){return h(f(e,t,1n,!1))},"number, bigint":function(e,t){return h(f(BigInt(e),t,1n,!1))},"bigint, bigint|number, bigint|number":function(e,t,n){return h(f(e,t,BigInt(n),!1))},"number, bigint, bigint|number":function(e,t,n){return h(f(BigInt(e),t,BigInt(n),!1))},"bigint, bigint|number, boolean":function(e,t,n){return h(f(e,t,1n,n))},"number, bigint, boolean":function(e,t,n){return h(f(BigInt(e),t,1n,n))},"bigint, bigint|number, bigint|number, boolean":function(e,t,n,r){return h(f(e,t,BigInt(n),r))},"number, bigint, bigint|number, boolean":function(e,t,n,r){return h(f(BigInt(e),t,BigInt(n),r))},"BigNumber, BigNumber":function(e,t){return h(f(e,t,new(0,e.constructor)(1),!1))},"BigNumber, BigNumber, BigNumber":function(e,t,n){return h(f(e,t,n,!1))},"BigNumber, BigNumber, boolean":function(e,t,n){return h(f(e,t,new(0,e.constructor)(1),n))},"BigNumber, BigNumber, BigNumber, boolean":function(e,t,n,r){return h(f(e,t,n,r))},"Fraction, Fraction":function(e,t){return h(f(e,t,1,!1))},"Fraction, Fraction, Fraction":function(e,t,n){return h(f(e,t,n,!1))},"Fraction, Fraction, boolean":function(e,t,n){return h(f(e,t,1,n))},"Fraction, Fraction, Fraction, boolean":function(e,t,n,r){return h(f(e,t,n,r))},"Unit, Unit, Unit":function(e,t,n){return h(f(e,t,n,!1))},"Unit, Unit, Unit, boolean":function(e,t,n,r){return h(f(e,t,n,r))}});function h(e){return"Matrix"===n.matrix?r?r(e):MU():e}function d(e,t){var r=function(e){var t=e.split(":"),n=t.map((function(e){return Number(e)}));if(n.some((function(e){return isNaN(e)})))return null;switch(n.length){case 2:return{start:n[0],end:n[1],step:1};case 3:return{start:n[0],end:n[2],step:n[1]};default:return null}}(e);if(!r)throw new SyntaxError('String "'+e+'" is no valid range');return"BigNumber"===n.number?(void 0===i&&wU(),h(f(i(r.start),i(r.end),i(r.step)))):h(f(r.start,r.end,r.step,t))}function f(e,t,n,r){for(var i=[],h=u(n)?r?o:a:r?l:s,d=e;h(d,t);)i.push(d),d=c(d,n);return i}})),KH=SN("row",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:n,matrix:r,range:i}=e;return t("row",{"Matrix, number":a,"Array, number":function(e,t){return a(r(CA(e)),t).valueOf()}});function a(e,t){if(2!==e.size().length)throw new Error("Only two dimensional matrix is supported");xF(t,e.size()[0]);var a=i(0,e.size()[1]),o=new n(t,a),s=e.subset(o);return qC(s)?s:r([[s]])}})),QH="setCartesian",JH=SN(QH,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:a,DenseMatrix:o}=e;return t(QH,{"Array | Matrix, Array | Matrix":function(e,t){var s=[];if(0!==r(n(e),new a(0))&&0!==r(n(t),new a(0))){var l=NF(Array.isArray(e)?e:e.toArray()).sort(i),c=NF(Array.isArray(t)?t:t.toArray()).sort(i);s=[];for(var u=0;u<l.length;u++)for(var h=0;h<c.length;h++)s.push([l[u],c[h]])}return Array.isArray(e)&&Array.isArray(t)?s:new o(s)}})})),$H="setDistinct",eV=SN($H,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:a,DenseMatrix:o}=e;return t($H,{"Array | Matrix":function(e){var t;if(0===r(n(e),new a(0)))t=[];else{var s=NF(Array.isArray(e)?e:e.toArray()).sort(i);(t=[]).push(s[0]);for(var l=1;l<s.length;l++)0!==i(s[l],s[l-1])&&t.push(s[l])}return Array.isArray(e)?t:new o(t)}})})),tV="setIsSubset",nV=SN(tV,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:a}=e;return t(tV,{"Array | Matrix, Array | Matrix":function(e,t){if(0===r(n(e),new a(0)))return!0;if(0===r(n(t),new a(0)))return!1;for(var o,s=BF(NF(Array.isArray(e)?e:e.toArray()).sort(i)),l=BF(NF(Array.isArray(t)?t:t.toArray()).sort(i)),c=0;c<s.length;c++){o=!1;for(var u=0;u<l.length;u++)if(0===i(s[c].value,l[u].value)&&s[c].identifier===l[u].identifier){o=!0;break}if(!1===o)return!1}return!0}})})),rV="setPowerset",iV=SN(rV,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:a}=e;return t(rV,{"Array | Matrix":function(e){if(0===r(n(e),new a(0)))return[];for(var t=NF(Array.isArray(e)?e:e.toArray()).sort(i),s=[],l=0;l.toString(2).length<=t.length;)s.push(o(t,l.toString(2).split("").reverse())),l++;return function(e){for(var t=[],n=e.length-1;n>0;n--)for(var r=0;r<n;r++)e[r].length>e[r+1].length&&(t=e[r],e[r]=e[r+1],e[r+1]=t);return e}(s)}});function o(e,t){for(var n=[],r=0;r<t.length;r++)"1"===t[r]&&n.push(e[r]);return n}}));function aV(e,t,n,r,i,a,o){var s=0;for(n[o]=e;s>=0;){var l=n[o+s],c=n[r+l];-1===c?(s--,a[t++]=l):(n[r+l]=n[i+c],n[o+ ++s]=c)}return t}function oV(e){return-e-2}var sV=SN("csAmd",["add","multiply","transpose"],(e=>{var{add:t,multiply:n,transpose:r}=e;return function(e,o){if(!o||e<=0||e>3)return null;var s=o._size,l=s[0],c=s[1],u=0,h=Math.max(16,10*Math.sqrt(c)),d=function(e,i,a,o,s){var l=r(i);if(1===e&&o===a)return t(i,l);if(2===e){for(var c=l._index,u=l._ptr,h=0,d=0;d<a;d++){var f=u[d];if(u[d]=h,!(u[d+1]-f>s))for(var p=u[d+1];f<p;f++)c[h++]=c[f]}return u[a]=h,i=r(l),n(l,i)}return n(l,i)}(e,o,l,c,h=Math.min(c-2,h));!function(e,t,n){for(var r=e._values,i=e._index,a=e._ptr,o=e._size[1],s=0,l=0;l<o;l++){var c=a[l];for(a[l]=s;c<a[l+1];c++)t(i[c],l,r?r[c]:1,n)&&(i[s]=i[c],r&&(r[s]=r[c]),s++)}a[o]=s,i.splice(s,i.length-s),r&&r.splice(s,r.length-s)}(d,a,null);for(var f,p,m,g,v,y,x,b,_,w,S,M,D,E,C,A,T=d._index,N=d._ptr,R=N[c],P=[],F=[],O=c+1,I=2*(c+1),B=3*(c+1),k=4*(c+1),L=5*(c+1),U=6*(c+1),z=7*(c+1),H=P,V=function(e,t,n,r,a,o,s,l,c,u,h,d){for(var f=0;f<e;f++)n[r+f]=t[f+1]-t[f];n[r+e]=0;for(var p=0;p<=e;p++)n[a+p]=-1,o[p]=-1,n[s+p]=-1,n[l+p]=-1,n[c+p]=1,n[u+p]=1,n[h+p]=0,n[d+p]=n[r+p];var m=i(0,0,n,u,e);return n[h+e]=-2,t[e]=-1,n[u+e]=0,m}(c,N,F,0,B,H,I,z,O,U,k,L),G=function(e,t,n,r,i,a,o,s,l,c,u){for(var h=0,d=0;d<e;d++){var f=n[r+d];if(0===f)n[i+d]=-2,h++,t[d]=-1,n[a+d]=0;else if(f>o)n[s+d]=0,n[i+d]=-1,h++,t[d]=oV(e),n[s+e]++;else{var p=n[l+f];-1!==p&&(c[p]=d),n[u+d]=n[l+f],n[l+f]=d}}return h}(c,N,F,L,k,U,h,O,B,H,I),q=0;G<c;){for(m=-1;q<c&&-1===(m=F[B+q]);q++);-1!==F[I+m]&&(H[F[I+m]]=-1),F[B+q]=F[I+m];var j=F[k+m],W=F[O+m];G+=W;var X=0;F[O+m]=-W;var Y=N[m],Z=0===j?Y:R,K=Z;for(g=1;g<=j+1;g++){for(g>j?(y=m,x=Y,b=F[0+m]-j):(x=N[y=T[Y++]],b=F[0+y]),v=1;v<=b;v++)(_=F[O+(f=T[x++])])<=0||(X+=_,F[O+f]=-_,T[K++]=f,-1!==F[I+f]&&(H[F[I+f]]=H[f]),-1!==H[f]?F[I+H[f]]=F[I+f]:F[B+F[L+f]]=F[I+f]);y!==m&&(N[y]=oV(m),F[U+y]=0)}for(0!==j&&(R=K),F[L+m]=X,N[m]=Z,F[0+m]=K-Z,F[k+m]=-2,V=i(V,u,F,U,c),w=Z;w<K;w++)if(!((S=F[k+(f=T[w])])<=0)){var Q=V-(_=-F[O+f]);for(Y=N[f],M=N[f]+S-1;Y<=M;Y++)F[U+(y=T[Y])]>=V?F[U+y]-=_:0!==F[U+y]&&(F[U+y]=F[L+y]+Q)}for(w=Z;w<K;w++){for(D=(M=N[f=T[w]])+F[k+f]-1,E=M,C=0,A=0,Y=M;Y<=D;Y++)if(0!==F[U+(y=T[Y])]){var J=F[U+y]-V;J>0?(A+=J,T[E++]=y,C+=y):(N[y]=oV(m),F[U+y]=0)}F[k+f]=E-M+1;var $=E,ee=M+F[0+f];for(Y=D+1;Y<ee;Y++){var te=F[O+(p=T[Y])];te<=0||(A+=te,T[E++]=p,C+=p)}0===A?(N[f]=oV(m),X-=_=-F[O+f],W+=_,G+=_,F[O+f]=0,F[k+f]=-1):(F[L+f]=Math.min(F[L+f],A),T[E]=T[$],T[$]=T[M],T[M]=m,F[0+f]=E-M+1,C=(C<0?-C:C)%c,F[I+f]=F[z+C],F[z+C]=f,H[f]=C)}for(F[L+m]=X,V=i(V+(u=Math.max(u,X)),u,F,U,c),w=Z;w<K;w++)if(!(F[O+(f=T[w])]>=0))for(f=F[z+(C=H[f])],F[z+C]=-1;-1!==f&&-1!==F[I+f];f=F[I+f],V++){for(b=F[0+f],S=F[k+f],Y=N[f]+1;Y<=N[f]+b-1;Y++)F[U+T[Y]]=V;var ne=f;for(p=F[I+f];-1!==p;){var re=F[0+p]===b&&F[k+p]===S;for(Y=N[p]+1;re&&Y<=N[p]+b-1;Y++)F[U+T[Y]]!==V&&(re=0);re?(N[p]=oV(f),F[O+f]+=F[O+p],F[O+p]=0,F[k+p]=-1,p=F[I+p],F[I+ne]=p):(ne=p,p=F[I+p])}}for(Y=Z,w=Z;w<K;w++)(_=-F[O+(f=T[w])])<=0||(F[O+f]=_,A=F[L+f]+X-_,-1!==F[B+(A=Math.min(A,c-G-_))]&&(H[F[B+A]]=f),F[I+f]=F[B+A],H[f]=-1,F[B+A]=f,q=Math.min(q,A),F[L+f]=A,T[Y++]=f);F[O+m]=W,0===(F[0+m]=Y-Z)&&(N[m]=-1,F[U+m]=0),0!==j&&(R=Y)}for(f=0;f<c;f++)N[f]=oV(N[f]);for(p=0;p<=c;p++)F[B+p]=-1;for(p=c;p>=0;p--)F[O+p]>0||(F[I+p]=F[B+N[p]],F[B+N[p]]=p);for(y=c;y>=0;y--)F[O+y]<=0||-1!==N[y]&&(F[I+y]=F[B+N[y]],F[B+N[y]]=y);for(m=0,f=0;f<=c;f++)-1===N[f]&&(m=aV(f,m,F,B,I,P,U));return P.splice(P.length-1,1),P};function i(e,t,n,r,i){if(e<2||e+t<0){for(var a=0;a<i;a++)0!==n[r+a]&&(n[r+a]=1);e=2}return e}function a(e,t){return e!==t}}));function lV(e,t,n,r,i,a,o){var s,l,c,u=0;if(e<=t||n[r+t]<=n[i+e])return-1;n[i+e]=n[r+t];var h=n[a+e];if(n[a+e]=t,-1===h)u=1,c=e;else{for(u=2,c=h;c!==n[o+c];c=n[o+c]);for(s=h;s!==c;s=l)l=n[o+s],n[o+s]=c}return{jleaf:u,q:c}}var cV=SN("csCounts",["transpose"],(e=>{var{transpose:t}=e;return function(e,n,r,i){if(!e||!n||!r)return null;var a,o,s,l,c,u,h,d=e._size,f=d[0],p=d[1],m=4*p+(i?p+f+1:0),g=[],v=p,y=2*p,x=3*p,b=4*p,_=5*p+1;for(s=0;s<m;s++)g[s]=-1;var w=[],S=t(e),M=S._index,D=S._ptr;for(s=0;s<p;s++)for(w[o=r[s]]=-1===g[x+o]?1:0;-1!==o&&-1===g[x+o];o=n[o])g[x+o]=s;if(i){for(s=0;s<p;s++)g[r[s]]=s;for(a=0;a<f;a++){for(s=p,u=D[a],h=D[a+1],c=u;c<h;c++)s=Math.min(s,g[M[c]]);g[_+a]=g[b+s],g[b+s]=a}}for(a=0;a<p;a++)g[0+a]=a;for(s=0;s<p;s++){for(-1!==n[o=r[s]]&&w[n[o]]--,l=i?g[b+s]:o;-1!==l;l=i?g[_+l]:-1)for(c=D[l];c<D[l+1];c++){var E=lV(a=M[c],o,g,x,v,y,0);E.jleaf>=1&&w[o]++,2===E.jleaf&&w[E.q]--}-1!==n[o]&&(g[0+o]=n[o])}for(o=0;o<p;o++)-1!==n[o]&&(w[n[o]]+=w[o]);return w}})),uV=SN("csSqr",["add","multiply","transpose"],(e=>{var{add:t,multiply:n,transpose:r}=e,i=sV({add:t,multiply:n,transpose:r}),a=cV({transpose:r});return function(e,t,n){var r,o=t._ptr,s=t._size[1],l={};if(l.q=i(e,t),e&&!l.q)return null;if(n){var c=e?function(e,t,n,r){for(var i=e._values,a=e._index,o=e._ptr,s=e._size,l=e._datatype,c=s[0],u=s[1],h=r&&e._values?[]:null,d=[],f=[],p=0,m=0;m<u;m++){f[m]=p;for(var g=n?n[m]:m,v=o[g],y=o[g+1],x=v;x<y;x++){var b=t?t[a[x]]:a[x];d[p]=b,h&&(h[p]=i[x]),p++}}return f[u]=p,e.createSparseMatrix({values:h,index:d,ptr:f,size:[c,u],datatype:l})}(t,null,l.q,0):t;l.parent=function(e,t){if(!e)return null;var n,r,i=e._index,a=e._ptr,o=e._size,s=o[0],l=o[1],c=[],u=[],h=l;if(t)for(n=0;n<s;n++)u[h+n]=-1;for(var d=0;d<l;d++){c[d]=-1,u[0+d]=-1;for(var f=a[d],p=a[d+1],m=f;m<p;m++){var g=i[m];for(n=t?u[h+g]:g;-1!==n&&n<d;n=r)r=u[0+n],u[0+n]=d,-1===r&&(c[n]=d);t&&(u[h+g]=d)}}return c}(c,1);var u=function(e,t){if(!e)return null;var n,r=0,i=[],a=[],o=t,s=2*t;for(n=0;n<t;n++)a[0+n]=-1;for(n=t-1;n>=0;n--)-1!==e[n]&&(a[o+n]=a[0+e[n]],a[0+e[n]]=n);for(n=0;n<t;n++)-1===e[n]&&(r=aV(n,r,a,0,o,i,s));return i}(l.parent,s);if(l.cp=a(c,l.parent,u,1),c&&l.parent&&l.cp&&function(e,t){var n=e._ptr,r=e._index,i=e._size,a=i[0],o=i[1];t.pinv=[],t.leftmost=[];var s,l,c,u,h,d=t.parent,f=t.pinv,p=t.leftmost,m=[],g=0,v=a,y=a+o,x=a+2*o;for(l=0;l<o;l++)m[v+l]=-1,m[y+l]=-1,m[x+l]=0;for(s=0;s<a;s++)p[s]=-1;for(l=o-1;l>=0;l--)for(u=n[l],h=n[l+1],c=u;c<h;c++)p[r[c]]=l;for(s=a-1;s>=0;s--)f[s]=-1,-1!==(l=p[s])&&(0===m[x+l]++&&(m[y+l]=s),m[g+s]=m[v+l],m[v+l]=s);for(t.lnz=0,t.m2=a,l=0;l<o;l++)if(s=m[v+l],t.lnz++,s<0&&(s=t.m2++),f[s]=l,!(--x[l]<=0)){t.lnz+=m[x+l];var b=d[l];-1!==b&&(0===m[x+b]&&(m[y+b]=m[y+l]),m[g+m[y+l]]=m[v+b],m[v+b]=m[g+s],m[x+b]+=m[x+l])}for(s=0;s<a;s++)f[s]<0&&(f[s]=l++);return!0}(c,l))for(l.unz=0,r=0;r<s;r++)l.unz+=l.cp[r]}else l.unz=4*o[s]+s,l.lnz=l.unz;return l}}));function hV(e,t){return e[t]<0}function dV(e,t){e[t]=oV(e[t])}function fV(e){return e<0?oV(e):e}function pV(e,t,n,r,i){var a,o,s,l=t._index,c=t._ptr,u=t._size[1],h=0;for(r[0]=e;h>=0;){e=r[h];var d=i?i[e]:e;hV(c,e)||(dV(c,e),r[u+h]=d<0?0:fV(c[d]));var f=1;for(o=r[u+h],s=d<0?0:fV(c[d+1]);o<s;o++)if(!hV(c,a=l[o])){r[u+h]=o,r[++h]=a,f=0;break}f&&(h--,r[--n]=e)}return n}var mV=SN("csSpsolve",["divideScalar","multiply","subtract"],(e=>{var{divideScalar:t,multiply:n,subtract:r}=e;return function(e,i,a,o,s,l,c){var u,h,d,f,p=e._values,m=e._index,g=e._ptr,v=e._size[1],y=i._values,x=i._index,b=i._ptr,_=function(e,t,n,r,i){var a,o,s,l=e._ptr,c=e._size,u=t._index,h=t._ptr,d=c[1],f=d;for(o=h[n],s=h[n+1],a=o;a<s;a++){var p=u[a];hV(l,p)||(f=pV(p,e,f,r,i))}for(a=f;a<d;a++)dV(l,r[a]);return f}(e,i,a,o,l);for(u=_;u<v;u++)s[o[u]]=0;for(h=b[a],d=b[a+1],u=h;u<d;u++)s[x[u]]=y[u];for(var w=_;w<v;w++){var S=o[w],M=l?l[S]:S;if(!(M<0))for(h=g[M],d=g[M+1],s[S]=t(s[S],p[c?h:d-1]),u=c?h+1:h,f=c?d:d-1;u<f;u++){var D=m[u];s[D]=r(s[D],n(p[u],s[S]))}}return _}})),gV=SN("csLu",["abs","divideScalar","multiply","subtract","larger","largerEq","SparseMatrix"],(e=>{var{abs:t,divideScalar:n,multiply:r,subtract:i,larger:a,largerEq:o,SparseMatrix:s}=e,l=mV({divideScalar:n,multiply:r,subtract:i});return function(e,i,c){if(!e)return null;var u,h=e._size[1],d=100,f=100;i&&(u=i.q,d=i.lnz||d,f=i.unz||f);var p,m,g=[],v=[],y=[],x=new s({values:g,index:v,ptr:y,size:[h,h]}),b=[],_=[],w=[],S=new s({values:b,index:_,ptr:w,size:[h,h]}),M=[],D=[],E=[];for(p=0;p<h;p++)D[p]=0,M[p]=-1,y[p+1]=0;d=0,f=0;for(var C=0;C<h;C++){y[C]=d,w[C]=f;var A=u?u[C]:C,T=l(x,e,A,E,D,M,1),N=-1,R=-1;for(m=T;m<h;m++)if(M[p=E[m]]<0){var P=t(D[p]);a(P,R)&&(R=P,N=p)}else _[f]=M[p],b[f++]=D[p];if(-1===N||R<=0)return null;M[A]<0&&o(t(D[A]),r(R,c))&&(N=A);var F=D[N];for(_[f]=C,b[f++]=F,M[N]=C,v[d]=N,g[d++]=1,m=T;m<h;m++)M[p=E[m]]<0&&(v[d]=p,g[d++]=n(D[p],F)),D[p]=0}for(y[h]=d,w[h]=f,m=0;m<d;m++)v[m]=M[v[m]];return g.splice(d,g.length-d),v.splice(d,v.length-d),b.splice(f,b.length-f),_.splice(f,_.length-f),{L:x,U:S,pinv:M}}})),vV=SN("slu",["typed","abs","add","multiply","transpose","divideScalar","subtract","larger","largerEq","SparseMatrix"],(e=>{var{typed:t,abs:n,add:r,multiply:i,transpose:a,divideScalar:o,subtract:s,larger:l,largerEq:c,SparseMatrix:u}=e,h=uV({add:r,multiply:i,transpose:a}),d=gV({abs:n,divideScalar:o,multiply:i,subtract:s,larger:l,largerEq:c,SparseMatrix:u});return t("slu",{"SparseMatrix, number, number":function(e,t,n){if(!IN(t)||t<0||t>3)throw new Error("Symbolic Ordering and Analysis order must be an integer number in the interval [0, 3]");if(n<0||n>1)throw new Error("Partial pivoting threshold must be a number from 0 to 1");var r=h(t,e,!1),i=d(e,r,n);return{L:i.L,U:i.U,p:i.pinv,q:r.q,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\np: "+this.p.toString()+(this.q?"\nq: "+this.q.toString():"")+"\n"}}}})})),yV="sort",xV=SN(yV,["typed","matrix","compare","compareNatural"],(e=>{var{typed:t,matrix:n,compare:r,compareNatural:i}=e,a=r,o=(e,t)=>-r(e,t);return t(yV,{Array:function(e){return l(e),e.sort(a)},Matrix:function(e){return c(e),n(e.toArray().sort(a),e.storage())},"Array, function":function(e,t){return l(e),e.sort(t)},"Matrix, function":function(e,t){return c(e),n(e.toArray().sort(t),e.storage())},"Array, string":function(e,t){return l(e),e.sort(s(t))},"Matrix, string":function(e,t){return c(e),n(e.toArray().sort(s(t)),e.storage())}});function s(e){if("asc"===e)return a;if("desc"===e)return o;if("natural"===e)return i;throw new Error('String "asc", "desc", or "natural" expected')}function l(e){if(1!==mF(e).length)throw new Error("One dimensional array expected")}function c(e){if(1!==e.size().length)throw new Error("One dimensional matrix expected")}})),bV="unaryPlus",_V=SN(bV,["typed","config","numeric"],(e=>{var{typed:t,config:n,numeric:r}=e;return t(bV,{number:yO,Complex:function(e){return e},BigNumber:function(e){return e},bigint:function(e){return e},Fraction:function(e){return e},Unit:function(e){return e.clone()},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e,!0))),boolean:function(e){return r(e?1:0,n.number)},string:function(e){return r(e,BN(e,n))}})})),wV="usolveAll",SV=SN(wV,["typed","matrix","divideScalar","multiplyScalar","subtractScalar","equalScalar","DenseMatrix"],(e=>{var{typed:t,matrix:n,divideScalar:r,multiplyScalar:i,subtractScalar:a,equalScalar:o,DenseMatrix:s}=e,l=Xz({DenseMatrix:s});return t(wV,{"SparseMatrix, Array | Matrix":function(e,t){return function(e,t){for(var n=[l(e,t,!0)._data.map((e=>e[0]))],c=e._size[0],u=e._size[1],h=e._values,d=e._index,f=e._ptr,p=u-1;p>=0;p--)for(var m=n.length,g=0;g<m;g++){for(var v=n[g],y=[],x=[],b=f[p],_=0,w=f[p+1]-1;w>=b;w--){var S=d[w];S===p?_=h[w]:S<p&&(y.push(h[w]),x.push(S))}if(o(_,0))if(o(v[p],0)){if(0===g){var M=[...v];M[p]=1;for(var D=0,E=x.length;D<E;D++){var C=x[D];M[C]=a(M[C],y[D])}n.push(M)}}else{if(0===g)return[];n.splice(g,1),g-=1,m-=1}else{v[p]=r(v[p],_);for(var A=0,T=x.length;A<T;A++){var N=x[A];v[N]=a(v[N],i(v[p],y[A]))}}}return n.map((e=>new s({data:e.map((e=>[e])),size:[c,1]})))}(e,t)},"DenseMatrix, Array | Matrix":function(e,t){return c(e,t)},"Array, Array | Matrix":function(e,t){return c(n(e),t).map((e=>e.valueOf()))}});function c(e,t){for(var n=[l(e,t,!0)._data.map((e=>e[0]))],c=e._data,u=e._size[0],h=e._size[1]-1;h>=0;h--)for(var d=n.length,f=0;f<d;f++){var p=n[f];if(o(c[h][h],0))if(o(p[h],0)){if(0===f){var m=[...p];m[h]=1;for(var g=h-1;g>=0;g--)m[g]=a(m[g],c[g][h]);n.push(m)}}else{if(0===f)return[];n.splice(f,1),f-=1,d-=1}else{p[h]=r(p[h],c[h][h]);for(var v=h-1;v>=0;v--)p[v]=a(p[v],i(p[h],c[v][h]))}}return n.map((e=>new s({data:e.map((e=>[e])),size:[u,1]})))}})),MV="zpk2tf",DV=SN(MV,["typed","add","multiply","Complex","number"],(e=>{var{typed:t,add:n,multiply:r,Complex:i,number:a}=e;return t(MV,{"Array,Array,number":function(e,t,n){return o(e,t,n)},"Array,Array":function(e,t){return o(e,t,1)},"Matrix,Matrix,number":function(e,t,n){return o(e.valueOf(),t.valueOf(),n)},"Matrix,Matrix":function(e,t){return o(e.valueOf(),t.valueOf(),1)}});function o(e,t,n){e.some((e=>"BigNumber"===e.type))&&(e=e.map((e=>a(e)))),t.some((e=>"BigNumber"===e.type))&&(t=t.map((e=>a(e))));for(var o=[i(1,0)],l=[i(1,0)],c=0;c<e.length;c++){var u=e[c];"number"===typeof u&&(u=i(u,0)),o=s(o,[i(1,0),i(-u.re,-u.im)])}for(var h=0;h<t.length;h++){var d=t[h];"number"===typeof d&&(d=i(d,0)),l=s(l,[i(1,0),i(-d.re,-d.im)])}for(var f=0;f<o.length;f++)o[f]=r(o[f],n);return[o,l]}function s(e,t){for(var a=[],o=0;o<e.length+t.length-1;o++){a[o]=i(0,0);for(var s=0;s<e.length;s++)o-s>=0&&o-s<t.length&&(a[o]=n(a[o],r(e[s],t[o-s])))}return a}})),EV=SN("and",["typed","matrix","equalScalar","zeros","not","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,not:a,concat:o}=e,s=zL({typed:t,equalScalar:r}),l=xU({typed:t,equalScalar:r}),c=VL({typed:t,equalScalar:r}),u=qL({typed:t}),h=WL({typed:t,matrix:n,concat:o});return t("and",{"number, number":tk,"Complex, Complex":function(e,t){return(0!==e.re||0!==e.im)&&(0!==t.re||0!==t.im)},"BigNumber, BigNumber":function(e,t){return!e.isZero()&&!t.isZero()&&!e.isNaN()&&!t.isNaN()},"bigint, bigint":tk,"Unit, Unit":t.referToSelf((e=>(t,n)=>e(t.value||0,n.value||0))),"SparseMatrix, any":t.referToSelf((e=>(t,n)=>a(n)?i(t.size(),t.storage()):c(t,n,e,!1))),"DenseMatrix, any":t.referToSelf((e=>(t,n)=>a(n)?i(t.size(),t.storage()):u(t,n,e,!1))),"any, SparseMatrix":t.referToSelf((e=>(t,n)=>a(t)?i(t.size(),t.storage()):c(n,t,e,!0))),"any, DenseMatrix":t.referToSelf((e=>(t,n)=>a(t)?i(t.size(),t.storage()):u(n,t,e,!0))),"Array, any":t.referToSelf((e=>(t,r)=>e(n(t),r).valueOf())),"any, Array":t.referToSelf((e=>(t,r)=>e(t,n(r)).valueOf()))},h({SS:l,DS:s}))})),CV="ceil",AV=["typed","config","round","matrix","equalScalar","zeros","DenseMatrix"],TV=new wN(10),NV=SN(CV,["typed","config","round"],(e=>{var{typed:t,config:n,round:r}=e;function i(e){var t=Math.ceil(e),i=r(e);return t===i?t:QN(e,i,n.relTol,n.absTol)&&!QN(e,t,n.relTol,n.absTol)?i:t}return t(CV,{number:i,"number, number":function(e,t){if(!IN(t))throw new RangeError("number of decimals in function ceil must be an integer");if(t<0||t>15)throw new RangeError("number of decimals in ceil number must be in range 0-15");var n=10**t;return i(e*n)/n}})})),RV=SN(CV,AV,(e=>{var{typed:t,config:n,round:r,matrix:i,equalScalar:a,zeros:o,DenseMatrix:s}=e,l=VL({typed:t,equalScalar:a}),c=QL({typed:t,DenseMatrix:s}),u=qL({typed:t}),h=NV({typed:t,config:n,round:r});function d(e){var t=(e,t)=>ZI(e,t,n.relTol,n.absTol),i=e.ceil(),a=r(e);return i.eq(a)?i:t(e,a)&&!t(e,i)?a:i}return t("ceil",{number:h.signatures.number,"number,number":h.signatures["number,number"],Complex:function(e){return e.ceil()},"Complex, number":function(e,t){return e.ceil(t)},"Complex, BigNumber":function(e,t){return e.ceil(t.toNumber())},BigNumber:d,"BigNumber, BigNumber":function(e,t){var n=TV.pow(t);return d(e.mul(n)).div(n)},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.ceil()},"Fraction, number":function(e,t){return e.ceil(t)},"Fraction, BigNumber":function(e,t){return e.ceil(t.toNumber())},"Unit, number, Unit":t.referToSelf((e=>function(t,n,r){var i=t.toNumeric(r);return r.multiply(e(i,n))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>e(t,n.toNumber(),r))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>sO(t,(t=>e(t,n,r)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,n)=>e(t,0,n))),"Array | Matrix":t.referToSelf((e=>t=>sO(t,e,!0))),"Array, number | BigNumber":t.referToSelf((e=>(t,n)=>sO(t,(t=>e(t,n)),!0))),"SparseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>l(t,n,e,!1))),"DenseMatrix, number | BigNumber":t.referToSelf((e=>(t,n)=>u(t,n,e,!1))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,n)=>u(i(n),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,n)=>a(t,0)?o(n.size(),n.storage()):"dense"===n.storage()?u(n,t,e,!0):c(n,t,e,!0)))})})),PV="column",FV=SN(PV,["typed","Index","matrix","range"],(e=>{var{typed:t,Index:n,matrix:r,range:i}=e;return t(PV,{"Matrix, number":a,"Array, number":function(e,t){return a(r(CA(e)),t).valueOf()}});function a(e,t){if(2!==e.size().length)throw new Error("Only two dimensional matrix is supported");xF(t,e.size()[1]);var a=i(0,e.size()[0]),o=new n(a,t),s=e.subset(o);return qC(s)?s:r([[s]])}})),OV="cross",IV=SN(OV,["typed","matrix","subtract","multiply"],(e=>{var{typed:t,matrix:n,subtract:r,multiply:i}=e;return t(OV,{"Matrix, Matrix":function(e,t){return n(a(e.toArray(),t.toArray()))},"Matrix, Array":function(e,t){return n(a(e.toArray(),t))},"Array, Matrix":function(e,t){return n(a(e,t.toArray()))},"Array, Array":a});function a(e,t){var n=Math.max(mF(e).length,mF(t).length);e=EF(e),t=EF(t);var a=mF(e),o=mF(t);if(1!==a.length||1!==o.length||3!==a[0]||3!==o[0])throw new RangeError("Vectors with length 3 expected (Size A = ["+a.join(", ")+"], B = ["+o.join(", ")+"])");var s=[r(i(e[1],t[2]),i(e[2],t[1])),r(i(e[2],t[0]),i(e[0],t[2])),r(i(e[0],t[1]),i(e[1],t[0]))];return n>1?[s]:s}})),BV=SN("det",["typed","matrix","subtractScalar","multiply","divideScalar","isZero","unaryMinus"],(e=>{var{typed:t,matrix:n,subtractScalar:r,multiply:i,divideScalar:a,isZero:o,unaryMinus:s}=e;return t("det",{any:function(e){return CA(e)},"Array | Matrix":function(e){var t;switch((t=qC(e)?e.size():Array.isArray(e)?(e=n(e)).size():[]).length){case 0:return CA(e);case 1:if(1===t[0])return CA(e.valueOf()[0]);if(0===t[0])return 1;throw new RangeError("Matrix must be square (size: "+sF(t)+")");case 2:var l=t[0],c=t[1];if(l===c)return function(e,t){if(1===t)return CA(e[0][0]);if(2===t)return r(i(e[0][0],e[1][1]),i(e[1][0],e[0][1]));for(var n=!1,l=new Array(t).fill(0).map(((e,t)=>t)),c=0;c<t;c++){var u=l[c];if(o(e[u][c])){var h=void 0;for(h=c+1;h<t;h++)if(!o(e[l[h]][c])){u=l[h],l[h]=l[c],l[c]=u,n=!n;break}if(h===t)return e[u][c]}for(var d=e[u][c],f=0===c?1:e[l[c-1]][c-1],p=c+1;p<t;p++)for(var m=l[p],g=c+1;g<t;g++)e[m][g]=a(r(i(e[m][g],d),i(e[m][c],e[u][g])),f)}var v=e[l[t-1]][t-1];return n?s(v):v}(e.clone().valueOf(),l);if(0===c)return 1;throw new RangeError("Matrix must be square (size: "+sF(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+sF(t)+")")}}})})),kV="fix",LV=["typed","Complex","matrix","ceil","floor","equalScalar","zeros","DenseMatrix"],UV=SN(kV,["typed","ceil","floor"],(e=>{var{typed:t,ceil:n,floor:r}=e;return t(kV,{number:function(e){return e>0?r(e):n(e)},"number, number":function(e,t){return e>0?r(e,t):n(e,t)}})})),zV=SN(kV,LV,(e=>{var{typed:t,Complex:n,matrix:r,ceil:i,floor:a,equalScalar:o,zeros:s,DenseMatrix:l}=e,c=QL({typed:t,DenseMatrix:l}),u=qL({typed:t}),h=UV({typed:t,ceil:i,floor:a});return t("fix",{number:h.signatures.number,"number, number | BigNumber":h.signatures["number,number"],Complex:function(e){return new n(e.re>0?Math.floor(e.re):Math.ceil(e.re),e.im>0?Math.floor(e.im):Math.ceil(e.im))},"Complex, number":function(e,t){return new n(e.re>0?a(e.re,t):i(e.re,t),e.im>0?a(e.im,t):i(e.im,t))},"Complex, BigNumber":function(e,t){var r=t.toNumber();return new n(e.re>0?a(e.re,r):i(e.re,r),e.im>0?a(e.im,r):i(e.im,r))},BigNumber:function(e){return e.isNegative()?i(e):a(e)},"BigNumber, number | BigNumber":function(e,t){return e.isNegative()?i(e,t):a(e,t)},bigint:e=>e,"bigint, number":(e,t)=>e,"bigint, BigNumber":(e,t)=>e,Fraction:function(e){return e.s<0n?e.ceil():e.floor()},"Fraction, number | BigNumber":function(e,t){return e.s<0n?i(e,t):a(e,t)},"Unit, number, Unit":t.referToSelf((e=>function(t,n,r){var i=t.toNumeric(r);return r.multiply(e(i,n))})),"Unit, BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>e(t,n.toNumber(),r))),"Array | Matrix, number | BigNumber, Unit":t.referToSelf((e=>(t,n,r)=>sO(t,(t=>e(t,n,r)),!0))),"Array | Matrix | Unit, Unit":t.referToSelf((e=>(t,n)=>e(t,0,n))),"Array | Matrix":t.referToSelf((e=>t=>sO(t,e,!0))),"Array | Matrix, number | BigNumber":t.referToSelf((e=>(t,n)=>sO(t,(t=>e(t,n)),!0))),"number | Complex | Fraction | BigNumber, Array":t.referToSelf((e=>(t,n)=>u(r(n),t,e,!0).valueOf())),"number | Complex | Fraction | BigNumber, Matrix":t.referToSelf((e=>(t,n)=>o(t,0)?s(n.size(),n.storage()):"dense"===n.storage()?u(n,t,e,!0):c(n,t,e,!0)))})})),HV=SN("inv",["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],(e=>{var{typed:t,matrix:n,divideScalar:r,addScalar:i,multiply:a,unaryMinus:o,det:s,identity:l,abs:c}=e;return t("inv",{"Array | Matrix":function(e){var t=qC(e)?e.size():mF(e);switch(t.length){case 1:if(1===t[0])return qC(e)?n([r(1,e.valueOf()[0])]):[r(1,e[0])];throw new RangeError("Matrix must be square (size: "+sF(t)+")");case 2:var i=t[0],a=t[1];if(i===a)return qC(e)?n(u(e.valueOf(),i,a),e.storage()):u(e,i,a);throw new RangeError("Matrix must be square (size: "+sF(t)+")");default:throw new RangeError("Matrix must be two dimensional (size: "+sF(t)+")")}},any:function(e){return r(1,e)}});function u(e,t,n){var u,h,d,f,p;if(1===t){if(0===(f=e[0][0]))throw Error("Cannot calculate inverse, determinant is zero");return[[r(1,f)]]}if(2===t){var m=s(e);if(0===m)throw Error("Cannot calculate inverse, determinant is zero");return[[r(e[1][1],m),r(o(e[0][1]),m)],[r(o(e[1][0]),m),r(e[0][0],m)]]}var g=e.concat();for(u=0;u<t;u++)g[u]=g[u].concat();for(var v=l(t).valueOf(),y=0;y<n;y++){var x=c(g[y][y]),b=y;for(u=y+1;u<t;)c(g[u][y])>x&&(x=c(g[u][y]),b=u),u++;if(0===x)throw Error("Cannot calculate inverse, determinant is zero");(u=b)!==y&&(p=g[y],g[y]=g[u],g[u]=p,p=v[y],v[y]=v[u],v[u]=p);var _=g[y],w=v[y];for(u=0;u<t;u++){var S=g[u],M=v[u];if(u!==y){if(0!==S[y]){for(d=r(o(S[y]),_[y]),h=y;h<n;h++)S[h]=i(S[h],a(d,_[h]));for(h=0;h<n;h++)M[h]=i(M[h],a(d,w[h]))}}else{for(d=_[y],h=y;h<n;h++)S[h]=r(S[h],d);for(h=0;h<n;h++)M[h]=r(M[h],d)}}}return v}})),VV="pinv",GV=SN(VV,["typed","matrix","inv","deepEqual","equal","dotDivide","dot","ctranspose","divideScalar","multiply","add","Complex"],(e=>{var{typed:t,matrix:n,inv:r,deepEqual:i,equal:a,dotDivide:o,dot:s,ctranspose:l,divideScalar:c,multiply:u,add:h,Complex:d}=e;return t(VV,{"Array | Matrix":function(e){var t=qC(e)?e.size():mF(e);switch(t.length){case 1:return m(e)?l(e):1===t[0]?r(e):o(l(e),s(e,e));case 2:if(m(e))return l(e);var i=t[0],a=t[1];if(i===a)try{return r(e)}catch(c){if(!(c instanceof Error&&c.message.match(/Cannot calculate inverse, determinant is zero/)))throw c}return qC(e)?n(f(e.valueOf(),i,a),e.storage()):f(e,i,a);default:throw new RangeError("Matrix must be two dimensional (size: "+sF(t)+")")}},any:function(e){return a(e,0)?CA(e):c(1,e)}});function f(e,t,n){var{C:i,F:a}=function(e,t,n){var r=function(e,t,n){for(var r=CA(e),i=0,a=0;a<t;a++){if(n<=i)return r;for(var s=a;p(r[s][i]);)if(t===++s&&(s=a,n===++i))return r;[r[s],r[a]]=[r[a],r[s]];for(var l=r[a][i],c=0;c<n;c++)r[a][c]=o(r[a][c],l);for(var d=0;d<t;d++)if(d!==a){l=r[d][i];for(var f=0;f<n;f++)r[d][f]=h(r[d][f],u(-1,u(l,r[a][f])))}i++}return r}(e,t,n),i=e.map(((e,n)=>e.filter(((e,n)=>n<t&&!p(s(r[n],r[n])))))),a=r.filter(((e,t)=>!p(s(r[t],r[t]))));return{C:i,F:a}}(e,t,n),c=u(r(u(l(i),i)),l(i)),d=u(l(a),r(u(a,l(a))));return u(d,c)}function p(e){return a(h(e,d(1,1)),h(0,d(1,1)))}function m(e){return i(h(e,d(1,1)),h(u(e,0),d(1,1)))}})),qV=SN("pow",["typed","config","identity","multiply","matrix","inv","fraction","number","Complex"],(e=>{var{typed:t,config:n,identity:r,multiply:i,matrix:a,inv:o,number:s,fraction:l,Complex:c}=e;return t("pow",{"number, number":u,"Complex, Complex":function(e,t){return e.pow(t)},"BigNumber, BigNumber":function(e,t){return t.isInteger()||e>=0||n.predictable?e.pow(t):new c(e.toNumber(),0).pow(t.toNumber(),0)},"bigint, bigint":(e,t)=>e**t,"Fraction, Fraction":function(e,t){var r=e.pow(t);if(null!=r)return r;if(n.predictable)throw new Error("Result of pow is non-rational and cannot be expressed as a fraction");return u(e.valueOf(),t.valueOf())},"Array, number":h,"Array, BigNumber":function(e,t){return h(e,t.toNumber())},"Matrix, number":d,"Matrix, BigNumber":function(e,t){return d(e,t.toNumber())},"Unit, number | BigNumber":function(e,t){return e.pow(t)}});function u(e,t){if(n.predictable&&!IN(t)&&e<0)try{var r=l(t),i=s(r);if((t===i||Math.abs((t-i)/t)<1e-14)&&r.d%2n===1n)return(r.n%2n===0n?1:-1)*Math.pow(-e,t)}catch(a){}return n.predictable&&(e<-1&&t===1/0||e>-1&&e<0&&t===-1/0)?NaN:IN(t)||e>=0||n.predictable?RO(e,t):e*e<1&&t===1/0||e*e>1&&t===-1/0?0:new c(e,0).pow(t,0)}function h(e,t){if(!IN(t))throw new TypeError("For A^b, b must be an integer (value is "+t+")");var n=mF(e);if(2!==n.length)throw new Error("For A^b, A must be 2 dimensional (A has "+n.length+" dimensions)");if(n[0]!==n[1])throw new Error("For A^b, A must be square (size is "+n[0]+"x"+n[1]+")");if(t<0)try{return h(o(e),-t)}catch(l){if("Cannot calculate inverse, determinant is zero"===l.message)throw new TypeError("For A^b, when A is not invertible, b must be a positive integer (value is "+t+")");throw l}for(var a=r(n[0]).valueOf(),s=e;t>=1;)1===(1&t)&&(a=i(s,a)),t>>=1,s=i(s,s);return a}function d(e,t){return a(h(e.valueOf(),t))}})),jV="setDifference",WV=SN(jV,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:a,DenseMatrix:o}=e;return t(jV,{"Array | Matrix, Array | Matrix":function(e,t){var s;if(0===r(n(e),new a(0)))s=[];else{if(0===r(n(t),new a(0)))return NF(e.toArray());var l,c=BF(NF(Array.isArray(e)?e:e.toArray()).sort(i)),u=BF(NF(Array.isArray(t)?t:t.toArray()).sort(i));s=[];for(var h=0;h<c.length;h++){l=!1;for(var d=0;d<u.length;d++)if(0===i(c[h].value,u[d].value)&&c[h].identifier===u[d].identifier){l=!0;break}l||s.push(c[h])}}return Array.isArray(e)&&Array.isArray(t)?kF(s):new o(kF(s))}})})),XV="setMultiplicity",YV=SN(XV,["typed","size","subset","compareNatural","Index"],(e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:a}=e;return t(XV,{"number | BigNumber | Fraction | Complex, Array | Matrix":function(e,t){if(0===r(n(t),new a(0)))return 0;for(var o=NF(Array.isArray(t)?t:t.toArray()),s=0,l=0;l<o.length;l++)0===i(o[l],e)&&s++;return s}})})),ZV="setSymDifference",KV=SN(ZV,["typed","size","concat","subset","setDifference","Index"],(e=>{var{typed:t,size:n,concat:r,subset:i,setDifference:a,Index:o}=e;return t(ZV,{"Array | Matrix, Array | Matrix":function(e,t){if(0===i(n(e),new o(0)))return NF(t);if(0===i(n(t),new o(0)))return NF(e);var s=NF(e),l=NF(t);return r(a(s,l),a(l,s))}})})),QV=SN("Spa",["addScalar","equalScalar","FibonacciHeap"],(e=>{var{addScalar:t,equalScalar:n,FibonacciHeap:r}=e;function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new r}return i.prototype.type="Spa",i.prototype.isSpa=!0,i.prototype.set=function(e,t){if(this._values[e])this._values[e].value=t;else{var n=this._heap.insert(e,t);this._values[e]=n}},i.prototype.get=function(e){var t=this._values[e];return t?t.value:0},i.prototype.accumulate=function(e,n){var r=this._values[e];r?r.value=t(r.value,n):(r=this._heap.insert(e,n),this._values[e]=r)},i.prototype.forEach=function(e,t,r){var i=this._heap,a=this._values,o=[],s=i.extractMinimum();for(s&&o.push(s);s&&s.key<=t;)s.key>=e&&(n(s.value,0)||r(s.key,s.value,this)),(s=i.extractMinimum())&&o.push(s);for(var l=0;l<o.length;l++){var c=o[l];a[(s=i.insert(c.key,c.value)).key]=s}},i.prototype.swap=function(e,t){var n=this._values[e],r=this._values[t];if(!n&&r)n=this._heap.insert(e,r.value),this._heap.remove(r),this._values[e]=n,this._values[t]=void 0;else if(n&&!r)r=this._heap.insert(t,n.value),this._heap.remove(n),this._values[t]=r,this._values[e]=void 0;else if(n&&r){var i=n.value;n.value=r.value,r.value=i}},i}),{isClass:!0}),JV="sqrtm",$V=SN(JV,["typed","abs","add","multiply","map","sqrt","subtract","inv","size","max","identity"],(e=>{var{typed:t,abs:n,add:r,multiply:i,map:a,sqrt:o,subtract:s,inv:l,size:c,max:u,identity:h}=e,d=1e-6;function f(e){var t,a=0,o=e,f=h(c(e));do{var p=o;if(o=i(.5,r(p,l(f))),f=i(.5,r(f,l(p))),(t=u(n(s(o,p))))>d&&++a>1e3)throw new Error("computing square root of matrix: iterative method could not converge")}while(t>d);return o}return t(JV,{"Array | Matrix":function(e){var t=qC(e)?e.size():mF(e);switch(t.length){case 1:if(1===t[0])return a(e,o);throw new RangeError("Matrix must be square (size: "+sF(t)+")");case 2:if(t[0]===t[1])return f(e);throw new RangeError("Matrix must be square (size: "+sF(t)+")");default:throw new RangeError("Matrix must be at most two dimensional (size: "+sF(t)+")")}}})})),eG=SN("sum",["typed","config","add","numeric"],(e=>{var{typed:t,config:n,add:r,numeric:i}=e;return t("sum",{"Array | Matrix":a,"Array | Matrix, number | BigNumber":function(e,t){try{return lO(e,t,r)}catch(n){throw EU(n,"sum")}},"...":function(e){if(aO(e))throw new TypeError("Scalar values expected in function sum");return a(e)}});function a(e){var t;return oO(e,(function(e){try{t=void 0===t?e:r(t,e)}catch(n){throw EU(n,"sum",e)}})),void 0===t&&(t=i(0,n.number)),"string"===typeof t&&(t=i(t,BN(t,n))),t}})),tG=n(4705);function nG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nG(Object(n),!0).forEach((function(t){(0,tG.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nG(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var iG=SN("Unit",["?on","config","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","abs","fix","round","equal","isNumeric","format","number","Complex","BigNumber","Fraction"],(e=>{var t,n,r,{on:i,config:a,addScalar:o,subtractScalar:s,multiplyScalar:l,divideScalar:c,pow:u,abs:h,fix:d,round:f,equal:p,isNumeric:m,format:g,number:v,Complex:y,BigNumber:x,Fraction:b}=e,_=v;function w(e,t){if(!(this instanceof w))throw new Error("Constructor must be called with the new operator");if(null!==e&&void 0!==e&&!m(e)&&!UC(e))throw new TypeError("First parameter in Unit constructor must be number, BigNumber, Fraction, Complex, or undefined");if(this.fixPrefix=!1,this.skipAutomaticSimplification=!0,void 0===t)this.units=[],this.dimensions=F.map((e=>0));else if("string"===typeof t){var n=w.parse(t);this.units=n.units,this.dimensions=n.dimensions}else{if(!HC(t)||null!==t.value)throw new TypeError("Second parameter in Unit constructor must be a string or valueless Unit");this.fixPrefix=t.fixPrefix,this.skipAutomaticSimplification=t.skipAutomaticSimplification,this.dimensions=t.dimensions.slice(0),this.units=t.units.map((e=>SC({},e)))}this.value=this._normalize(e)}function S(){for(;" "===r||"\t"===r;)D()}function M(e){return e>="0"&&e<="9"}function D(){n++,r=t.charAt(n)}function E(e){n=e,r=t.charAt(n)}function C(){var e="",t=n;if("+"===r?D():"-"===r&&(e+=r,D()),!function(e){return e>="0"&&e<="9"||"."===e}(r))return E(t),null;if("."===r){if(e+=r,D(),!M(r))return E(t),null}else{for(;M(r);)e+=r,D();"."===r&&(e+=r,D())}for(;M(r);)e+=r,D();if("E"===r||"e"===r){var i="",a=n;if(i+=r,D(),"+"!==r&&"-"!==r||(i+=r,D()),!M(r))return E(a),e;for(e+=i;M(r);)e+=r,D()}return e}function A(){for(var e="";M(r)||w.isValidAlpha(r);)e+=r,D();var t=e.charAt(0);return w.isValidAlpha(t)?e:null}function T(e){return r===e?(D(),e):null}Object.defineProperty(w,"name",{value:"Unit"}),w.prototype.constructor=w,w.prototype.type="Unit",w.prototype.isUnit=!0,w.parse=function(e,i){if(i=i||{},n=-1,r="","string"!==typeof(t=e))throw new TypeError("Invalid argument in Unit.parse, string expected");var o=new w;o.units=[];var s=1,l=!1;D(),S();var c=C(),u=null;if(c){if("BigNumber"===a.number)u=new x(c);else if("Fraction"===a.number)try{u=new b(c)}catch(M){u=parseFloat(c)}else u=parseFloat(c);S(),T("*")?(s=1,l=!0):T("/")&&(s=-1,l=!0)}for(var h=[],d=1;;){for(S();"("===r;)h.push(s),d*=s,s=1,D(),S();var f=void 0;if(!r)break;var p=r;if(null===(f=A()))throw new SyntaxError('Unexpected "'+p+'" in "'+t+'" at index '+n.toString());var m=N(f);if(null===m)throw new SyntaxError('Unit "'+f+'" not found.');var g=s*d;if(S(),T("^")){S();var v=C();if(null===v)throw new SyntaxError('In "'+e+'", "^" must be followed by a floating-point number');g*=v}o.units.push({unit:m.unit,prefix:m.prefix,power:g});for(var y=0;y<F.length;y++)o.dimensions[y]+=(m.unit.dimensions[y]||0)*g;for(S();")"===r;){if(0===h.length)throw new SyntaxError('Unmatched ")" in "'+t+'" at index '+n.toString());d/=h.pop(),D(),S()}if(l=!1,T("*")?(s=1,l=!0):T("/")?(s=-1,l=!0):s=1,m.unit.base){var _=m.unit.base.key;z.auto[_]={unit:m.unit,prefix:m.prefix}}}if(S(),r)throw new SyntaxError('Could not parse: "'+e+'"');if(l)throw new SyntaxError('Trailing characters: "'+e+'"');if(0!==h.length)throw new SyntaxError('Unmatched "(" in "'+t+'"');if(0===o.units.length&&!i.allowNoUnits)throw new SyntaxError('"'+e+'" contains no units');return o.value=void 0!==u?o._normalize(u):null,o},w.prototype.clone=function(){var e=new w;e.fixPrefix=this.fixPrefix,e.skipAutomaticSimplification=this.skipAutomaticSimplification,e.value=CA(this.value),e.dimensions=this.dimensions.slice(0),e.units=[];for(var t=0;t<this.units.length;t++)for(var n in e.units[t]={},this.units[t])OA(this.units[t],n)&&(e.units[t][n]=this.units[t][n]);return e},w.prototype.valueType=function(){return EA(this.value)},w.prototype._isDerived=function(){return 0!==this.units.length&&(this.units.length>1||Math.abs(this.units[0].power-1)>1e-15)},w.prototype._normalize=function(e){if(null===e||void 0===e||0===this.units.length)return e;for(var t=e,n=w._getNumberConverter(EA(e)),r=0;r<this.units.length;r++){var i=n(this.units[r].unit.value),a=n(this.units[r].prefix.value),o=n(this.units[r].power);t=l(t,u(l(i,a),o))}return t},w.prototype._denormalize=function(e,t){if(null===e||void 0===e||0===this.units.length)return e;for(var n=e,r=w._getNumberConverter(EA(e)),i=0;i<this.units.length;i++){var a=r(this.units[i].unit.value),o=r(this.units[i].prefix.value),s=r(this.units[i].power);n=c(n,u(l(a,o),s))}return n};var N=lR((e=>{if(OA(k,e)){var t=k[e];return{unit:t,prefix:t.prefixes[""]}}for(var n in k)if(OA(k,n)&&oF(e,n)){var r=k[n],i=e.length-n.length,a=e.substring(0,i),o=OA(r.prefixes,a)?r.prefixes[a]:void 0;if(void 0!==o)return{unit:r,prefix:o}}return null}),{hasher:e=>e[0],limit:100});function R(e){return e.equalBase(O.NONE)&&null!==e.value&&!a.predictable?e.value:e}w.isValuelessUnit=function(e){return null!==N(e)},w.prototype.hasBase=function(e){if("string"===typeof e&&(e=O[e]),!e)return!1;for(var t=0;t<F.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},w.prototype.equalBase=function(e){for(var t=0;t<F.length;t++)if(Math.abs((this.dimensions[t]||0)-(e.dimensions[t]||0))>1e-12)return!1;return!0},w.prototype.equals=function(e){return this.equalBase(e)&&p(this.value,e.value)},w.prototype.multiply=function(e){for(var t=this.clone(),n=HC(e)?e:new w(e),r=0;r<F.length;r++)t.dimensions[r]=(this.dimensions[r]||0)+(n.dimensions[r]||0);for(var i=0;i<n.units.length;i++){var a=rG({},n.units[i]);t.units.push(a)}if(null!==this.value||null!==n.value){var o=null===this.value?this._normalize(1):this.value,s=null===n.value?n._normalize(1):n.value;t.value=l(o,s)}else t.value=null;return HC(e)&&(t.skipAutomaticSimplification=!1),R(t)},w.prototype.divideInto=function(e){return new w(e).divide(this)},w.prototype.divide=function(e){for(var t=this.clone(),n=HC(e)?e:new w(e),r=0;r<F.length;r++)t.dimensions[r]=(this.dimensions[r]||0)-(n.dimensions[r]||0);for(var i=0;i<n.units.length;i++){var a=rG(rG({},n.units[i]),{},{power:-n.units[i].power});t.units.push(a)}if(null!==this.value||null!==n.value){var o=null===this.value?this._normalize(1):this.value,s=null===n.value?n._normalize(1):n.value;t.value=c(o,s)}else t.value=null;return HC(e)&&(t.skipAutomaticSimplification=!1),R(t)},w.prototype.pow=function(e){for(var t=this.clone(),n=0;n<F.length;n++)t.dimensions[n]=(this.dimensions[n]||0)*e;for(var r=0;r<t.units.length;r++)t.units[r].power*=e;return null!==t.value?t.value=u(t.value,e):t.value=null,t.skipAutomaticSimplification=!1,R(t)},w.prototype.abs=function(){var e=this.clone();if(null!==e.value)if(e._isDerived()||0===e.units.length||0===e.units[0].unit.offset)e.value=h(e.value);else{var t=e._numberConverter(),n=t(e.units[0].unit.value),r=t(e.units[0].unit.offset),i=l(n,r);e.value=s(h(o(e.value,i)),i)}for(var a in e.units)"VA"!==e.units[a].unit.name&&"VAR"!==e.units[a].unit.name||(e.units[a].unit=k.W);return e},w.prototype.to=function(e){var t,n=null===this.value?this._normalize(1):this.value;if("string"===typeof e)t=w.parse(e);else{if(!HC(e))throw new Error("String or Unit expected as parameter");t=e.clone()}if(!this.equalBase(t))throw new Error("Units do not match ('".concat(t.toString(),"' != '").concat(this.toString(),"')"));if(null!==t.value)throw new Error("Cannot convert to a unit with a value");if(null===this.value||this._isDerived()||0===this.units.length||0===t.units.length||this.units[0].unit.offset===t.units[0].unit.offset)t.value=CA(n);else{var r=w._getNumberConverter(EA(n)),i=this.units[0].unit.value,a=this.units[0].unit.offset,c=l(i,a),u=t.units[0].unit.value,h=t.units[0].unit.offset,d=l(u,h);t.value=o(n,r(s(c,d)))}return t.fixPrefix=!0,t.skipAutomaticSimplification=!0,t},w.prototype.toNumber=function(e){return _(this.toNumeric(e))},w.prototype.toNumeric=function(e){var t;return(t=e?this.to(e):this.clone())._isDerived()||0===t.units.length?t._denormalize(t.value):t._denormalize(t.value,t.units[0].prefix.value)},w.prototype.toString=function(){return this.format()},w.prototype.toJSON=function(){return{mathjs:"Unit",value:this._denormalize(this.value),unit:this.units.length>0?this.formatUnits():null,fixPrefix:this.fixPrefix}},w.fromJSON=function(e){var t,n=new w(e.value,null!==(t=e.unit)&&void 0!==t?t:void 0);return n.fixPrefix=e.fixPrefix||!1,n},w.prototype.valueOf=w.prototype.toString,w.prototype.simplify=function(){var e,t,n=this.clone(),r=[];for(var i in H)if(OA(H,i)&&n.hasBase(O[i])){e=i;break}if("NONE"===e)n.units=[];else if(e&&OA(H,e)&&(t=H[e]),t)n.units=[{unit:t.unit,prefix:t.prefix,power:1}];else{for(var a=!1,o=0;o<F.length;o++){var s=F[o];Math.abs(n.dimensions[o]||0)>1e-12&&(OA(H,s)?r.push({unit:H[s].unit,prefix:H[s].prefix,power:n.dimensions[o]||0}):a=!0)}r.length<n.units.length&&!a&&(n.units=r)}return n},w.prototype.toSI=function(){for(var e=this.clone(),t=[],n=0;n<F.length;n++){var r=F[n];if(Math.abs(e.dimensions[n]||0)>1e-12){if(!OA(z.si,r))throw new Error("Cannot express custom unit "+r+" in SI units");t.push({unit:z.si[r].unit,prefix:z.si[r].prefix,power:e.dimensions[n]||0})}}return e.units=t,e.fixPrefix=!0,e.skipAutomaticSimplification=!0,null!==this.value?(e.value=null,this.to(e)):e},w.prototype.formatUnits=function(){for(var e="",t="",n=0,r=0,i=0;i<this.units.length;i++)this.units[i].power>0?(n++,e+=" "+this.units[i].prefix.name+this.units[i].unit.name,Math.abs(this.units[i].power-1)>1e-15&&(e+="^"+this.units[i].power)):this.units[i].power<0&&r++;if(r>0)for(var a=0;a<this.units.length;a++)this.units[a].power<0&&(n>0?(t+=" "+this.units[a].prefix.name+this.units[a].unit.name,Math.abs(this.units[a].power+1)>1e-15&&(t+="^"+-this.units[a].power)):(t+=" "+this.units[a].prefix.name+this.units[a].unit.name,t+="^"+this.units[a].power));e=e.substr(1),t=t.substr(1),n>1&&r>0&&(e="("+e+")"),r>1&&n>0&&(t="("+t+")");var o=e;return n>0&&r>0&&(o+=" / "),o+=t},w.prototype.format=function(e){var t=this.skipAutomaticSimplification||null===this.value?this.clone():this.simplify(),n=!1;for(var r in"undefined"!==typeof t.value&&null!==t.value&&UC(t.value)&&(n=Math.abs(t.value.re)<1e-14),t.units)OA(t.units,r)&&t.units[r].unit&&("VA"===t.units[r].unit.name&&n?t.units[r].unit=k.VAR:"VAR"!==t.units[r].unit.name||n||(t.units[r].unit=k.VA));1!==t.units.length||t.fixPrefix||Math.abs(t.units[0].power-Math.round(t.units[0].power))<1e-14&&(t.units[0].prefix=t._bestPrefix());var i=t._denormalize(t.value),a=null!==t.value?g(i,e||{}):"",o=t.formatUnits();return t.value&&UC(t.value)&&(a="("+a+")"),o.length>0&&a.length>0&&(a+=" "),a+=o},w.prototype._bestPrefix=function(){if(1!==this.units.length)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");if(Math.abs(this.units[0].power-Math.round(this.units[0].power))>=1e-14)throw new Error("Can only compute the best prefix for single units with integer powers, like kg, s^2, N^-1, and so forth!");var e=null!==this.value?h(this.value):0,t=h(this.units[0].unit.value),n=this.units[0].prefix;if(0===e)return n;var r=this.units[0].power,i=Math.log(e/Math.pow(n.value*t,r))/Math.LN10-1.2;if(i>-2.200001&&i<1.800001)return n;i=Math.abs(i);var a=this.units[0].unit.prefixes;for(var o in a)if(OA(a,o)){var s=a[o];if(s.scientific){var l=Math.abs(Math.log(e/Math.pow(s.value*t,r))/Math.LN10-1.2);(l<i||l===i&&s.name.length<n.name.length)&&(n=s,i=l)}}return n},w.prototype.splitUnit=function(e){for(var t=this.clone(),n=[],r=0;r<e.length&&(t=t.to(e[r]),r!==e.length-1);r++){var i=t.toNumeric(),a=f(i),l=new w(p(a,i)?a:d(t.toNumeric()),e[r].toString());n.push(l),t=s(t,l)}for(var c=0,u=0;u<n.length;u++)c=o(c,n[u].value);return p(c,this.value)&&(t.value=0),n.push(t),n};var P={NONE:{"":{name:"",value:1,scientific:!0}},SHORT:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:10,scientific:!1},h:{name:"h",value:100,scientific:!1},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0},R:{name:"R",value:1e27,scientific:!0},Q:{name:"Q",value:1e30,scientific:!0},d:{name:"d",value:.1,scientific:!1},c:{name:"c",value:.01,scientific:!1},m:{name:"m",value:.001,scientific:!0},u:{name:"u",value:1e-6,scientific:!0},n:{name:"n",value:1e-9,scientific:!0},p:{name:"p",value:1e-12,scientific:!0},f:{name:"f",value:1e-15,scientific:!0},a:{name:"a",value:1e-18,scientific:!0},z:{name:"z",value:1e-21,scientific:!0},y:{name:"y",value:1e-24,scientific:!0},r:{name:"r",value:1e-27,scientific:!0},q:{name:"q",value:1e-30,scientific:!0}},LONG:{"":{name:"",value:1,scientific:!0},deca:{name:"deca",value:10,scientific:!1},hecto:{name:"hecto",value:100,scientific:!1},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0},ronna:{name:"ronna",value:1e27,scientific:!0},quetta:{name:"quetta",value:1e30,scientific:!0},deci:{name:"deci",value:.1,scientific:!1},centi:{name:"centi",value:.01,scientific:!1},milli:{name:"milli",value:.001,scientific:!0},micro:{name:"micro",value:1e-6,scientific:!0},nano:{name:"nano",value:1e-9,scientific:!0},pico:{name:"pico",value:1e-12,scientific:!0},femto:{name:"femto",value:1e-15,scientific:!0},atto:{name:"atto",value:1e-18,scientific:!0},zepto:{name:"zepto",value:1e-21,scientific:!0},yocto:{name:"yocto",value:1e-24,scientific:!0},ronto:{name:"ronto",value:1e-27,scientific:!0},quecto:{name:"quecto",value:1e-30,scientific:!0}},SQUARED:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:100,scientific:!1},h:{name:"h",value:1e4,scientific:!1},k:{name:"k",value:1e6,scientific:!0},M:{name:"M",value:1e12,scientific:!0},G:{name:"G",value:1e18,scientific:!0},T:{name:"T",value:1e24,scientific:!0},P:{name:"P",value:1e30,scientific:!0},E:{name:"E",value:1e36,scientific:!0},Z:{name:"Z",value:1e42,scientific:!0},Y:{name:"Y",value:1e48,scientific:!0},R:{name:"R",value:1e54,scientific:!0},Q:{name:"Q",value:1e60,scientific:!0},d:{name:"d",value:.01,scientific:!1},c:{name:"c",value:1e-4,scientific:!1},m:{name:"m",value:1e-6,scientific:!0},u:{name:"u",value:1e-12,scientific:!0},n:{name:"n",value:1e-18,scientific:!0},p:{name:"p",value:1e-24,scientific:!0},f:{name:"f",value:1e-30,scientific:!0},a:{name:"a",value:1e-36,scientific:!0},z:{name:"z",value:1e-42,scientific:!0},y:{name:"y",value:1e-48,scientific:!0},r:{name:"r",value:1e-54,scientific:!0},q:{name:"q",value:1e-60,scientific:!0}},CUBIC:{"":{name:"",value:1,scientific:!0},da:{name:"da",value:1e3,scientific:!1},h:{name:"h",value:1e6,scientific:!1},k:{name:"k",value:1e9,scientific:!0},M:{name:"M",value:1e18,scientific:!0},G:{name:"G",value:1e27,scientific:!0},T:{name:"T",value:1e36,scientific:!0},P:{name:"P",value:1e45,scientific:!0},E:{name:"E",value:1e54,scientific:!0},Z:{name:"Z",value:1e63,scientific:!0},Y:{name:"Y",value:1e72,scientific:!0},R:{name:"R",value:1e81,scientific:!0},Q:{name:"Q",value:1e90,scientific:!0},d:{name:"d",value:.001,scientific:!1},c:{name:"c",value:1e-6,scientific:!1},m:{name:"m",value:1e-9,scientific:!0},u:{name:"u",value:1e-18,scientific:!0},n:{name:"n",value:1e-27,scientific:!0},p:{name:"p",value:1e-36,scientific:!0},f:{name:"f",value:1e-45,scientific:!0},a:{name:"a",value:1e-54,scientific:!0},z:{name:"z",value:1e-63,scientific:!0},y:{name:"y",value:1e-72,scientific:!0},r:{name:"r",value:1e-81,scientific:!0},q:{name:"q",value:1e-90,scientific:!0}},BINARY_SHORT_SI:{"":{name:"",value:1,scientific:!0},k:{name:"k",value:1e3,scientific:!0},M:{name:"M",value:1e6,scientific:!0},G:{name:"G",value:1e9,scientific:!0},T:{name:"T",value:1e12,scientific:!0},P:{name:"P",value:1e15,scientific:!0},E:{name:"E",value:1e18,scientific:!0},Z:{name:"Z",value:1e21,scientific:!0},Y:{name:"Y",value:1e24,scientific:!0}},BINARY_SHORT_IEC:{"":{name:"",value:1,scientific:!0},Ki:{name:"Ki",value:1024,scientific:!0},Mi:{name:"Mi",value:Math.pow(1024,2),scientific:!0},Gi:{name:"Gi",value:Math.pow(1024,3),scientific:!0},Ti:{name:"Ti",value:Math.pow(1024,4),scientific:!0},Pi:{name:"Pi",value:Math.pow(1024,5),scientific:!0},Ei:{name:"Ei",value:Math.pow(1024,6),scientific:!0},Zi:{name:"Zi",value:Math.pow(1024,7),scientific:!0},Yi:{name:"Yi",value:Math.pow(1024,8),scientific:!0}},BINARY_LONG_SI:{"":{name:"",value:1,scientific:!0},kilo:{name:"kilo",value:1e3,scientific:!0},mega:{name:"mega",value:1e6,scientific:!0},giga:{name:"giga",value:1e9,scientific:!0},tera:{name:"tera",value:1e12,scientific:!0},peta:{name:"peta",value:1e15,scientific:!0},exa:{name:"exa",value:1e18,scientific:!0},zetta:{name:"zetta",value:1e21,scientific:!0},yotta:{name:"yotta",value:1e24,scientific:!0}},BINARY_LONG_IEC:{"":{name:"",value:1,scientific:!0},kibi:{name:"kibi",value:1024,scientific:!0},mebi:{name:"mebi",value:Math.pow(1024,2),scientific:!0},gibi:{name:"gibi",value:Math.pow(1024,3),scientific:!0},tebi:{name:"tebi",value:Math.pow(1024,4),scientific:!0},pebi:{name:"pebi",value:Math.pow(1024,5),scientific:!0},exi:{name:"exi",value:Math.pow(1024,6),scientific:!0},zebi:{name:"zebi",value:Math.pow(1024,7),scientific:!0},yobi:{name:"yobi",value:Math.pow(1024,8),scientific:!0}},BTU:{"":{name:"",value:1,scientific:!0},MM:{name:"MM",value:1e6,scientific:!0}}};P.SHORTLONG=SC({},P.SHORT,P.LONG),P.BINARY_SHORT=SC({},P.BINARY_SHORT_SI,P.BINARY_SHORT_IEC),P.BINARY_LONG=SC({},P.BINARY_LONG_SI,P.BINARY_LONG_IEC);var F=["MASS","LENGTH","TIME","CURRENT","TEMPERATURE","LUMINOUS_INTENSITY","AMOUNT_OF_SUBSTANCE","ANGLE","BIT"],O={NONE:{dimensions:[0,0,0,0,0,0,0,0,0]},MASS:{dimensions:[1,0,0,0,0,0,0,0,0]},LENGTH:{dimensions:[0,1,0,0,0,0,0,0,0]},TIME:{dimensions:[0,0,1,0,0,0,0,0,0]},CURRENT:{dimensions:[0,0,0,1,0,0,0,0,0]},TEMPERATURE:{dimensions:[0,0,0,0,1,0,0,0,0]},LUMINOUS_INTENSITY:{dimensions:[0,0,0,0,0,1,0,0,0]},AMOUNT_OF_SUBSTANCE:{dimensions:[0,0,0,0,0,0,1,0,0]},FORCE:{dimensions:[1,1,-2,0,0,0,0,0,0]},SURFACE:{dimensions:[0,2,0,0,0,0,0,0,0]},VOLUME:{dimensions:[0,3,0,0,0,0,0,0,0]},ENERGY:{dimensions:[1,2,-2,0,0,0,0,0,0]},POWER:{dimensions:[1,2,-3,0,0,0,0,0,0]},PRESSURE:{dimensions:[1,-1,-2,0,0,0,0,0,0]},ELECTRIC_CHARGE:{dimensions:[0,0,1,1,0,0,0,0,0]},ELECTRIC_CAPACITANCE:{dimensions:[-1,-2,4,2,0,0,0,0,0]},ELECTRIC_POTENTIAL:{dimensions:[1,2,-3,-1,0,0,0,0,0]},ELECTRIC_RESISTANCE:{dimensions:[1,2,-3,-2,0,0,0,0,0]},ELECTRIC_INDUCTANCE:{dimensions:[1,2,-2,-2,0,0,0,0,0]},ELECTRIC_CONDUCTANCE:{dimensions:[-1,-2,3,2,0,0,0,0,0]},MAGNETIC_FLUX:{dimensions:[1,2,-2,-1,0,0,0,0,0]},MAGNETIC_FLUX_DENSITY:{dimensions:[1,0,-2,-1,0,0,0,0,0]},FREQUENCY:{dimensions:[0,0,-1,0,0,0,0,0,0]},ANGLE:{dimensions:[0,0,0,0,0,0,0,1,0]},BIT:{dimensions:[0,0,0,0,0,0,0,0,1]}};for(var I in O)OA(O,I)&&(O[I].key=I);var B={name:"",base:{},value:1,offset:0,dimensions:F.map((e=>0))},k={meter:{name:"meter",base:O.LENGTH,prefixes:P.LONG,value:1,offset:0},inch:{name:"inch",base:O.LENGTH,prefixes:P.NONE,value:.0254,offset:0},foot:{name:"foot",base:O.LENGTH,prefixes:P.NONE,value:.3048,offset:0},yard:{name:"yard",base:O.LENGTH,prefixes:P.NONE,value:.9144,offset:0},mile:{name:"mile",base:O.LENGTH,prefixes:P.NONE,value:1609.344,offset:0},link:{name:"link",base:O.LENGTH,prefixes:P.NONE,value:.201168,offset:0},rod:{name:"rod",base:O.LENGTH,prefixes:P.NONE,value:5.0292,offset:0},chain:{name:"chain",base:O.LENGTH,prefixes:P.NONE,value:20.1168,offset:0},angstrom:{name:"angstrom",base:O.LENGTH,prefixes:P.NONE,value:1e-10,offset:0},m:{name:"m",base:O.LENGTH,prefixes:P.SHORT,value:1,offset:0},in:{name:"in",base:O.LENGTH,prefixes:P.NONE,value:.0254,offset:0},ft:{name:"ft",base:O.LENGTH,prefixes:P.NONE,value:.3048,offset:0},yd:{name:"yd",base:O.LENGTH,prefixes:P.NONE,value:.9144,offset:0},mi:{name:"mi",base:O.LENGTH,prefixes:P.NONE,value:1609.344,offset:0},li:{name:"li",base:O.LENGTH,prefixes:P.NONE,value:.201168,offset:0},rd:{name:"rd",base:O.LENGTH,prefixes:P.NONE,value:5.02921,offset:0},ch:{name:"ch",base:O.LENGTH,prefixes:P.NONE,value:20.1168,offset:0},mil:{name:"mil",base:O.LENGTH,prefixes:P.NONE,value:254e-7,offset:0},m2:{name:"m2",base:O.SURFACE,prefixes:P.SQUARED,value:1,offset:0},sqin:{name:"sqin",base:O.SURFACE,prefixes:P.NONE,value:64516e-8,offset:0},sqft:{name:"sqft",base:O.SURFACE,prefixes:P.NONE,value:.09290304,offset:0},sqyd:{name:"sqyd",base:O.SURFACE,prefixes:P.NONE,value:.83612736,offset:0},sqmi:{name:"sqmi",base:O.SURFACE,prefixes:P.NONE,value:2589988.110336,offset:0},sqrd:{name:"sqrd",base:O.SURFACE,prefixes:P.NONE,value:25.29295,offset:0},sqch:{name:"sqch",base:O.SURFACE,prefixes:P.NONE,value:404.6873,offset:0},sqmil:{name:"sqmil",base:O.SURFACE,prefixes:P.NONE,value:6.4516e-10,offset:0},acre:{name:"acre",base:O.SURFACE,prefixes:P.NONE,value:4046.86,offset:0},hectare:{name:"hectare",base:O.SURFACE,prefixes:P.NONE,value:1e4,offset:0},m3:{name:"m3",base:O.VOLUME,prefixes:P.CUBIC,value:1,offset:0},L:{name:"L",base:O.VOLUME,prefixes:P.SHORT,value:.001,offset:0},l:{name:"l",base:O.VOLUME,prefixes:P.SHORT,value:.001,offset:0},litre:{name:"litre",base:O.VOLUME,prefixes:P.LONG,value:.001,offset:0},cuin:{name:"cuin",base:O.VOLUME,prefixes:P.NONE,value:16387064e-12,offset:0},cuft:{name:"cuft",base:O.VOLUME,prefixes:P.NONE,value:.028316846592,offset:0},cuyd:{name:"cuyd",base:O.VOLUME,prefixes:P.NONE,value:.764554857984,offset:0},teaspoon:{name:"teaspoon",base:O.VOLUME,prefixes:P.NONE,value:5e-6,offset:0},tablespoon:{name:"tablespoon",base:O.VOLUME,prefixes:P.NONE,value:15e-6,offset:0},drop:{name:"drop",base:O.VOLUME,prefixes:P.NONE,value:5e-8,offset:0},gtt:{name:"gtt",base:O.VOLUME,prefixes:P.NONE,value:5e-8,offset:0},minim:{name:"minim",base:O.VOLUME,prefixes:P.NONE,value:6.1611519921875e-8,offset:0},fluiddram:{name:"fluiddram",base:O.VOLUME,prefixes:P.NONE,value:36966911953125e-19,offset:0},fluidounce:{name:"fluidounce",base:O.VOLUME,prefixes:P.NONE,value:295735295625e-16,offset:0},gill:{name:"gill",base:O.VOLUME,prefixes:P.NONE,value:.00011829411825,offset:0},cc:{name:"cc",base:O.VOLUME,prefixes:P.NONE,value:1e-6,offset:0},cup:{name:"cup",base:O.VOLUME,prefixes:P.NONE,value:.0002365882365,offset:0},pint:{name:"pint",base:O.VOLUME,prefixes:P.NONE,value:.000473176473,offset:0},quart:{name:"quart",base:O.VOLUME,prefixes:P.NONE,value:.000946352946,offset:0},gallon:{name:"gallon",base:O.VOLUME,prefixes:P.NONE,value:.003785411784,offset:0},beerbarrel:{name:"beerbarrel",base:O.VOLUME,prefixes:P.NONE,value:.117347765304,offset:0},oilbarrel:{name:"oilbarrel",base:O.VOLUME,prefixes:P.NONE,value:.158987294928,offset:0},hogshead:{name:"hogshead",base:O.VOLUME,prefixes:P.NONE,value:.238480942392,offset:0},g:{name:"g",base:O.MASS,prefixes:P.SHORT,value:.001,offset:0},gram:{name:"gram",base:O.MASS,prefixes:P.LONG,value:.001,offset:0},ton:{name:"ton",base:O.MASS,prefixes:P.SHORT,value:907.18474,offset:0},t:{name:"t",base:O.MASS,prefixes:P.SHORT,value:1e3,offset:0},tonne:{name:"tonne",base:O.MASS,prefixes:P.LONG,value:1e3,offset:0},grain:{name:"grain",base:O.MASS,prefixes:P.NONE,value:6479891e-11,offset:0},dram:{name:"dram",base:O.MASS,prefixes:P.NONE,value:.0017718451953125,offset:0},ounce:{name:"ounce",base:O.MASS,prefixes:P.NONE,value:.028349523125,offset:0},poundmass:{name:"poundmass",base:O.MASS,prefixes:P.NONE,value:.45359237,offset:0},hundredweight:{name:"hundredweight",base:O.MASS,prefixes:P.NONE,value:45.359237,offset:0},stick:{name:"stick",base:O.MASS,prefixes:P.NONE,value:.115,offset:0},stone:{name:"stone",base:O.MASS,prefixes:P.NONE,value:6.35029318,offset:0},gr:{name:"gr",base:O.MASS,prefixes:P.NONE,value:6479891e-11,offset:0},dr:{name:"dr",base:O.MASS,prefixes:P.NONE,value:.0017718451953125,offset:0},oz:{name:"oz",base:O.MASS,prefixes:P.NONE,value:.028349523125,offset:0},lbm:{name:"lbm",base:O.MASS,prefixes:P.NONE,value:.45359237,offset:0},cwt:{name:"cwt",base:O.MASS,prefixes:P.NONE,value:45.359237,offset:0},s:{name:"s",base:O.TIME,prefixes:P.SHORT,value:1,offset:0},min:{name:"min",base:O.TIME,prefixes:P.NONE,value:60,offset:0},h:{name:"h",base:O.TIME,prefixes:P.NONE,value:3600,offset:0},second:{name:"second",base:O.TIME,prefixes:P.LONG,value:1,offset:0},sec:{name:"sec",base:O.TIME,prefixes:P.LONG,value:1,offset:0},minute:{name:"minute",base:O.TIME,prefixes:P.NONE,value:60,offset:0},hour:{name:"hour",base:O.TIME,prefixes:P.NONE,value:3600,offset:0},day:{name:"day",base:O.TIME,prefixes:P.NONE,value:86400,offset:0},week:{name:"week",base:O.TIME,prefixes:P.NONE,value:604800,offset:0},month:{name:"month",base:O.TIME,prefixes:P.NONE,value:2629800,offset:0},year:{name:"year",base:O.TIME,prefixes:P.NONE,value:31557600,offset:0},decade:{name:"decade",base:O.TIME,prefixes:P.NONE,value:315576e3,offset:0},century:{name:"century",base:O.TIME,prefixes:P.NONE,value:315576e4,offset:0},millennium:{name:"millennium",base:O.TIME,prefixes:P.NONE,value:315576e5,offset:0},hertz:{name:"Hertz",base:O.FREQUENCY,prefixes:P.LONG,value:1,offset:0,reciprocal:!0},Hz:{name:"Hz",base:O.FREQUENCY,prefixes:P.SHORT,value:1,offset:0,reciprocal:!0},rad:{name:"rad",base:O.ANGLE,prefixes:P.SHORT,value:1,offset:0},radian:{name:"radian",base:O.ANGLE,prefixes:P.LONG,value:1,offset:0},deg:{name:"deg",base:O.ANGLE,prefixes:P.SHORT,value:null,offset:0},degree:{name:"degree",base:O.ANGLE,prefixes:P.LONG,value:null,offset:0},grad:{name:"grad",base:O.ANGLE,prefixes:P.SHORT,value:null,offset:0},gradian:{name:"gradian",base:O.ANGLE,prefixes:P.LONG,value:null,offset:0},cycle:{name:"cycle",base:O.ANGLE,prefixes:P.NONE,value:null,offset:0},arcsec:{name:"arcsec",base:O.ANGLE,prefixes:P.NONE,value:null,offset:0},arcmin:{name:"arcmin",base:O.ANGLE,prefixes:P.NONE,value:null,offset:0},A:{name:"A",base:O.CURRENT,prefixes:P.SHORT,value:1,offset:0},ampere:{name:"ampere",base:O.CURRENT,prefixes:P.LONG,value:1,offset:0},K:{name:"K",base:O.TEMPERATURE,prefixes:P.SHORT,value:1,offset:0},degC:{name:"degC",base:O.TEMPERATURE,prefixes:P.SHORT,value:1,offset:273.15},degF:{name:"degF",base:O.TEMPERATURE,prefixes:P.SHORT,value:new b(5,9),offset:459.67},degR:{name:"degR",base:O.TEMPERATURE,prefixes:P.SHORT,value:new b(5,9),offset:0},kelvin:{name:"kelvin",base:O.TEMPERATURE,prefixes:P.LONG,value:1,offset:0},celsius:{name:"celsius",base:O.TEMPERATURE,prefixes:P.LONG,value:1,offset:273.15},fahrenheit:{name:"fahrenheit",base:O.TEMPERATURE,prefixes:P.LONG,value:new b(5,9),offset:459.67},rankine:{name:"rankine",base:O.TEMPERATURE,prefixes:P.LONG,value:new b(5,9),offset:0},mol:{name:"mol",base:O.AMOUNT_OF_SUBSTANCE,prefixes:P.SHORT,value:1,offset:0},mole:{name:"mole",base:O.AMOUNT_OF_SUBSTANCE,prefixes:P.LONG,value:1,offset:0},cd:{name:"cd",base:O.LUMINOUS_INTENSITY,prefixes:P.SHORT,value:1,offset:0},candela:{name:"candela",base:O.LUMINOUS_INTENSITY,prefixes:P.LONG,value:1,offset:0},N:{name:"N",base:O.FORCE,prefixes:P.SHORT,value:1,offset:0},newton:{name:"newton",base:O.FORCE,prefixes:P.LONG,value:1,offset:0},dyn:{name:"dyn",base:O.FORCE,prefixes:P.SHORT,value:1e-5,offset:0},dyne:{name:"dyne",base:O.FORCE,prefixes:P.LONG,value:1e-5,offset:0},lbf:{name:"lbf",base:O.FORCE,prefixes:P.NONE,value:4.4482216152605,offset:0},poundforce:{name:"poundforce",base:O.FORCE,prefixes:P.NONE,value:4.4482216152605,offset:0},kip:{name:"kip",base:O.FORCE,prefixes:P.LONG,value:4448.2216,offset:0},kilogramforce:{name:"kilogramforce",base:O.FORCE,prefixes:P.NONE,value:9.80665,offset:0},J:{name:"J",base:O.ENERGY,prefixes:P.SHORT,value:1,offset:0},joule:{name:"joule",base:O.ENERGY,prefixes:P.LONG,value:1,offset:0},erg:{name:"erg",base:O.ENERGY,prefixes:P.SHORTLONG,value:1e-7,offset:0},Wh:{name:"Wh",base:O.ENERGY,prefixes:P.SHORT,value:3600,offset:0},BTU:{name:"BTU",base:O.ENERGY,prefixes:P.BTU,value:1055.05585262,offset:0},eV:{name:"eV",base:O.ENERGY,prefixes:P.SHORT,value:1602176565e-28,offset:0},electronvolt:{name:"electronvolt",base:O.ENERGY,prefixes:P.LONG,value:1602176565e-28,offset:0},W:{name:"W",base:O.POWER,prefixes:P.SHORT,value:1,offset:0},watt:{name:"watt",base:O.POWER,prefixes:P.LONG,value:1,offset:0},hp:{name:"hp",base:O.POWER,prefixes:P.NONE,value:745.6998715386,offset:0},VAR:{name:"VAR",base:O.POWER,prefixes:P.SHORT,value:y.I,offset:0},VA:{name:"VA",base:O.POWER,prefixes:P.SHORT,value:1,offset:0},Pa:{name:"Pa",base:O.PRESSURE,prefixes:P.SHORT,value:1,offset:0},psi:{name:"psi",base:O.PRESSURE,prefixes:P.NONE,value:6894.75729276459,offset:0},atm:{name:"atm",base:O.PRESSURE,prefixes:P.NONE,value:101325,offset:0},bar:{name:"bar",base:O.PRESSURE,prefixes:P.SHORTLONG,value:1e5,offset:0},torr:{name:"torr",base:O.PRESSURE,prefixes:P.NONE,value:133.322,offset:0},mmHg:{name:"mmHg",base:O.PRESSURE,prefixes:P.NONE,value:133.322,offset:0},mmH2O:{name:"mmH2O",base:O.PRESSURE,prefixes:P.NONE,value:9.80665,offset:0},cmH2O:{name:"cmH2O",base:O.PRESSURE,prefixes:P.NONE,value:98.0665,offset:0},coulomb:{name:"coulomb",base:O.ELECTRIC_CHARGE,prefixes:P.LONG,value:1,offset:0},C:{name:"C",base:O.ELECTRIC_CHARGE,prefixes:P.SHORT,value:1,offset:0},farad:{name:"farad",base:O.ELECTRIC_CAPACITANCE,prefixes:P.LONG,value:1,offset:0},F:{name:"F",base:O.ELECTRIC_CAPACITANCE,prefixes:P.SHORT,value:1,offset:0},volt:{name:"volt",base:O.ELECTRIC_POTENTIAL,prefixes:P.LONG,value:1,offset:0},V:{name:"V",base:O.ELECTRIC_POTENTIAL,prefixes:P.SHORT,value:1,offset:0},ohm:{name:"ohm",base:O.ELECTRIC_RESISTANCE,prefixes:P.SHORTLONG,value:1,offset:0},henry:{name:"henry",base:O.ELECTRIC_INDUCTANCE,prefixes:P.LONG,value:1,offset:0},H:{name:"H",base:O.ELECTRIC_INDUCTANCE,prefixes:P.SHORT,value:1,offset:0},siemens:{name:"siemens",base:O.ELECTRIC_CONDUCTANCE,prefixes:P.LONG,value:1,offset:0},S:{name:"S",base:O.ELECTRIC_CONDUCTANCE,prefixes:P.SHORT,value:1,offset:0},weber:{name:"weber",base:O.MAGNETIC_FLUX,prefixes:P.LONG,value:1,offset:0},Wb:{name:"Wb",base:O.MAGNETIC_FLUX,prefixes:P.SHORT,value:1,offset:0},tesla:{name:"tesla",base:O.MAGNETIC_FLUX_DENSITY,prefixes:P.LONG,value:1,offset:0},T:{name:"T",base:O.MAGNETIC_FLUX_DENSITY,prefixes:P.SHORT,value:1,offset:0},b:{name:"b",base:O.BIT,prefixes:P.BINARY_SHORT,value:1,offset:0},bits:{name:"bits",base:O.BIT,prefixes:P.BINARY_LONG,value:1,offset:0},B:{name:"B",base:O.BIT,prefixes:P.BINARY_SHORT,value:8,offset:0},bytes:{name:"bytes",base:O.BIT,prefixes:P.BINARY_LONG,value:8,offset:0}},L={meters:"meter",inches:"inch",feet:"foot",yards:"yard",miles:"mile",links:"link",rods:"rod",chains:"chain",angstroms:"angstrom",lt:"l",litres:"litre",liter:"litre",liters:"litre",teaspoons:"teaspoon",tablespoons:"tablespoon",minims:"minim",fldr:"fluiddram",fluiddrams:"fluiddram",floz:"fluidounce",fluidounces:"fluidounce",gi:"gill",gills:"gill",cp:"cup",cups:"cup",pt:"pint",pints:"pint",qt:"quart",quarts:"quart",gal:"gallon",gallons:"gallon",bbl:"beerbarrel",beerbarrels:"beerbarrel",obl:"oilbarrel",oilbarrels:"oilbarrel",hogsheads:"hogshead",gtts:"gtt",grams:"gram",tons:"ton",tonnes:"tonne",grains:"grain",drams:"dram",ounces:"ounce",poundmasses:"poundmass",hundredweights:"hundredweight",sticks:"stick",lb:"lbm",lbs:"lbm",kips:"kip",kgf:"kilogramforce",acres:"acre",hectares:"hectare",sqfeet:"sqft",sqyard:"sqyd",sqmile:"sqmi",sqmiles:"sqmi",mmhg:"mmHg",mmh2o:"mmH2O",cmh2o:"cmH2O",seconds:"second",secs:"second",minutes:"minute",mins:"minute",hours:"hour",hr:"hour",hrs:"hour",days:"day",weeks:"week",months:"month",years:"year",decades:"decade",centuries:"century",millennia:"millennium",hertz:"hertz",radians:"radian",degrees:"degree",gradians:"gradian",cycles:"cycle",arcsecond:"arcsec",arcseconds:"arcsec",arcminute:"arcmin",arcminutes:"arcmin",BTUs:"BTU",watts:"watt",joules:"joule",amperes:"ampere",amps:"ampere",amp:"ampere",coulombs:"coulomb",volts:"volt",ohms:"ohm",farads:"farad",webers:"weber",teslas:"tesla",electronvolts:"electronvolt",moles:"mole",bit:"bits",byte:"bytes"};function U(e){if("BigNumber"===e.number){var t=hR(x);k.rad.value=new x(1),k.deg.value=t.div(180),k.grad.value=t.div(200),k.cycle.value=t.times(2),k.arcsec.value=t.div(648e3),k.arcmin.value=t.div(10800)}else k.rad.value=1,k.deg.value=Math.PI/180,k.grad.value=Math.PI/200,k.cycle.value=2*Math.PI,k.arcsec.value=Math.PI/648e3,k.arcmin.value=Math.PI/10800;k.radian.value=k.rad.value,k.degree.value=k.deg.value,k.gradian.value=k.grad.value}U(a),i&&i("config",(function(e,t){e.number!==t.number&&U(e)}));var z={si:{NONE:{unit:B,prefix:P.NONE[""]},LENGTH:{unit:k.m,prefix:P.SHORT[""]},MASS:{unit:k.g,prefix:P.SHORT.k},TIME:{unit:k.s,prefix:P.SHORT[""]},CURRENT:{unit:k.A,prefix:P.SHORT[""]},TEMPERATURE:{unit:k.K,prefix:P.SHORT[""]},LUMINOUS_INTENSITY:{unit:k.cd,prefix:P.SHORT[""]},AMOUNT_OF_SUBSTANCE:{unit:k.mol,prefix:P.SHORT[""]},ANGLE:{unit:k.rad,prefix:P.SHORT[""]},BIT:{unit:k.bits,prefix:P.SHORT[""]},FORCE:{unit:k.N,prefix:P.SHORT[""]},ENERGY:{unit:k.J,prefix:P.SHORT[""]},POWER:{unit:k.W,prefix:P.SHORT[""]},PRESSURE:{unit:k.Pa,prefix:P.SHORT[""]},ELECTRIC_CHARGE:{unit:k.C,prefix:P.SHORT[""]},ELECTRIC_CAPACITANCE:{unit:k.F,prefix:P.SHORT[""]},ELECTRIC_POTENTIAL:{unit:k.V,prefix:P.SHORT[""]},ELECTRIC_RESISTANCE:{unit:k.ohm,prefix:P.SHORT[""]},ELECTRIC_INDUCTANCE:{unit:k.H,prefix:P.SHORT[""]},ELECTRIC_CONDUCTANCE:{unit:k.S,prefix:P.SHORT[""]},MAGNETIC_FLUX:{unit:k.Wb,prefix:P.SHORT[""]},MAGNETIC_FLUX_DENSITY:{unit:k.T,prefix:P.SHORT[""]},FREQUENCY:{unit:k.Hz,prefix:P.SHORT[""]}}};z.cgs=JSON.parse(JSON.stringify(z.si)),z.cgs.LENGTH={unit:k.m,prefix:P.SHORT.c},z.cgs.MASS={unit:k.g,prefix:P.SHORT[""]},z.cgs.FORCE={unit:k.dyn,prefix:P.SHORT[""]},z.cgs.ENERGY={unit:k.erg,prefix:P.NONE[""]},z.us=JSON.parse(JSON.stringify(z.si)),z.us.LENGTH={unit:k.ft,prefix:P.NONE[""]},z.us.MASS={unit:k.lbm,prefix:P.NONE[""]},z.us.TEMPERATURE={unit:k.degF,prefix:P.NONE[""]},z.us.FORCE={unit:k.lbf,prefix:P.NONE[""]},z.us.ENERGY={unit:k.BTU,prefix:P.BTU[""]},z.us.POWER={unit:k.hp,prefix:P.NONE[""]},z.us.PRESSURE={unit:k.psi,prefix:P.NONE[""]},z.auto=JSON.parse(JSON.stringify(z.si));var H=z.auto;for(var V in w.setUnitSystem=function(e){if(!OA(z,e))throw new Error("Unit system "+e+" does not exist. Choices are: "+Object.keys(z).join(", "));H=z[e]},w.getUnitSystem=function(){for(var e in z)if(OA(z,e)&&z[e]===H)return e},w.typeConverters={BigNumber:function(e){return null!==e&&void 0!==e&&e.isFraction?new x(String(e.n)).div(String(e.d)).times(String(e.s)):new x(e+"")},Fraction:function(e){return new b(e)},Complex:function(e){return e},number:function(e){return null!==e&&void 0!==e&&e.isFraction?v(e):e}},w.prototype._numberConverter=function(){var e=w.typeConverters[this.valueType()];if(e)return e;throw new TypeError('Unsupported Unit value type "'+this.valueType()+'"')},w._getNumberConverter=function(e){if(!w.typeConverters[e])throw new TypeError('Unsupported type "'+e+'"');return w.typeConverters[e]},k)if(OA(k,V)){var G=k[V];G.dimensions=G.base.dimensions}for(var q in L)if(OA(L,q)){var j=k[L[q]],W={};for(var X in j)OA(j,X)&&(W[X]=j[X]);W.name=q,k[q]=W}return w.isValidAlpha=function(e){return/^[a-zA-Z]$/.test(e)},w.createUnit=function(e,t){if("object"!==typeof e)throw new TypeError("createUnit expects first parameter to be of type 'Object'");if(t&&t.override)for(var n in e)if(OA(e,n)&&w.deleteUnit(n),e[n].aliases)for(var r=0;r<e[n].aliases.length;r++)w.deleteUnit(e[n].aliases[r]);var i;for(var a in e)OA(e,a)&&(i=w.createUnitSingle(a,e[a]));return i},w.createUnitSingle=function(e,t){if("undefined"!==typeof t&&null!==t||(t={}),"string"!==typeof e)throw new TypeError("createUnitSingle expects first parameter to be of type 'string'");if(OA(k,e))throw new Error('Cannot create unit "'+e+'": a unit with that name already exists');!function(e){for(var t=0;t<e.length;t++){if(r=e.charAt(t),0===t&&!w.isValidAlpha(r))throw new Error('Invalid unit name (must begin with alpha character): "'+e+'"');if(t>0&&!w.isValidAlpha(r)&&!M(r))throw new Error('Invalid unit name (only alphanumeric characters are allowed): "'+e+'"')}}(e);var n,i,a,o=null,s=[],l=0;if(t&&"Unit"===t.type)o=t.clone();else if("string"===typeof t)""!==t&&(n=t);else{if("object"!==typeof t)throw new TypeError('Cannot create unit "'+e+'" from "'+t.toString()+'": expecting "string" or "Unit" or "Object"');n=t.definition,i=t.prefixes,l=t.offset,a=t.baseName,t.aliases&&(s=t.aliases.valueOf())}if(s)for(var c=0;c<s.length;c++)if(OA(k,s[c]))throw new Error('Cannot create alias "'+s[c]+'": a unit with that name already exists');if(n&&"string"===typeof n&&!o)try{o=w.parse(n,{allowNoUnits:!0})}catch(D){throw D.message='Could not create unit "'+e+'" from "'+n+'": '+D.message,D}else n&&"Unit"===n.type&&(o=n.clone());s=s||[],l=l||0,i=i&&i.toUpperCase&&P[i.toUpperCase()]||P.NONE;var u={};if(o){u={name:e,value:o.value,dimensions:o.dimensions.slice(0),prefixes:i,offset:l};var h=!1;for(var d in O)if(OA(O,d)){for(var f=!0,p=0;p<F.length;p++)if(Math.abs((u.dimensions[p]||0)-(O[d].dimensions[p]||0))>1e-12){f=!1;break}if(f){h=!0,u.base=O[d];break}}if(!h){a=a||e+"_STUFF";var m={dimensions:o.dimensions.slice(0)};m.key=a,O[a]=m,H[a]={unit:u,prefix:P.NONE[""]},u.base=O[a]}}else{if(a=a||e+"_STUFF",F.indexOf(a)>=0)throw new Error('Cannot create new base unit "'+e+'": a base unit with that name already exists (and cannot be overridden)');for(var g in F.push(a),O)OA(O,g)&&(O[g].dimensions[F.length-1]=0);for(var v={dimensions:[]},y=0;y<F.length;y++)v.dimensions[y]=0;v.dimensions[F.length-1]=1,v.key=a,O[a]=v,u={name:e,value:1,dimensions:O[a].dimensions.slice(0),prefixes:i,offset:l,base:O[a]},H[a]={unit:u,prefix:P.NONE[""]}}w.UNITS[e]=u;for(var x=0;x<s.length;x++){var b=s[x],_={};for(var S in u)OA(u,S)&&(_[S]=u[S]);_.name=b,w.UNITS[b]=_}return delete N.cache,new w(null,e)},w.deleteUnit=function(e){delete w.UNITS[e],delete N.cache},w.PREFIXES=P,w.BASE_DIMENSIONS=F,w.BASE_UNITS=O,w.UNIT_SYSTEMS=z,w.UNITS=k,w}),{isClass:!0}),aG="cumsum",oG=SN(aG,["typed","add","unaryPlus"],(e=>{var{typed:t,add:n,unaryPlus:r}=e;return t(aG,{Array:i,Matrix:function(e){return e.create(i(e.valueOf(),e.datatype()))},"Array, number | BigNumber":o,"Matrix, number | BigNumber":function(e,t){return e.create(o(e.valueOf(),t),e.datatype())},"...":function(e){if(aO(e))throw new TypeError("All values expected to be scalar in function cumsum");return i(e)}});function i(e){try{return a(e)}catch(t){throw EU(t,aG)}}function a(e){if(0===e.length)return[];for(var t=[r(e[0])],i=1;i<e.length;++i)t.push(n(t[i-1],e[i]));return t}function o(e,t){var n=mF(e);if(t<0||t>=n.length)throw new pF(t,n.length);try{return s(e,t)}catch(r){throw EU(r,aG)}}function s(e,t){var n,r,i;if(t<=0){var o=e[0][0];if(Array.isArray(o)){for(i=iO(e),r=[],n=0;n<i.length;n++)r[n]=s(i[n],t-1);return r}return a(e)}for(r=[],n=0;n<e.length;n++)r[n]=s(e[n],t-1);return r}})),sG="dotPow",lG=SN(sG,["typed","equalScalar","matrix","pow","DenseMatrix","concat","SparseMatrix"],(e=>{var{typed:t,equalScalar:n,matrix:r,pow:i,DenseMatrix:a,concat:o,SparseMatrix:s}=e,l=ZL({typed:t}),c=KL({typed:t,SparseMatrix:s}),u=VL({typed:t,equalScalar:n}),h=QL({typed:t,DenseMatrix:a}),d=WL({typed:t,matrix:r,concat:o}),f={};for(var p in i.signatures)Object.prototype.hasOwnProperty.call(i.signatures,p)&&(p.includes("Matrix")||p.includes("Array")||(f[p]=i.signatures[p]));var m=t(f);return t(sG,d({elop:m,SS:c,DS:l,Ss:u,sS:h}))})),cG="expm",uG=SN(cG,["typed","abs","add","identity","inv","multiply"],(e=>{var{typed:t,abs:n,add:r,identity:i,inv:a,multiply:o}=e;return t(cG,{Matrix:function(e){var t=e.size();if(2!==t.length||t[0]!==t[1])throw new RangeError("Matrix must be square (size: "+sF(t)+")");for(var l=t[0],c=function(e){for(var t=e.size()[0],r=0,i=0;i<t;i++){for(var a=0,o=0;o<t;o++)a+=n(e.get([i,o]));r=Math.max(a,r)}return r}(e),u=function(e,t){for(var n=30,r=0;r<n;r++)for(var i=0;i<=r;i++){var a=r-i;if(s(e,i,a)<t)return{q:i,j:a}}throw new Error("Could not find acceptable parameters to compute the matrix exponential (try increasing maxSearchSize in expm.js)")}(c,1e-15),h=u.q,d=u.j,f=o(e,Math.pow(2,-d)),p=i(l),m=i(l),g=1,v=f,y=-1,x=1;x<=h;x++)x>1&&(v=o(v,f),y=-y),p=r(p,o(g=g*(h-x+1)/((2*h-x+1)*x),v)),m=r(m,o(g*y,v));for(var b=o(a(m),p),_=0;_<d;_++)b=o(b,b);return XC(e)?e.createSparseMatrix(b):b}});function s(e,t,n){for(var r=1,i=2;i<=t;i++)r*=i;for(var a=r,o=t+1;o<=2*t;o++)a*=o;var s=a*(2*t+1);return 8*Math.pow(e/Math.pow(2,n),2*t)*r*r/(a*s)}})),hG=SN("fft",["typed","matrix","addScalar","multiplyScalar","divideScalar","exp","tau","i","dotDivide","conj","pow","ceil","log2"],(e=>{var{typed:t,matrix:n,addScalar:r,multiplyScalar:i,divideScalar:a,exp:o,tau:s,i:l,dotDivide:c,conj:u,pow:h,ceil:d,log2:f}=e;return t("fft",{Array:p,Matrix:function(e){return e.create(p(e.valueOf()),e.datatype())}});function p(e){var t=mF(e);return 1===t.length?g(e,t[0]):m(e.map((e=>p(e,t.slice(1)))),0)}function m(e,t){var n=mF(e);if(0!==t)return new Array(n[0]).fill(0).map(((n,r)=>m(e[r],t-1)));if(1===n.length)return g(e);function r(e){var t=mF(e);return new Array(t[1]).fill(0).map(((n,r)=>new Array(t[0]).fill(0).map(((t,n)=>e[n][r]))))}return r(m(r(e),1))}function g(e){var t=e.length;if(1===t)return[e[0]];if(t%2===0){for(var n=[...g(e.filter(((e,t)=>t%2===0))),...g(e.filter(((e,t)=>t%2===1)))],m=0;m<t/2;m++){var v=n[m],y=i(n[m+t/2],o(i(i(s,l),a(-m,t))));n[m]=r(v,y),n[m+t/2]=r(v,i(-1,y))}return n}return function(e){for(var t=e.length,n=o(a(i(-1,i(l,s)),t)),r=[],m=1-t;m<t;m++)r.push(h(n,a(h(m,2),2)));for(var v=h(2,d(f(t+t-1))),y=[...new Array(t).fill(0).map(((n,a)=>i(e[a],r[t-1+a]))),...new Array(v-t).fill(0)],x=[...new Array(t+t-1).fill(0).map(((e,t)=>a(1,r[t]))),...new Array(v-(t+t-1)).fill(0)],b=g(y),_=g(x),w=new Array(v).fill(0).map(((e,t)=>i(b[t],_[t]))),S=c(u(p(u(w))),v),M=[],D=t-1;D<t+t-1;D++)M.push(i(S[D],r[D]));return M}(e)}})),dG="gamma",fG=SN(dG,["typed","config","multiplyScalar","pow","BigNumber","Complex"],(e=>{var{typed:t,config:n,multiplyScalar:r,pow:i,BigNumber:a,Complex:o}=e;return t(dG,{number:FB,Complex:function e(t){if(0===t.im)return FB(t.re);if(t.re<.5){var n=new o(1-t.re,-t.im),r=new o(Math.PI*t.re,Math.PI*t.im);return new o(Math.PI).div(r.sin()).div(e(n))}t=new o(t.re-1,t.im);for(var i=new o(IB[0],0),a=1;a<IB.length;++a){var s=new o(IB[a],0);i=i.add(s.div(t.add(a)))}var l=new o(t.re+OB+.5,t.im),c=Math.sqrt(2*Math.PI),u=l.pow(t.add(.5)),h=l.neg().exp();return i.mul(c).mul(u).mul(h)},BigNumber:function(e){if(e.isInteger())return e.isNegative()||e.isZero()?new a(1/0):s(e.minus(1));if(!e.isFinite())return new a(e.isNegative()?NaN:1/0);throw new Error("Integer BigNumber expected")}});function s(e){if(e<8)return new a([1,1,2,6,24,120,720,5040][e]);var t=n.precision+(0|Math.log(e.toNumber())),r=a.clone({precision:t});if(e%2===1)return e.times(s(new a(e-1)));for(var i=e,o=new r(e),l=e.toNumber();i>2;)l+=i-=2,o=o.times(l);return new a(o.toPrecision(a.precision))}})),pG="ifft",mG=SN(pG,["typed","fft","dotDivide","conj"],(e=>{var{typed:t,fft:n,dotDivide:r,conj:i}=e;return t(pG,{"Array | Matrix":function(e){var t=qC(e)?e.size():mF(e);return r(i(n(i(e))),t.reduce(((e,t)=>e*t),1))}})})),gG="setSize",vG=SN(gG,["typed","compareNatural"],(e=>{var{typed:t,compareNatural:n}=e;return t(gG,{"Array | Matrix":function(e){return Array.isArray(e)?NF(e).length:NF(e.toArray()).length},"Array | Matrix, boolean":function(e,t){if(!1===t||0===e.length)return Array.isArray(e)?NF(e).length:NF(e.toArray()).length;for(var r=NF(Array.isArray(e)?e:e.toArray()).sort(n),i=1,a=1;a<r.length;a++)0!==n(r[a],r[a-1])&&i++;return i}})})),yG="createUnit",xG=SN(yG,["typed","Unit"],(e=>{var{typed:t,Unit:n}=e;return t(yG,{"Object, Object":function(e,t){return n.createUnit(e,t)},Object:function(e){return n.createUnit(e,{})},"string, Unit | string | Object, Object":function(e,t,r){var i={};return i[e]=t,n.createUnit(i,r)},"string, Unit | string | Object":function(e,t){var r={};return r[e]=t,n.createUnit(r,{})},string:function(e){var t={};return t[e]={},n.createUnit(t,{})}})})),bG=SN("divide",["typed","matrix","multiply","equalScalar","divideScalar","inv"],(e=>{var{typed:t,matrix:n,multiply:r,equalScalar:i,divideScalar:a,inv:o}=e,s=VL({typed:t,equalScalar:i}),l=qL({typed:t});return t("divide",AA({"Array | Matrix, Array | Matrix":function(e,t){return r(e,o(t))},"DenseMatrix, any":function(e,t){return l(e,t,a,!1)},"SparseMatrix, any":function(e,t){return s(e,t,a,!1)},"Array, any":function(e,t){return l(n(e),t,a,!1).valueOf()},"any, Array | Matrix":function(e,t){return r(e,o(t))}},a.signatures))})),_G="factorial",wG=SN(_G,["typed","gamma"],(e=>{var{typed:t,gamma:n}=e;return t(_G,{number:function(e){if(e<0)throw new Error("Value must be non-negative");return n(e+1)},BigNumber:function(e){if(e.isNegative())throw new Error("Value must be non-negative");return n(e.plus(1))},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),SG=SN("intersect",["typed","config","abs","add","addScalar","matrix","multiply","multiplyScalar","divideScalar","subtract","smaller","equalScalar","flatten","isZero","isNumeric"],(e=>{var{typed:t,config:n,abs:r,add:i,addScalar:a,matrix:o,multiply:s,multiplyScalar:l,divideScalar:c,subtract:u,smaller:h,equalScalar:d,flatten:f,isZero:p,isNumeric:m}=e;return t("intersect",{"Array, Array, Array":g,"Array, Array, Array, Array":v,"Matrix, Matrix, Matrix":function(e,t,n){var r=g(e.valueOf(),t.valueOf(),n.valueOf());return null===r?null:o(r)},"Matrix, Matrix, Matrix, Matrix":function(e,t,n,r){var i=v(e.valueOf(),t.valueOf(),n.valueOf(),r.valueOf());return null===i?null:o(i)}});function g(e,t,n){if(e=y(e),t=y(t),n=y(n),!b(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!b(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!function(e){return 4===e.length&&m(e[0])&&m(e[1])&&m(e[2])&&m(e[3])}(n))throw new TypeError("Array with 4 numbers expected as third argument");return function(e,t,n,r,i,o,s,h,d,f){var p=l(e,s),m=l(r,s),g=l(t,h),v=l(i,h),y=l(n,d),x=l(o,d),b=u(u(u(f,p),g),y),_=u(u(u(a(a(m,v),x),p),g),y),w=c(b,_),S=a(e,l(w,u(r,e))),M=a(t,l(w,u(i,t))),D=a(n,l(w,u(o,n)));return[S,M,D]}(e[0],e[1],e[2],t[0],t[1],t[2],n[0],n[1],n[2],n[3])}function v(e,t,o,f){if(e=y(e),t=y(t),o=y(o),f=y(f),2===e.length){if(!x(e))throw new TypeError("Array with 2 numbers or BigNumbers expected for first argument");if(!x(t))throw new TypeError("Array with 2 numbers or BigNumbers expected for second argument");if(!x(o))throw new TypeError("Array with 2 numbers or BigNumbers expected for third argument");if(!x(f))throw new TypeError("Array with 2 numbers or BigNumbers expected for fourth argument");return function(e,t,o,d){var f=e,m=o,g=u(f,t),v=u(m,d),y=u(l(g[0],v[1]),l(v[0],g[1]));if(p(y))return null;if(h(r(y),n.relTol))return null;var x=l(v[0],f[1]),b=l(v[1],f[0]),_=l(v[0],m[1]),w=l(v[1],m[0]),S=c(a(u(u(x,b),_),w),y);return i(s(g,S),f)}(e,t,o,f)}if(3===e.length){if(!b(e))throw new TypeError("Array with 3 numbers or BigNumbers expected for first argument");if(!b(t))throw new TypeError("Array with 3 numbers or BigNumbers expected for second argument");if(!b(o))throw new TypeError("Array with 3 numbers or BigNumbers expected for third argument");if(!b(f))throw new TypeError("Array with 3 numbers or BigNumbers expected for fourth argument");return function(e,t,n,r,i,o,s,h,f,m,g,v){var y=_(e,s,m,s,t,h,g,h,n,f,v,f),x=_(m,s,r,e,g,h,i,t,v,f,o,n),b=_(e,s,r,e,t,h,i,t,n,f,o,n),w=_(m,s,m,s,g,h,g,h,v,f,v,f),S=_(r,e,r,e,i,t,i,t,o,n,o,n),M=u(l(y,x),l(b,w)),D=u(l(S,w),l(x,x));if(p(D))return null;var E=c(M,D),C=c(a(y,l(E,x)),w),A=a(e,l(E,u(r,e))),T=a(t,l(E,u(i,t))),N=a(n,l(E,u(o,n))),R=a(s,l(C,u(m,s))),P=a(h,l(C,u(g,h))),F=a(f,l(C,u(v,f)));return d(A,R)&&d(T,P)&&d(N,F)?[A,T,N]:null}(e[0],e[1],e[2],t[0],t[1],t[2],o[0],o[1],o[2],f[0],f[1],f[2])}throw new TypeError("Arrays with two or thee dimensional points expected")}function y(e){return 1===e.length?e[0]:e.length>1&&Array.isArray(e[0])&&e.every((e=>Array.isArray(e)&&1===e.length))?f(e):e}function x(e){return 2===e.length&&m(e[0])&&m(e[1])}function b(e){return 3===e.length&&m(e[0])&&m(e[1])&&m(e[2])}function _(e,t,n,r,i,o,s,c,h,d,f,p){var m=l(u(e,t),u(n,r)),g=l(u(i,o),u(s,c)),v=l(u(h,d),u(f,p));return a(a(m,g),v)}})),MG=SN("lup",["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtractScalar","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],(e=>{var{typed:t,matrix:n,abs:r,addScalar:i,divideScalar:a,multiplyScalar:o,subtractScalar:s,larger:l,equalScalar:c,unaryMinus:u,DenseMatrix:h,SparseMatrix:d,Spa:f}=e;return t("lup",{DenseMatrix:function(e){return p(e)},SparseMatrix:function(e){return m(e)},Array:function(e){var t=p(n(e));return{L:t.L.valueOf(),U:t.U.valueOf(),p:t.p}}});function p(e){var t,n,u,d=e._size[0],f=e._size[1],p=Math.min(d,f),m=CA(e._data),g=[],v=[d,p],y=[],x=[p,f],b=[];for(t=0;t<d;t++)b[t]=t;for(n=0;n<f;n++){if(n>0)for(t=0;t<d;t++){var _=Math.min(t,n),w=0;for(u=0;u<_;u++)w=i(w,o(m[t][u],m[u][n]));m[t][n]=s(m[t][n],w)}var S=n,M=0,D=0;for(t=n;t<d;t++){var E=m[t][n],C=r(E);l(C,M)&&(S=t,M=C,D=E)}if(n!==S&&(b[n]=[b[S],b[S]=b[n]][0],h._swapRows(n,S,m)),n<d)for(t=n+1;t<d;t++){var A=m[t][n];c(A,0)||(m[t][n]=a(m[t][n],D))}}for(n=0;n<f;n++)for(t=0;t<d;t++)0===n&&(t<f&&(y[t]=[]),g[t]=[]),t<n?(t<f&&(y[t][n]=m[t][n]),n<d&&(g[t][n]=0)):t!==n?(t<f&&(y[t][n]=0),n<d&&(g[t][n]=m[t][n])):(t<f&&(y[t][n]=m[t][n]),n<d&&(g[t][n]=1));var T=new h({data:g,size:v}),N=new h({data:y,size:x}),R=[];for(t=0,p=b.length;t<p;t++)R[b[t]]=t;return{L:T,U:N,p:R,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}function m(e){var t,n,i,s=e._size[0],h=e._size[1],p=Math.min(s,h),m=e._values,g=e._index,v=e._ptr,y=[],x=[],b=[],_=[s,p],w=[],S=[],M=[],D=[p,h],E=[],C=[];for(t=0;t<s;t++)E[t]=t,C[t]=t;var A=function(){var e=new f;n<s&&(b.push(y.length),y.push(1),x.push(n)),M.push(w.length);var h=v[n],p=v[n+1];for(i=h;i<p;i++)t=g[i],e.set(E[t],m[i]);n>0&&e.forEach(0,n-1,(function(t,n){d._forEachRow(t,y,x,b,(function(r,i){r>t&&e.accumulate(r,u(o(i,n)))}))}));var A=n,T=e.get(n),N=r(T);e.forEach(n+1,s-1,(function(e,t){var n=r(t);l(n,N)&&(A=e,N=n,T=t)})),n!==A&&(d._swapRows(n,A,_[1],y,x,b),d._swapRows(n,A,D[1],w,S,M),e.swap(n,A),function(e,t){var n=C[e],r=C[t];E[n]=t,E[r]=e,C[e]=r,C[t]=n}(n,A)),e.forEach(0,s-1,(function(e,t){e<=n?(w.push(t),S.push(e)):(t=a(t,T),c(t,0)||(y.push(t),x.push(e)))}))};for(n=0;n<h;n++)A();return M.push(w.length),b.push(y.length),{L:new d({values:y,index:x,ptr:b,size:_}),U:new d({values:w,index:S,ptr:M,size:D}),p:E,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}})),DG="multinomial",EG=SN(DG,["typed","add","divide","multiply","factorial","isInteger","isPositive"],(e=>{var{typed:t,add:n,divide:r,multiply:i,factorial:a,isInteger:o,isPositive:s}=e;return t(DG,{"Array | Matrix":function(e){var t=0,l=1;return oO(e,(function(e){if(!o(e)||!s(e))throw new TypeError("Positive integer value expected in function multinomial");t=n(t,e),l=i(l,a(e))})),r(a(t),l)}})})),CG="permutations",AG=SN(CG,["typed","factorial"],(e=>{var{typed:t,factorial:n}=e;return t(CG,{"number | BigNumber":n,"number, number":function(e,t){if(!IN(e)||e<0)throw new TypeError("Positive integer value expected in function permutations");if(!IN(t)||t<0)throw new TypeError("Positive integer value expected in function permutations");if(t>e)throw new TypeError("second argument k must be less than or equal to first argument n");return II(e-t+1,e)},"BigNumber, BigNumber":function(e,t){var n,r;if(!TG(e)||!TG(t))throw new TypeError("Positive integer value expected in function permutations");if(t.gt(e))throw new TypeError("second argument k must be less than or equal to first argument n");for(n=e.mul(0).add(1),r=e.minus(t).plus(1);r.lte(e);r=r.plus(1))n=n.times(r);return n}})}));function TG(e){return e.isInteger()&&e.gte(0)}var NG="polynomialRoot",RG=SN(NG,["typed","isZero","equalScalar","add","subtract","multiply","divide","sqrt","unaryMinus","cbrt","typeOf","im","re"],(e=>{var{typed:t,isZero:n,equalScalar:r,add:i,subtract:a,multiply:o,divide:s,sqrt:l,unaryMinus:c,cbrt:u,typeOf:h,im:d,re:f}=e;return t(NG,{"number|Complex, ...number|Complex":(e,t)=>{for(var p=[e,...t];p.length>0&&n(p[p.length-1]);)p.pop();if(p.length<2)throw new RangeError("Polynomial [".concat(e,", ").concat(t,"] must have a non-zero non-constant coefficient"));switch(p.length){case 2:return[c(s(p[0],p[1]))];case 3:var[m,g,v]=p,y=o(2,v),x=o(g,g),b=o(4,v,m);if(r(x,b))return[s(c(g),y)];var _=l(a(x,b));return[s(a(_,g),y),s(a(c(_),g),y)];case 4:var[w,S,M,D]=p,E=c(o(3,D)),C=o(M,M),A=o(3,D,S),T=i(o(2,M,M,M),o(27,D,D,w)),N=o(9,D,M,S);if(r(C,A)&&r(T,N))return[s(M,E)];var R,P=a(C,A),F=a(T,N),O=i(o(18,D,M,S,w),o(M,M,S,S)),I=i(o(4,M,M,M,w),o(4,D,S,S,S),o(27,D,D,w,w));if(r(O,I))return[s(a(o(4,D,M,S),i(o(9,D,D,w),o(M,M,M))),o(D,P)),s(a(o(9,D,w),o(M,S)),o(2,P))];R=r(C,A)?F:s(i(F,l(a(o(F,F),o(4,P,P,P)))),2);var B=u(R,!0).toArray().map((e=>s(i(M,e,s(P,e)),E)));return B.map((e=>"Complex"===h(e)&&r(f(e),f(e)+d(e))?f(e):e));default:throw new RangeError("only implemented for cubic or lower-order polynomials, not ".concat(p))}}})})),PG="setIntersect",FG=SN(PG,["typed","size","subset","compareNatural","Index","DenseMatrix"],(e=>{var{typed:t,size:n,subset:r,compareNatural:i,Index:a,DenseMatrix:o}=e;return t(PG,{"Array | Matrix, Array | Matrix":function(e,t){var s;if(0===r(n(e),new a(0))||0===r(n(t),new a(0)))s=[];else{var l=BF(NF(Array.isArray(e)?e:e.toArray()).sort(i)),c=BF(NF(Array.isArray(t)?t:t.toArray()).sort(i));s=[];for(var u=0;u<l.length;u++)for(var h=0;h<c.length;h++)if(0===i(l[u].value,c[h].value)&&l[u].identifier===c[h].identifier){s.push(l[u]);break}}return Array.isArray(e)&&Array.isArray(t)?kF(s):new o(kF(s))}})}));function OG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var IG=SN("solveODE",["typed","add","subtract","multiply","divide","max","map","abs","isPositive","isNegative","larger","smaller","matrix","bignumber","unaryMinus"],(e=>{var{typed:t,add:n,subtract:r,multiply:i,divide:a,max:o,map:s,abs:l,isPositive:c,isNegative:u,larger:h,smaller:d,matrix:f,bignumber:p,unaryMinus:m}=e;function g(e){return function(t,f,g,v){if(!(2===f.length&&(f.every(b)||f.every(HC))))throw new Error('"tspan" must be an Array of two numeric values or two units [tStart, tEnd]');var y=f[0],x=f[1],_=h(x,y),w=v.firstStep;if(void 0!==w&&!c(w))throw new Error('"firstStep" must be positive');var S=v.maxStep;if(void 0!==S&&!c(S))throw new Error('"maxStep" must be positive');var M=v.minStep;if(M&&u(M))throw new Error('"minStep" must be positive or zero');var D=[y,x,w,M,S].filter((e=>void 0!==e));if(!D.every(b)&&!D.every(HC))throw new Error('Inconsistent type of "t" dependant variables');for(var E=v.tol?v.tol:1e-4,C=v.minDelta?v.minDelta:.2,A=v.maxDelta?v.maxDelta:5,T=v.maxIter?v.maxIter:1e4,N=[y,x,...g,S,M].some(kC),[R,P,F,O]=N?[p(e.a),p(e.c),p(e.b),p(e.bp)]:[e.a,e.c,e.b,e.bp],I=w?_?w:m(w):a(r(x,y),1),B=[y],k=[g],L=r(F,O),U=0,z=0,H=function(e){return e?d:h}(_),V=function(e){var t=e?h:d;return function(e,i,a){var o=n(e,a);return t(o,i)?r(i,e):a}}(_);H(B[U],x);){var G=[];I=V(B[U],x,I),G.push(t(B[U],k[U]));for(var q=1;q<P.length;++q)G.push(t(n(B[U],i(P[q],I)),n(k[U],i(I,R[q],G))));var j=o(l(s(i(L,G),(e=>HC(e)?e.value:e))));j<E&&E/j>1/4&&(B.push(n(B[U],I)),k.push(n(k[U],i(I,F,G))),U++);var W=.84*(E/j)**.2;if(d(W,C)?W=C:h(W,A)&&(W=A),W=N?p(W):W,I=i(I,W),S&&h(l(I),S)?I=_?S:m(S):M&&d(l(I),M)&&(I=_?M:m(M)),++z>T)throw new Error("Maximum number of iterations reached, try changing options")}return{t:B,y:k}}}function v(e,t,n,r){return g({a:[[],[.5],[0,3/4],[2/9,1/3,4/9]],c:[null,.5,3/4,1],b:[2/9,1/3,4/9,0],bp:[7/24,1/4,1/3,1/8]})(e,t,n,r)}function y(e,t,n,r){return g({a:[[],[.2],[3/40,9/40],[44/45,-56/15,32/9],[19372/6561,-25360/2187,64448/6561,-212/729],[9017/3168,-355/33,46732/5247,49/176,-5103/18656],[35/384,0,500/1113,125/192,-2187/6784,11/84]],c:[null,.2,.3,.8,8/9,1,1],b:[35/384,0,500/1113,125/192,-2187/6784,11/84,0],bp:[5179/57600,0,7571/16695,393/640,-92097/339200,187/2100,1/40]})(e,t,n,r)}function x(e,t,n,r){var i=r.method?r.method:"RK45",a={RK23:v,RK45:y};if(i.toUpperCase()in a){var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?OG(Object(n),!0).forEach((function(t){(0,tG.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OG(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r);return delete o.method,a[i.toUpperCase()](e,t,n,o)}var s=Object.keys(a).map((e=>'"'.concat(e,'"'))),l="".concat(s.slice(0,-1).join(", ")," and ").concat(s.slice(-1));throw new Error('Unavailable method "'.concat(i,'". Available methods are ').concat(l))}function b(e){return kC(e)||BC(e)}function _(e,t,n,r){var i=x(e,t.toArray(),n.toArray(),r);return{t:f(i.t),y:f(i.y)}}return t("solveODE",{"function, Array, Array, Object":x,"function, Matrix, Matrix, Object":_,"function, Array, Array":(e,t,n)=>x(e,t,n,{}),"function, Matrix, Matrix":(e,t,n)=>_(e,t,n,{}),"function, Array, number | BigNumber | Unit":(e,t,n)=>{var r=x(e,t,[n],{});return{t:r.t,y:r.y.map((e=>e[0]))}},"function, Matrix, number | BigNumber | Unit":(e,t,n)=>{var r=x(e,t.toArray(),[n],{});return{t:f(r.t),y:f(r.y.map((e=>e[0])))}},"function, Array, number | BigNumber | Unit, Object":(e,t,n,r)=>{var i=x(e,t,[n],r);return{t:i.t,y:i.y.map((e=>e[0]))}},"function, Matrix, number | BigNumber | Unit, Object":(e,t,n,r)=>{var i=x(e,t.toArray(),[n],r);return{t:f(i.t),y:f(i.y.map((e=>e[0])))}}})})),BG="stirlingS2",kG=SN(BG,["typed","addScalar","subtractScalar","multiplyScalar","divideScalar","pow","factorial","combinations","isNegative","isInteger","number","?bignumber","larger"],(e=>{var{typed:t,addScalar:n,subtractScalar:r,multiplyScalar:i,divideScalar:a,pow:o,factorial:s,combinations:l,isNegative:c,isInteger:u,number:h,bignumber:d,larger:f}=e,p=[],m=[];return t(BG,{"number | BigNumber, number | BigNumber":function(e,t){if(!u(e)||c(e)||!u(t)||c(t))throw new TypeError("Non-negative integer value expected in function stirlingS2");if(f(t,e))throw new TypeError("k must be less than or equal to n in function stirlingS2");var r=!(BC(e)&&BC(t)),a=r?m:p,o=r?d:h,s=h(e),l=h(t);if(a[s]&&a[s].length>l)return a[s][l];for(var g=0;g<=s;++g)if(a[g]||(a[g]=[o(0===g?1:0)]),0!==g)for(var v=a[g],y=a[g-1],x=v.length;x<=g&&x<=l;++x)v[x]=x===g?1:n(i(o(x),y[x]),y[x-1]);return a[s][l]}})})),LG="unit",UG=SN(LG,["typed","Unit"],(e=>{var{typed:t,Unit:n}=e;return t(LG,{Unit:function(e){return e.clone()},string:function(e){return n.isValuelessUnit(e)?new n(null,e):n.parse(e,{allowNoUnits:!0})},"number | BigNumber | Fraction | Complex, string | Unit":function(e,t){return new n(e,t)},"number | BigNumber | Fraction":function(e){return new n(e)},"Array | Matrix":t.referToSelf((e=>t=>sO(t,e)))})})),zG="bellNumbers",HG=SN(zG,["typed","addScalar","isNegative","isInteger","stirlingS2"],(e=>{var{typed:t,addScalar:n,isNegative:r,isInteger:i,stirlingS2:a}=e;return t(zG,{"number | BigNumber":function(e){if(!i(e)||r(e))throw new TypeError("Non-negative integer value expected in function bellNumbers");for(var t=0,o=0;o<=e;o++)t=n(t,a(e,o));return t}})}));function VG(e){var{addScalar:t,subtract:n,flatten:r,multiply:i,multiplyScalar:a,divideScalar:o,sqrt:s,abs:l,bignumber:c,diag:u,size:h,reshape:d,inv:f,qr:p,usolve:m,usolveAll:g,equal:v,complex:y,larger:x,smaller:b,matrixFromColumns:_,dot:w}=e;function S(e,r,i,o){var l=t(e,o),c=n(a(e,o),a(r,i)),u=a(l,.5),h=a(s(n(a(l,l),a(4,c))),.5);return[t(u,h),n(u,h)]}function M(e,t,r,i,a,o,s,u){var h="BigNumber"===u,d="Complex"===u,f=h?c(0):d?y(0):0,p=h?c(1):d?y(1):1;if(b(l(r),s))return[[p,f],[f,p]];if(x(l(n(a,o)),s))return[[n(a,i),n(o,i)],[r,r]];var m=n(e,a),g=n(i,a);return b(l(t),s)&&b(l(g),s)?[[m,p],[r,f]]:[[t,f],[g,p]]}function D(e,t){for(var n=0;n<e.length;n++)e[n].push(...Array(t-e[n].length).fill(0));for(var r=e.length;r<t;r++)e.push(Array(t).fill(0)),e[r][r]=1;return e}function E(e,t,n){for(var r=0;r<e.length;r++)if(n(e[r],t))return r;return-1}function C(e,t,n,r,i){for(var a,o="BigNumber"===i?c(1e3):1e3,s=0;s<5;++s){a=A(t,n,i);try{a=m(e,a)}catch(u){continue}if(x(N(a),o))break}if(s>=5)return null;for(s=0;;){var l=m(e,a);if(b(N(T(a,[l])),r))break;if(++s>=10)return null;a=R(l)}return a}function A(e,t,n){var r="BigNumber"===n,i="Complex"===n,a=Array(e).fill(0).map((e=>2*Math.random()-1));return r&&(a=a.map((e=>c(e)))),i&&(a=a.map((e=>y(e)))),R(a=T(a,t),n)}function T(e,t){var r=h(e);for(var a of t)a=d(a,r),e=n(e,i(o(w(a,e),w(a,a)),a));return e}function N(e){return l(s(w(e,e)))}function R(e,t){var n="Complex"===t,r="BigNumber"===t?c(1):n?y(1):1;return i(o(r,N(e)),e)}return function(e,s,h,d){var m=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],_=function(e,n,r,i,s){var h,d="BigNumber"===i,f="Complex"===i,p=d?c(0):0,m=d?c(1):f?y(1):1,g=d?c(1):1,_=d?c(10):2,w=a(_,_);s&&(h=Array(n).fill(m));var S=!1;for(;!S;){S=!0;for(var M=0;M<n;M++){for(var D=p,E=p,C=0;C<n;C++)M!==C&&(D=t(D,l(e[C][M])),E=t(E,l(e[M][C])));if(!v(D,0)&&!v(E,0)){for(var A=g,T=D,N=o(E,_),R=a(E,_);b(T,N);)T=a(T,w),A=a(A,_);for(;x(T,R);)T=o(T,w),A=o(A,_);if(b(o(t(T,E),A),a(t(D,E),.95))){S=!1;for(var P=o(1,A),F=0;F<n;F++)M!==F&&(e[M][F]=a(e[M][F],P),e[F][M]=a(e[F][M],A));s&&(h[M]=a(h[M],P))}}}}return s?u(h):null}(e,s,0,d,m);!function(e,r,i,s,u,h){var d="BigNumber"===s,f="Complex"===s,p=d?c(0):f?y(0):0;d&&(i=c(i));for(var m=0;m<r-2;m++){for(var g=0,v=p,x=m+1;x<r;x++){var _=e[x][m];b(l(v),l(_))&&(v=_,g=x)}if(!b(l(v),i)){if(g!==m+1){var w=e[g];e[g]=e[m+1],e[m+1]=w;for(var S=0;S<r;S++){var M=e[S][g];e[S][g]=e[S][m+1],e[S][m+1]=M}if(u){var D=h[g];h[g]=h[m+1],h[m+1]=D}}for(var E=m+2;E<r;E++){var C=o(e[E][m],v);if(0!==C){for(var A=0;A<r;A++)e[E][A]=n(e[E][A],a(C,e[m+1][A]));for(var T=0;T<r;T++)e[T][m+1]=t(e[T][m+1],a(C,e[T][E]));if(u)for(var N=0;N<r;N++)h[E][N]=n(h[E][N],a(C,h[m+1][N]))}}}}}(e,s,h,d,m,_);var{values:w,C:A}=function(e,r,a,o,s){var h="BigNumber"===o,d="Complex"===o,f=h?c(1):d?y(1):1;h&&(a=c(a));var m=CA(e),g=[],v=r,x=[],_=s?u(Array(r).fill(f)):void 0,w=s?u(Array(v).fill(f)):void 0,E=0;for(;E<=100;){E+=1;for(var C=m[v-1][v-1],A=0;A<v;A++)m[A][A]=n(m[A][A],C);var{Q:T,R:N}=p(m);m=i(N,T);for(var R=0;R<v;R++)m[R][R]=t(m[R][R],C);if(s&&(w=i(w,T)),1===v||b(l(m[v-1][v-2]),a)){E=0,g.push(m[v-1][v-1]),s&&(x.unshift([[1]]),D(w,r),_=i(_,w),v>1&&(w=u(Array(v-1).fill(f)))),v-=1,m.pop();for(var P=0;P<v;P++)m[P].pop()}else if(2===v||b(l(m[v-2][v-3]),a)){E=0;var F=S(m[v-2][v-2],m[v-2][v-1],m[v-1][v-2],m[v-1][v-1]);g.push(...F),s&&(x.unshift(M(m[v-2][v-2],m[v-2][v-1],m[v-1][v-2],m[v-1][v-1],F[0],F[1],a,o)),D(w,r),_=i(_,w),v>2&&(w=u(Array(v-2).fill(f)))),v-=2,m.pop(),m.pop();for(var O=0;O<v;O++)m[O].pop(),m[O].pop()}if(0===v)break}if(g.sort(((e,t)=>+n(l(e),l(t)))),E>100){var I=Error("The eigenvalues failed to converge. Only found these eigenvalues: "+g.join(", "));throw I.values=g,I.vectors=[],I}var B=s?i(_,function(e,t){for(var n=[],r=0;r<t;r++)n[r]=Array(t).fill(0);var i=0;for(var a of e){for(var o=a.length,s=0;s<o;s++)for(var l=0;l<o;l++)n[i+s][i+l]=a[s][l];i+=o}return n}(x,r)):void 0;return{values:g,C:B}}(e,s,h,d,m);if(m){var T=function(e,t,a,o,s,l,h){var d=f(a),p=i(d,e,a),m="BigNumber"===h,x="Complex"===h,b=m?c(0):x?y(0):0,_=m?c(1):x?y(1):1,w=[],S=[];for(var M of s){var D=E(w,M,v);-1===D?(w.push(M),S.push(1)):S[D]+=1}for(var A=[],T=w.length,N=Array(t).fill(b),R=u(Array(t).fill(_)),P=function(){var e=w[F],s=n(p,i(e,R)),c=g(s,N);for(c.shift();c.length<S[F];){var u=C(s,t,c,l,h);if(null===u)break;c.push(u)}var d=i(f(o),a);c=c.map((e=>i(d,e))),A.push(...c.map((t=>({value:e,vector:r(t)}))))},F=0;F<T;F++)P();return A}(e,s,A,_,w,h,d);return{values:w,eigenvectors:T}}return{values:w}}}function GG(e){var{config:t,addScalar:n,subtract:r,abs:i,atan:a,cos:o,sin:s,multiplyScalar:l,inv:c,bignumber:u,multiply:h,add:d}=e;function f(e,n,r){var i=n-e;return Math.abs(i)<=t.relTol?Math.PI/4:.5*Math.atan(2*r/(n-e))}function p(e,n,o){var s=r(n,e);return i(s)<=t.relTol?u(-1).acos().div(4):l(.5,a(h(2,o,c(s))))}function m(e,t,n,r){for(var i=e.length,a=Math.cos(t),o=Math.sin(t),s=Array(i).fill(0),l=Array(i).fill(0),c=0;c<i;c++)s[c]=a*e[c][n]-o*e[c][r],l[c]=o*e[c][n]+a*e[c][r];for(var u=0;u<i;u++)e[u][n]=s[u],e[u][r]=l[u];return e}function g(e,t,i,a){for(var c=e.length,h=o(t),d=s(t),f=Array(c).fill(u(0)),p=Array(c).fill(u(0)),m=0;m<c;m++)f[m]=r(l(h,e[m][i]),l(d,e[m][a])),p[m]=n(l(d,e[m][i]),l(h,e[m][a]));for(var g=0;g<c;g++)e[g][i]=f[g],e[g][a]=p[g];return e}function v(e,t,i,a){for(var c=e.length,f=u(o(t)),p=u(s(t)),m=l(f,f),g=l(p,p),v=Array(c).fill(u(0)),y=Array(c).fill(u(0)),x=h(u(2),f,p,e[i][a]),b=n(r(l(m,e[i][i]),x),l(g,e[a][a])),_=d(l(g,e[i][i]),x,l(m,e[a][a])),w=0;w<c;w++)v[w]=r(l(f,e[i][w]),l(p,e[a][w])),y[w]=n(l(p,e[i][w]),l(f,e[a][w]));e[i][i]=b,e[a][a]=_,e[i][a]=u(0),e[a][i]=u(0);for(var S=0;S<c;S++)S!==i&&S!==a&&(e[i][S]=v[S],e[S][i]=v[S],e[a][S]=y[S],e[S][a]=y[S]);return e}function y(e,t,n,r){for(var i=e.length,a=Math.cos(t),o=Math.sin(t),s=a*a,l=o*o,c=Array(i).fill(0),u=Array(i).fill(0),h=s*e[n][n]-2*a*o*e[n][r]+l*e[r][r],d=l*e[n][n]+2*a*o*e[n][r]+s*e[r][r],f=0;f<i;f++)c[f]=a*e[n][f]-o*e[r][f],u[f]=o*e[n][f]+a*e[r][f];e[n][n]=h,e[r][r]=d,e[n][r]=0,e[r][n]=0;for(var p=0;p<i;p++)p!==n&&p!==r&&(e[n][p]=c[p],e[p][n]=c[p],e[r][p]=u[p],e[p][r]=u[p]);return e}function x(e){for(var t=e.length,n=0,r=[0,1],i=0;i<t;i++)for(var a=i+1;a<t;a++)Math.abs(n)<Math.abs(e[i][a])&&(n=Math.abs(e[i][a]),r=[i,a]);return[r,n]}function b(e){for(var t=e.length,n=0,r=[0,1],a=0;a<t;a++)for(var o=a+1;o<t;o++)i(n)<i(e[a][o])&&(n=i(e[a][o]),r=[a,o]);return[r,n]}function _(e,t,n){var r,a=e.length,o=Array(a);if(n){r=Array(a);for(var s=0;s<a;s++)r[s]=Array(a)}for(var l=0;l<a;l++){for(var c=0,u=e[0],h=0;h<e.length;h++)i(e[h])<i(u)&&(u=e[c=h]);if(o[l]=e.splice(c,1)[0],n)for(var d=0;d<a;d++)r[l][d]=t[d][c],t[d].splice(c,1)}if(!n)return{values:o};var f=r.map(((e,t)=>({value:o[t],vector:e})));return{values:o,eigenvectors:f}}return function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.relTol,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if("number"===a)return function(e,t,n){var r,i,a=e.length,o=Math.abs(t/a);if(n){i=new Array(a);for(var s=0;s<a;s++)i[s]=Array(a).fill(0),i[s][s]=1}var l=x(e);for(;Math.abs(l[1])>=Math.abs(o);){var c=l[0][0],u=l[0][1];e=y(e,r=f(e[c][c],e[u][u],e[c][u]),c,u),n&&(i=m(i,r,c,u)),l=x(e)}for(var h=Array(a).fill(0),d=0;d<a;d++)h[d]=e[d][d];return _(CA(h),i,n)}(e,r,o);if("BigNumber"===a)return function(e,t,n){var r,a,o=e.length,s=i(t/o);if(n){a=new Array(o);for(var l=0;l<o;l++)a[l]=Array(o).fill(0),a[l][l]=1}var c=b(e);for(;i(c[1])>=i(s);){var u=c[0][0],h=c[0][1];e=v(e,r=p(e[u][u],e[h][h],e[u][h]),u,h),n&&(a=g(a,r,u,h)),c=b(e)}for(var d=Array(o).fill(0),f=0;f<o;f++)d[f]=e[f][f];return _(CA(d),a,n)}(e,r,o);throw TypeError("Unsupported data type: "+a)}}var qG=SN("eigs",["config","typed","matrix","addScalar","equal","subtract","abs","atan","cos","sin","multiplyScalar","divideScalar","inv","bignumber","multiply","add","larger","column","flatten","number","complex","sqrt","diag","size","reshape","qr","usolve","usolveAll","im","re","smaller","matrixFromColumns","dot"],(e=>{var{config:t,typed:n,matrix:r,addScalar:i,subtract:a,equal:o,abs:s,atan:l,cos:c,sin:u,multiplyScalar:h,divideScalar:d,inv:f,bignumber:p,multiply:m,add:g,larger:v,column:y,flatten:x,number:b,complex:_,sqrt:w,diag:S,size:M,reshape:D,qr:E,usolve:C,usolveAll:A,im:T,re:N,smaller:R,matrixFromColumns:P,dot:F}=e,O=GG({config:t,addScalar:i,subtract:a,column:y,flatten:x,equal:o,abs:s,atan:l,cos:c,sin:u,multiplyScalar:h,inv:f,bignumber:p,complex:_,multiply:m,add:g}),I=VG({config:t,addScalar:i,subtract:a,multiply:m,multiplyScalar:h,flatten:x,divideScalar:d,sqrt:w,abs:s,bignumber:p,diag:S,size:M,reshape:D,qr:E,inv:f,usolve:C,usolveAll:A,equal:o,complex:_,larger:v,smaller:R,matrixFromColumns:P,dot:F});return n("eigs",{Array:function(e){return B(r(e))},"Array, number|BigNumber":function(e,t){return B(r(e),{precision:t})},"Array, Object":(e,t)=>B(r(e),t),Matrix:function(e){return B(e,{matricize:!0})},"Matrix, number|BigNumber":function(e,t){return B(e,{precision:t,matricize:!0})},"Matrix, Object":function(e,t){var n={matricize:!0};return SC(n,t),B(e,n)}});function B(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=!("eigenvectors"in i)||i.eigenvectors,l=function(e,t,n){var r=e.toArray(),i=e.size();if(2!==i.length||i[0]!==i[1])throw new RangeError("Matrix must be square (size: ".concat(sF(i),")"));var o=i[0];if(function(e,t,n){for(var r=0;r<t;r++)for(var i=0;i<t;i++)if(v(p(s(T(e[r][i]))),n))return!1;return!0}(r,o,t)&&(function(e,t){for(var n=0;n<t;n++)for(var r=0;r<t;r++)e[n][r]=N(e[n][r])}(r,o),function(e,t,n){for(var r=0;r<t;r++)for(var i=r;i<t;i++)if(v(p(s(a(e[r][i],e[i][r]))),n))return!1;return!0}(r,o,t))){var l=k(e,r,o);return O(r,o,t,l,n)}var c=k(e,r,o);return I(r,o,t,c,n)}(e,null!==(n=i.precision)&&void 0!==n?n:t.relTol,o);return i.matricize&&(l.values=r(l.values),o&&(l.eigenvectors=l.eigenvectors.map((e=>{var{value:t,vector:n}=e;return{value:t,vector:r(n)}})))),o&&Object.defineProperty(l,"vectors",{enumerable:!1,get:()=>{throw new Error("eigs(M).vectors replaced with eigs(M).eigenvectors")}}),l}function k(e,t,n){var r=e.datatype();if("number"===r||"BigNumber"===r||"Complex"===r)return r;for(var i=!1,a=!1,o=!1,s=0;s<n;s++)for(var l=0;l<n;l++){var c=t[s][l];if(BC(c)||zC(c))i=!0;else if(kC(c))a=!0;else{if(!UC(c))throw TypeError("Unsupported type in Matrix: "+EA(c));o=!0}}if(a&&o&&console.warn("Complex BigNumbers not supported, this operation will lose precission."),o){for(var u=0;u<n;u++)for(var h=0;h<n;h++)t[u][h]=_(t[u][h]);return"Complex"}if(a){for(var d=0;d<n;d++)for(var f=0;f<n;f++)t[d][f]=p(t[d][f]);return"BigNumber"}if(i){for(var m=0;m<n;m++)for(var g=0;g<n;g++)t[m][g]=b(t[m][g]);return"number"}throw TypeError("Matrix contains unsupported types only.")}})),jG="kldivergence",WG=SN(jG,["typed","matrix","divide","sum","multiply","map","dotDivide","log","isNumeric"],(e=>{var{typed:t,matrix:n,divide:r,sum:i,multiply:a,map:o,dotDivide:s,log:l,isNumeric:c}=e;return t(jG,{"Array, Array":function(e,t){return u(n(e),n(t))},"Matrix, Array":function(e,t){return u(e,n(t))},"Array, Matrix":function(e,t){return u(n(e),t)},"Matrix, Matrix":function(e,t){return u(e,t)}});function u(e,t){var n=t.size().length,u=e.size().length;if(n>1)throw new Error("first object must be one dimensional");if(u>1)throw new Error("second object must be one dimensional");if(n!==u)throw new Error("Length of two vectors must be equal");if(0===i(e))throw new Error("Sum of elements in first object must be non zero");if(0===i(t))throw new Error("Sum of elements in second object must be non zero");var h=r(e,i(e)),d=r(t,i(t)),f=i(a(h,o(s(h,d),(e=>l(e)))));return c(f)?f:Number.NaN}}));function XG(e,t){var n,r=t.length,i=[];if(e)for(n=0;n<r;n++)i[e[n]]=t[n];else for(n=0;n<r;n++)i[n]=t[n];return i}var YG="lusolve",ZG=["typed","matrix","lup","slu","usolve","lsolve","DenseMatrix"],KG=SN(YG,ZG,(e=>{var{typed:t,matrix:n,lup:r,slu:i,usolve:a,lsolve:o,DenseMatrix:s}=e,l=Xz({DenseMatrix:s});return t(YG,{"Array, Array | Matrix":function(e,t){e=n(e);var i=r(e);return u(i.L,i.U,i.p,null,t).valueOf()},"DenseMatrix, Array | Matrix":function(e,t){var n=r(e);return u(n.L,n.U,n.p,null,t)},"SparseMatrix, Array | Matrix":function(e,t){var n=r(e);return u(n.L,n.U,n.p,null,t)},"SparseMatrix, Array | Matrix, number, number":function(e,t,n,r){var a=i(e,n,r);return u(a.L,a.U,a.p,a.q,t)},"Object, Array | Matrix":function(e,t){return u(e.L,e.U,e.p,e.q,t)}});function c(e){if(qC(e))return e;if(GC(e))return n(e);throw new TypeError("Invalid Matrix LU decomposition")}function u(e,t,n,r,i){e=c(e),t=c(t),n&&((i=l(e,i,!0))._data=XG(n,i._data));var s=o(e,i),u=a(t,s);return r&&(u._data=XG(r,u._data)),u}})),QG="mean",JG=["typed","add","divide"],$G=SN(QG,JG,(e=>{var{typed:t,add:n,divide:r}=e;return t(QG,{"Array | Matrix":i,"Array | Matrix, number | BigNumber":function(e,t){try{var i=lO(e,t,n),a=Array.isArray(e)?mF(e):e.size();return r(i,a[t])}catch(o){throw EU(o,"mean")}},"...":function(e){if(aO(e))throw new TypeError("Scalar values expected in function mean");return i(e)}});function i(e){var t,i=0;if(oO(e,(function(e){try{t=void 0===t?e:n(t,e),i++}catch(r){throw EU(r,"mean",e)}})),0===i)throw new Error("Cannot calculate the mean of an empty array");return r(t,i)}})),eq="quantileSeq",tq=["typed","?bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],nq=SN(eq,tq,(e=>{var{typed:t,bignumber:n,add:r,subtract:i,divide:a,multiply:o,partitionSelect:s,compare:l,isInteger:c,smaller:u,smallerEq:h,larger:d,mapSlices:f}=e;return t(eq,{"Array | Matrix, number | BigNumber":(e,t)=>m(e,t,!1),"Array | Matrix, number | BigNumber, number":(e,t,n)=>p(e,t,!1,n,m),"Array | Matrix, number | BigNumber, boolean":m,"Array | Matrix, number | BigNumber, boolean, number":(e,t,n,r)=>p(e,t,n,r,m),"Array | Matrix, Array | Matrix":(e,t)=>g(e,t,!1),"Array | Matrix, Array | Matrix, number":(e,t,n)=>p(e,t,!1,n,g),"Array | Matrix, Array | Matrix, boolean":g,"Array | Matrix, Array | Matrix, boolean, number":(e,t,n,r)=>p(e,t,n,r,g)});function p(e,t,n,r,i){return f(e,r,(e=>i(e,t,n)))}function m(e,t,i){var o,s=e.valueOf();if(u(t,0))throw new Error("N/prob must be non-negative");if(h(t,1))return BC(t)?v(s,t,i):n(v(s,t,i));if(d(t,1)){if(!c(t))throw new Error("N must be a positive integer");if(d(t,4294967295))throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");var l=r(t,1);o=[];for(var f=0;u(f,t);f++){var p=a(f+1,l);o.push(v(s,p,i))}return BC(t)?o:n(o)}}function g(e,t,n){for(var r=e.valueOf(),i=t.valueOf(),a=[],o=0;o<i.length;++o)a.push(v(r,i[o],n));return a}function v(e,t,n){var a=NF(e),u=a.length;if(0===u)throw new Error("Cannot calculate quantile of an empty sequence");var h,d,f=BC(t)?t*(u-1):t.times(u-1),p=BC(t)?Math.floor(f):f.floor().toNumber(),m=BC(t)?f%1:f.minus(p);if(c(f))return n?a[f]:s(a,BC(t)?f:f.valueOf());if(n)h=a[p],d=a[p+1];else{d=s(a,p+1),h=a[p];for(var g=0;g<p;++g)l(a[g],h)>0&&(h=a[g])}return r(o(h,i(1,m)),o(d,m))}})),rq="setUnion",iq=["typed","size","concat","subset","setIntersect","setSymDifference","Index"],aq=SN(rq,iq,(e=>{var{typed:t,size:n,concat:r,subset:i,setIntersect:a,setSymDifference:o,Index:s}=e;return t(rq,{"Array | Matrix, Array | Matrix":function(e,t){if(0===i(n(e),new s(0)))return NF(t);if(0===i(n(t),new s(0)))return NF(e);var l=NF(e),c=NF(t);return r(o(l,c),a(l,c))}})})),oq="unbiased",sq="variance",lq=["typed","add","subtract","multiply","divide","mapSlices","isNaN"],cq=SN(sq,lq,(e=>{var{typed:t,add:n,subtract:r,multiply:i,divide:a,mapSlices:o,isNaN:s}=e;return t(sq,{"Array | Matrix":function(e){return l(e,oq)},"Array | Matrix, string":l,"Array | Matrix, number | BigNumber":function(e,t){return c(e,t,oq)},"Array | Matrix, number | BigNumber, string":c,"...":function(e){return l(e,oq)}});function l(e,t){var o,l=0;if(0===e.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");if(oO(e,(function(e){try{o=void 0===o?e:n(o,e),l++}catch(t){throw EU(t,"variance",e)}})),0===l)throw new Error("Cannot calculate variance of an empty array");var c=a(o,l);if(o=void 0,oO(e,(function(e){var t=r(e,c);o=void 0===o?i(t,t):n(o,i(t,t))})),s(o))return o;switch(t){case"uncorrected":return a(o,l);case"biased":return a(o,l+1);case"unbiased":var u=kC(o)?o.mul(0):0;return 1===l?u:a(o,l-1);default:throw new Error('Unknown normalization "'+t+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}function c(e,t,n){try{if(0===e.length)throw new SyntaxError("Function variance requires one or more parameters (0 provided)");return o(e,t,(e=>l(e,n)))}catch(r){throw EU(r,"variance")}}})),uq="median",hq=["typed","add","divide","compare","partitionSelect"],dq=SN(uq,hq,(e=>{var{typed:t,add:n,divide:r,compare:i,partitionSelect:a}=e;function o(e){try{var t=(e=NF(e.valueOf())).length;if(0===t)throw new Error("Cannot calculate median of an empty array");if(t%2===0){for(var n=t/2-1,r=a(e,n+1),o=e[n],c=0;c<n;++c)i(e[c],o)>0&&(o=e[c]);return l(o,r)}var u=a(e,(t-1)/2);return s(u)}catch(h){throw EU(h,"median")}}var s=t({"number | BigNumber | Complex | Unit":function(e){return e}}),l=t({"number | BigNumber | Complex | Unit, number | BigNumber | Complex | Unit":function(e,t){return r(n(e,t),2)}});return t(uq,{"Array | Matrix":o,"Array | Matrix, number | BigNumber":function(e,t){throw new Error("median(A, dim) is not yet supported")},"...":function(e){if(aO(e))throw new TypeError("Scalar values expected in function median");return o(e)}})})),fq="corr",pq=["typed","matrix","mean","sqrt","sum","add","subtract","multiply","pow","divide"],mq=SN(fq,pq,(e=>{var{typed:t,matrix:n,sqrt:r,sum:i,add:a,subtract:o,multiply:s,pow:l,divide:c}=e;return t(fq,{"Array, Array":function(e,t){return u(e,t)},"Matrix, Matrix":function(e,t){var r=u(e.toArray(),t.toArray());return Array.isArray(r)?n(r):r}});function u(e,t){var n=[];if(Array.isArray(e[0])&&Array.isArray(t[0])){if(e.length!==t.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same length.");for(var r=0;r<e.length;r++){if(e[r].length!==t[r].length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");n.push(h(e[r],t[r]))}return n}if(e.length!==t.length)throw new SyntaxError("Dimension mismatch. Array A and B must have the same number of elements.");return h(e,t)}function h(e,t){var n=e.length,u=i(e),h=i(t),d=e.reduce(((e,n,r)=>a(e,s(n,t[r]))),0),f=i(e.map((e=>l(e,2)))),p=i(t.map((e=>l(e,2)))),m=o(s(n,d),s(u,h)),g=r(s(o(s(n,f),l(u,2)),o(s(n,p),l(h,2))));return c(m,g)}})),gq="freqz",vq=["typed","add","multiply","Complex","divide","matrix"],yq=SN(gq,vq,(e=>{var{typed:t,add:n,multiply:r,Complex:i,divide:a,matrix:o}=e;return t(gq,{"Array, Array":function(e,t){return s(e,t,l(512))},"Array, Array, Array":function(e,t,n){return s(e,t,n)},"Array, Array, number":function(e,t,n){if(n<0)throw new Error("w must be a positive number");return s(e,t,l(n))},"Matrix, Matrix":function(e,t){var n=l(512),{w:r,h:i}=s(e.valueOf(),t.valueOf(),n);return{w:o(r),h:o(i)}},"Matrix, Matrix, Matrix":function(e,t,n){var{h:r}=s(e.valueOf(),t.valueOf(),n.valueOf());return{h:o(r),w:o(n)}},"Matrix, Matrix, number":function(e,t,n){if(n<0)throw new Error("w must be a positive number");var r=l(n),{h:i}=s(e.valueOf(),t.valueOf(),r);return{h:o(i),w:o(r)}}});function s(e,t,o){for(var s=[],l=[],c=0;c<o.length;c++){for(var u=i(0,0),h=i(0,0),d=0;d<e.length;d++)u=n(u,r(e[d],i(Math.cos(-d*o[c]),Math.sin(-d*o[c]))));for(var f=0;f<t.length;f++)h=n(h,r(t[f],i(Math.cos(-f*o[c]),Math.sin(-f*o[c]))));s.push(u),l.push(h)}for(var p=[],m=0;m<s.length;m++)p.push(a(s[m],l[m]));return{h:p,w:o}}function l(e){for(var t=[],n=0;n<e;n++)t.push(n/e*Math.PI);return t}})),xq=["typed","abs","map","median","subtract"],bq=SN("mad",xq,(e=>{var{typed:t,abs:n,map:r,median:i,subtract:a}=e;return t("mad",{"Array | Matrix":o,"...":function(e){return o(e)}});function o(e){if(0===(e=NF(e.valueOf())).length)throw new Error("Cannot calculate median absolute deviation (mad) of an empty array");try{var t=i(e);return i(r(e,(function(e){return n(a(e,t))})))}catch(o){throw o instanceof TypeError&&o.message.includes("median")?new TypeError(o.message.replace("median","mad")):EU(o,"mad")}}})),_q=["typed","map","sqrt","variance"],wq=SN("std",_q,(e=>{var{typed:t,map:n,sqrt:r,variance:i}=e;return t("std",{"Array | Matrix":a,"Array | Matrix, string":a,"Array | Matrix, number | BigNumber":a,"Array | Matrix, number | BigNumber, string":a,"...":function(e){return a(e)}});function a(e,t){if(0===e.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");try{var a=i.apply(null,arguments);return jC(a)?n(a,r):r(a)}catch(o){throw o instanceof TypeError&&o.message.includes(" variance")?new TypeError(o.message.replace(" variance"," std")):o}}})),Sq="zeta",Mq=["typed","config","multiply","pow","divide","factorial","equal","smallerEq","isNegative","gamma","sin","subtract","add","?Complex","?BigNumber","pi"],Dq=SN(Sq,Mq,(e=>{var{typed:t,config:n,multiply:r,pow:i,divide:a,factorial:o,equal:s,smallerEq:l,isNegative:c,gamma:u,sin:h,subtract:d,add:f,Complex:p,BigNumber:m,pi:g}=e;return t(Sq,{number:e=>v(e,(e=>e),(()=>20)),BigNumber:e=>v(e,(e=>new m(e)),(()=>Math.abs(Math.log10(n.relTol)))),Complex:function(e){if(0===e.re&&0===e.im)return new p(-.5);if(1===e.re)return new p(NaN,NaN);if(e.re===1/0&&0===e.im)return new p(1);if(e.im===1/0||e.re===-1/0)return new p(NaN,NaN);return y(e,(e=>e),(e=>Math.round(19.5+.9*Math.abs(e.im))),(e=>e.re))}});function v(e,t,n){return s(e,0)?t(-.5):s(e,1)?t(NaN):isFinite(e)?y(e,t,n,(e=>e)):c(e)?t(NaN):t(1)}function y(e,t,n,o){var s=n(e);if(o(e)>-(s-1)/2)return function(e,t,n){for(var o=a(1,r(x(n(0),t),d(1,i(2,d(1,e))))),s=n(0),c=n(1);l(c,t);c=f(c,1))s=f(s,a(r((-1)**(c-1),x(c,t)),i(c,e)));return r(o,s)}(e,t(s),t);var c=r(i(2,e),i(t(g),d(e,1)));return c=r(c,h(r(a(t(g),2),e))),c=r(c,u(d(1,e))),r(c,y(d(1,e),t,n,o))}function x(e,t){for(var n=e,s=e;l(s,t);s=f(s,1)){var c=a(r(o(f(t,d(s,1))),i(4,s)),r(o(d(t,s)),o(r(2,s))));n=f(n,c)}return r(t,n)}})),Eq="norm",Cq=["typed","abs","add","pow","conj","sqrt","multiply","equalScalar","larger","smaller","matrix","ctranspose","eigs"],Aq=SN(Eq,Cq,(e=>{var{typed:t,abs:n,add:r,pow:i,conj:a,sqrt:o,multiply:s,equalScalar:l,larger:c,smaller:u,matrix:h,ctranspose:d,eigs:f}=e;return t(Eq,{number:Math.abs,Complex:function(e){return e.abs()},BigNumber:function(e){return e.abs()},boolean:function(e){return Math.abs(e)},Array:function(e){return g(h(e),2)},Matrix:function(e){return g(e,2)},"Array, number | BigNumber | string":function(e,t){return g(h(e),t)},"Matrix, number | BigNumber | string":function(e,t){return g(e,t)}});function p(e,t){if(t===Number.POSITIVE_INFINITY||"inf"===t)return function(e){var t=0;return e.forEach((function(e){var r=n(e);c(r,t)&&(t=r)}),!0),t}(e);if(t===Number.NEGATIVE_INFINITY||"-inf"===t)return function(e){var t;return e.forEach((function(e){var r=n(e);t&&!u(r,t)||(t=r)}),!0),t||0}(e);if("fro"===t)return g(e,2);if("number"===typeof t&&!isNaN(t)){if(!l(t,0)){var a=0;return e.forEach((function(e){a=r(i(n(e),t),a)}),!0),i(a,1/t)}return Number.POSITIVE_INFINITY}throw new Error("Unsupported parameter value")}function m(e,t){if(1===t)return function(e){var t=[],i=0;return e.forEach((function(e,a){var o=a[1],s=r(t[o]||0,n(e));c(s,i)&&(i=s),t[o]=s}),!0),i}(e);if(t===Number.POSITIVE_INFINITY||"inf"===t)return function(e){var t=[],i=0;return e.forEach((function(e,a){var o=a[0],s=r(t[o]||0,n(e));c(s,i)&&(i=s),t[o]=s}),!0),i}(e);if("fro"===t)return function(e){var t=0;return e.forEach((function(e,n){t=r(t,s(e,a(e)))})),n(o(t))}(e);if(2===t)return function(e){var t=e.size();if(t[0]!==t[1])throw new RangeError("Invalid matrix dimensions");var r=d(e),i=s(r,e),a=f(i).values.toArray(),l=a[a.length-1];return n(o(l))}(e);throw new Error("Unsupported parameter value "+t)}function g(e,t){var n=e.size();if(1===n.length)return p(e,t);if(2===n.length){if(n[0]&&n[1])return m(e,t);throw new RangeError("Invalid matrix dimensions")}}})),Tq="rotationMatrix",Nq=["typed","config","multiplyScalar","addScalar","unaryMinus","norm","matrix","BigNumber","DenseMatrix","SparseMatrix","cos","sin"],Rq=SN(Tq,Nq,(e=>{var{typed:t,config:n,multiplyScalar:r,addScalar:i,unaryMinus:a,norm:o,BigNumber:s,matrix:l,DenseMatrix:c,SparseMatrix:u,cos:h,sin:d}=e;return t(Tq,{"":function(){return"Matrix"===n.matrix?l([]):[]},string:function(e){return l(e)},"number | BigNumber | Complex | Unit":function(e){return f(e,"Matrix"===n.matrix?"dense":void 0)},"number | BigNumber | Complex | Unit, string":function(e,t){return f(e,t)},"number | BigNumber | Complex | Unit, Array":function(e,t){var n=l(t);return p(n),v(e,n,void 0)},"number | BigNumber | Complex | Unit, Matrix":function(e,t){p(t);var r=t.storage()||("Matrix"===n.matrix?"dense":void 0);return v(e,t,r)},"number | BigNumber | Complex | Unit, Array, string":function(e,t,n){var r=l(t);return p(r),v(e,r,n)},"number | BigNumber | Complex | Unit, Matrix, string":function(e,t,n){return p(t),v(e,t,n)}});function f(e,t){var n=kC(e)?new s(-1):-1,i=h(e),a=d(e);return g([[i,r(n,a)],[a,i]],t)}function p(e){var t=e.size();if(t.length<1||3!==t[0])throw new RangeError("Vector must be of dimensions 1x3")}function m(e){return e.reduce(((e,t)=>r(e,t)))}function g(e,t){if(t){if("sparse"===t)return new u(e);if("dense"===t)return new c(e);throw new TypeError('Unknown matrix type "'.concat(t,'"'))}return e}function v(e,t,n){var r=o(t);if(0===r)throw new RangeError("Rotation around zero vector");var l=kC(e)?s:null,c=l?new l(1):1,u=l?new l(-1):-1,f=l?new l(t.get([0])/r):t.get([0])/r,p=l?new l(t.get([1])/r):t.get([1])/r,v=l?new l(t.get([2])/r):t.get([2])/r,y=h(e),x=i(c,a(y)),b=d(e);return g([[i(y,m([f,f,x])),i(m([f,p,x]),m([u,v,b])),i(m([f,v,x]),m([p,b]))],[i(m([f,p,x]),m([v,b])),i(y,m([p,p,x])),i(m([p,v,x]),m([u,f,b]))],[i(m([f,v,x]),m([u,p,b])),i(m([p,v,x]),m([f,b])),i(y,m([v,v,x]))]],n)}})),Pq="schur",Fq=["typed","matrix","identity","multiply","qr","norm","subtract"],Oq=SN(Pq,Fq,(e=>{var{typed:t,matrix:n,identity:r,multiply:i,qr:a,norm:o,subtract:s}=e;return t(Pq,{Array:function(e){var t=l(n(e));return{U:t.U.valueOf(),T:t.T.valueOf()}},Matrix:function(e){return l(e)}});function l(e){var t,n=e.size()[0],l=e,c=r(n),u=0;do{t=l;var h=a(l),d=h.Q,f=h.R;if(l=i(f,d),c=i(c,d),u++>100)break}while(o(s(l,t))>1e-4);return{U:c,T:l}}})),Iq="rotate",Bq=["typed","multiply","rotationMatrix"],kq=SN(Iq,Bq,(e=>{var{typed:t,multiply:n,rotationMatrix:r}=e;return t(Iq,{"Array , number | BigNumber | Complex | Unit":function(e,t){return i(e,2),n(r(t),e).toArray()},"Matrix , number | BigNumber | Complex | Unit":function(e,t){return i(e,2),n(r(t),e)},"Array, number | BigNumber | Complex | Unit, Array | Matrix":function(e,t,a){return i(e,3),n(r(t,a),e)},"Matrix, number | BigNumber | Complex | Unit, Array | Matrix":function(e,t,a){return i(e,3),n(r(t,a),e)}});function i(e,t){var n=Array.isArray(e)?mF(e):e.size();if(n.length>2)throw new RangeError("Vector must be of dimensions 1x".concat(t));if(2===n.length&&1!==n[1])throw new RangeError("Vector must be of dimensions 1x".concat(t));if(n[0]!==t)throw new RangeError("Vector must be of dimensions 1x".concat(t))}})),Lq="sylvester",Uq=["typed","schur","matrixFromColumns","matrix","multiply","range","concat","transpose","index","subset","add","subtract","identity","lusolve","abs"],zq=SN(Lq,Uq,(e=>{var{typed:t,schur:n,matrixFromColumns:r,matrix:i,multiply:a,range:o,concat:s,transpose:l,index:c,subset:u,add:h,subtract:d,identity:f,lusolve:p,abs:m}=e;return t(Lq,{"Matrix, Matrix, Matrix":g,"Array, Matrix, Matrix":function(e,t,n){return g(i(e),t,n)},"Array, Array, Matrix":function(e,t,n){return g(i(e),i(t),n)},"Array, Matrix, Array":function(e,t,n){return g(i(e),t,i(n))},"Matrix, Array, Matrix":function(e,t,n){return g(e,i(t),n)},"Matrix, Array, Array":function(e,t,n){return g(e,i(t),i(n))},"Matrix, Matrix, Array":function(e,t,n){return g(e,t,i(n))},"Array, Array, Array":function(e,t,n){return g(i(e),i(t),i(n)).toArray()}});function g(e,t,g){for(var v=t.size()[0],y=e.size()[0],x=n(e),b=x.T,_=x.U,w=n(a(-1,t)),S=w.T,M=w.U,D=a(a(l(_),g),M),E=o(0,y),C=[],A=(e,t)=>s(e,t,1),T=(e,t)=>s(e,t,0),N=0;N<v;N++)if(N<v-1&&m(u(S,c(N+1,N)))>1e-5){for(var R=T(u(D,c(E,N)),u(D,c(E,N+1))),P=0;P<N;P++)R=h(R,T(a(C[P],u(S,c(P,N))),a(C[P],u(S,c(P,N+1)))));var F=a(f(y),a(-1,u(S,c(N,N)))),O=a(f(y),a(-1,u(S,c(N+1,N)))),I=a(f(y),a(-1,u(S,c(N,N+1)))),B=a(f(y),a(-1,u(S,c(N+1,N+1)))),k=T(A(h(b,F),O),A(I,h(b,B))),L=p(k,R);C[N]=L.subset(c(o(0,y),0)),C[N+1]=L.subset(c(o(y,2*y),0)),N++}else{for(var U=u(D,c(E,N)),z=0;z<N;z++)U=h(U,a(C[z],u(S,c(z,N))));var H=u(S,c(N,N)),V=d(b,a(H,f(y)));C[N]=p(V,U)}var G=i(r(...C));return a(_,a(G,l(M)))}})),Hq="lyap",Vq=["typed","matrix","sylvester","multiply","transpose"],Gq=SN(Hq,Vq,(e=>{var{typed:t,matrix:n,sylvester:r,multiply:i,transpose:a}=e;return t(Hq,{"Matrix, Matrix":function(e,t){return r(e,a(e),i(-1,t))},"Array, Matrix":function(e,t){return r(n(e),a(n(e)),i(-1,t))},"Matrix, Array":function(e,t){return r(e,a(n(e)),n(i(-1,t)))},"Array, Array":function(e,t){return r(n(e),a(n(e)),n(i(-1,t))).toArray()}})})),qq=EN({config:UA}),jq=oR({}),Wq=MR({BigNumber:qq,config:UA}),Xq=yR({}),Yq=nP({BigNumber:qq,config:UA}),Zq=JP({}),Kq=PR({Complex:jq}),Qq=bR({BigNumber:qq,config:UA}),Jq=CR({BigNumber:qq,config:UA}),$q=TR({BigNumber:qq,config:UA}),ej=$P({}),tj=_R({BigNumber:qq,config:UA}),nj=xR({}),rj=DR({BigNumber:qq,config:UA}),ij=eF({}),aj=tF({}),oj=NR({BigNumber:qq,config:UA}),sj=_P({BigNumber:qq,config:UA}),lj=SR({BigNumber:qq,config:UA}),cj=vR({}),uj=IR({}),hj=QF({Matrix:ej}),dj=hP({BigNumber:qq,config:UA}),fj=ER({BigNumber:qq,config:UA}),pj=wR({BigNumber:qq,config:UA}),mj=JF({}),gj=RR({BigNumber:qq,config:UA}),vj=eO({BigNumber:qq,Complex:jq,DenseMatrix:hj,Fraction:Zq}),yj=uP({BigNumber:qq,config:UA}),xj=FO({typed:vj}),bj=IO({Complex:jq,config:UA,typed:vj}),_j=eI({BigNumber:qq,typed:vj}),wj=nI({BigNumber:qq,Complex:jq,config:UA,typed:vj}),Sj=iI({typed:vj}),Mj=aI({typed:vj}),Dj=sI({BigNumber:qq,Complex:jq,config:UA,typed:vj}),Ej=lI({typed:vj}),Cj=cI({typed:vj}),Aj=hI({Complex:jq,config:UA,typed:vj}),Tj=dI({typed:vj}),Nj=NI({typed:vj}),Rj=PI({typed:vj}),Pj=OI({typed:vj}),Fj=LI({typed:vj}),Oj=zI({Complex:jq,typed:vj}),Ij=VI({typed:vj}),Bj=qI({typed:vj}),kj=jI({BigNumber:qq,typed:vj}),Lj=WI({BigNumber:qq,typed:vj}),Uj=YI({typed:vj}),zj=JI({config:UA,typed:vj}),Hj=$I({typed:vj}),Vj=aB({typed:vj}),Gj=sB({Complex:jq,typed:vj}),qj=lB({typed:vj}),jj=hB({typed:vj}),Wj=fB({typed:vj}),Xj=gB({typed:vj}),Yj=yB({typed:vj}),Zj=xB({format:Xj,typed:vj}),Kj=bB({typed:vj}),Qj=wB({typed:vj}),Jj=AB({config:UA,typed:vj}),$j=NB({config:UA,typed:vj}),eW=PB({equalScalar:zj,typed:vj}),tW=AR({BigNumber:qq,config:UA}),nW=zB({Complex:jq,typed:vj}),rW=jB({Complex:jq,config:UA,typed:vj}),iW=XB({Complex:jq,config:UA,typed:vj}),aW=ZB({typed:vj}),oW=KB({typed:vj}),sW=nk({typed:vj}),lW=rk({typed:vj}),cW=ik({format:Xj,typed:vj}),uW=ck({config:UA,typed:vj}),hW=dk({typed:vj}),dW=gk({config:UA,typed:vj}),fW=vk({typed:vj}),pW=yk({BigNumber:qq,typed:vj}),mW=bk({BigNumber:qq,Fraction:Zq,complex:Oj,typed:vj}),gW=_k({typed:vj}),vW=wk({Matrix:ej,equalScalar:zj,typed:vj}),yW=Mk({typed:vj}),xW=Ek({typed:vj}),bW=Ak({typed:vj}),_W=Nk({typed:vj}),wW=Rk({typed:vj}),SW=Fk({typed:vj}),MW=Ik({Complex:jq,config:UA,typed:vj}),DW=kk({BigNumber:qq,typed:vj}),EW=Uk({BigNumber:qq,Complex:jq,config:UA,typed:vj}),CW=zk({BigNumber:qq,typed:vj}),AW=Vk({typed:vj}),TW=jk({typed:vj}),NW=Xk({BigNumber:qq,typed:vj}),RW=Zk({typed:vj}),PW=Qk({typed:vj}),FW=$k({isInteger:Qj,typed:vj}),OW=FW,IW=nL({DenseMatrix:hj,Matrix:ej,SparseMatrix:vW,typed:vj}),BW=iL({isZero:eW,matrix:IW,typed:vj}),kW=aL({BigNumber:qq,config:UA,matrix:IW,typed:vj}),LW=lL({config:UA,log2:iW,typed:vj}),UW=uL({isInteger:Qj,matrix:IW,typed:vj}),zW=dL({BigNumber:qq,typed:vj}),HW=pL({typed:vj}),VW=gL({SparseMatrix:vW,typed:vj}),GW=vL({Complex:jq,config:UA,typed:vj}),qW=xL({typed:vj}),jW=bL({typed:vj}),WW=wL({matrix:IW,typed:vj}),XW=ML({BigNumber:qq,config:UA,matrix:IW,typed:vj}),YW=EL({BigNumber:qq,config:UA,matrix:IW,typed:vj}),ZW=AL({BigNumber:qq,Complex:jq,config:UA,typed:vj}),KW=NL({Complex:jq,config:UA,typed:vj}),QW=RL({format:Xj,typed:vj}),JW=FL({isInteger:Qj,matrix:IW,typed:vj}),$W=IL({BigNumber:qq,typed:vj}),eX=kL({conj:Ij,transpose:WW,typed:vj}),tX=UL({DenseMatrix:hj,SparseMatrix:vW,matrix:IW,typed:vj}),nX=YL({concat:JW,equalScalar:zj,matrix:IW,multiplyScalar:oW,typed:vj}),rX=$L({DenseMatrix:hj,SparseMatrix:vW,concat:JW,equalScalar:zj,matrix:IW,typed:vj}),iX=tU({Fraction:Zq,typed:vj}),aX=rU({BigNumber:qq,DenseMatrix:hj,SparseMatrix:vW,config:UA,matrix:IW,typed:vj}),oX=aU({typed:vj}),sX=sU({matrix:IW,multiplyScalar:oW,typed:vj}),lX=cU({DenseMatrix:hj,SparseMatrix:vW,concat:JW,config:UA,matrix:IW,typed:vj}),cX=gU({DenseMatrix:hj,concat:JW,equalScalar:zj,matrix:IW,typed:vj,zeros:YW}),uX=yU({isNaN:RW,isNumeric:oX,typed:vj}),hX=_U({BigNumber:qq,concat:JW,equalScalar:zj,matrix:IW,typed:vj}),dX=DU({bignumber:CW,fraction:iX,number:lW}),fX=AU({config:UA,multiplyScalar:oW,numeric:dX,typed:vj}),pX=NU({config:UA,matrix:IW}),mX=PU({DenseMatrix:hj,concat:JW,equalScalar:zj,matrix:IW,typed:vj,zeros:YW}),gX=IU({BigNumber:qq,DenseMatrix:hj,config:UA,equalScalar:zj,matrix:IW,typed:vj,zeros:YW}),vX=kU({matrix:IW,config:UA,typed:vj}),yX=UU({DenseMatrix:hj,SparseMatrix:vW,bignumber:CW,concat:JW,config:UA,matrix:IW,typed:vj}),xX=HU({concat:JW,matrix:IW,typed:vj}),bX=GU({typed:vj}),_X=jU({DenseMatrix:hj,SparseMatrix:vW,concat:JW,config:UA,equalScalar:zj,matrix:IW,typed:vj}),wX=XU({DenseMatrix:hj,SparseMatrix:vW,concat:JW,matrix:IW,typed:vj}),SX=ZU({DenseMatrix:hj,SparseMatrix:vW,addScalar:Sj,concat:JW,equalScalar:zj,matrix:IW,typed:vj}),MX=QU({BigNumber:qq,DenseMatrix:hj,concat:JW,equalScalar:zj,matrix:IW,typed:vj}),DX=$U({concat:JW,equalScalar:zj,matrix:IW,typed:vj}),EX=tz({DenseMatrix:hj,concat:JW,equalScalar:zj,matrix:IW,typed:vj}),CX=rz({DenseMatrix:hj,SparseMatrix:vW,concat:JW,matrix:IW,typed:vj}),AX=az({BigNumber:qq,Complex:jq,Fraction:Zq,config:UA,isNegative:Jj,matrix:IW,typed:vj,unaryMinus:bX}),TX=lz({BigNumber:qq,DenseMatrix:hj,Fraction:Zq,concat:JW,config:UA,equalScalar:zj,matrix:IW,typed:vj}),NX=dz({concat:JW,matrix:IW,typed:vj}),RX=pz({prod:fX,size:vX,typed:vj}),PX=gz({equal:rX,typed:vj}),FX=yz({numeric:dX,typed:vj}),OX=bz({DenseMatrix:hj,SparseMatrix:vW,concat:JW,divideScalar:FX,equalScalar:zj,matrix:IW,typed:vj}),IX=wz({compareText:NX,isZero:eW,typed:vj}),BX=Cz({DenseMatrix:hj,config:UA,equalScalar:zj,matrix:IW,round:gX,typed:vj,zeros:YW}),kX=Fz({BigNumber:qq,DenseMatrix:hj,concat:JW,config:UA,equalScalar:zj,matrix:IW,round:gX,typed:vj,zeros:YW}),LX=Iz({isNumeric:oX,typed:vj}),UX=kz({abs:xj,addScalar:Sj,divideScalar:FX,isPositive:$j,multiplyScalar:oW,smaller:yX,sqrt:GW,typed:vj}),zX=Lz({DenseMatrix:hj,smaller:yX}),HX=Uz({ImmutableDenseMatrix:zX,getMatrixDataType:Yj}),VX=Vz({DenseMatrix:hj,SparseMatrix:vW,bignumber:CW,concat:JW,config:UA,matrix:IW,typed:vj}),GX=Wz({Complex:jq,config:UA,divideScalar:FX,typeOf:SW,typed:vj}),qX=Zz({DenseMatrix:hj,divideScalar:FX,equalScalar:zj,matrix:IW,multiplyScalar:oW,subtractScalar:_W,typed:vj}),jX=Qz({flatten:jj,matrix:IW,size:vX,typed:vj}),WX=Jz({config:UA,isNaN:RW,larger:VX,numeric:dX,typed:vj}),XX=$z({config:UA,isNaN:RW,numeric:dX,smaller:yX,typed:vj}),YX=Az({DenseMatrix:hj,concat:JW,config:UA,equalScalar:zj,matrix:IW,round:gX,typed:vj,zeros:YW}),ZX=tH({Complex:jq,config:UA,divideScalar:FX,typed:vj}),KX=nH({DenseMatrix:hj,concat:JW,equalScalar:zj,matrix:IW,typed:vj}),QX=iH({compare:TX,isNaN:RW,isNumeric:oX,typed:vj}),JX=aH({addScalar:Sj,complex:Oj,conj:Ij,divideScalar:FX,equal:rX,identity:aX,isZero:eW,matrix:IW,multiplyScalar:oW,sign:mW,sqrt:GW,subtractScalar:_W,typed:vj,unaryMinus:bX,zeros:YW}),$X=sH({DenseMatrix:hj,concat:JW,equalScalar:zj,matrix:IW,typed:vj,zeros:YW}),eY=cH({DenseMatrix:hj,SparseMatrix:vW,concat:JW,config:UA,matrix:IW,typed:vj}),tY=dH({add:SX,matrix:IW,typed:vj,zeros:YW}),nY=yH({DenseMatrix:hj,concat:JW,equalScalar:zj,matrix:IW,subtractScalar:_W,typed:vj,unaryMinus:bX}),rY=xH({add:SX,matrix:IW,typed:vj}),iY=_H({DenseMatrix:hj,divideScalar:FX,equalScalar:zj,matrix:IW,multiplyScalar:oW,subtractScalar:_W,typed:vj}),aY=SH({addScalar:Sj,combinations:Fj,divideScalar:FX,isInteger:Qj,isNegative:Jj,multiplyScalar:oW,typed:vj}),oY=EH({compare:TX,typed:vj}),sY=AH({addScalar:Sj,combinations:Fj,isInteger:Qj,isNegative:Jj,isPositive:$j,larger:VX,typed:vj}),lY=NH({matrix:IW,number:lW,subtract:nY,typed:vj}),cY=PH({abs:xj,addScalar:Sj,deepEqual:PX,divideScalar:FX,multiplyScalar:oW,sqrt:GW,subtractScalar:_W,typed:vj}),uY=FH({addScalar:Sj,conj:Ij,multiplyScalar:oW,size:vX,typed:vj}),hY=OH({larger:VX,smaller:yX}),dY=BH({Index:HX,typed:vj}),fY=LH({BigNumber:qq,add:SX,config:UA,equal:rX,isInteger:Qj,mod:YX,smaller:yX,typed:vj,xgcd:XW}),pY=UH({concat:JW,equalScalar:zj,matrix:IW,typed:vj}),mY=HH({Complex:jq,config:UA,divideScalar:FX,log:GX,typed:vj}),gY=GH({DenseMatrix:hj,divideScalar:FX,equalScalar:zj,matrix:IW,multiplyScalar:oW,subtractScalar:_W,typed:vj}),vY=jH({flatten:jj,matrix:IW,size:vX,typed:vj}),yY=XH({addScalar:Sj,dot:uY,equalScalar:zj,matrix:IW,multiplyScalar:oW,typed:vj}),xY=ZH({bignumber:CW,matrix:IW,add:SX,config:UA,isPositive:$j,larger:VX,largerEq:lX,smaller:yX,smallerEq:eY,typed:vj}),bY=KH({Index:HX,matrix:IW,range:xY,typed:vj}),_Y=JH({DenseMatrix:hj,Index:HX,compareNatural:oY,size:vX,subset:tY,typed:vj}),wY=eV({DenseMatrix:hj,Index:HX,compareNatural:oY,size:vX,subset:tY,typed:vj}),SY=nV({Index:HX,compareNatural:oY,size:vX,subset:tY,typed:vj}),MY=iV({Index:HX,compareNatural:oY,size:vX,subset:tY,typed:vj}),DY=vV({SparseMatrix:vW,abs:xj,add:SX,divideScalar:FX,larger:VX,largerEq:lX,multiply:yY,subtract:nY,transpose:WW,typed:vj}),EY=xV({compare:TX,compareNatural:oY,matrix:IW,typed:vj}),CY=_V({config:UA,numeric:dX,typed:vj}),AY=SV({DenseMatrix:hj,divideScalar:FX,equalScalar:zj,matrix:IW,multiplyScalar:oW,subtractScalar:_W,typed:vj}),TY=DV({Complex:jq,add:SX,multiply:yY,number:lW,typed:vj}),NY=EV({concat:JW,equalScalar:zj,matrix:IW,not:sW,typed:vj,zeros:YW}),RY=RV({DenseMatrix:hj,config:UA,equalScalar:zj,matrix:IW,round:gX,typed:vj,zeros:YW}),PY=FV({Index:HX,matrix:IW,range:xY,typed:vj}),FY=IV({matrix:IW,multiply:yY,subtract:nY,typed:vj}),OY=BV({divideScalar:FX,isZero:eW,matrix:IW,multiply:yY,subtractScalar:_W,typed:vj,unaryMinus:bX}),IY=zV({Complex:jq,DenseMatrix:hj,ceil:RY,equalScalar:zj,floor:BX,matrix:IW,typed:vj,zeros:YW}),BY=HV({abs:xj,addScalar:Sj,det:OY,divideScalar:FX,identity:aX,matrix:IW,multiply:yY,typed:vj,unaryMinus:bX}),kY=GV({Complex:jq,add:SX,ctranspose:eX,deepEqual:PX,divideScalar:FX,dot:uY,dotDivide:OX,equal:rX,inv:BY,matrix:IW,multiply:yY,typed:vj}),LY=qV({Complex:jq,config:UA,fraction:iX,identity:aX,inv:BY,matrix:IW,multiply:yY,number:lW,typed:vj}),UY=WV({DenseMatrix:hj,Index:HX,compareNatural:oY,size:vX,subset:tY,typed:vj}),zY=YV({Index:HX,compareNatural:oY,size:vX,subset:tY,typed:vj}),HY=KV({Index:HX,concat:JW,setDifference:UY,size:vX,subset:tY,typed:vj}),VY=QV({FibonacciHeap:hY,addScalar:Sj,equalScalar:zj}),GY=$V({abs:xj,add:SX,identity:aX,inv:BY,map:aW,max:WX,multiply:yY,size:vX,sqrt:GW,subtract:nY,typed:vj}),qY=eG({add:SX,config:UA,numeric:dX,typed:vj}),jY=iG({BigNumber:qq,Complex:jq,Fraction:Zq,abs:xj,addScalar:Sj,config:UA,divideScalar:FX,equal:rX,fix:IY,format:Xj,isNumeric:oX,multiplyScalar:oW,number:lW,pow:LY,round:gX,subtractScalar:_W}),WY=GR({BigNumber:qq,Unit:jY,config:UA}),XY=MP({BigNumber:qq,Unit:jY,config:UA}),YY=dP({BigNumber:qq,Unit:jY,config:UA}),ZY=WR({BigNumber:qq,Unit:jY,config:UA}),KY=pP({BigNumber:qq,Unit:jY,config:UA}),QY=XR({BigNumber:qq,Unit:jY,config:UA}),JY=qR({BigNumber:qq,Unit:jY,config:UA}),$Y=oG({add:SX,typed:vj,unaryPlus:CY}),eZ=aP({BigNumber:qq,Unit:jY,config:UA}),tZ=lG({DenseMatrix:hj,SparseMatrix:vW,concat:JW,equalScalar:zj,matrix:IW,pow:LY,typed:vj}),nZ=VR({BigNumber:qq,Unit:jY,config:UA}),rZ=jR({BigNumber:qq,Unit:jY,config:UA}),iZ=uG({abs:xj,add:SX,identity:aX,inv:BY,multiply:yY,typed:vj}),aZ=mP({BigNumber:qq,Unit:jY,config:UA}),oZ=hG({addScalar:Sj,ceil:RY,conj:Ij,divideScalar:FX,dotDivide:OX,exp:Vj,i:Kq,log2:iW,matrix:IW,multiplyScalar:oW,pow:LY,tau:lj,typed:vj}),sZ=fG({BigNumber:qq,Complex:jq,config:UA,multiplyScalar:oW,pow:LY,typed:vj}),lZ=LR({BigNumber:qq,Unit:jY,config:UA}),cZ=rP({BigNumber:qq,Unit:jY,config:UA}),uZ=mG({conj:Ij,dotDivide:OX,fft:oZ,typed:vj}),hZ=YR({BigNumber:qq,Unit:jY,config:UA}),dZ=QR({BigNumber:qq,Unit:jY,config:UA}),fZ=vP({BigNumber:qq,Unit:jY,config:UA}),pZ=HR({BigNumber:qq,Unit:jY,config:UA}),mZ=DP({BigNumber:qq,Unit:jY,config:UA}),gZ=xP({BigNumber:qq,Unit:jY,config:UA}),vZ=oP({BigNumber:qq,Unit:jY,config:UA}),yZ=KR({BigNumber:qq,Unit:jY,config:UA}),xZ=RP({BigNumber:qq,Unit:jY,config:UA}),bZ=AP({BigNumber:qq,Unit:jY,config:UA}),_Z=PP({BigNumber:qq,Unit:jY,config:UA}),wZ=iP({BigNumber:qq,Unit:jY,config:UA}),SZ=sP({BigNumber:qq,Unit:jY,config:UA}),MZ=zR({BigNumber:qq,Unit:jY,config:UA}),DZ=lP({BigNumber:qq,Unit:jY,config:UA}),EZ=wP({BigNumber:qq,Unit:jY,config:UA}),CZ=vG({compareNatural:oY,typed:vj}),AZ=kR({BigNumber:qq,Unit:jY,config:UA}),TZ=SP({BigNumber:qq,Unit:jY,config:UA}),NZ=cP({BigNumber:qq,Unit:jY,config:UA}),RZ=fP({BigNumber:qq,Unit:jY,config:UA}),PZ=JR({BigNumber:qq,Unit:jY,config:UA}),FZ=xG({Unit:jY,typed:vj}),OZ=bG({divideScalar:FX,equalScalar:zj,inv:BY,matrix:IW,multiply:yY,typed:vj}),IZ=eP({BigNumber:qq,Unit:jY,config:UA}),BZ=wG({gamma:sZ,typed:vj}),kZ=gP({BigNumber:qq,Unit:jY,config:UA}),LZ=CP({BigNumber:qq,Unit:jY,config:UA}),UZ=SG({abs:xj,add:SX,addScalar:Sj,config:UA,divideScalar:FX,equalScalar:zj,flatten:jj,isNumeric:oX,isZero:eW,matrix:IW,multiply:yY,multiplyScalar:oW,smaller:yX,subtract:nY,typed:vj}),zZ=MG({DenseMatrix:hj,Spa:VY,SparseMatrix:vW,abs:xj,addScalar:Sj,divideScalar:FX,equalScalar:zj,larger:VX,matrix:IW,multiplyScalar:oW,subtractScalar:_W,typed:vj,unaryMinus:bX}),HZ=ZR({BigNumber:qq,Unit:jY,config:UA}),VZ=EP({BigNumber:qq,Unit:jY,config:UA}),GZ=EG({add:SX,divide:OZ,factorial:BZ,isInteger:Qj,isPositive:$j,multiply:yY,typed:vj}),qZ=AG({factorial:BZ,typed:vj}),jZ=TP({BigNumber:qq,Unit:jY,config:UA}),WZ=RG({add:SX,cbrt:AX,divide:OZ,equalScalar:zj,im:Kj,isZero:eW,multiply:yY,re:fW,sqrt:GW,subtract:nY,typeOf:SW,typed:vj,unaryMinus:bX}),XZ=FG({DenseMatrix:hj,Index:HX,compareNatural:oY,size:vX,subset:tY,typed:vj}),YZ=IG({abs:xj,add:SX,bignumber:CW,divide:OZ,isNegative:Jj,isPositive:$j,larger:VX,map:aW,matrix:IW,max:WX,multiply:yY,smaller:yX,subtract:nY,typed:vj,unaryMinus:bX}),ZZ=kG({bignumber:CW,addScalar:Sj,combinations:Fj,divideScalar:FX,factorial:BZ,isInteger:Qj,isNegative:Jj,larger:VX,multiplyScalar:oW,number:lW,pow:LY,subtractScalar:_W,typed:vj}),KZ=UG({Unit:jY,typed:vj}),QZ=HG({addScalar:Sj,isInteger:Qj,isNegative:Jj,stirlingS2:ZZ,typed:vj}),JZ=qG({abs:xj,add:SX,addScalar:Sj,atan:Cj,bignumber:CW,column:PY,complex:Oj,config:UA,cos:Bj,diag:tX,divideScalar:FX,dot:uY,equal:rX,flatten:jj,im:Kj,inv:BY,larger:VX,matrix:IW,matrixFromColumns:jX,multiply:yY,multiplyScalar:oW,number:lW,qr:JX,re:fW,reshape:UW,sin:gW,size:vX,smaller:yX,sqrt:GW,subtract:nY,typed:vj,usolve:iY,usolveAll:AY}),$Z=tP({BigNumber:qq,Unit:jY,config:UA}),eK=yP({BigNumber:qq,Unit:jY,config:UA}),tK=WG({divide:OZ,dotDivide:OX,isNumeric:oX,log:GX,map:aW,matrix:IW,multiply:yY,sum:qY,typed:vj}),nK=KG({DenseMatrix:hj,lsolve:qX,lup:zZ,matrix:IW,slu:DY,typed:vj,usolve:iY}),rK=$G({add:SX,divide:OZ,typed:vj}),iK=bP({BigNumber:qq,Unit:jY,config:UA}),aK=UR({BigNumber:qq,Unit:jY,config:UA}),oK=nq({bignumber:CW,add:SX,compare:TX,divide:OZ,isInteger:Qj,larger:VX,mapSlices:FW,multiply:yY,partitionSelect:QX,smaller:yX,smallerEq:eY,subtract:nY,typed:vj}),sK=aq({Index:HX,concat:JW,setIntersect:XZ,setSymDifference:HY,size:vX,subset:tY,typed:vj}),lK=cq({add:SX,divide:OZ,isNaN:RW,mapSlices:FW,multiply:yY,subtract:nY,typed:vj}),cK=$R({BigNumber:qq,Unit:jY,config:UA}),uK=dq({add:SX,compare:TX,divide:OZ,partitionSelect:QX,typed:vj}),hK=mq({add:SX,divide:OZ,matrix:IW,mean:rK,multiply:yY,pow:LY,sqrt:GW,subtract:nY,sum:qY,typed:vj}),dK=yq({Complex:jq,add:SX,divide:OZ,matrix:IW,multiply:yY,typed:vj}),fK=bq({abs:xj,map:aW,median:uK,subtract:nY,typed:vj}),pK=wq({map:aW,sqrt:GW,typed:vj,variance:lK}),mK=Dq({BigNumber:qq,Complex:jq,add:SX,config:UA,divide:OZ,equal:rX,factorial:BZ,gamma:sZ,isNegative:Jj,multiply:yY,pi:pj,pow:LY,sin:gW,smallerEq:eY,subtract:nY,typed:vj}),gK=Aq({abs:xj,add:SX,conj:Ij,ctranspose:eX,eigs:JZ,equalScalar:zj,larger:VX,matrix:IW,multiply:yY,pow:LY,smaller:yX,sqrt:GW,typed:vj}),vK=Rq({BigNumber:qq,DenseMatrix:hj,SparseMatrix:vW,addScalar:Sj,config:UA,cos:Bj,matrix:IW,multiplyScalar:oW,norm:gK,sin:gW,typed:vj,unaryMinus:bX}),yK=NP({BigNumber:qq,Unit:jY,config:UA}),xK=Oq({identity:aX,matrix:IW,multiply:yY,norm:gK,qr:JX,subtract:nY,typed:vj}),bK=kq({multiply:yY,rotationMatrix:vK,typed:vj}),_K=zq({abs:xj,add:SX,concat:JW,identity:aX,index:dY,lusolve:nK,matrix:IW,matrixFromColumns:jX,multiply:yY,range:xY,schur:xK,subset:tY,subtract:nY,transpose:WW,typed:vj}),wK=Gq({matrix:IW,multiply:yY,sylvester:_K,transpose:WW,typed:vj}),SK=new Set(["end"]),MK=SN("Node",["mathWithTransform"],(e=>{var{mathWithTransform:t}=e;return class{get type(){return"Node"}get isNode(){return!0}evaluate(e){return this.compile().evaluate(e)}compile(){var e=this._compile(t,{}),n={};return{evaluate:function(t){var r=IC(t);return function(e){for(var t of[...SK])if(e.has(t))throw new Error('Scope contains an illegal symbol, "'+t+'" is a reserved keyword')}(r),e(r,n,null)}}}_compile(e,t){throw new Error("Method _compile must be implemented by type "+this.type)}forEach(e){throw new Error("Cannot run forEach on a Node interface")}map(e){throw new Error("Cannot run map on a Node interface")}_ifNode(e){if(!yA(e))throw new TypeError("Callback function must return a Node");return e}traverse(e){e(this,null,null),function e(t,n){t.forEach((function(t,r,i){n(t,r,i),e(t,n)}))}(this,e)}transform(e){return function t(n,r,i){var a=e(n,r,i);return a!==n?a:n.map(t)}(this,null,null)}filter(e){var t=[];return this.traverse((function(n,r,i){e(n,r,i)&&t.push(n)})),t}clone(){throw new Error("Cannot clone a Node interface")}cloneDeep(){return this.map((function(e){return e.cloneDeep()}))}equals(e){return!!e&&(this.type===e.type&&NA(this,e))}toString(e){var t=this._getCustomString(e);return"undefined"!==typeof t?t:this._toString(e)}_toString(){throw new Error("_toString not implemented for "+this.type)}toJSON(){throw new Error("Cannot serialize object: toJSON not implemented by "+this.type)}toHTML(e){var t=this._getCustomString(e);return"undefined"!==typeof t?t:this._toHTML(e)}_toHTML(){throw new Error("_toHTML not implemented for "+this.type)}toTex(e){var t=this._getCustomString(e);return"undefined"!==typeof t?t:this._toTex(e)}_toTex(e){throw new Error("_toTex not implemented for "+this.type)}_getCustomString(e){if(e&&"object"===typeof e)switch(typeof e.handler){case"object":case"undefined":return;case"function":return e.handler(this,e);default:throw new TypeError("Object or function expected as callback")}}getIdentifier(){return this.type}getContent(){return this}}}),{isClass:!0,isNode:!0}),DK="ObjectNode",EK=SN(DK,["Node"],(e=>{var{Node:t}=e;class n extends t{constructor(e){if(super(),this.properties=e||{},e&&("object"!==typeof e||!Object.keys(e).every((function(t){return yA(e[t])}))))throw new TypeError("Object containing Nodes expected")}get type(){return DK}get isObjectNode(){return!0}_compile(e,t){var n={};for(var r in this.properties)if(OA(this.properties,r)){var i=lF(r),a=JSON.parse(i),o=DC(this.properties,r);n[a]=o._compile(e,t)}return function(e,t,r){var i={};for(var a in n)OA(n,a)&&(i[a]=n[a](e,t,r));return i}}forEach(e){for(var t in this.properties)OA(this.properties,t)&&e(this.properties[t],"properties["+lF(t)+"]",this)}map(e){var t={};for(var r in this.properties)OA(this.properties,r)&&(t[r]=this._ifNode(e(this.properties[r],"properties["+lF(r)+"]",this)));return new n(t)}clone(){var e={};for(var t in this.properties)OA(this.properties,t)&&(e[t]=this.properties[t]);return new n(e)}_toString(e){var t=[];for(var n in this.properties)OA(this.properties,n)&&t.push(lF(n)+": "+this.properties[n].toString(e));return"{"+t.join(", ")+"}"}toJSON(){return{mathjs:DK,properties:this.properties}}static fromJSON(e){return new n(e.properties)}_toHTML(e){var t=[];for(var n in this.properties)OA(this.properties,n)&&t.push('<span class="math-symbol math-property">'+uF(n)+'</span><span class="math-operator math-assignment-operator math-property-assignment-operator math-binary-operator">:</span>'+this.properties[n].toHTML(e));return'<span class="math-parenthesis math-curly-parenthesis">{</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-curly-parenthesis">}</span>'}_toTex(e){var t=[];for(var n in this.properties)OA(this.properties,n)&&t.push("\\mathbf{"+n+":} & "+this.properties[n].toTex(e)+"\\\\");return"\\left\\{\\begin{array}{ll}"+t.join("\n")+"\\end{array}\\right\\}"}}return(0,tG.A)(n,"name",DK),n}),{isClass:!0,isNode:!0});function CK(e,t){return new PC(e,new RC(t),new Set(Object.keys(t)))}var AK=[{AssignmentNode:{},FunctionAssignmentNode:{}},{ConditionalNode:{latexLeftParens:!1,latexRightParens:!1,latexParens:!1}},{"OperatorNode:or":{op:"or",associativity:"left",associativeWith:[]}},{"OperatorNode:xor":{op:"xor",associativity:"left",associativeWith:[]}},{"OperatorNode:and":{op:"and",associativity:"left",associativeWith:[]}},{"OperatorNode:bitOr":{op:"|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitXor":{op:"^|",associativity:"left",associativeWith:[]}},{"OperatorNode:bitAnd":{op:"&",associativity:"left",associativeWith:[]}},{"OperatorNode:equal":{op:"==",associativity:"left",associativeWith:[]},"OperatorNode:unequal":{op:"!=",associativity:"left",associativeWith:[]},"OperatorNode:smaller":{op:"<",associativity:"left",associativeWith:[]},"OperatorNode:larger":{op:">",associativity:"left",associativeWith:[]},"OperatorNode:smallerEq":{op:"<=",associativity:"left",associativeWith:[]},"OperatorNode:largerEq":{op:">=",associativity:"left",associativeWith:[]},RelationalNode:{associativity:"left",associativeWith:[]}},{"OperatorNode:leftShift":{op:"<<",associativity:"left",associativeWith:[]},"OperatorNode:rightArithShift":{op:">>",associativity:"left",associativeWith:[]},"OperatorNode:rightLogShift":{op:">>>",associativity:"left",associativeWith:[]}},{"OperatorNode:to":{op:"to",associativity:"left",associativeWith:[]}},{RangeNode:{}},{"OperatorNode:add":{op:"+",associativity:"left",associativeWith:["OperatorNode:add","OperatorNode:subtract"]},"OperatorNode:subtract":{op:"-",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{op:"*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]},"OperatorNode:divide":{op:"/",associativity:"left",associativeWith:[],latexLeftParens:!1,latexRightParens:!1,latexParens:!1},"OperatorNode:dotMultiply":{op:".*",associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","OperatorNode:dotMultiply","OperatorNode:doDivide"]},"OperatorNode:dotDivide":{op:"./",associativity:"left",associativeWith:[]},"OperatorNode:mod":{op:"mod",associativity:"left",associativeWith:[]}},{"OperatorNode:multiply":{associativity:"left",associativeWith:["OperatorNode:multiply","OperatorNode:divide","Operator:dotMultiply","Operator:dotDivide"]}},{"OperatorNode:unaryPlus":{op:"+",associativity:"right"},"OperatorNode:unaryMinus":{op:"-",associativity:"right"},"OperatorNode:bitNot":{op:"~",associativity:"right"},"OperatorNode:not":{op:"not",associativity:"right"}},{"OperatorNode:pow":{op:"^",associativity:"right",associativeWith:[],latexRightParens:!1},"OperatorNode:dotPow":{op:".^",associativity:"right",associativeWith:[]}},{"OperatorNode:factorial":{op:"!",associativity:"left"}},{"OperatorNode:ctranspose":{op:"'",associativity:"left"}}];function TK(e,t){if(!t||"auto"!==t)return e;for(var n=e;_A(n);)n=n.content;return n}function NK(e,t,n,r){var i=e;"keep"!==t&&(i=e.getContent());for(var a=i.getIdentifier(),o=null,s=0;s<AK.length;s++)if(a in AK[s]){o=s;break}if("OperatorNode:multiply"===a&&i.implicit&&"show"!==n){var l=TK(i.args[0],t);fA(l)&&r&&"OperatorNode:divide"===r.getIdentifier()&&pA(TK(r.args[0],t))||"OperatorNode:divide"===l.getIdentifier()&&pA(TK(l.args[0],t))&&fA(TK(l.args[1]))||(o+=1)}return o}function RK(e,t){var n=e;"keep"!==t&&(n=e.getContent());var r=n.getIdentifier(),i=NK(n,t);if(null===i)return null;var a=AK[i][r];if(OA(a,"associativity")){if("left"===a.associativity)return"left";if("right"===a.associativity)return"right";throw Error("'"+r+"' has the invalid associativity '"+a.associativity+"'.")}return null}function PK(e,t,n){var r="keep"!==n?e.getContent():e,i="keep"!==n?e.getContent():t,a=r.getIdentifier(),o=i.getIdentifier(),s=NK(r,n);if(null===s)return null;var l=AK[s][a];if(OA(l,"associativeWith")&&l.associativeWith instanceof Array){for(var c=0;c<l.associativeWith.length;c++)if(l.associativeWith[c]===o)return!0;return!1}return null}var FK=n(1147),OK={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},IK={transpose:"^\\top",ctranspose:"^H",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"\\~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},BK={abs:{1:"\\left|${args[0]}\\right|"},add:{2:"\\left(${args[0]}".concat(IK.add,"${args[1]}\\right)")},cbrt:{1:"\\sqrt[3]{${args[0]}}"},ceil:{1:"\\left\\lceil${args[0]}\\right\\rceil"},cube:{1:"\\left(${args[0]}\\right)^3"},divide:{2:"\\frac{${args[0]}}{${args[1]}}"},dotDivide:{2:"\\left(${args[0]}".concat(IK.dotDivide,"${args[1]}\\right)")},dotMultiply:{2:"\\left(${args[0]}".concat(IK.dotMultiply,"${args[1]}\\right)")},dotPow:{2:"\\left(${args[0]}".concat(IK.dotPow,"${args[1]}\\right)")},exp:{1:"\\exp\\left(${args[0]}\\right)"},expm1:"\\left(e".concat(IK.pow,"{${args[0]}}-1\\right)"),fix:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},floor:{1:"\\left\\lfloor${args[0]}\\right\\rfloor"},fraction:{2:"\\frac{${args[0]}}{${args[1]}}"},gcd:"\\gcd\\left(${args}\\right)",hypot:"\\hypot\\left(${args}\\right)",log:{1:"\\ln\\left(${args[0]}\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}\\right)"},log10:{1:"\\log_{10}\\left(${args[0]}\\right)"},log1p:{1:"\\ln\\left(${args[0]}+1\\right)",2:"\\log_{${args[1]}}\\left(${args[0]}+1\\right)"},log2:"\\log_{2}\\left(${args[0]}\\right)",mod:{2:"\\left(${args[0]}".concat(IK.mod,"${args[1]}\\right)")},multiply:{2:"\\left(${args[0]}".concat(IK.multiply,"${args[1]}\\right)")},norm:{1:"\\left\\|${args[0]}\\right\\|",2:void 0},nthRoot:{2:"\\sqrt[${args[1]}]{${args[0]}}"},nthRoots:{2:"\\{y : y^${args[1]} = {${args[0]}}\\}"},pow:{2:"\\left(${args[0]}\\right)".concat(IK.pow,"{${args[1]}}")},round:{1:"\\left\\lfloor${args[0]}\\right\\rceil",2:void 0},sign:{1:"\\mathrm{${name}}\\left(${args[0]}\\right)"},sqrt:{1:"\\sqrt{${args[0]}}"},square:{1:"\\left(${args[0]}\\right)^2"},subtract:{2:"\\left(${args[0]}".concat(IK.subtract,"${args[1]}\\right)")},unaryMinus:{1:"".concat(IK.unaryMinus,"\\left(${args[0]}\\right)")},unaryPlus:{1:"".concat(IK.unaryPlus,"\\left(${args[0]}\\right)")},bitAnd:{2:"\\left(${args[0]}".concat(IK.bitAnd,"${args[1]}\\right)")},bitNot:{1:IK.bitNot+"\\left(${args[0]}\\right)"},bitOr:{2:"\\left(${args[0]}".concat(IK.bitOr,"${args[1]}\\right)")},bitXor:{2:"\\left(${args[0]}".concat(IK.bitXor,"${args[1]}\\right)")},leftShift:{2:"\\left(${args[0]}".concat(IK.leftShift,"${args[1]}\\right)")},rightArithShift:{2:"\\left(${args[0]}".concat(IK.rightArithShift,"${args[1]}\\right)")},rightLogShift:{2:"\\left(${args[0]}".concat(IK.rightLogShift,"${args[1]}\\right)")},bellNumbers:{1:"\\mathrm{B}_{${args[0]}}"},catalan:{1:"\\mathrm{C}_{${args[0]}}"},stirlingS2:{2:"\\mathrm{S}\\left(${args}\\right)"},arg:{1:"\\arg\\left(${args[0]}\\right)"},conj:{1:"\\left(${args[0]}\\right)^*"},im:{1:"\\Im\\left\\lbrace${args[0]}\\right\\rbrace"},re:{1:"\\Re\\left\\lbrace${args[0]}\\right\\rbrace"},and:{2:"\\left(${args[0]}".concat(IK.and,"${args[1]}\\right)")},not:{1:IK.not+"\\left(${args[0]}\\right)"},or:{2:"\\left(${args[0]}".concat(IK.or,"${args[1]}\\right)")},xor:{2:"\\left(${args[0]}".concat(IK.xor,"${args[1]}\\right)")},cross:{2:"\\left(${args[0]}\\right)\\times\\left(${args[1]}\\right)"},ctranspose:{1:"\\left(${args[0]}\\right)".concat(IK.ctranspose)},det:{1:"\\det\\left(${args[0]}\\right)"},dot:{2:"\\left(${args[0]}\\cdot${args[1]}\\right)"},expm:{1:"\\exp\\left(${args[0]}\\right)"},inv:{1:"\\left(${args[0]}\\right)^{-1}"},pinv:{1:"\\left(${args[0]}\\right)^{+}"},sqrtm:{1:"{${args[0]}}".concat(IK.pow,"{\\frac{1}{2}}")},trace:{1:"\\mathrm{tr}\\left(${args[0]}\\right)"},transpose:{1:"\\left(${args[0]}\\right)".concat(IK.transpose)},combinations:{2:"\\binom{${args[0]}}{${args[1]}}"},combinationsWithRep:{2:"\\left(\\!\\!{\\binom{${args[0]}}{${args[1]}}}\\!\\!\\right)"},factorial:{1:"\\left(${args[0]}\\right)".concat(IK.factorial)},gamma:{1:"\\Gamma\\left(${args[0]}\\right)"},lgamma:{1:"\\ln\\Gamma\\left(${args[0]}\\right)"},equal:{2:"\\left(${args[0]}".concat(IK.equal,"${args[1]}\\right)")},larger:{2:"\\left(${args[0]}".concat(IK.larger,"${args[1]}\\right)")},largerEq:{2:"\\left(${args[0]}".concat(IK.largerEq,"${args[1]}\\right)")},smaller:{2:"\\left(${args[0]}".concat(IK.smaller,"${args[1]}\\right)")},smallerEq:{2:"\\left(${args[0]}".concat(IK.smallerEq,"${args[1]}\\right)")},unequal:{2:"\\left(${args[0]}".concat(IK.unequal,"${args[1]}\\right)")},erf:{1:"erf\\left(${args[0]}\\right)"},max:"\\max\\left(${args}\\right)",min:"\\min\\left(${args}\\right)",variance:"\\mathrm{Var}\\left(${args}\\right)",acos:{1:"\\cos^{-1}\\left(${args[0]}\\right)"},acosh:{1:"\\cosh^{-1}\\left(${args[0]}\\right)"},acot:{1:"\\cot^{-1}\\left(${args[0]}\\right)"},acoth:{1:"\\coth^{-1}\\left(${args[0]}\\right)"},acsc:{1:"\\csc^{-1}\\left(${args[0]}\\right)"},acsch:{1:"\\mathrm{csch}^{-1}\\left(${args[0]}\\right)"},asec:{1:"\\sec^{-1}\\left(${args[0]}\\right)"},asech:{1:"\\mathrm{sech}^{-1}\\left(${args[0]}\\right)"},asin:{1:"\\sin^{-1}\\left(${args[0]}\\right)"},asinh:{1:"\\sinh^{-1}\\left(${args[0]}\\right)"},atan:{1:"\\tan^{-1}\\left(${args[0]}\\right)"},atan2:{2:"\\mathrm{atan2}\\left(${args}\\right)"},atanh:{1:"\\tanh^{-1}\\left(${args[0]}\\right)"},cos:{1:"\\cos\\left(${args[0]}\\right)"},cosh:{1:"\\cosh\\left(${args[0]}\\right)"},cot:{1:"\\cot\\left(${args[0]}\\right)"},coth:{1:"\\coth\\left(${args[0]}\\right)"},csc:{1:"\\csc\\left(${args[0]}\\right)"},csch:{1:"\\mathrm{csch}\\left(${args[0]}\\right)"},sec:{1:"\\sec\\left(${args[0]}\\right)"},sech:{1:"\\mathrm{sech}\\left(${args[0]}\\right)"},sin:{1:"\\sin\\left(${args[0]}\\right)"},sinh:{1:"\\sinh\\left(${args[0]}\\right)"},tan:{1:"\\tan\\left(${args[0]}\\right)"},tanh:{1:"\\tanh\\left(${args[0]}\\right)"},to:{2:"\\left(${args[0]}".concat(IK.to,"${args[1]}\\right)")},numeric:function(e,t){return e.args[0].toTex()},number:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"},string:{0:'\\mathtt{""}',1:"\\mathrm{string}\\left(${args[0]}\\right)"},bignumber:{0:"0",1:"\\left(${args[0]}\\right)"},bigint:{0:"0",1:"\\left(${args[0]}\\right)"},complex:{0:"0",1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)+".concat(OK.i,"\\cdot\\left(${args[1]}\\right)\\right)")},matrix:{0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},sparse:{0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},unit:{1:"\\left(${args[0]}\\right)",2:"\\left(\\left(${args[0]}\\right)${args[1]}\\right)"}},kK={deg:"^\\circ"};function LK(e){return FK(e,{preserveFormatting:!0})}function UK(e,t){return(t="undefined"!==typeof t&&t)?OA(kK,e)?kK[e]:"\\mathrm{"+LK(e)+"}":OA(OK,e)?OK[e]:LK(e)}var zK="OperatorNode",HK=SN(zK,["Node"],(e=>{var{Node:t}=e;function n(e,t){var r=e;if("auto"===t)for(;_A(r);)r=r.content;return!!fA(r)||!!bA(r)&&n(r.args[0],t)}function r(e,t,r,i,a){var o,s=NK(e,t,r),l=RK(e,t);if("all"===t||i.length>2&&"OperatorNode:add"!==e.getIdentifier()&&"OperatorNode:multiply"!==e.getIdentifier())return i.map((function(e){switch(e.getContent().type){case"ArrayNode":case"ConstantNode":case"SymbolNode":case"ParenthesisNode":return!1;default:return!0}}));switch(i.length){case 0:o=[];break;case 1:var c=NK(i[0],t,r,e);if(a&&null!==c){var u,h;if("keep"===t?(u=i[0].getIdentifier(),h=e.getIdentifier()):(u=i[0].getContent().getIdentifier(),h=e.getContent().getIdentifier()),!1===AK[s][h].latexLeftParens){o=[!1];break}if(!1===AK[c][u].latexParens){o=[!1];break}}if(null===c){o=[!1];break}if(c<=s){o=[!0];break}o=[!1];break;case 2:var d,f,p=NK(i[0],t,r,e),m=PK(e,i[0],t);d=null!==p&&(p===s&&"right"===l&&!m||p<s);var g,v,y,x=NK(i[1],t,r,e),b=PK(e,i[1],t);if(f=null!==x&&(x===s&&"left"===l&&!b||x<s),a)"keep"===t?(g=e.getIdentifier(),v=e.args[0].getIdentifier(),y=e.args[1].getIdentifier()):(g=e.getContent().getIdentifier(),v=e.args[0].getContent().getIdentifier(),y=e.args[1].getContent().getIdentifier()),null!==p&&(!1===AK[s][g].latexLeftParens&&(d=!1),!1===AK[p][v].latexParens&&(d=!1)),null!==x&&(!1===AK[s][g].latexRightParens&&(f=!1),!1===AK[x][y].latexParens&&(f=!1));o=[d,f];break;default:"OperatorNode:add"!==e.getIdentifier()&&"OperatorNode:multiply"!==e.getIdentifier()||(o=i.map((function(n){var i=NK(n,t,r,e),a=PK(e,n,t),o=RK(n,t);return null!==i&&(s===i&&l===o&&!a||i<s)})))}if(i.length>=2&&"OperatorNode:multiply"===e.getIdentifier()&&e.implicit&&"all"!==t&&"hide"===r)for(var _=1;_<o.length;++_)!n(i[_],t)||o[_-1]||"keep"===t&&_A(i[_-1])||(o[_]=!0);return o}class i extends t{constructor(e,t,n,r,i){if(super(),"string"!==typeof e)throw new TypeError('string expected for parameter "op"');if("string"!==typeof t)throw new TypeError('string expected for parameter "fn"');if(!Array.isArray(n)||!n.every(yA))throw new TypeError('Array containing Nodes expected for parameter "args"');this.implicit=!0===r,this.isPercentage=!0===i,this.op=e,this.fn=t,this.args=n||[]}get type(){return zK}get isOperatorNode(){return!0}_compile(e,t){if("string"!==typeof this.fn||!AC(e,this.fn))throw e[this.fn]?new Error('No access to function "'+this.fn+'"'):new Error("Function "+this.fn+' missing in provided namespace "math"');var n=DC(e,this.fn),r=RF(this.args,(function(n){return n._compile(e,t)}));if("function"===typeof n&&!0===n.rawArgs){var i=this.args;return function(t,r,a){return n(i,e,CK(t,r))}}if(1===r.length){var a=r[0];return function(e,t,r){return n(a(e,t,r))}}if(2===r.length){var o=r[0],s=r[1];return function(e,t,r){return n(o(e,t,r),s(e,t,r))}}return function(e,t,i){return n.apply(null,RF(r,(function(n){return n(e,t,i)})))}}forEach(e){for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)}map(e){for(var t=[],n=0;n<this.args.length;n++)t[n]=this._ifNode(e(this.args[n],"args["+n+"]",this));return new i(this.op,this.fn,t,this.implicit,this.isPercentage)}clone(){return new i(this.op,this.fn,this.args.slice(0),this.implicit,this.isPercentage)}isUnary(){return 1===this.args.length}isBinary(){return 2===this.args.length}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=e&&e.implicit?e.implicit:"hide",i=this.args,a=r(this,t,n,i,!1);if(1===i.length){var o=RK(this,t),s=i[0].toString(e);a[0]&&(s="("+s+")");var l=/[a-zA-Z]+/.test(this.op);return"right"===o?this.op+(l?" ":"")+s:"left"===o?s+(l?" ":"")+this.op:s+this.op}if(2===i.length){var c=i[0].toString(e),u=i[1].toString(e);return a[0]&&(c="("+c+")"),a[1]&&(u="("+u+")"),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?c+" "+u:c+" "+this.op+" "+u}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var h=i.map((function(t,n){return t=t.toString(e),a[n]&&(t="("+t+")"),t}));return this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?h.join(" "):h.join(" "+this.op+" ")}return this.fn+"("+this.args.join(", ")+")"}toJSON(){return{mathjs:zK,op:this.op,fn:this.fn,args:this.args,implicit:this.implicit,isPercentage:this.isPercentage}}static fromJSON(e){return new i(e.op,e.fn,e.args,e.implicit,e.isPercentage)}_toHTML(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=e&&e.implicit?e.implicit:"hide",i=this.args,a=r(this,t,n,i,!1);if(1===i.length){var o=RK(this,t),s=i[0].toHTML(e);return a[0]&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),"right"===o?'<span class="math-operator math-unary-operator math-lefthand-unary-operator">'+uF(this.op)+"</span>"+s:s+'<span class="math-operator math-unary-operator math-righthand-unary-operator">'+uF(this.op)+"</span>"}if(2===i.length){var l=i[0].toHTML(e),c=i[1].toHTML(e);return a[0]&&(l='<span class="math-parenthesis math-round-parenthesis">(</span>'+l+'<span class="math-parenthesis math-round-parenthesis">)</span>'),a[1]&&(c='<span class="math-parenthesis math-round-parenthesis">(</span>'+c+'<span class="math-parenthesis math-round-parenthesis">)</span>'),this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?l+'<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'+c:l+'<span class="math-operator math-binary-operator math-explicit-binary-operator">'+uF(this.op)+"</span>"+c}var u=i.map((function(t,n){return t=t.toHTML(e),a[n]&&(t='<span class="math-parenthesis math-round-parenthesis">(</span>'+t+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t}));return i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())?this.implicit&&"OperatorNode:multiply"===this.getIdentifier()&&"hide"===n?u.join('<span class="math-operator math-binary-operator math-implicit-binary-operator"></span>'):u.join('<span class="math-operator math-binary-operator math-explicit-binary-operator">'+uF(this.op)+"</span>"):'<span class="math-function">'+uF(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+u.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}_toTex(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=e&&e.implicit?e.implicit:"hide",i=this.args,a=r(this,t,n,i,!0),o=IK[this.fn];if(o="undefined"===typeof o?this.op:o,1===i.length){var s=RK(this,t),l=i[0].toTex(e);return a[0]&&(l="\\left(".concat(l,"\\right)")),"right"===s?o+l:l+o}if(2===i.length){var c=i[0],u=c.toTex(e);a[0]&&(u="\\left(".concat(u,"\\right)"));var h,d=i[1].toTex(e);switch(a[1]&&(d="\\left(".concat(d,"\\right)")),h="keep"===t?c.getIdentifier():c.getContent().getIdentifier(),this.getIdentifier()){case"OperatorNode:divide":return o+"{"+u+"}{"+d+"}";case"OperatorNode:pow":switch(u="{"+u+"}",d="{"+d+"}",h){case"ConditionalNode":case"OperatorNode:divide":u="\\left(".concat(u,"\\right)")}break;case"OperatorNode:multiply":if(this.implicit&&"hide"===n)return u+"~"+d}return u+o+d}if(i.length>2&&("OperatorNode:add"===this.getIdentifier()||"OperatorNode:multiply"===this.getIdentifier())){var f=i.map((function(t,n){return t=t.toTex(e),a[n]&&(t="\\left(".concat(t,"\\right)")),t}));return"OperatorNode:multiply"===this.getIdentifier()&&this.implicit&&"hide"===n?f.join("~"):f.join(o)}return"\\mathrm{"+this.fn+"}\\left("+i.map((function(t){return t.toTex(e)})).join(",")+"\\right)"}getIdentifier(){return this.type+":"+this.fn}}return(0,tG.A)(i,"name",zK),i}),{isClass:!0,isNode:!0}),VK="ParenthesisNode",GK=SN(VK,["Node"],(e=>{var{Node:t}=e;class n extends t{constructor(e){if(super(),!yA(e))throw new TypeError('Node expected for parameter "content"');this.content=e}get type(){return VK}get isParenthesisNode(){return!0}_compile(e,t){return this.content._compile(e,t)}getContent(){return this.content.getContent()}forEach(e){e(this.content,"content",this)}map(e){var t=e(this.content,"content",this);return new n(t)}clone(){return new n(this.content)}_toString(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"("+this.content.toString(e)+")":this.content.toString(e)}toJSON(){return{mathjs:VK,content:this.content}}static fromJSON(e){return new n(e.content)}_toHTML(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?'<span class="math-parenthesis math-round-parenthesis">(</span>'+this.content.toHTML(e)+'<span class="math-parenthesis math-round-parenthesis">)</span>':this.content.toHTML(e)}_toTex(e){return!e||e&&!e.parenthesis||e&&"keep"===e.parenthesis?"\\left(".concat(this.content.toTex(e),"\\right)"):this.content.toTex(e)}}return(0,tG.A)(n,"name",VK),n}),{isClass:!0,isNode:!0}),qK="RelationalNode",jK=SN(qK,["Node"],(e=>{var{Node:t}=e,n={equal:"==",unequal:"!=",smaller:"<",larger:">",smallerEq:"<=",largerEq:">="};class r extends t{constructor(e,t){if(super(),!Array.isArray(e))throw new TypeError("Parameter conditionals must be an array");if(!Array.isArray(t))throw new TypeError("Parameter params must be an array");if(e.length!==t.length-1)throw new TypeError("Parameter params must contain exactly one more element than parameter conditionals");this.conditionals=e,this.params=t}get type(){return qK}get isRelationalNode(){return!0}_compile(e,t){var n=this,r=this.params.map((n=>n._compile(e,t)));return function(t,i,a){for(var o,s=r[0](t,i,a),l=0;l<n.conditionals.length;l++){if(o=s,s=r[l+1](t,i,a),!DC(e,n.conditionals[l])(o,s))return!1}return!0}}forEach(e){this.params.forEach(((t,n)=>e(t,"params["+n+"]",this)),this)}map(e){return new r(this.conditionals.slice(),this.params.map(((t,n)=>this._ifNode(e(t,"params["+n+"]",this))),this))}clone(){return new r(this.conditionals,this.params)}_toString(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",r=NK(this,t,e&&e.implicit),i=this.params.map((function(n,i){var a=NK(n,t,e&&e.implicit);return"all"===t||null!==a&&a<=r?"("+n.toString(e)+")":n.toString(e)})),a=i[0],o=0;o<this.conditionals.length;o++)a+=" "+n[this.conditionals[o]],a+=" "+i[o+1];return a}toJSON(){return{mathjs:qK,conditionals:this.conditionals,params:this.params}}static fromJSON(e){return new r(e.conditionals,e.params)}_toHTML(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",r=NK(this,t,e&&e.implicit),i=this.params.map((function(n,i){var a=NK(n,t,e&&e.implicit);return"all"===t||null!==a&&a<=r?'<span class="math-parenthesis math-round-parenthesis">(</span>'+n.toHTML(e)+'<span class="math-parenthesis math-round-parenthesis">)</span>':n.toHTML(e)})),a=i[0],o=0;o<this.conditionals.length;o++)a+='<span class="math-operator math-binary-operator math-explicit-binary-operator">'+uF(n[this.conditionals[o]])+"</span>"+i[o+1];return a}_toTex(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",n=NK(this,t,e&&e.implicit),r=this.params.map((function(r,i){var a=NK(r,t,e&&e.implicit);return"all"===t||null!==a&&a<=n?"\\left("+r.toTex(e)+"\right)":r.toTex(e)})),i=r[0],a=0;a<this.conditionals.length;a++)i+=IK[this.conditionals[a]]+r[a+1];return i}}return(0,tG.A)(r,"name",qK),r}),{isClass:!0,isNode:!0}),WK="ArrayNode",XK=SN(WK,["Node"],(e=>{var{Node:t}=e;class n extends t{constructor(e){if(super(),this.items=e||[],!Array.isArray(this.items)||!this.items.every(yA))throw new TypeError("Array containing Nodes expected")}get type(){return WK}get isArrayNode(){return!0}_compile(e,t){var n=RF(this.items,(function(n){return n._compile(e,t)}));if("Array"!==e.config.matrix){var r=e.matrix;return function(e,t,i){return r(RF(n,(function(n){return n(e,t,i)})))}}return function(e,t,r){return RF(n,(function(n){return n(e,t,r)}))}}forEach(e){for(var t=0;t<this.items.length;t++){e(this.items[t],"items["+t+"]",this)}}map(e){for(var t=[],r=0;r<this.items.length;r++)t[r]=this._ifNode(e(this.items[r],"items["+r+"]",this));return new n(t)}clone(){return new n(this.items.slice(0))}_toString(e){var t=this.items.map((function(t){return t.toString(e)}));return"["+t.join(", ")+"]"}toJSON(){return{mathjs:WK,items:this.items}}static fromJSON(e){return new n(e.items)}_toHTML(e){var t=this.items.map((function(t){return t.toHTML(e)}));return'<span class="math-parenthesis math-square-parenthesis">[</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(e){return function t(n,r){var i=n.some(cA)&&!n.every(cA),a=r||i,o=a?"&":"\\\\",s=n.map((function(n){return n.items?t(n.items,!r):n.toTex(e)})).join(o);return i||!a||a&&!r?"\\begin{bmatrix}"+s+"\\end{bmatrix}":s}(this.items,!1)}}return(0,tG.A)(n,"name",WK),n}),{isClass:!0,isNode:!0}),YK="BlockNode",ZK=SN(YK,["ResultSet","Node"],(e=>{var{ResultSet:t,Node:n}=e;class r extends n{constructor(e){if(super(),!Array.isArray(e))throw new Error("Array expected");this.blocks=e.map((function(e){var t=e&&e.node,n=!e||void 0===e.visible||e.visible;if(!yA(t))throw new TypeError('Property "node" must be a Node');if("boolean"!==typeof n)throw new TypeError('Property "visible" must be a boolean');return{node:t,visible:n}}))}get type(){return YK}get isBlockNode(){return!0}_compile(e,n){var r=RF(this.blocks,(function(t){return{evaluate:t.node._compile(e,n),visible:t.visible}}));return function(e,n,i){var a=[];return PF(r,(function(t){var r=t.evaluate(e,n,i);t.visible&&a.push(r)})),new t(a)}}forEach(e){for(var t=0;t<this.blocks.length;t++)e(this.blocks[t].node,"blocks["+t+"].node",this)}map(e){for(var t=[],n=0;n<this.blocks.length;n++){var i=this.blocks[n],a=this._ifNode(e(i.node,"blocks["+n+"].node",this));t[n]={node:a,visible:i.visible}}return new r(t)}clone(){var e=this.blocks.map((function(e){return{node:e.node,visible:e.visible}}));return new r(e)}_toString(e){return this.blocks.map((function(t){return t.node.toString(e)+(t.visible?"":";")})).join("\n")}toJSON(){return{mathjs:YK,blocks:this.blocks}}static fromJSON(e){return new r(e.blocks)}_toHTML(e){return this.blocks.map((function(t){return t.node.toHTML(e)+(t.visible?"":'<span class="math-separator">;</span>')})).join('<span class="math-separator"><br /></span>')}_toTex(e){return this.blocks.map((function(t){return t.node.toTex(e)+(t.visible?"":";")})).join("\\;\\;\n")}}return(0,tG.A)(r,"name",YK),r}),{isClass:!0,isNode:!0}),KK="ConditionalNode",QK=SN(KK,["Node"],(e=>{var{Node:t}=e;class n extends t{constructor(e,t,n){if(super(),!yA(e))throw new TypeError("Parameter condition must be a Node");if(!yA(t))throw new TypeError("Parameter trueExpr must be a Node");if(!yA(n))throw new TypeError("Parameter falseExpr must be a Node");this.condition=e,this.trueExpr=t,this.falseExpr=n}get type(){return KK}get isConditionalNode(){return!0}_compile(e,t){var n=this.condition._compile(e,t),r=this.trueExpr._compile(e,t),i=this.falseExpr._compile(e,t);return function(e,t,a){return function(e){if("number"===typeof e||"boolean"===typeof e||"string"===typeof e)return!!e;if(e){if(kC(e))return!e.isZero();if(UC(e))return!(!e.re&&!e.im);if(HC(e))return!!e.value}if(null===e||void 0===e)return!1;throw new TypeError('Unsupported type of condition "'+EA(e)+'"')}(n(e,t,a))?r(e,t,a):i(e,t,a)}}forEach(e){e(this.condition,"condition",this),e(this.trueExpr,"trueExpr",this),e(this.falseExpr,"falseExpr",this)}map(e){return new n(this._ifNode(e(this.condition,"condition",this)),this._ifNode(e(this.trueExpr,"trueExpr",this)),this._ifNode(e(this.falseExpr,"falseExpr",this)))}clone(){return new n(this.condition,this.trueExpr,this.falseExpr)}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=NK(this,t,e&&e.implicit),r=this.condition.toString(e),i=NK(this.condition,t,e&&e.implicit);("all"===t||"OperatorNode"===this.condition.type||null!==i&&i<=n)&&(r="("+r+")");var a=this.trueExpr.toString(e),o=NK(this.trueExpr,t,e&&e.implicit);("all"===t||"OperatorNode"===this.trueExpr.type||null!==o&&o<=n)&&(a="("+a+")");var s=this.falseExpr.toString(e),l=NK(this.falseExpr,t,e&&e.implicit);return("all"===t||"OperatorNode"===this.falseExpr.type||null!==l&&l<=n)&&(s="("+s+")"),r+" ? "+a+" : "+s}toJSON(){return{mathjs:KK,condition:this.condition,trueExpr:this.trueExpr,falseExpr:this.falseExpr}}static fromJSON(e){return new n(e.condition,e.trueExpr,e.falseExpr)}_toHTML(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=NK(this,t,e&&e.implicit),r=this.condition.toHTML(e),i=NK(this.condition,t,e&&e.implicit);("all"===t||"OperatorNode"===this.condition.type||null!==i&&i<=n)&&(r='<span class="math-parenthesis math-round-parenthesis">(</span>'+r+'<span class="math-parenthesis math-round-parenthesis">)</span>');var a=this.trueExpr.toHTML(e),o=NK(this.trueExpr,t,e&&e.implicit);("all"===t||"OperatorNode"===this.trueExpr.type||null!==o&&o<=n)&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>');var s=this.falseExpr.toHTML(e),l=NK(this.falseExpr,t,e&&e.implicit);return("all"===t||"OperatorNode"===this.falseExpr.type||null!==l&&l<=n)&&(s='<span class="math-parenthesis math-round-parenthesis">(</span>'+s+'<span class="math-parenthesis math-round-parenthesis">)</span>'),r+'<span class="math-operator math-conditional-operator">?</span>'+a+'<span class="math-operator math-conditional-operator">:</span>'+s}_toTex(e){return"\\begin{cases} {"+this.trueExpr.toTex(e)+"}, &\\quad{\\text{if }\\;"+this.condition.toTex(e)+"}\\\\{"+this.falseExpr.toTex(e)+"}, &\\quad{\\text{otherwise}}\\end{cases}"}}return(0,tG.A)(n,"name",KK),n}),{isClass:!0,isNode:!0}),JK="ConstantNode",$K=SN(JK,["Node"],(e=>{var{Node:t}=e;class n extends t{constructor(e){super(),this.value=e}get type(){return JK}get isConstantNode(){return!0}_compile(e,t){var n=this.value;return function(){return n}}forEach(e){}map(e){return this.clone()}clone(){return new n(this.value)}_toString(e){return sF(this.value,e)}_toHTML(e){var t=this._toString(e);switch(EA(this.value)){case"number":case"bigint":case"BigNumber":case"Fraction":return'<span class="math-number">'+t+"</span>";case"string":return'<span class="math-string">'+t+"</span>";case"boolean":return'<span class="math-boolean">'+t+"</span>";case"null":return'<span class="math-null-symbol">'+t+"</span>";case"undefined":return'<span class="math-undefined">'+t+"</span>";default:return'<span class="math-symbol">'+t+"</span>"}}toJSON(){return{mathjs:JK,value:this.value}}static fromJSON(e){return new n(e.value)}_toTex(e){var t=this._toString(e),n=EA(this.value);switch(n){case"string":return"\\mathtt{"+LK(t)+"}";case"number":case"BigNumber":if(!("BigNumber"===n?this.value.isFinite():isFinite(this.value)))return this.value.valueOf()<0?"-\\infty":"\\infty";var r=t.toLowerCase().indexOf("e");return-1!==r?t.substring(0,r)+"\\cdot10^{"+t.substring(r+1)+"}":t;case"bigint":return t.toString();case"Fraction":return this.value.toLatex();default:return t}}}return(0,tG.A)(n,"name",JK),n}),{isClass:!0,isNode:!0}),eQ="RangeNode",tQ=SN(eQ,["Node"],(e=>{var{Node:t}=e;function n(e,t,n){var r=NK(e,t,n),i={},a=NK(e.start,t,n);if(i.start=null!==a&&a<=r||"all"===t,e.step){var o=NK(e.step,t,n);i.step=null!==o&&o<=r||"all"===t}var s=NK(e.end,t,n);return i.end=null!==s&&s<=r||"all"===t,i}class r extends t{constructor(e,t,n){if(super(),!yA(e))throw new TypeError("Node expected");if(!yA(t))throw new TypeError("Node expected");if(n&&!yA(n))throw new TypeError("Node expected");if(arguments.length>3)throw new Error("Too many arguments");this.start=e,this.end=t,this.step=n||null}get type(){return eQ}get isRangeNode(){return!0}needsEnd(){var e=this.filter((function(e){return MA(e)&&"end"===e.name}));return e.length>0}_compile(e,t){var n=e.range,r=this.start._compile(e,t),i=this.end._compile(e,t);if(this.step){var a=this.step._compile(e,t);return function(e,t,o){return n(r(e,t,o),i(e,t,o),a(e,t,o))}}return function(e,t,a){return n(r(e,t,a),i(e,t,a))}}forEach(e){e(this.start,"start",this),e(this.end,"end",this),this.step&&e(this.step,"step",this)}map(e){return new r(this._ifNode(e(this.start,"start",this)),this._ifNode(e(this.end,"end",this)),this.step&&this._ifNode(e(this.step,"step",this)))}clone(){return new r(this.start,this.end,this.step&&this.step)}_toString(e){var t,r=n(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),i=this.start.toString(e);if(r.start&&(i="("+i+")"),t=i,this.step){var a=this.step.toString(e);r.step&&(a="("+a+")"),t+=":"+a}var o=this.end.toString(e);return r.end&&(o="("+o+")"),t+=":"+o}toJSON(){return{mathjs:eQ,start:this.start,end:this.end,step:this.step}}static fromJSON(e){return new r(e.start,e.end,e.step)}_toHTML(e){var t,r=n(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),i=this.start.toHTML(e);if(r.start&&(i='<span class="math-parenthesis math-round-parenthesis">(</span>'+i+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t=i,this.step){var a=this.step.toHTML(e);r.step&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+='<span class="math-operator math-range-operator">:</span>'+a}var o=this.end.toHTML(e);return r.end&&(o='<span class="math-parenthesis math-round-parenthesis">(</span>'+o+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+='<span class="math-operator math-range-operator">:</span>'+o}_toTex(e){var t=n(this,e&&e.parenthesis?e.parenthesis:"keep",e&&e.implicit),r=this.start.toTex(e);if(t.start&&(r="\\left(".concat(r,"\\right)")),this.step){var i=this.step.toTex(e);t.step&&(i="\\left(".concat(i,"\\right)")),r+=":"+i}var a=this.end.toTex(e);return t.end&&(a="\\left(".concat(a,"\\right)")),r+=":"+a}}return(0,tG.A)(r,"name",eQ),r}),{isClass:!0,isNode:!0}),nQ=SN("reviver",["classes"],(e=>{var{classes:t}=e;return function(e,n){var r=t[n&&n.mathjs];return r&&"function"===typeof r.fromJSON?r.fromJSON(n):n}})),rQ=SN("Chain",["?on","math","typed"],(e=>{var{on:t,math:n,typed:r}=e;function i(e){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");DA(e)?this.value=e.value:this.value=e}function a(e,t){FA(i.prototype,e,(function(){var e=t();if("function"===typeof e)return o(e)}))}function o(e){return function(){if(0===arguments.length)return new i(e(this.value));for(var t=[this.value],n=0;n<arguments.length;n++)t[n+1]=arguments[n];if(r.isTypedFunction(e)){var a=r.resolve(e,t);if(1===a.params.length)throw new Error("chain function "+e.name+" cannot match rest parameter between chain value and additional arguments.");return new i(a.implementation.apply(e,t))}return new i(e.apply(e,t))}}i.prototype.type="Chain",i.prototype.isChain=!0,i.prototype.done=function(){return this.value},i.prototype.valueOf=function(){return this.value},i.prototype.toString=function(){return sF(this.value)},i.prototype.toJSON=function(){return{mathjs:"Chain",value:this.value}},i.fromJSON=function(e){return new i(e.value)},i.createProxy=function(e,t){if("string"===typeof e)l=e,"function"===typeof(c=t)&&(i.prototype[l]=o(c));else{var n=function(t){OA(e,t)&&void 0===s[t]&&a(t,(()=>e[t]))};for(var r in e)n(r)}var l,c};var s={expression:!0,docs:!0,type:!0,classes:!0,json:!0,error:!0,isChain:!0};return i.createProxy(n),t&&t("import",(function(e,t,n){n||a(e,t)})),i}),{isClass:!0}),iQ="FunctionAssignmentNode",aQ=SN(iQ,["typed","Node"],(e=>{var{typed:t,Node:n}=e;function r(e,t,n){var r=NK(e,t,n),i=NK(e.expr,t,n);return"all"===t||null!==i&&i<=r}class i extends n{constructor(e,t,n){if(super(),"string"!==typeof e)throw new TypeError('String expected for parameter "name"');if(!Array.isArray(t))throw new TypeError('Array containing strings or objects expected for parameter "params"');if(!yA(n))throw new TypeError('Node expected for parameter "expr"');if(SK.has(e))throw new Error('Illegal function name, "'+e+'" is a reserved keyword');var r=new Set;for(var i of t){var a="string"===typeof i?i:i.name;if(r.has(a))throw new Error('Duplicate parameter name "'.concat(a,'"'));r.add(a)}this.name=e,this.params=t.map((function(e){return e&&e.name||e})),this.types=t.map((function(e){return e&&e.type||"any"})),this.expr=n}get type(){return iQ}get isFunctionAssignmentNode(){return!0}_compile(e,n){var r=Object.create(n);PF(this.params,(function(e){r[e]=!0}));var i=this.expr._compile(e,r),a=this.name,o=this.params,s=IF(this.types,","),l=a+"("+IF(this.params,", ")+")";return function(e,n,r){var c={};c[s]=function(){for(var t=Object.create(n),a=0;a<o.length;a++)t[o[a]]=arguments[a];return i(e,t,r)};var u=t(a,c);return u.syntax=l,e.set(a,u),u}}forEach(e){e(this.expr,"expr",this)}map(e){var t=this._ifNode(e(this.expr,"expr",this));return new i(this.name,this.params.slice(0),t)}clone(){return new i(this.name,this.params.slice(0),this.expr)}_toString(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=this.expr.toString(e);return r(this,t,e&&e.implicit)&&(n="("+n+")"),this.name+"("+this.params.join(", ")+") = "+n}toJSON(){var e=this.types;return{mathjs:iQ,name:this.name,params:this.params.map((function(t,n){return{name:t,type:e[n]}})),expr:this.expr}}static fromJSON(e){return new i(e.name,e.params,e.expr)}_toHTML(e){for(var t=e&&e.parenthesis?e.parenthesis:"keep",n=[],i=0;i<this.params.length;i++)n.push('<span class="math-symbol math-parameter">'+uF(this.params[i])+"</span>");var a=this.expr.toHTML(e);return r(this,t,e&&e.implicit)&&(a='<span class="math-parenthesis math-round-parenthesis">(</span>'+a+'<span class="math-parenthesis math-round-parenthesis">)</span>'),'<span class="math-function">'+uF(this.name)+'</span><span class="math-parenthesis math-round-parenthesis">(</span>'+n.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-round-parenthesis">)</span><span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+a}_toTex(e){var t=e&&e.parenthesis?e.parenthesis:"keep",n=this.expr.toTex(e);return r(this,t,e&&e.implicit)&&(n="\\left(".concat(n,"\\right)")),"\\mathrm{"+this.name+"}\\left("+this.params.map(UK).join(",")+"\\right)="+n}}return(0,tG.A)(i,"name",iQ),i}),{isClass:!0,isNode:!0}),oQ="chain",sQ=SN(oQ,["typed","Chain"],(e=>{var{typed:t,Chain:n}=e;return t(oQ,{"":function(){return new n},any:function(e){return new n(e)}})}));function lQ(e){return e&&e.isIndexError?new pF(e.index+1,e.min+1,void 0!==e.max?e.max+1:void 0):e}function cQ(e){var{subset:t}=e;return function(e,n){try{if(Array.isArray(e))return t(e,n);if(e&&"function"===typeof e.subset)return e.subset(n);if("string"===typeof e)return t(e,n);if("object"===typeof e){if(!n.isObjectProperty())throw new TypeError("Cannot apply a numeric index as object property");return DC(e,n.getObjectProperty())}throw new TypeError("Cannot apply index: unsupported type of object")}catch(r){throw lQ(r)}}}var uQ="AccessorNode",hQ=SN(uQ,["subset","Node"],(e=>{var{subset:t,Node:n}=e,r=cQ({subset:t});function i(e){return!(lA(e)||cA(e)||fA(e)||gA(e)||xA(e)||_A(e)||MA(e))}class a extends n{constructor(e,t){if(super(),!yA(e))throw new TypeError('Node expected for parameter "object"');if(!vA(t))throw new TypeError('IndexNode expected for parameter "index"');this.object=e,this.index=t}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return uQ}get isAccessorNode(){return!0}_compile(e,t){var n=this.object._compile(e,t),i=this.index._compile(e,t);if(this.index.isObjectProperty()){var a=this.index.getObjectProperty();return function(e,t,r){return DC(n(e,t,r),a)}}return function(e,t,a){var o=n(e,t,a),s=i(e,t,o);return r(o,s)}}forEach(e){e(this.object,"object",this),e(this.index,"index",this)}map(e){return new a(this._ifNode(e(this.object,"object",this)),this._ifNode(e(this.index,"index",this)))}clone(){return new a(this.object,this.index)}_toString(e){var t=this.object.toString(e);return i(this.object)&&(t="("+t+")"),t+this.index.toString(e)}_toHTML(e){var t=this.object.toHTML(e);return i(this.object)&&(t='<span class="math-parenthesis math-round-parenthesis">(</span>'+t+'<span class="math-parenthesis math-round-parenthesis">)</span>'),t+this.index.toHTML(e)}_toTex(e){var t=this.object.toTex(e);return i(this.object)&&(t="\\left(' + object + '\\right)"),t+this.index.toTex(e)}toJSON(){return{mathjs:uQ,object:this.object,index:this.index}}static fromJSON(e){return new a(e.object,e.index)}}return(0,tG.A)(a,"name",uQ),a}),{isClass:!0,isNode:!0});var dQ="AssignmentNode",fQ=SN(dQ,["subset","?matrix","Node"],(e=>{var{subset:t,matrix:n,Node:r}=e,i=cQ({subset:t}),a=function(e){var{subset:t,matrix:n}=e;return function(e,r,i){try{if(Array.isArray(e))return n(e).subset(r,i).valueOf().forEach(((t,n)=>{e[n]=t})),e;if(e&&"function"===typeof e.subset)return e.subset(r,i);if("string"===typeof e)return t(e,r,i);if("object"===typeof e){if(!r.isObjectProperty())throw TypeError("Cannot apply a numeric index as object property");return EC(e,r.getObjectProperty(),i),e}throw new TypeError("Cannot apply index: unsupported type of object")}catch(a){throw lQ(a)}}}({subset:t,matrix:n});function o(e,t,n){t||(t="keep");var r=NK(e,t,n),i=NK(e.value,t,n);return"all"===t||null!==i&&i<=r}class s extends r{constructor(e,t,n){if(super(),this.object=e,this.index=n?t:null,this.value=n||t,!MA(e)&&!lA(e))throw new TypeError('SymbolNode or AccessorNode expected as "object"');if(MA(e)&&"end"===e.name)throw new Error('Cannot assign to symbol "end"');if(this.index&&!vA(this.index))throw new TypeError('IndexNode expected as "index"');if(!yA(this.value))throw new TypeError('Node expected as "value"')}get name(){return this.index?this.index.isObjectProperty()?this.index.getObjectProperty():"":this.object.name||""}get type(){return dQ}get isAssignmentNode(){return!0}_compile(e,t){var n=this.object._compile(e,t),r=this.index?this.index._compile(e,t):null,o=this.value._compile(e,t),s=this.object.name;if(this.index){if(this.index.isObjectProperty()){var l=this.index.getObjectProperty();return function(e,t,r){var i=n(e,t,r),a=o(e,t,r);return EC(i,l,a),a}}if(MA(this.object))return function(e,t,i){var l=n(e,t,i),c=o(e,t,i),u=r(e,t,l);return e.set(s,a(l,u,c)),c};var c=this.object.object._compile(e,t);if(this.object.index.isObjectProperty()){var u=this.object.index.getObjectProperty();return function(e,t,n){var i=c(e,t,n),s=DC(i,u),l=r(e,t,s),h=o(e,t,n);return EC(i,u,a(s,l,h)),h}}var h=this.object.index._compile(e,t);return function(e,t,n){var s=c(e,t,n),l=h(e,t,s),u=i(s,l),d=r(e,t,u),f=o(e,t,n);return a(s,l,a(u,d,f)),f}}if(!MA(this.object))throw new TypeError("SymbolNode expected as object");return function(e,t,n){var r=o(e,t,n);return e.set(s,r),r}}forEach(e){e(this.object,"object",this),this.index&&e(this.index,"index",this),e(this.value,"value",this)}map(e){var t=this._ifNode(e(this.object,"object",this)),n=this.index?this._ifNode(e(this.index,"index",this)):null,r=this._ifNode(e(this.value,"value",this));return new s(t,n,r)}clone(){return new s(this.object,this.index,this.value)}_toString(e){var t=this.object.toString(e),n=this.index?this.index.toString(e):"",r=this.value.toString(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(r="("+r+")"),t+n+" = "+r}toJSON(){return{mathjs:dQ,object:this.object,index:this.index,value:this.value}}static fromJSON(e){return new s(e.object,e.index,e.value)}_toHTML(e){var t=this.object.toHTML(e),n=this.index?this.index.toHTML(e):"",r=this.value.toHTML(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(r='<span class="math-paranthesis math-round-parenthesis">(</span>'+r+'<span class="math-paranthesis math-round-parenthesis">)</span>'),t+n+'<span class="math-operator math-assignment-operator math-variable-assignment-operator math-binary-operator">=</span>'+r}_toTex(e){var t=this.object.toTex(e),n=this.index?this.index.toTex(e):"",r=this.value.toTex(e);return o(this,e&&e.parenthesis,e&&e.implicit)&&(r="\\left(".concat(r,"\\right)")),t+n+"="+r}}return(0,tG.A)(s,"name",dQ),s}),{isClass:!0,isNode:!0}),pQ="IndexNode",mQ=SN(pQ,["Node","size"],(e=>{var{Node:t,size:n}=e;class r extends t{constructor(e,t){if(super(),this.dimensions=e,this.dotNotation=t||!1,!Array.isArray(e)||!e.every(yA))throw new TypeError('Array containing Nodes expected for parameter "dimensions"');if(this.dotNotation&&!this.isObjectProperty())throw new Error("dotNotation only applicable for object properties")}get type(){return pQ}get isIndexNode(){return!0}_compile(e,t){var r=RF(this.dimensions,(function(r,i){var a=r.filter((e=>e.isSymbolNode&&"end"===e.name)).length>0;if(a){var o=Object.create(t);o.end=!0;var s=r._compile(e,o);return function(e,t,r){if(!qC(r)&&!GC(r)&&!VC(r))throw new TypeError('Cannot resolve "end": context must be a Matrix, Array, or string but is '+EA(r));var a=n(r).valueOf(),o=Object.create(t);return o.end=a[i],s(e,o,r)}}return r._compile(e,t)})),i=DC(e,"index");return function(e,t,n){var a=RF(r,(function(r){return r(e,t,n)}));return i(...a)}}forEach(e){for(var t=0;t<this.dimensions.length;t++)e(this.dimensions[t],"dimensions["+t+"]",this)}map(e){for(var t=[],n=0;n<this.dimensions.length;n++)t[n]=this._ifNode(e(this.dimensions[n],"dimensions["+n+"]",this));return new r(t,this.dotNotation)}clone(){return new r(this.dimensions.slice(0),this.dotNotation)}isObjectProperty(){return 1===this.dimensions.length&&fA(this.dimensions[0])&&"string"===typeof this.dimensions[0].value}getObjectProperty(){return this.isObjectProperty()?this.dimensions[0].value:null}_toString(e){return this.dotNotation?"."+this.getObjectProperty():"["+this.dimensions.join(", ")+"]"}toJSON(){return{mathjs:pQ,dimensions:this.dimensions,dotNotation:this.dotNotation}}static fromJSON(e){return new r(e.dimensions,e.dotNotation)}_toHTML(e){for(var t=[],n=0;n<this.dimensions.length;n++)t[n]=this.dimensions[n].toHTML();return this.dotNotation?'<span class="math-operator math-accessor-operator">.</span><span class="math-symbol math-property">'+uF(this.getObjectProperty())+"</span>":'<span class="math-parenthesis math-square-parenthesis">[</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-parenthesis math-square-parenthesis">]</span>'}_toTex(e){var t=this.dimensions.map((function(t){return t.toTex(e)}));return this.dotNotation?"."+this.getObjectProperty():"_{"+t.join(",")+"}"}}return(0,tG.A)(r,"name",pQ),r}),{isClass:!0,isNode:!0}),gQ=SN("SymbolNode",["math","?Unit","Node"],(e=>{var{math:t,Unit:n,Node:r}=e;function i(e){return!!n&&n.isValuelessUnit(e)}class a extends r{constructor(e){if(super(),"string"!==typeof e)throw new TypeError('String expected for parameter "name"');this.name=e}get type(){return"SymbolNode"}get isSymbolNode(){return!0}_compile(e,t){var r=this.name;if(!0===t[r])return function(e,t,n){return DC(t,r)};if(r in e)return function(t,n,i){return t.has(r)?t.get(r):DC(e,r)};var o=i(r);return function(e,t,i){return e.has(r)?e.get(r):o?new n(null,r):a.onUndefinedSymbol(r)}}forEach(e){}map(e){return this.clone()}static onUndefinedSymbol(e){throw new Error("Undefined symbol "+e)}clone(){return new a(this.name)}_toString(e){return this.name}_toHTML(e){var t=uF(this.name);return"true"===t||"false"===t?'<span class="math-symbol math-boolean">'+t+"</span>":"i"===t?'<span class="math-symbol math-imaginary-symbol">'+t+"</span>":"Infinity"===t?'<span class="math-symbol math-infinity-symbol">'+t+"</span>":"NaN"===t?'<span class="math-symbol math-nan-symbol">'+t+"</span>":"null"===t?'<span class="math-symbol math-null-symbol">'+t+"</span>":"undefined"===t?'<span class="math-symbol math-undefined-symbol">'+t+"</span>":'<span class="math-symbol">'+t+"</span>"}toJSON(){return{mathjs:"SymbolNode",name:this.name}}static fromJSON(e){return new a(e.name)}_toTex(e){var n=!1;"undefined"===typeof t[this.name]&&i(this.name)&&(n=!0);var r=UK(this.name,n);return"\\"===r[0]?r:" "+r}}return a}),{isClass:!0,isNode:!0}),vQ="FunctionNode",yQ=SN(vQ,["math","Node","SymbolNode"],(e=>{var t,{math:n,Node:r,SymbolNode:i}=e,a=e=>sF(e,{truncate:78});function o(e,t,n){for(var r,i="",a=/\$(?:\{([a-z_][a-z_0-9]*)(?:\[([0-9]+)\])?\}|\$)/gi,o=0;null!==(r=a.exec(e));)if(i+=e.substring(o,r.index),o=r.index,"$$"===r[0])i+="$",o++;else{o+=r[0].length;var s=t[r[1]];if(!s)throw new ReferenceError("Template: Property "+r[1]+" does not exist.");if(void 0===r[2])switch(typeof s){case"string":i+=s;break;case"object":if(yA(s))i+=s.toTex(n);else{if(!Array.isArray(s))throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes");i+=s.map((function(e,t){if(yA(e))return e.toTex(n);throw new TypeError("Template: "+r[1]+"["+t+"] is not a Node.")})).join(",")}break;default:throw new TypeError("Template: "+r[1]+" has to be a Node, String or array of Nodes")}else{if(!yA(s[r[2]]&&s[r[2]]))throw new TypeError("Template: "+r[1]+"["+r[2]+"] is not a Node.");i+=s[r[2]].toTex(n)}}return i+=e.slice(o)}class s extends r{constructor(e,t){if(super(),"string"===typeof e&&(e=new i(e)),!yA(e))throw new TypeError('Node expected as parameter "fn"');if(!Array.isArray(t)||!t.every(yA))throw new TypeError('Array containing Nodes expected for parameter "args"');this.fn=e,this.args=t||[]}get name(){return this.fn.name||""}get type(){return vQ}get isFunctionNode(){return!0}_compile(e,t){var n=this.args.map((n=>n._compile(e,t)));if(!MA(this.fn)){if(lA(this.fn)&&vA(this.fn.index)&&this.fn.index.isObjectProperty()){var r=this.fn.object._compile(e,t),i=this.fn.index.getObjectProperty(),o=this.args;return function(t,a,s){var l=r(t,a,s),c=function(e,t){if(!AC(e,t))throw new Error('No access to method "'+t+'"');return e[t]}(l,i);if(null!==c&&void 0!==c&&c.rawArgs)return c(o,e,CK(t,a));var u=n.map((e=>e(t,a,s)));return c.apply(l,u)}}var l=this.fn.toString(),c=this.fn._compile(e,t),u=this.args;return function(t,r,i){var o=c(t,r,i);if("function"!==typeof o)throw new TypeError("Expression '".concat(l,"' did not evaluate to a function; value is:")+"\n  ".concat(a(o)));if(o.rawArgs)return o(u,e,CK(t,r));var s=n.map((e=>e(t,r,i)));return o.apply(o,s)}}var h=this.fn.name;if(t[h]){var d=this.args;return function(t,r,i){var o=DC(r,h);if("function"!==typeof o)throw new TypeError("Argument '".concat(h,"' was not a function; received: ").concat(a(o)));if(o.rawArgs)return o(d,e,CK(t,r));var s=n.map((e=>e(t,r,i)));return o.apply(o,s)}}var f=h in e?DC(e,h):void 0,p="function"===typeof f&&!0===f.rawArgs,m=t=>{var n;if(t.has(h))n=t.get(h);else{if(!(h in e))return s.onUndefinedFunction(h);n=DC(e,h)}if("function"===typeof n)return n;throw new TypeError("'".concat(h,"' is not a function; its value is:\n  ").concat(a(n)))};if(p){var g=this.args;return function(t,r,i){var a=m(t);return!0===a.rawArgs?a(g,e,CK(t,r)):a(...n.map((e=>e(t,r,i))))}}switch(n.length){case 0:return function(e,t,n){return m(e)()};case 1:return function(e,t,r){return m(e)((0,n[0])(e,t,r))};case 2:return function(e,t,r){var i=m(e),a=n[0],o=n[1];return i(a(e,t,r),o(e,t,r))};default:return function(e,t,r){return m(e)(...n.map((n=>n(e,t,r))))}}}forEach(e){e(this.fn,"fn",this);for(var t=0;t<this.args.length;t++)e(this.args[t],"args["+t+"]",this)}map(e){for(var t=this._ifNode(e(this.fn,"fn",this)),n=[],r=0;r<this.args.length;r++)n[r]=this._ifNode(e(this.args[r],"args["+r+"]",this));return new s(t,n)}clone(){return new s(this.fn,this.args.slice(0))}toString(e){var t,n=this.fn.toString(e);return e&&"object"===typeof e.handler&&OA(e.handler,n)&&(t=e.handler[n](this,e)),"undefined"!==typeof t?t:super.toString(e)}_toString(e){var t=this.args.map((function(t){return t.toString(e)}));return(mA(this.fn)?"("+this.fn.toString(e)+")":this.fn.toString(e))+"("+t.join(", ")+")"}toJSON(){return{mathjs:vQ,fn:this.fn,args:this.args}}_toHTML(e){var t=this.args.map((function(t){return t.toHTML(e)}));return'<span class="math-function">'+uF(this.fn)+'</span><span class="math-paranthesis math-round-parenthesis">(</span>'+t.join('<span class="math-separator">,</span>')+'<span class="math-paranthesis math-round-parenthesis">)</span>'}toTex(e){var t;return e&&"object"===typeof e.handler&&OA(e.handler,this.name)&&(t=e.handler[this.name](this,e)),"undefined"!==typeof t?t:super.toTex(e)}_toTex(e){var t,r,i=this.args.map((function(t){return t.toTex(e)}));switch(BK[this.name]&&(t=BK[this.name]),!n[this.name]||"function"!==typeof n[this.name].toTex&&"object"!==typeof n[this.name].toTex&&"string"!==typeof n[this.name].toTex||(t=n[this.name].toTex),typeof t){case"function":r=t(this,e);break;case"string":r=o(t,this,e);break;case"object":switch(typeof t[i.length]){case"function":r=t[i.length](this,e);break;case"string":r=o(t[i.length],this,e)}}return"undefined"!==typeof r?r:o("\\mathrm{${name}}\\left(${args}\\right)",this,e)}getIdentifier(){return this.type+":"+this.name}}return t=s,(0,tG.A)(s,"name",vQ),(0,tG.A)(s,"onUndefinedFunction",(function(e){throw new Error("Undefined function "+e)})),(0,tG.A)(s,"fromJSON",(function(e){return new t(e.fn,e.args)})),s}),{isClass:!0,isNode:!0}),xQ="parse",bQ=SN(xQ,["typed","numeric","config","AccessorNode","ArrayNode","AssignmentNode","BlockNode","ConditionalNode","ConstantNode","FunctionAssignmentNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","RangeNode","RelationalNode","SymbolNode"],(e=>{var{typed:t,numeric:n,config:r,AccessorNode:i,ArrayNode:a,AssignmentNode:o,BlockNode:s,ConditionalNode:l,ConstantNode:c,FunctionAssignmentNode:u,FunctionNode:h,IndexNode:d,ObjectNode:f,OperatorNode:p,ParenthesisNode:m,RangeNode:g,RelationalNode:v,SymbolNode:y}=e,x=t(xQ,{string:function(e){return B(e,{})},"Array | Matrix":function(e){return b(e,{})},"string, Object":function(e,t){return B(e,void 0!==t.nodes?t.nodes:{})},"Array | Matrix, Object":b});function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0!==t.nodes?t.nodes:{};return sO(e,(function(e){if("string"!==typeof e)throw new TypeError("String expected");return B(e,n)}))}var _={NULL:0,DELIMITER:1,NUMBER:2,SYMBOL:3,UNKNOWN:4},w={",":!0,"(":!0,")":!0,"[":!0,"]":!0,"{":!0,"}":!0,'"':!0,"'":!0,";":!0,"+":!0,"-":!0,"*":!0,".*":!0,"/":!0,"./":!0,"%":!0,"^":!0,".^":!0,"~":!0,"!":!0,"&":!0,"|":!0,"^|":!0,"=":!0,":":!0,"?":!0,"==":!0,"!=":!0,"<":!0,">":!0,"<=":!0,">=":!0,"<<":!0,">>":!0,">>>":!0},S={mod:!0,to:!0,in:!0,and:!0,xor:!0,or:!0,not:!0},M={true:!0,false:!1,null:null,undefined:void 0},D=["NaN","Infinity"],E={'"':'"',"'":"'","\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function C(e,t){return e.expression.substr(e.index,t)}function A(e){return C(e,1)}function T(e){e.index++}function N(e){return e.expression.charAt(e.index-1)}function R(e){return e.expression.charAt(e.index+1)}function P(e){for(e.tokenType=_.NULL,e.token="",e.comment="";;){if("#"===A(e))for(;"\n"!==A(e)&&""!==A(e);)e.comment+=A(e),T(e);if(!x.isWhitespace(A(e),e.nestingLevel))break;T(e)}if(""!==A(e)){if("\n"===A(e)&&!e.nestingLevel)return e.tokenType=_.DELIMITER,e.token=A(e),void T(e);var t=A(e),n=C(e,2),r=C(e,3);if(3===r.length&&w[r])return e.tokenType=_.DELIMITER,e.token=r,T(e),T(e),void T(e);if(2===n.length&&w[n])return e.tokenType=_.DELIMITER,e.token=n,T(e),void T(e);if(w[t])return e.tokenType=_.DELIMITER,e.token=t,void T(e);if(x.isDigitDot(t)){e.tokenType=_.NUMBER;var i=C(e,2);if("0b"===i||"0o"===i||"0x"===i){for(e.token+=A(e),T(e),e.token+=A(e),T(e);x.isHexDigit(A(e));)e.token+=A(e),T(e);if("."===A(e))for(e.token+=".",T(e);x.isHexDigit(A(e));)e.token+=A(e),T(e);else if("i"===A(e))for(e.token+="i",T(e);x.isDigit(A(e));)e.token+=A(e),T(e);return}if("."===A(e)){if(e.token+=A(e),T(e),!x.isDigit(A(e)))return void(e.tokenType=_.DELIMITER)}else{for(;x.isDigit(A(e));)e.token+=A(e),T(e);x.isDecimalMark(A(e),R(e))&&(e.token+=A(e),T(e))}for(;x.isDigit(A(e));)e.token+=A(e),T(e);if("E"===A(e)||"e"===A(e))if(x.isDigit(R(e))||"-"===R(e)||"+"===R(e)){if(e.token+=A(e),T(e),"+"!==A(e)&&"-"!==A(e)||(e.token+=A(e),T(e)),!x.isDigit(A(e)))throw ne(e,'Digit expected, got "'+A(e)+'"');for(;x.isDigit(A(e));)e.token+=A(e),T(e);if(x.isDecimalMark(A(e),R(e)))throw ne(e,'Digit expected, got "'+A(e)+'"')}else if(x.isDecimalMark(R(e),e.expression.charAt(e.index+2)))throw T(e),ne(e,'Digit expected, got "'+A(e)+'"')}else{if(!x.isAlpha(A(e),N(e),R(e))){for(e.tokenType=_.UNKNOWN;""!==A(e);)e.token+=A(e),T(e);throw ne(e,'Syntax error in part "'+e.token+'"')}for(;x.isAlpha(A(e),N(e),R(e))||x.isDigit(A(e));)e.token+=A(e),T(e);OA(S,e.token)?e.tokenType=_.DELIMITER:e.tokenType=_.SYMBOL}}else e.tokenType=_.DELIMITER}function F(e){do{P(e)}while("\n"===e.token)}function O(e){e.nestingLevel++}function I(e){e.nestingLevel--}function B(e,t){var n={extraNodes:{},expression:"",comment:"",index:0,token:"",tokenType:_.NULL,nestingLevel:0,conditionalLevel:null};SC(n,{expression:e,extraNodes:t}),P(n);var r=function(e){var t,n,r=[];""!==e.token&&"\n"!==e.token&&";"!==e.token&&(t=k(e),e.comment&&(t.comment=e.comment));for(;"\n"===e.token||";"===e.token;)0===r.length&&t&&(n=";"!==e.token,r.push({node:t,visible:n})),P(e),"\n"!==e.token&&";"!==e.token&&""!==e.token&&(t=k(e),e.comment&&(t.comment=e.comment),n=";"!==e.token,r.push({node:t,visible:n}));return r.length>0?new s(r):(t||(t=new c(void 0),e.comment&&(t.comment=e.comment)),t)}(n);if(""!==n.token)throw n.tokenType===_.DELIMITER?re(n,"Unexpected operator "+n.token):ne(n,'Unexpected part "'+n.token+'"');return r}function k(e){var t,n,r,i,a=function(e){var t=function(e){var t=L(e);for(;"or"===e.token;)F(e),t=new p("or","or",[t,L(e)]);return t}(e);for(;"?"===e.token;){var n=e.conditionalLevel;e.conditionalLevel=e.nestingLevel,F(e);var r=t,i=k(e);if(":"!==e.token)throw ne(e,"False part of conditional expression expected");e.conditionalLevel=null,F(e);var a=k(e);t=new l(r,i,a),e.conditionalLevel=n}return t}(e);if("="===e.token){if(MA(a))return t=a.name,F(e),r=k(e),new o(new y(t),r);if(lA(a))return F(e),r=k(e),new o(a.object,a.index,r);if(gA(a)&&MA(a.fn)&&(i=!0,n=[],t=a.name,a.args.forEach((function(e,t){MA(e)?n[t]=e.name:i=!1})),i))return F(e),r=k(e),new u(t,n,r);throw ne(e,"Invalid left hand side of assignment operator =")}return a}function L(e){for(var t=U(e);"xor"===e.token;)F(e),t=new p("xor","xor",[t,U(e)]);return t}function U(e){for(var t=z(e);"and"===e.token;)F(e),t=new p("and","and",[t,z(e)]);return t}function z(e){for(var t=H(e);"|"===e.token;)F(e),t=new p("|","bitOr",[t,H(e)]);return t}function H(e){for(var t=V(e);"^|"===e.token;)F(e),t=new p("^|","bitXor",[t,V(e)]);return t}function V(e){for(var t=G(e);"&"===e.token;)F(e),t=new p("&","bitAnd",[t,G(e)]);return t}function G(e){for(var t=[q(e)],n=[],r={"==":"equal","!=":"unequal","<":"smaller",">":"larger","<=":"smallerEq",">=":"largerEq"};OA(r,e.token);){var i={name:e.token,fn:r[e.token]};n.push(i),F(e),t.push(q(e))}return 1===t.length?t[0]:2===t.length?new p(n[0].name,n[0].fn,t):new v(n.map((e=>e.fn)),t)}function q(e){var t,n,r,i;t=j(e);for(var a={"<<":"leftShift",">>":"rightArithShift",">>>":"rightLogShift"};OA(a,e.token);)r=a[n=e.token],F(e),i=[t,j(e)],t=new p(n,r,i);return t}function j(e){var t,n,r,i;t=W(e);for(var a={to:"to",in:"to"};OA(a,e.token);)r=a[n=e.token],F(e),"in"===n&&""===e.token?t=new p("*","multiply",[t,new y("in")],!0):(i=[t,W(e)],t=new p(n,r,i));return t}function W(e){var t,n=[];if(t=":"===e.token?new c(1):X(e),":"===e.token&&e.conditionalLevel!==e.nestingLevel){for(n.push(t);":"===e.token&&n.length<3;)F(e),")"===e.token||"]"===e.token||","===e.token||""===e.token?n.push(new y("end")):n.push(X(e));t=3===n.length?new g(n[0],n[2],n[1]):new g(n[0],n[1])}return t}function X(e){var t,n,r,i;t=Y(e);for(var a={"+":"add","-":"subtract"};OA(a,e.token);){r=a[n=e.token],F(e);var o=Y(e);i=o.isPercentage?[t,new p("*","multiply",[t,o])]:[t,o],t=new p(n,r,i)}return t}function Y(e){var t,n,r,i;n=t=Z(e);for(var a={"*":"multiply",".*":"dotMultiply","/":"divide","./":"dotDivide","%":"mod",mod:"mod"};OA(a,e.token);)if(i=a[r=e.token],F(e),"%"===r&&e.tokenType===_.DELIMITER&&"("!==e.token)if(""!==e.token&&a[e.token]){var o=new p("/","divide",[t,new c(100)],!1,!0);i=a[r=e.token],F(e),n=Z(e),t=new p(r,i,[o,n])}else t=new p("/","divide",[t,new c(100)],!1,!0);else n=Z(e),t=new p(r,i,[t,n]);return t}function Z(e){var t,n;for(n=t=K(e);e.tokenType===_.SYMBOL||"in"===e.token&&fA(t)||"in"===e.token&&bA(t)&&"unaryMinus"===t.fn&&fA(t.args[0])||!(e.tokenType!==_.NUMBER||fA(n)||bA(n)&&"!"!==n.op)||"("===e.token;)n=K(e),t=new p("*","multiply",[t,n],!0);return t}function K(e){for(var t=Q(e),n=t,r=[];"/"===e.token&&pA(n);){if(r.push(SC({},e)),F(e),e.tokenType!==_.NUMBER){SC(e,r.pop());break}if(r.push(SC({},e)),F(e),e.tokenType!==_.SYMBOL&&"("!==e.token&&"in"!==e.token){r.pop(),SC(e,r.pop());break}SC(e,r.pop()),r.pop(),n=Q(e),t=new p("/","divide",[t,n])}return t}function Q(e){var t,i,o,s={"-":"unaryMinus","+":"unaryPlus","~":"bitNot",not:"not"};return OA(s,e.token)?(o=s[e.token],t=e.token,F(e),i=[Q(e)],new p(t,o,i)):function(e){var t,i,o,s;t=function(e){var t,i,o;t=function(e){var t=[];if(e.tokenType===_.SYMBOL&&OA(e.extraNodes,e.token)){var i=e.extraNodes[e.token];if(P(e),"("===e.token){if(t=[],O(e),P(e),")"!==e.token)for(t.push(k(e));","===e.token;)P(e),t.push(k(e));if(")"!==e.token)throw ne(e,"Parenthesis ) expected");I(e),P(e)}return new i(t)}return function(e){var t;if(e.tokenType===_.SYMBOL||e.tokenType===_.DELIMITER&&e.token in S)return t=e.token,P(e),J(e,OA(M,t)?new c(M[t]):D.includes(t)?new c(n(t,"number")):new y(t));return function(e){var t;if('"'===e.token||"'"===e.token)return t=$(e,e.token),J(e,new c(t));return function(e){var t,i,o,s;if("["===e.token){if(O(e),P(e),"]"!==e.token){var l=ee(e);if(";"===e.token){for(o=1,i=[l];";"===e.token;)P(e),"]"!==e.token&&(i[o]=ee(e),o++);if("]"!==e.token)throw ne(e,"End of matrix ] expected");I(e),P(e),s=i[0].items.length;for(var u=1;u<o;u++)if(i[u].items.length!==s)throw re(e,"Column dimensions mismatch ("+i[u].items.length+" !== "+s+")");t=new a(i)}else{if("]"!==e.token)throw ne(e,"End of matrix ] expected");I(e),P(e),t=l}}else I(e),P(e),t=new a([]);return J(e,t)}return function(e){if("{"===e.token){var t;O(e);var i={};do{if(P(e),"}"!==e.token){if('"'===e.token||"'"===e.token)t=$(e,e.token);else{if(!(e.tokenType===_.SYMBOL||e.tokenType===_.DELIMITER&&e.token in S))throw ne(e,"Symbol or string expected as object key");t=e.token,P(e)}if(":"!==e.token)throw ne(e,"Colon : expected after object key");P(e),i[t]=k(e)}}while(","===e.token);if("}"!==e.token)throw ne(e,"Comma , or bracket } expected after object value");I(e),P(e);var a=new f(i);return a=J(e,a)}return function(e){var t;if(e.tokenType===_.NUMBER){t=e.token,P(e);var i=BN(t,r),a=n(t,i);return new c(a)}return function(e){var t;if("("===e.token){if(O(e),P(e),t=k(e),")"!==e.token)throw ne(e,"Parenthesis ) expected");return I(e),P(e),t=J(e,t=new m(t))}return function(e){throw""===e.token?ne(e,"Unexpected end of expression"):ne(e,"Value expected")}(e)}(e)}(e)}(e)}(e)}(e)}(e)}(e);var s={"!":"factorial","'":"ctranspose"};for(;OA(s,e.token);)o=s[i=e.token],P(e),t=J(e,t=new p(i,o,[t]));return t}(e),("^"===e.token||".^"===e.token)&&(o="^"===(i=e.token)?"pow":"dotPow",F(e),s=[t,Q(e)],t=new p(i,o,s));return t}(e)}function J(e,t,n){for(var r;("("===e.token||"["===e.token||"."===e.token)&&(!n||n.includes(e.token));)if(r=[],"("===e.token){if(!MA(t)&&!lA(t))return t;if(O(e),P(e),")"!==e.token)for(r.push(k(e));","===e.token;)P(e),r.push(k(e));if(")"!==e.token)throw ne(e,"Parenthesis ) expected");I(e),P(e),t=new h(t,r)}else if("["===e.token){if(O(e),P(e),"]"!==e.token)for(r.push(k(e));","===e.token;)P(e),r.push(k(e));if("]"!==e.token)throw ne(e,"Parenthesis ] expected");I(e),P(e),t=new i(t,new d(r))}else{if(P(e),!(e.tokenType===_.SYMBOL||e.tokenType===_.DELIMITER&&e.token in S))throw ne(e,"Property name expected after dot");r.push(new c(e.token)),P(e);t=new i(t,new d(r,!0))}return t}function $(e,t){for(var n="";""!==A(e)&&A(e)!==t;)if("\\"===A(e)){T(e);var r=A(e),i=E[r];if(void 0!==i)n+=i,e.index+=1;else{if("u"!==r)throw ne(e,"Bad escape character \\".concat(r));var a=e.expression.slice(e.index+1,e.index+5);if(!/^[0-9A-Fa-f]{4}$/.test(a))throw ne(e,"Invalid unicode character \\u".concat(a));n+=String.fromCharCode(parseInt(a,16)),e.index+=5}}else n+=A(e),T(e);if(P(e),e.token!==t)throw ne(e,"End of string ".concat(t," expected"));return P(e),n}function ee(e){for(var t=[k(e)],n=1;","===e.token;)P(e),"]"!==e.token&&";"!==e.token&&(t[n]=k(e),n++);return new a(t)}function te(e){return e.index-e.token.length+1}function ne(e,t){var n=te(e),r=new SyntaxError(t+" (char "+n+")");return r.char=n,r}function re(e,t){var n=te(e),r=new SyntaxError(t+" (char "+n+")");return r.char=n,r}return x.isAlpha=function(e,t,n){return x.isValidLatinOrGreek(e)||x.isValidMathSymbol(e,n)||x.isValidMathSymbol(t,e)},x.isValidLatinOrGreek=function(e){return/^[a-zA-Z_$\u00C0-\u02AF\u0370-\u03FF\u2100-\u214F]$/.test(e)},x.isValidMathSymbol=function(e,t){return/^[\uD835]$/.test(e)&&/^[\uDC00-\uDFFF]$/.test(t)&&/^[^\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDFCC\uDFCD]$/.test(t)},x.isWhitespace=function(e,t){return" "===e||"\t"===e||"\n"===e&&t>0},x.isDecimalMark=function(e,t){return"."===e&&"/"!==t&&"*"!==t&&"^"!==t},x.isDigitDot=function(e){return e>="0"&&e<="9"||"."===e},x.isDigit=function(e){return e>="0"&&e<="9"},x.isHexDigit=function(e){return e>="0"&&e<="9"||e>="a"&&e<="f"||e>="A"&&e<="F"},t.addConversion({from:"string",to:"Node",convert:x}),x})),_Q=SN("resolve",["typed","parse","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode"],(e=>{var{typed:t,parse:n,ConstantNode:r,FunctionNode:i,OperatorNode:a,ParenthesisNode:o}=e;function s(e,t){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;if(!t)return e;if(MA(e)){if(l.has(e.name)){var c=Array.from(l).join(", ");throw new ReferenceError("recursive loop of variable definitions among {".concat(c,"}"))}var u=t.get(e.name);if(yA(u)){var h=new Set(l);return h.add(e.name),s(u,t,h)}return"number"===typeof u?n(String(u)):void 0!==u?new r(u):e}if(bA(e)){var d=e.args.map((function(e){return s(e,t,l)}));return new a(e.op,e.fn,d,e.implicit)}if(_A(e))return new o(s(e.content,t,l));if(gA(e)){var f=e.args.map((function(e){return s(e,t,l)}));return new i(e.name,f)}return e.map((e=>s(e,t,l)))}return t("resolve",{Node:s,"Node, Map | null | undefined":s,"Node, Object":(e,t)=>s(e,IC(t)),"Array | Matrix":t.referToSelf((e=>t=>t.map((t=>e(t))))),"Array | Matrix, null | undefined":t.referToSelf((e=>t=>t.map((t=>e(t))))),"Array, Object":t.referTo("Array,Map",(e=>(t,n)=>e(t,IC(n)))),"Matrix, Object":t.referTo("Matrix,Map",(e=>(t,n)=>e(t,IC(n)))),"Array | Matrix, Map":t.referToSelf((e=>(t,n)=>t.map((t=>e(t,n)))))})}));function wQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function SQ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wQ(Object(n),!0).forEach((function(t){(0,tG.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wQ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var MQ=SN("simplifyUtil",["FunctionNode","OperatorNode","SymbolNode"],(e=>{var{FunctionNode:t,OperatorNode:n,SymbolNode:r}=e,i=!0,a=!1,o="defaultF",s={add:{trivial:i,total:i,commutative:i,associative:i},unaryPlus:{trivial:i,total:i,commutative:i,associative:i},subtract:{trivial:a,total:i,commutative:a,associative:a},multiply:{trivial:i,total:i,commutative:i,associative:i},divide:{trivial:a,total:i,commutative:a,associative:a},paren:{trivial:i,total:i,commutative:i,associative:a},defaultF:{trivial:a,total:i,commutative:a,associative:a}};function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s,r=o;if("string"===typeof e?r=e:bA(e)?r=e.fn.toString():gA(e)?r=e.name:_A(e)&&(r="paren"),OA(n,r)){var i=n[r];if(OA(i,t))return i[t];if(OA(s,r))return s[r][t]}if(OA(n,o)){var a=n[o];return OA(a,t)?a[t]:s[o][t]}if(OA(s,r)){var l=s[r];if(OA(l,t))return l[t]}return s[o][t]}function c(e){return l(e,"associative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:s)}function u(e,t){var n,r=[],i=function(e){for(var t=0;t<e.args.length;t++){var a=e.args[t];bA(a)&&n===a.op?i(a):r.push(a)}};return c(e,t)?(n=e.op,i(e),r):e.args}function h(e){return bA(e)?function(t){try{return new n(e.op,e.fn,t,e.implicit)}catch(r){return console.error(r),[]}}:function(n){return new t(new r(e.name),n)}}return{createMakeNodeFunction:h,hasProperty:l,isCommutative:function(e){return l(e,"commutative",arguments.length>1&&void 0!==arguments[1]?arguments[1]:s)},isAssociative:c,mergeContext:function(e,t){var n=SQ({},e);for(var r in t)OA(e,r)?n[r]=SQ(SQ({},t[r]),e[r]):n[r]=t[r];return n},flatten:function e(t,n){if(!t.args||0===t.args.length)return t;t.args=u(t,n);for(var r=0;r<t.args.length;r++)e(t.args[r],n)},allChildren:u,unflattenr:function e(t,n){if(t.args&&0!==t.args.length){for(var r=h(t),i=t.args.length,a=0;a<i;a++)e(t.args[a],n);if(i>2&&c(t,n)){for(var o=t.args.pop();t.args.length>0;)o=r([t.args.pop(),o]);t.args=o.args}}},unflattenl:function e(t,n){if(t.args&&0!==t.args.length){for(var r=h(t),i=t.args.length,a=0;a<i;a++)e(t.args[a],n);if(i>2&&c(t,n)){for(var o=t.args.shift();t.args.length>0;)o=r([o,t.args.shift()]);t.args=o.args}}},defaultContext:s,realContext:{divide:{total:a},log:{total:a}},positiveContext:{subtract:{total:a},abs:{trivial:i},log:{total:i}}}})),DQ=SN("simplifyConstant",["typed","config","mathWithTransform","matrix","?fraction","?bignumber","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode"],(e=>{var{typed:t,config:n,mathWithTransform:r,matrix:i,fraction:a,bignumber:o,AccessorNode:s,ArrayNode:l,ConstantNode:c,FunctionNode:u,IndexNode:h,ObjectNode:d,OperatorNode:f,SymbolNode:p}=e,{isCommutative:m,isAssociative:g,allChildren:v,createMakeNodeFunction:y}=MQ({FunctionNode:u,OperatorNode:f,SymbolNode:p}),x=t("simplifyConstant",{Node:e=>S(A(e,{})),"Node, Object":function(e,t){return S(A(e,t))}});function b(e){return zC(e)?e.valueOf():e instanceof Array?e.map(b):qC(e)?i(b(e.valueOf())):e}function _(e,t,n){try{return r[e].apply(null,t)}catch(i){return t=t.map(b),D(r[e].apply(null,t),n)}}var w=t({Fraction:function(e){var t=e=>"BigNumber"===n.number&&o?o(e):Number(e),r=e.s*e.n,i=r<0n?new f("-","unaryMinus",[new c(-t(r))]):new c(t(r));return 1n===e.d?i:new f("/","divide",[i,new c(t(e.d))])},number:function(e){return e<0?E(new c(-e)):new c(e)},BigNumber:function(e){return e<0?E(new c(-e)):new c(e)},bigint:function(e){return e<0n?E(new c(-e)):new c(e)},Complex:function(e){throw new Error("Cannot convert Complex number to Node")},string:function(e){return new c(e)},Matrix:function(e){return new l(e.valueOf().map((e=>w(e))))}});function S(e){return yA(e)?e:w(e)}function M(e,t){if(t&&!1!==t.exactFractions&&isFinite(e)&&a){var n=a(e),r=t&&"number"===typeof t.fractionsLimit?t.fractionsLimit:1/0;if(n.valueOf()===e&&n.n<r&&n.d<r)return n}return e}var D=t({"string, Object":function(e,t){var r=BN(e,n);return"BigNumber"===r?(void 0===o&&wU(),o(e)):"bigint"===r?BigInt(e):"Fraction"===r?(void 0===a&&SU(),a(e)):M(parseFloat(e),t)},"Fraction, Object":function(e,t){return e},"BigNumber, Object":function(e,t){return e},"number, Object":function(e,t){return M(e,t)},"bigint, Object":function(e,t){return e},"Complex, Object":function(e,t){return 0!==e.im?e:M(e.re,t)},"Matrix, Object":function(e,t){return i(M(e.valueOf()))},"Array, Object":function(e,t){return e.map(M)}});function E(e){return new f("-","unaryMinus",[e])}function C(e,t,n,r){var i=t.shift(),a=t.reduce(((t,i)=>{if(!yA(i)){var a=t.pop();if(yA(a))return[a,i];try{return t.push(_(e,[a,i],r)),t}catch(s){t.push(a)}}t.push(S(t.pop()));var o=1===t.length?t[0]:n(t);return[n([o,S(i)])]}),[i]);return 1===a.length?a[0]:n([a[0],w(a[1])])}function A(e,t){switch(e.type){case"SymbolNode":return e;case"ConstantNode":switch(typeof e.value){case"number":case"bigint":return D(e.value,t);case"string":return e.value;default:if(!isNaN(e.value))return D(e.value,t)}return e;case"FunctionNode":if(r[e.name]&&r[e.name].rawArgs)return e;if(!["add","multiply"].includes(e.name)){var n=e.args.map((e=>A(e,t)));if(!n.some(yA))try{return _(e.name,n,t)}catch(F){}if("size"===e.name&&1===n.length&&cA(n[0])){for(var a=[],o=n[0];cA(o);)a.push(o.items.length),o=o.items[0];return i(a)}return new u(e.name,n.map(S))}case"OperatorNode":var f,p,b=e.fn.toString(),w=y(e);if(bA(e)&&e.isUnary())p=yA((f=[A(e.args[0],t)])[0])?w(f):_(b,f,t);else if(g(e,t.context))if(f=(f=v(e,t.context)).map((e=>A(e,t))),m(b,t.context)){for(var M=[],E=[],T=0;T<f.length;T++)yA(f[T])?E.push(f[T]):M.push(f[T]);M.length>1?(p=C(b,M,w,t),E.unshift(p),p=C(b,E,w,t)):p=C(b,f,w,t)}else p=C(b,f,w,t);else f=e.args.map((e=>A(e,t))),p=C(b,f,w,t);return p;case"ParenthesisNode":return A(e.content,t);case"AccessorNode":return function(e,t,n){if(!vA(t))return new s(S(e),S(t));if(cA(e)||qC(e)){for(var r=Array.from(t.dimensions);r.length>0;)if(fA(r[0])&&"string"!==typeof r[0].value){var a=D(r.shift().value,n);cA(e)?e=e.items[a-1]:(e=e.valueOf()[a-1])instanceof Array&&(e=i(e))}else{if(!(r.length>1&&fA(r[1])&&"string"!==typeof r[1].value))break;var o=D(r[1].value,n),u=[],d=cA(e)?e.items:e.valueOf();for(var f of d)if(cA(f))u.push(f.items[o-1]);else{if(!qC(e))break;u.push(f[o-1])}if(u.length!==d.length)break;e=cA(e)?new l(u):i(u),r.splice(1,1)}return r.length===t.dimensions.length?new s(S(e),t):r.length>0?(t=new h(r),new s(S(e),t)):e}if(xA(e)&&1===t.dimensions.length&&fA(t.dimensions[0])){var p=t.dimensions[0].value;return p in e.properties?e.properties[p]:new c}return new s(S(e),t)}(A(e.object,t),A(e.index,t),t);case"ArrayNode":var N=e.items.map((e=>A(e,t)));return N.some(yA)?new l(N.map(S)):i(N);case"IndexNode":return new h(e.dimensions.map((e=>x(e,t))));case"ObjectNode":var R={};for(var P in e.properties)R[P]=x(e.properties[P],t);return new d(R);default:throw new Error("Unimplemented node type in simplifyConstant: ".concat(e.type))}}return x})),EQ="compile",CQ=SN(EQ,["typed","parse"],(e=>{var{typed:t,parse:n}=e;return t(EQ,{string:function(e){return n(e).compile()},"Array | Matrix":function(e){return sO(e,(function(e){return n(e).compile()}))}})})),AQ="simplifyCore",TQ=SN(AQ,["typed","parse","equal","isZero","add","subtract","multiply","divide","pow","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode"],(e=>{var{typed:t,parse:n,equal:r,isZero:i,add:a,subtract:o,multiply:s,divide:l,pow:c,AccessorNode:u,ArrayNode:h,ConstantNode:d,FunctionNode:f,IndexNode:p,ObjectNode:m,OperatorNode:g,ParenthesisNode:v,SymbolNode:y}=e,x=new d(0),b=new d(1),_=new d(!0),w=new d(!1);function S(e){return bA(e)&&["and","not","or"].includes(e.op)}var{hasProperty:M,isCommutative:D}=MQ({FunctionNode:f,OperatorNode:g,SymbolNode:y});function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t?t.context:void 0;if(M(e,"trivial",n)){if(gA(e)&&1===e.args.length)return E(e.args[0],t);var a=!1,o=0;if(e.forEach((e=>{1===++o&&(a=E(e,t))})),1===o)return a}var s=e;if(gA(s)){var l=function(e){var t="OperatorNode:"+e;for(var n of AK)if(t in n)return n[t].op;return null}(s.name);if(!l)return new f(E(s.fn),s.args.map((e=>E(e,t))));if(s.args.length>2&&M(s,"associative",n))for(;s.args.length>2;){var c=s.args.pop(),d=s.args.pop();s.args.push(new g(l,s.name,[c,d]))}s=new g(l,s.name,s.args)}if(bA(s)&&s.isUnary()){var v=E(s.args[0],t);if("~"===s.op&&bA(v)&&v.isUnary()&&"~"===v.op)return v.args[0];if("not"===s.op&&bA(v)&&v.isUnary()&&"not"===v.op&&S(v.args[0]))return v.args[0];var y=!0;if("-"===s.op&&bA(v)&&(v.isBinary()&&"subtract"===v.fn&&(s=new g("-","subtract",[v.args[1],v.args[0]]),y=!1),v.isUnary()&&"-"===v.op))return v.args[0];if(y)return new g(s.op,s.fn,[v])}if(bA(s)&&s.isBinary()){var C=E(s.args[0],t),A=E(s.args[1],t);if("+"===s.op){if(fA(C)&&i(C.value))return A;if(fA(A)&&i(A.value))return C;bA(A)&&A.isUnary()&&"-"===A.op&&(A=A.args[0],s=new g("-","subtract",[C,A]))}if("-"===s.op)return bA(A)&&A.isUnary()&&"-"===A.op?E(new g("+","add",[C,A.args[0]]),t):fA(C)&&i(C.value)?E(new g("-","unaryMinus",[A])):fA(A)&&i(A.value)?C:new g(s.op,s.fn,[C,A]);if("*"===s.op){if(fA(C)){if(i(C.value))return x;if(r(C.value,1))return A}if(fA(A)){if(i(A.value))return x;if(r(A.value,1))return C;if(D(s,n))return new g(s.op,s.fn,[A,C],s.implicit)}return new g(s.op,s.fn,[C,A],s.implicit)}if("/"===s.op)return fA(C)&&i(C.value)?x:fA(A)&&r(A.value,1)?C:new g(s.op,s.fn,[C,A]);if("^"===s.op&&fA(A)){if(i(A.value))return b;if(r(A.value,1))return C}if("and"===s.op){if(fA(C)){if(!C.value)return w;if(S(A))return A;if(fA(A))return A.value?_:w}if(fA(A)){if(!A.value)return w;if(S(C))return C}}if("or"===s.op){if(fA(C)){if(C.value)return _;if(S(A))return A}if(fA(A)){if(A.value)return _;if(S(C))return C}}return new g(s.op,s.fn,[C,A])}if(bA(s))return new g(s.op,s.fn,s.args.map((e=>E(e,t))));if(cA(s))return new h(s.items.map((e=>E(e,t))));if(lA(s))return new u(E(s.object,t),E(s.index,t));if(vA(s))return new p(s.dimensions.map((e=>E(e,t))));if(xA(s)){var T={};for(var N in s.properties)T[N]=E(s.properties[N],t);return new m(T)}return s}return t(AQ,{Node:E,"Node,Object":E})})),NQ="evaluate",RQ=SN(NQ,["typed","parse"],(e=>{var{typed:t,parse:n}=e;return t(NQ,{string:function(e){var t=OC();return n(e).compile().evaluate(t)},"string, Map | Object":function(e,t){return n(e).compile().evaluate(t)},"Array | Matrix":function(e){var t=OC();return sO(e,(function(e){return n(e).compile().evaluate(t)}))},"Array | Matrix, Map | Object":function(e,t){return sO(e,(function(e){return n(e).compile().evaluate(t)}))}})})),PQ=SN("Help",["evaluate"],(e=>{var{evaluate:t}=e;function n(e){if(!(this instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!e)throw new Error('Argument "doc" missing');this.doc=e}return n.prototype.type="Help",n.prototype.isHelp=!0,n.prototype.toString=function(){var e=this.doc||{},n="\n";if(e.name&&(n+="Name: "+e.name+"\n\n"),e.category&&(n+="Category: "+e.category+"\n\n"),e.description&&(n+="Description:\n    "+e.description+"\n\n"),e.syntax&&(n+="Syntax:\n    "+e.syntax.join("\n    ")+"\n\n"),e.examples){n+="Examples:\n";for(var r=!1,i=t("config()"),a={config:e=>(r=!0,t("config(newConfig)",{newConfig:e}))},o=0;o<e.examples.length;o++){var s=e.examples[o];n+="    "+s+"\n";var l=void 0;try{l=t(s,a)}catch(gR){l=gR}void 0===l||JC(l)||(n+="        "+sF(l,{precision:14})+"\n")}n+="\n",r&&t("config(originalConfig)",{originalConfig:i})}return e.mayThrow&&e.mayThrow.length&&(n+="Throws: "+e.mayThrow.join(", ")+"\n\n"),e.seealso&&e.seealso.length&&(n+="See also: "+e.seealso.join(", ")+"\n"),n},n.prototype.toJSON=function(){var e=CA(this.doc);return e.mathjs="Help",e},n.fromJSON=function(e){var t={};return Object.keys(e).filter((e=>"mathjs"!==e)).forEach((n=>{t[n]=e[n]})),new n(t)},n.prototype.valueOf=n.prototype.toString,n}),{isClass:!0}),FQ=SN("Parser",["evaluate","parse"],(e=>{var{evaluate:t,parse:n}=e;function r(){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");Object.defineProperty(this,"scope",{value:OC(),writable:!1})}return r.prototype.type="Parser",r.prototype.isParser=!0,r.prototype.evaluate=function(e){return t(e,this.scope)},r.prototype.get=function(e){if(this.scope.has(e))return this.scope.get(e)},r.prototype.getAll=function(){return function(e){if(e instanceof RC)return e.wrappedObject;var t={};for(var n of e.keys())EC(t,n,e.get(n));return t}(this.scope)},r.prototype.getAllAsMap=function(){return this.scope},r.prototype.set=function(e,t){if(!function(e){if(0===e.length)return!1;for(var t=0;t<e.length;t++){var r=e.charAt(t-1),i=e.charAt(t),a=e.charAt(t+1);if(!(n.isAlpha(i,r,a)||t>0&&n.isDigit(i)))return!1}return!0}(e))throw new Error("Invalid variable name: '".concat(e,"'. Variable names must follow the specified rules."));return this.scope.set(e,t),t},r.prototype.remove=function(e){this.scope.delete(e)},r.prototype.clear=function(){this.scope.clear()},r}),{isClass:!0});function OQ(e){return fA(e)||bA(e)&&e.isUnary()&&fA(e.args[0])}function IQ(e){return!!fA(e)||(!(!gA(e)&&!bA(e)||!e.args.every(IQ))||!(!_A(e)||!IQ(e.content)))}var BQ=["typed","parse","equal","resolve","simplifyConstant","simplifyCore","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","ParenthesisNode","SymbolNode","replacer"],kQ=SN("simplify",BQ,(e=>{var{typed:t,parse:n,equal:r,resolve:i,simplifyConstant:a,simplifyCore:o,AccessorNode:s,ArrayNode:l,ConstantNode:c,FunctionNode:u,IndexNode:h,ObjectNode:d,OperatorNode:f,ParenthesisNode:p,SymbolNode:m,replacer:g}=e,{hasProperty:v,isCommutative:y,isAssociative:x,mergeContext:b,flatten:_,unflattenr:w,unflattenl:S,createMakeNodeFunction:M,defaultContext:D,realContext:E,positiveContext:C}=MQ({FunctionNode:u,OperatorNode:f,SymbolNode:m});t.addConversion({from:"Object",to:"Map",convert:IC});var A=t("simplify",{Node:O,"Node, Map":(e,t)=>O(e,!1,t),"Node, Map, Object":(e,t,n)=>O(e,!1,t,n),"Node, Array":O,"Node, Array, Map":O,"Node, Array, Map, Object":O});function T(e){return e.transform((function(e){return _A(e)?T(e.content):e}))}t.removeConversion({from:"Object",to:"Map",convert:IC}),A.defaultContext=D,A.realContext=E,A.positiveContext=C;var N={true:!0,false:!0,e:!0,i:!0,Infinity:!0,LN2:!0,LN10:!0,LOG2E:!0,LOG10E:!0,NaN:!0,phi:!0,pi:!0,SQRT1_2:!0,SQRT2:!0,tau:!0};function R(e,t){var r={};if(e.s){var i=e.s.split("->");if(2!==i.length)throw SyntaxError("Could not parse rule: "+e.s);r.l=i[0],r.r=i[1]}else r.l=e.l,r.r=e.r;for(var a of(r.l=T(n(r.l)),r.r=T(n(r.r)),["imposeContext","repeat","assuming"]))a in e&&(r[a]=e[a]);if(e.evaluate&&(r.evaluate=n(e.evaluate)),x(r.l,t)){var o,s=!y(r.l,t);s&&(o=F());var l=M(r.l),c=F();r.expanded={},r.expanded.l=l([r.l,c]),_(r.expanded.l,t),w(r.expanded.l,t),r.expanded.r=l([r.r,c]),s&&(r.expandedNC1={},r.expandedNC1.l=l([o,r.l]),r.expandedNC1.r=l([o,r.r]),r.expandedNC2={},r.expandedNC2.l=l([o,r.expanded.l]),r.expandedNC2.r=l([o,r.expanded.r]))}return r}A.rules=[o,{l:"log(e)",r:"1"},{s:"n-n1 -> n+-n1",assuming:{subtract:{total:!0}}},{s:"n-n -> 0",assuming:{subtract:{total:!1}}},{s:"-(cl*v) -> v * (-cl)",assuming:{multiply:{commutative:!0},subtract:{total:!0}}},{s:"-(cl*v) -> (-cl) * v",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{s:"-(v*cl) -> v * (-cl)",assuming:{multiply:{commutative:!1},subtract:{total:!0}}},{l:"-(n1/n2)",r:"-n1/n2"},{l:"-v",r:"v * (-1)"},{l:"(n1 + n2)*(-1)",r:"n1*(-1) + n2*(-1)",repeat:!0},{l:"n/n1^n2",r:"n*n1^-n2"},{l:"n/n1",r:"n*n1^-1"},{s:"(n1*n2)^n3 -> n1^n3 * n2^n3",assuming:{multiply:{commutative:!0}}},{s:"(n1*n2)^(-1) -> n2^(-1) * n1^(-1)",assuming:{multiply:{commutative:!1}}},{s:"(n ^ n1) ^ n2 -> n ^ (n1 * n2)",assuming:{divide:{total:!0}}},{l:" vd   * ( vd   * n1 + n2)",r:"vd^2       * n1 +  vd   * n2"},{s:" vd   * (vd^n4 * n1 + n2)   ->  vd^(1+n4)  * n1 +  vd   * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * ( vd   * n1 + n2)   ->  vd^(n3+1)  * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{s:"vd^n3 * (vd^n4 * n1 + n2)   ->  vd^(n3+n4) * n1 + vd^n3 * n2",assuming:{divide:{total:!0}}},{l:"n*n",r:"n^2"},{s:"n * n^n1 -> n^(n1+1)",assuming:{divide:{total:!0}}},{s:"n^n1 * n^n2 -> n^(n1+n2)",assuming:{divide:{total:!0}}},a,{s:"n+n -> 2*n",assuming:{add:{total:!0}}},{l:"n+-n",r:"0"},{l:"vd*n + vd",r:"vd*(n+1)"},{l:"n3*n1 + n3*n2",r:"n3*(n1+n2)"},{l:"n3^(-n4)*n1 +   n3  * n2",r:"n3^(-n4)*(n1 + n3^(n4+1) *n2)"},{l:"n3^(-n4)*n1 + n3^n5 * n2",r:"n3^(-n4)*(n1 + n3^(n4+n5)*n2)"},{s:"n*vd + vd -> (n+1)*vd",assuming:{multiply:{commutative:!1}}},{s:"vd + n*vd -> (1+n)*vd",assuming:{multiply:{commutative:!1}}},{s:"n1*n3 + n2*n3 -> (n1+n2)*n3",assuming:{multiply:{commutative:!1}}},{s:"n^n1 * n -> n^(n1+1)",assuming:{divide:{total:!0},multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3    -> (n1 + n2*n3^(n4 +  1))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{s:"n1*n3^(-n4) + n2 * n3^n5 -> (n1 + n2*n3^(n4 + n5))*n3^(-n4)",assuming:{multiply:{commutative:!1}}},{l:"n*cd + cd",r:"(n+1)*cd"},{s:"cd*n + cd -> cd*(n+1)",assuming:{multiply:{commutative:!1}}},{s:"cd + cd*n -> cd*(1+n)",assuming:{multiply:{commutative:!1}}},a,{s:"(-n)*n1 -> -(n*n1)",assuming:{subtract:{total:!0}}},{s:"n1*(-n) -> -(n1*n)",assuming:{subtract:{total:!0},multiply:{commutative:!1}}},{s:"ce+ve -> ve+ce",assuming:{add:{commutative:!0}},imposeContext:{add:{commutative:!1}}},{s:"vd*cd -> cd*vd",assuming:{multiply:{commutative:!0}},imposeContext:{multiply:{commutative:!1}}},{l:"n+-n1",r:"n-n1"},{l:"n+-(n1)",r:"n-(n1)"},{s:"n*(n1^-1) -> n/n1",assuming:{multiply:{commutative:!0}}},{s:"n*n1^-n2 -> n/n1^n2",assuming:{multiply:{commutative:!0}}},{s:"n^-1 -> 1/n",assuming:{multiply:{commutative:!0}}},{l:"n^1",r:"n"},{s:"n*(n1/n2) -> (n*n1)/n2",assuming:{multiply:{associative:!0}}},{s:"n-(n1+n2) -> n-n1-n2",assuming:{addition:{associative:!0,commutative:!0}}},{l:"1*n",r:"n",imposeContext:{multiply:{commutative:!0}}},{s:"n1/(n2/n3) -> (n1*n3)/n2",assuming:{multiply:{associative:!0}}},{l:"n1/(-n2)",r:"-n1/n2"}];var P=0;function F(){return new m("_p"+P++)}function O(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:OC(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.consoleDebug;t=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],a=void 0,o=typeof i;switch(o){case"string":i={s:i};case"object":a=R(i,t);break;case"function":a=i;break;default:throw TypeError("Unsupported type of rule: "+o)}n.push(a)}return n}(t||A.rules,r.context);for(var o=i(e,n),s={},l=(o=T(o)).toString({parenthesis:"all"});!s[l];){s[l]=!0,P=0;var c=l;a&&console.log("Working on: ",l);for(var u=0;u<t.length;u++){var h="";if("function"===typeof t[u]?(o=t[u](o,r),a&&(h=t[u].name)):(_(o,r.context),o=B(o,t[u],r.context),a&&(h="".concat(t[u].l.toString()," -> ").concat(t[u].r.toString()))),a){var d=o.toString({parenthesis:"all"});d!==c&&(console.log("Applying",h,"produced",d),c=d)}S(o,r.context)}l=o.toString({parenthesis:"all"})}return o}function I(e,t,n){var r=e;if(e)for(var i=0;i<e.length;++i){var a=B(e[i],t,n);a!==e[i]&&(r===e&&(r=e.slice()),r[i]=a)}return r}function B(e,t,n){if(t.assuming)for(var r in t.assuming)for(var i in t.assuming[r])if(v(r,i,n)!==t.assuming[r][i])return e;var a=b(t.imposeContext,n),o=e;if(o instanceof f||o instanceof u){var c=I(o.args,t,n);c!==o.args&&((o=o.clone()).args=c)}else if(o instanceof p){if(o.content){var m=B(o.content,t,n);m!==o.content&&(o=new p(m))}}else if(o instanceof l){var g=I(o.items,t,n);g!==o.items&&(o=new l(g))}else if(o instanceof s){var y=o.object;o.object&&(y=B(o.object,t,n));var x=o.index;o.index&&(x=B(o.index,t,n)),y===o.object&&x===o.index||(o=new s(y,x))}else if(o instanceof h){var _=I(o.dimensions,t,n);_!==o.dimensions&&(o=new h(_))}else if(o instanceof d){var w=!1,S={};for(var M in o.properties)S[M]=B(o.properties[M],t,n),S[M]!==o.properties[M]&&(w=!0);w&&(o=new d(S))}var D=t.r,E=U(t.l,o,a)[0];if(!E&&t.expanded&&(D=t.expanded.r,E=U(t.expanded.l,o,a)[0]),!E&&t.expandedNC1&&(D=t.expandedNC1.r,(E=U(t.expandedNC1.l,o,a)[0])||(D=t.expandedNC2.r,E=U(t.expandedNC2.l,o,a)[0])),E){var C=o.implicit;o=D.clone(),C&&"implicit"in D&&(o.implicit=!0),o=o.transform((function(e){return e.isSymbolNode&&OA(E.placeholders,e.name)?E.placeholders[e.name].clone():e}))}return t.repeat&&o!==e&&(o=B(o,t,n)),o}function k(e,t){var n={placeholders:{}};if(!e.placeholders&&!t.placeholders)return n;if(!e.placeholders)return t;if(!t.placeholders)return e;for(var r in e.placeholders)if(OA(e.placeholders,r)&&(n.placeholders[r]=e.placeholders[r],OA(t.placeholders,r)&&!z(e.placeholders[r],t.placeholders[r])))return null;for(var i in t.placeholders)OA(t.placeholders,i)&&(n.placeholders[i]=t.placeholders[i]);return n}function L(e,t){var n,r=[];if(0===e.length||0===t.length)return r;for(var i=0;i<e.length;i++)for(var a=0;a<t.length;a++)(n=k(e[i],t[a]))&&r.push(n);return r}function U(e,t,n,i){var a=[{placeholders:{}}];if(e instanceof f&&t instanceof f||e instanceof u&&t instanceof u){if(e instanceof f){if(e.op!==t.op||e.fn!==t.fn)return[]}else if(e instanceof u&&e.name!==t.name)return[];if(!(1===t.args.length&&1===e.args.length||!x(t,n)&&t.args.length===e.args.length||i)){if(t.args.length>=2&&2===e.args.length){for(var o=function(e,t){var n,r,i=[],a=M(e);if(y(e,t))for(var o=0;o<e.args.length;o++)(r=e.args.slice(0)).splice(o,1),n=1===r.length?r[0]:a(r),i.push(a([e.args[o],n]));else for(var s=1;s<e.args.length;s++){var l=e.args[0];s>1&&(l=a(e.args.slice(0,s))),n=1===(r=e.args.slice(s)).length?r[0]:a(r),i.push(a([l,n]))}return i}(t,n),s=[],l=0;l<o.length;l++){var h=U(e,o[l],n,!0);s=s.concat(h)}return s}if(e.args.length>2)throw Error("Unexpected non-binary associative function: "+e.toString());return[]}for(var d=[],p=0;p<e.args.length;p++){var v=U(e.args[p],t.args[p],n);if(0===v.length)break;d.push(v)}if(d.length!==e.args.length){if(!y(t,n)||1===e.args.length)return[];if(e.args.length>2)throw new Error("permuting >2 commutative non-associative rule arguments not yet implemented");var b=U(e.args[0],t.args[1],n);if(0===b.length)return[];var _=U(e.args[1],t.args[0],n);if(0===_.length)return[];d=[b,_]}a=function(e){if(0===e.length)return e;for(var t=e.reduce(L),n=[],r={},i=0;i<t.length;i++){var a=JSON.stringify(t[i],g);r[a]||(r[a]=!0,n.push(t[i]))}return n}(d)}else if(e instanceof m){if(0===e.name.length)throw new Error("Symbol in rule has 0 length...!?");if(N[e.name]){if(e.name!==t.name)return[]}else switch(e.name[1]>="a"&&e.name[1]<="z"?e.name.substring(0,2):e.name[0]){case"n":case"_p":a[0].placeholders[e.name]=t;break;case"c":case"cl":if(!fA(t))return[];a[0].placeholders[e.name]=t;break;case"v":if(fA(t))return[];a[0].placeholders[e.name]=t;break;case"vl":if(!MA(t))return[];a[0].placeholders[e.name]=t;break;case"cd":if(!OQ(t))return[];a[0].placeholders[e.name]=t;break;case"vd":if(OQ(t))return[];a[0].placeholders[e.name]=t;break;case"ce":if(!IQ(t))return[];a[0].placeholders[e.name]=t;break;case"ve":if(IQ(t))return[];a[0].placeholders[e.name]=t;break;default:throw new Error("Invalid symbol in rule: "+e.name)}}else{if(!(e instanceof c))return[];if(!r(e.value,t.value))return[]}return a}function z(e,t){if(e instanceof c&&t instanceof c){if(!r(e.value,t.value))return!1}else if(e instanceof m&&t instanceof m){if(e.name!==t.name)return!1}else{if(!(e instanceof f&&t instanceof f||e instanceof u&&t instanceof u))return!1;if(e instanceof f){if(e.op!==t.op||e.fn!==t.fn)return!1}else if(e instanceof u&&e.name!==t.name)return!1;if(e.args.length!==t.args.length)return!1;for(var n=0;n<e.args.length;n++)if(!z(e.args[n],t.args[n]))return!1}return!0}return A})),LQ="symbolicEqual",UQ=["parse","simplify","typed","OperatorNode"],zQ=SN(LQ,UQ,(e=>{var{parse:t,simplify:n,typed:r,OperatorNode:i}=e;function a(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=new i("-","subtract",[e,t]),o=n(a,{},r);return fA(o)&&!o.value}return r(LQ,{"Node, Node":a,"Node, Node, Object":a})})),HQ="leafCount",VQ=["parse","typed"],GQ=SN(HQ,VQ,(e=>{var{parse:t,typed:n}=e;function r(e){var t=0;return e.forEach((e=>{t+=r(e)})),t||1}return n(HQ,{Node:function(e){return r(e)}})})),qQ="parser",jQ=["typed","Parser"],WQ=SN(qQ,jQ,(e=>{var{typed:t,Parser:n}=e;return t(qQ,{"":function(){return new n}})})),XQ="rationalize",YQ=["config","typed","equal","isZero","add","subtract","multiply","divide","pow","parse","simplifyConstant","simplifyCore","simplify","?bignumber","?fraction","mathWithTransform","matrix","AccessorNode","ArrayNode","ConstantNode","FunctionNode","IndexNode","ObjectNode","OperatorNode","SymbolNode","ParenthesisNode"],ZQ=SN(XQ,YQ,(e=>{var{config:t,typed:n,equal:r,isZero:i,add:a,subtract:o,multiply:s,divide:l,pow:c,parse:u,simplifyConstant:h,simplifyCore:d,simplify:f,fraction:p,bignumber:m,mathWithTransform:g,matrix:v,AccessorNode:y,ArrayNode:x,ConstantNode:b,FunctionNode:_,IndexNode:w,ObjectNode:S,OperatorNode:M,SymbolNode:D,ParenthesisNode:E}=e;function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(){var e=[d,{l:"n+n",r:"2*n"},{l:"n+-n",r:"0"},h,{l:"n*(n1^-1)",r:"n/n1"},{l:"n*n1^-n2",r:"n/n1^n2"},{l:"n1^-1",r:"1/n1"},{l:"n*(n1/n2)",r:"(n*n1)/n2"},{l:"1*n",r:"n"}],t=[{l:"(-n1)/(-n2)",r:"n1/n2"},{l:"(-n1)*(-n2)",r:"n1*n2"},{l:"n1--n2",r:"n1+n2"},{l:"n1-n2",r:"n1+(-n2)"},{l:"(n1+n2)*n3",r:"(n1*n3 + n2*n3)"},{l:"n1*(n2+n3)",r:"(n1*n2+n1*n3)"},{l:"c1*n + c2*n",r:"(c1+c2)*n"},{l:"c1*n + n",r:"(c1+1)*n"},{l:"c1*n - c2*n",r:"(c1-c2)*n"},{l:"c1*n - n",r:"(c1-1)*n"},{l:"v/c",r:"(1/c)*v"},{l:"v/-c",r:"-(1/c)*v"},{l:"-v*-c",r:"c*v"},{l:"-v*c",r:"-c*v"},{l:"v*-c",r:"-c*v"},{l:"v*c",r:"c*v"},{l:"-(-n1*n2)",r:"(n1*n2)"},{l:"-(n1*n2)",r:"(-n1*n2)"},{l:"-(-n1+n2)",r:"(n1-n2)"},{l:"-(n1+n2)",r:"(-n1-n2)"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"},{l:"-(-n1/n2)",r:"(n1/n2)"},{l:"-(n1/n2)",r:"(-n1/n2)"}],n=[{l:"(n1/n2 + n3/n4)",r:"((n1*n4 + n3*n2)/(n2*n4))"},{l:"(n1/n2 + n3)",r:"((n1 + n3*n2)/n2)"},{l:"(n1 + n2/n3)",r:"((n1*n3 + n2)/n3)"}],r=[{l:"(n1/(n2/n3))",r:"((n1*n3)/n2)"},{l:"(n1/n2/n3)",r:"(n1/(n2*n3))"}],i={};return i.firstRules=e.concat(t,r),i.distrDivRules=n,i.sucDivRules=r,i.firstRulesAgain=e.concat(t),i.finalRules=[d,{l:"n*-n",r:"-n^2"},{l:"n*n",r:"n^2"},h,{l:"n*-n^n1",r:"-n^(n1+1)"},{l:"n*n^n1",r:"n^(n1+1)"},{l:"n^n1*-n^n2",r:"-n^(n1+n2)"},{l:"n^n1*n^n2",r:"n^(n1+n2)"},{l:"n^n1*-n",r:"-n^(n1+1)"},{l:"n^n1*n",r:"n^(n1+1)"},{l:"n^n1/-n",r:"-n^(n1-1)"},{l:"n^n1/n",r:"n^(n1-1)"},{l:"n/-n^n1",r:"-n^(1-n1)"},{l:"n/n^n1",r:"n^(1-n1)"},{l:"n^n1/-n^n2",r:"n^(n1-n2)"},{l:"n^n1/n^n2",r:"n^(n1-n2)"},{l:"n1+(-n2*n3)",r:"n1-n2*n3"},{l:"v*(-c)",r:"-c*v"},{l:"n1+-n2",r:"n1-n2"},{l:"v*c",r:"c*v"},{l:"(n1^n2)^n3",r:"(n1^(n2*n3))"}],i}(),i=function(e,t,n,r){var i=[],a=f(e,r,t,{exactFractions:!1}),o="+-*"+((n=!!n)?"/":"");l(a);var s={};return s.expression=a,s.variables=i,s;function l(e){var t=e.type;if("FunctionNode"===t)throw new Error("There is an unsolved function call");if("OperatorNode"===t)if("^"===e.op){if("ConstantNode"!==e.args[1].type||!IN(parseFloat(e.args[1].value)))throw new Error("There is a non-integer exponent");l(e.args[0])}else{if(!o.includes(e.op))throw new Error("Operator "+e.op+" invalid in polynomial expression");for(var n=0;n<e.args.length;n++)l(e.args[n])}else if("SymbolNode"===t){var r=e.name;-1===i.indexOf(r)&&i.push(r)}else if("ParenthesisNode"===t)l(e.content);else if("ConstantNode"!==t)throw new Error("type "+t+" is not allowed in polynomial expression")}}(e,t,!0,r.firstRules),a=i.variables.length,o={exactFractions:!1},s={exactFractions:!0};if(e=i.expression,a>=1){var l,c;e=A(e);var u,p=!0,m=!1;for(e=f(e,r.firstRules,{},o);c=p?r.distrDivRules:r.sucDivRules,p=!p,(u=(e=f(e,c,{},s)).toString())!==l;)m=!0,l=u;m&&(e=f(e,r.firstRulesAgain,{},o)),e=f(e,r.finalRules,{},o)}var g=[],v={};return"OperatorNode"===e.type&&e.isBinary()&&"/"===e.op?(1===a&&(e.args[0]=T(e.args[0],g),e.args[1]=T(e.args[1])),n&&(v.numerator=e.args[0],v.denominator=e.args[1])):(1===a&&(e=T(e,g)),n&&(v.numerator=e,v.denominator=null)),n?(v.coefficients=g,v.variables=i.variables,v.expression=e,v):e}return n(XQ,{Node:C,"Node, boolean":(e,t)=>C(e,{},t),"Node, Object":C,"Node, Object, boolean":C});function A(e,t,n){var r=e.type,i=arguments.length>1;if("OperatorNode"===r&&e.isBinary()){var a,o=!1;if("^"===e.op&&("ParenthesisNode"!==e.args[0].type&&"OperatorNode"!==e.args[0].type||"ConstantNode"!==e.args[1].type||(o=(a=parseFloat(e.args[1].value))>=2&&IN(a))),o){if(a>2){var s=e.args[0],l=new M("^","pow",[e.args[0].cloneDeep(),new b(a-1)]);e=new M("*","multiply",[s,l])}else e=new M("*","multiply",[e.args[0],e.args[0].cloneDeep()]);i&&("content"===n?t.content=e:t.args[n]=e)}}if("ParenthesisNode"===r)A(e.content,e,"content");else if("ConstantNode"!==r&&"SymbolNode"!==r)for(var c=0;c<e.args.length;c++)A(e.args[c],e,c);if(!i)return e}function T(e,t){void 0===t&&(t=[]),t[0]=0;var n={cte:1,oper:"+",fire:""},r=0,i="";!function e(n,a,o){var s=n.type;if("FunctionNode"===s)throw new Error("There is an unsolved function call");if("OperatorNode"===s){if(!"+-*^".includes(n.op))throw new Error("Operator "+n.op+" invalid");if(null!==a){if(("unaryMinus"===n.fn||"pow"===n.fn)&&"add"!==a.fn&&"subtract"!==a.fn&&"multiply"!==a.fn)throw new Error("Invalid "+n.op+" placing");if(("subtract"===n.fn||"add"===n.fn||"multiply"===n.fn)&&"add"!==a.fn&&"subtract"!==a.fn)throw new Error("Invalid "+n.op+" placing");if(("subtract"===n.fn||"add"===n.fn||"unaryMinus"===n.fn)&&0!==o.noFil)throw new Error("Invalid "+n.op+" placing")}"^"!==n.op&&"*"!==n.op||(o.fire=n.op);for(var l=0;l<n.args.length;l++)"unaryMinus"===n.fn&&(o.oper="-"),"+"!==n.op&&"subtract"!==n.fn||(o.fire="",o.cte=1,o.oper=0===l?"+":n.op),o.noFil=l,e(n.args[l],n,o)}else if("SymbolNode"===s){if(n.name!==i&&""!==i)throw new Error("There is more than one variable");if(i=n.name,null===a)return void(t[1]=1);if("^"===a.op&&0!==o.noFil)throw new Error("In power the variable should be the first parameter");if("*"===a.op&&1!==o.noFil)throw new Error("In multiply the variable should be the second parameter");""!==o.fire&&"*"!==o.fire||(r<1&&(t[1]=0),t[1]+=o.cte*("+"===o.oper?1:-1),r=Math.max(1,r))}else{if("ConstantNode"!==s)throw new Error("Type "+s+" is not allowed");var c=parseFloat(n.value);if(null===a)return void(t[0]=c);if("^"===a.op){if(1!==o.noFil)throw new Error("Constant cannot be powered");if(!IN(c)||c<=0)throw new Error("Non-integer exponent is not allowed");for(var u=r+1;u<c;u++)t[u]=0;return c>r&&(t[c]=0),t[c]+=o.cte*("+"===o.oper?1:-1),void(r=Math.max(c,r))}o.cte=c,""===o.fire&&(t[0]+=o.cte*("+"===o.oper?1:-1))}}(e,null,n);for(var a,o=!0,s=r=t.length-1;s>=0;s--)if(0!==t[s]){var l=new b(o?t[s]:Math.abs(t[s])),c=t[s]<0?"-":"+";if(s>0){var u=new D(i);if(s>1){var h=new b(s);u=new M("^","pow",[u,h])}l=-1===t[s]&&o?new M("-","unaryMinus",[u]):1===Math.abs(t[s])?u:new M("*","multiply",[l,u])}a=o?l:"+"===c?new M("+","add",[a,l]):new M("-","subtract",[a,l]),o=!1}return o?new b(0):a}})),KQ="derivative",QQ=["typed","config","parse","simplify","equal","isZero","numeric","ConstantNode","FunctionNode","OperatorNode","ParenthesisNode","SymbolNode"],JQ=SN(KQ,QQ,(e=>{var{typed:t,config:n,parse:r,simplify:i,equal:a,isZero:o,numeric:s,ConstantNode:l,FunctionNode:c,OperatorNode:u,ParenthesisNode:h,SymbolNode:d}=e;function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{simplify:!0},r=new Map,a=t.name;var o=y(e,(function e(t){var n=r.get(t);if(void 0!==n)return n;var i=v(e,t,a);return r.set(t,i),i}));return n.simplify?i(o):o}function p(e){var t=r(e);if(!t.isSymbolNode)throw new TypeError("Invalid variable. "+"Cannot parse ".concat(JSON.stringify(e)," into a variable in function derivative"));return t}var m=t(KQ,{"Node, SymbolNode":f,"Node, SymbolNode, Object":f,"Node, string":(e,t)=>f(e,p(t)),"Node, string, Object":(e,t,n)=>f(e,p(t),n)});m._simplify=!0,m.toTex=function(e){return g.apply(null,e.args)};var g=t("_derivTex",{"Node, SymbolNode":function(e,t){return fA(e)&&"string"===EA(e.value)?g(r(e.value).toString(),t.toString(),1):g(e.toTex(),t.toString(),1)},"Node, ConstantNode":function(e,t){if("string"===EA(t.value))return g(e,r(t.value));throw new Error("The second parameter to 'derivative' is a non-string constant")},"Node, SymbolNode, ConstantNode":function(e,t,n){return g(e.toString(),t.name,n.value)},"string, string, number":function(e,t,n){return(1===n?"{d\\over d"+t+"}":"{d^{"+n+"}\\over d"+t+"^{"+n+"}}")+"\\left[".concat(e,"\\right]")}}),v=t("_isConst",{"function, ConstantNode, string":function(){return!0},"function, SymbolNode, string":function(e,t,n){return t.name!==n},"function, ParenthesisNode, string":function(e,t,n){return e(t.content,n)},"function, FunctionAssignmentNode, string":function(e,t,n){return!t.params.includes(n)||e(t.expr,n)},"function, FunctionNode | OperatorNode, string":function(e,t,n){return t.args.every((t=>e(t,n)))}}),y=t("_derivative",{"ConstantNode, function":function(){return x(0)},"SymbolNode, function":function(e,t){return t(e)?x(0):x(1)},"ParenthesisNode, function":function(e,t){return new h(y(e.content,t))},"FunctionAssignmentNode, function":function(e,t){return t(e)?x(0):y(e.expr,t)},"FunctionNode, function":function(e,t){if(t(e))return x(0);var n,r,i,a,o=e.args[0],s=!1,l=!1;switch(e.name){case"cbrt":s=!0,r=new u("*","multiply",[x(3),new u("^","pow",[o,new u("/","divide",[x(2),x(3)])])]);break;case"sqrt":case"nthRoot":if(1===e.args.length)s=!0,r=new u("*","multiply",[x(2),new c("sqrt",[o])]);else if(2===e.args.length)return n=new u("/","divide",[x(1),e.args[1]]),y(new u("^","pow",[o,n]),t);break;case"log10":n=x(10);case"log":if(n||1!==e.args.length){if(1===e.args.length&&n||2===e.args.length&&t(e.args[1]))r=new u("*","multiply",[o.clone(),new c("log",[n||e.args[1]])]),s=!0;else if(2===e.args.length)return y(new u("/","divide",[new c("log",[o]),new c("log",[e.args[1]])]),t)}else r=o.clone(),s=!0;break;case"pow":if(2===e.args.length)return y(new u("^","pow",[o,e.args[1]]),t);break;case"exp":r=new c("exp",[o.clone()]);break;case"sin":r=new c("cos",[o.clone()]);break;case"cos":r=new u("-","unaryMinus",[new c("sin",[o.clone()])]);break;case"tan":r=new u("^","pow",[new c("sec",[o.clone()]),x(2)]);break;case"sec":r=new u("*","multiply",[e,new c("tan",[o.clone()])]);break;case"csc":l=!0,r=new u("*","multiply",[e,new c("cot",[o.clone()])]);break;case"cot":l=!0,r=new u("^","pow",[new c("csc",[o.clone()]),x(2)]);break;case"asin":s=!0,r=new c("sqrt",[new u("-","subtract",[x(1),new u("^","pow",[o.clone(),x(2)])])]);break;case"acos":s=!0,l=!0,r=new c("sqrt",[new u("-","subtract",[x(1),new u("^","pow",[o.clone(),x(2)])])]);break;case"atan":s=!0,r=new u("+","add",[new u("^","pow",[o.clone(),x(2)]),x(1)]);break;case"asec":s=!0,r=new u("*","multiply",[new c("abs",[o.clone()]),new c("sqrt",[new u("-","subtract",[new u("^","pow",[o.clone(),x(2)]),x(1)])])]);break;case"acsc":s=!0,l=!0,r=new u("*","multiply",[new c("abs",[o.clone()]),new c("sqrt",[new u("-","subtract",[new u("^","pow",[o.clone(),x(2)]),x(1)])])]);break;case"acot":s=!0,l=!0,r=new u("+","add",[new u("^","pow",[o.clone(),x(2)]),x(1)]);break;case"sinh":r=new c("cosh",[o.clone()]);break;case"cosh":r=new c("sinh",[o.clone()]);break;case"tanh":r=new u("^","pow",[new c("sech",[o.clone()]),x(2)]);break;case"sech":l=!0,r=new u("*","multiply",[e,new c("tanh",[o.clone()])]);break;case"csch":l=!0,r=new u("*","multiply",[e,new c("coth",[o.clone()])]);break;case"coth":l=!0,r=new u("^","pow",[new c("csch",[o.clone()]),x(2)]);break;case"asinh":s=!0,r=new c("sqrt",[new u("+","add",[new u("^","pow",[o.clone(),x(2)]),x(1)])]);break;case"acosh":s=!0,r=new c("sqrt",[new u("-","subtract",[new u("^","pow",[o.clone(),x(2)]),x(1)])]);break;case"atanh":s=!0,r=new u("-","subtract",[x(1),new u("^","pow",[o.clone(),x(2)])]);break;case"asech":s=!0,l=!0,r=new u("*","multiply",[o.clone(),new c("sqrt",[new u("-","subtract",[x(1),new u("^","pow",[o.clone(),x(2)])])])]);break;case"acsch":s=!0,l=!0,r=new u("*","multiply",[new c("abs",[o.clone()]),new c("sqrt",[new u("+","add",[new u("^","pow",[o.clone(),x(2)]),x(1)])])]);break;case"acoth":s=!0,l=!0,r=new u("-","subtract",[x(1),new u("^","pow",[o.clone(),x(2)])]);break;case"abs":r=new u("/","divide",[new c(new d("abs"),[o.clone()]),o.clone()]);break;default:throw new Error('Cannot process function "'+e.name+'" in derivative: the function is not supported, undefined, or the number of arguments passed to it are not supported')}s?(i="/",a="divide"):(i="*",a="multiply");var h=y(o,t);return l&&(h=new u("-","unaryMinus",[h])),new u(i,a,[h,r])},"OperatorNode, function":function(e,t){if(t(e))return x(0);if("+"===e.op)return new u(e.op,e.fn,e.args.map((function(e){return y(e,t)})));if("-"===e.op){if(e.isUnary())return new u(e.op,e.fn,[y(e.args[0],t)]);if(e.isBinary())return new u(e.op,e.fn,[y(e.args[0],t),y(e.args[1],t)])}if("*"===e.op){var n=e.args.filter((function(e){return t(e)}));if(n.length>0){var r=e.args.filter((function(e){return!t(e)})),i=1===r.length?r[0]:new u("*","multiply",r),s=n.concat(y(i,t));return new u("*","multiply",s)}return new u("+","add",e.args.map((function(n){return new u("*","multiply",e.args.map((function(e){return e===n?y(e,t):e.clone()})))})))}if("/"===e.op&&e.isBinary()){var l=e.args[0],h=e.args[1];return t(h)?new u("/","divide",[y(l,t),h]):t(l)?new u("*","multiply",[new u("-","unaryMinus",[l]),new u("/","divide",[y(h,t),new u("^","pow",[h.clone(),x(2)])])]):new u("/","divide",[new u("-","subtract",[new u("*","multiply",[y(l,t),h.clone()]),new u("*","multiply",[l.clone(),y(h,t)])]),new u("^","pow",[h.clone(),x(2)])])}if("^"===e.op&&e.isBinary()){var d=e.args[0],f=e.args[1];if(t(d))return fA(d)&&(o(d.value)||a(d.value,1))?x(0):new u("*","multiply",[e,new u("*","multiply",[new c("log",[d.clone()]),y(f.clone(),t)])]);if(t(f)){if(fA(f)){if(o(f.value))return x(0);if(a(f.value,1))return y(d,t)}var p=new u("^","pow",[d.clone(),new u("-","subtract",[f,x(1)])]);return new u("*","multiply",[f.clone(),new u("*","multiply",[y(d,t),p])])}return new u("*","multiply",[new u("^","pow",[d.clone(),f.clone()]),new u("+","add",[new u("*","multiply",[y(d,t),new u("/","divide",[f.clone(),d.clone()])]),new u("*","multiply",[y(f,t),new c("log",[d.clone()])])])])}throw new Error('Cannot process operator "'+e.op+'" in derivative: the operator is not supported, undefined, or the number of arguments passed to it are not supported')}});function x(e,t){return new l(s(e,t||BN(String(e),n)))}return m})),$Q={name:"e",category:"Constants",syntax:["e"],description:"Euler's number, the base of the natural logarithm. Approximately equal to 2.71828",examples:["e","e ^ 2","exp(2)","log(e)"],seealso:["exp"]},eJ={name:"pi",category:"Constants",syntax:["pi"],description:"The number pi is a mathematical constant that is the ratio of a circle's circumference to its diameter, and is approximately equal to 3.14159",examples:["pi","sin(pi/2)"],seealso:["tau"]},tJ={bignumber:{name:"bignumber",category:"Construction",syntax:["bignumber(x)"],description:"Create a big number from a number or string.",examples:["0.1 + 0.2","bignumber(0.1) + bignumber(0.2)",'bignumber("7.2")','bignumber("7.2e500")',"bignumber([0.1, 0.2, 0.3])"],seealso:["boolean","bigint","complex","fraction","index","matrix","string","unit"]},bigint:{name:"bigint",category:"Construction",syntax:["bigint(x)"],description:"Create a bigint, an integer with an arbitrary number of digits, from a number or string.",examples:["123123123123123123 # a large number will lose digits",'bigint("123123123123123123")','bignumber(["1", "3", "5"])'],seealso:["boolean","bignumber","number","complex","fraction","index","matrix","string","unit"]},boolean:{name:"boolean",category:"Construction",syntax:["x","boolean(x)"],description:"Convert a string or number into a boolean.",examples:["boolean(0)","boolean(1)","boolean(3)",'boolean("true")','boolean("false")',"boolean([1, 0, 1, 1])"],seealso:["bignumber","complex","index","matrix","number","string","unit"]},complex:{name:"complex",category:"Construction",syntax:["complex()","complex(re, im)","complex(string)"],description:"Create a complex number.",examples:["complex()","complex(2, 3)",'complex("7 - 2i")'],seealso:["bignumber","boolean","index","matrix","number","string","unit"]},createUnit:{name:"createUnit",category:"Construction",syntax:["createUnit(definitions)","createUnit(name, definition)"],description:"Create a user-defined unit and register it with the Unit type.",examples:['createUnit("foo")','createUnit("knot", {definition: "0.514444444 m/s", aliases: ["knots", "kt", "kts"]})','createUnit("mph", "1 mile/hour")'],seealso:["unit","splitUnit"]},fraction:{name:"fraction",category:"Construction",syntax:["fraction(num)","fraction(matrix)","fraction(num,den)","fraction({n: num, d: den})"],description:"Create a fraction from a number or from integer numerator and denominator.",examples:["fraction(0.125)","fraction(1, 3) + fraction(2, 5)","fraction({n: 333, d: 53})","fraction([sqrt(9), sqrt(10), sqrt(11)])"],seealso:["bignumber","boolean","complex","index","matrix","string","unit"]},index:{name:"index",category:"Construction",syntax:["[start]","[start:end]","[start:step:end]","[start1, start 2, ...]","[start1:end1, start2:end2, ...]","[start1:step1:end1, start2:step2:end2, ...]"],description:"Create an index to get or replace a subset of a matrix",examples:["A = [1, 2, 3; 4, 5, 6]","A[1, :]","A[1, 2] = 50","A[1:2, 1:2] = 1","B = [1, 2, 3]","B[B>1 and B<3]"],seealso:["bignumber","boolean","complex","matrix,","number","range","string","unit"]},matrix:{name:"matrix",category:"Construction",syntax:["[]","[a1, b1, ...; a2, b2, ...]","matrix()",'matrix("dense")',"matrix([...])"],description:"Create a matrix.",examples:["[]","[1, 2, 3]","[1, 2, 3; 4, 5, 6]","matrix()","matrix([3, 4])",'matrix([3, 4; 5, 6], "sparse")','matrix([3, 4; 5, 6], "sparse", "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","sparse"]},number:{name:"number",category:"Construction",syntax:["x","number(x)","number(unit, valuelessUnit)"],description:"Create a number or convert a string or boolean into a number.",examples:["2","2e3","4.05","number(2)",'number("7.2")',"number(true)","number([true, false, true, true])",'number(unit("52cm"), "m")'],seealso:["bignumber","bigint","boolean","complex","fraction","index","matrix","string","unit"]},sparse:{name:"sparse",category:"Construction",syntax:["sparse()","sparse([a1, b1, ...; a1, b2, ...])",'sparse([a1, b1, ...; a1, b2, ...], "number")'],description:"Create a sparse matrix.",examples:["sparse()","sparse([3, 4; 5, 6])",'sparse([3, 0; 5, 0], "number")'],seealso:["bignumber","boolean","complex","index","number","string","unit","matrix"]},splitUnit:{name:"splitUnit",category:"Construction",syntax:["splitUnit(unit: Unit, parts: Unit[])"],description:"Split a unit in an array of units whose sum is equal to the original unit.",examples:['splitUnit(1 m, ["feet", "inch"])'],seealso:["unit","createUnit"]},string:{name:"string",category:"Construction",syntax:['"text"',"string(x)"],description:"Create a string or convert a value to a string",examples:['"Hello World!"',"string(4.2)","string(3 + 2i)"],seealso:["bignumber","boolean","complex","index","matrix","number","unit"]},unit:{name:"unit",category:"Construction",syntax:["value unit","unit(value, unit)","unit(string)"],description:"Create a unit.",examples:["5.5 mm","3 inch",'unit(7.1, "kilogram")','unit("23 deg")'],seealso:["bignumber","boolean","complex","index","matrix","number","string"]},e:$Q,E:$Q,false:{name:"false",category:"Constants",syntax:["false"],description:"Boolean value false",examples:["false"],seealso:["true"]},i:{name:"i",category:"Constants",syntax:["i"],description:"Imaginary unit, defined as i*i=-1. A complex number is described as a + b*i, where a is the real part, and b is the imaginary part.",examples:["i","i * i","sqrt(-1)"],seealso:[]},Infinity:{name:"Infinity",category:"Constants",syntax:["Infinity"],description:"Infinity, a number which is larger than the maximum number that can be handled by a floating point number.",examples:["Infinity","1 / 0"],seealso:[]},LN2:{name:"LN2",category:"Constants",syntax:["LN2"],description:"Returns the natural logarithm of 2, approximately equal to 0.693",examples:["LN2","log(2)"],seealso:[]},LN10:{name:"LN10",category:"Constants",syntax:["LN10"],description:"Returns the natural logarithm of 10, approximately equal to 2.302",examples:["LN10","log(10)"],seealso:[]},LOG2E:{name:"LOG2E",category:"Constants",syntax:["LOG2E"],description:"Returns the base-2 logarithm of E, approximately equal to 1.442",examples:["LOG2E","log(e, 2)"],seealso:[]},LOG10E:{name:"LOG10E",category:"Constants",syntax:["LOG10E"],description:"Returns the base-10 logarithm of E, approximately equal to 0.434",examples:["LOG10E","log(e, 10)"],seealso:[]},NaN:{name:"NaN",category:"Constants",syntax:["NaN"],description:"Not a number",examples:["NaN","0 / 0"],seealso:[]},null:{name:"null",category:"Constants",syntax:["null"],description:"Value null",examples:["null"],seealso:["true","false"]},pi:eJ,PI:eJ,phi:{name:"phi",category:"Constants",syntax:["phi"],description:"Phi is the golden ratio. Two quantities are in the golden ratio if their ratio is the same as the ratio of their sum to the larger of the two quantities. Phi is defined as `(1 + sqrt(5)) / 2` and is approximately 1.618034...",examples:["phi"],seealso:[]},SQRT1_2:{name:"SQRT1_2",category:"Constants",syntax:["SQRT1_2"],description:"Returns the square root of 1/2, approximately equal to 0.707",examples:["SQRT1_2","sqrt(1/2)"],seealso:[]},SQRT2:{name:"SQRT2",category:"Constants",syntax:["SQRT2"],description:"Returns the square root of 2, approximately equal to 1.414",examples:["SQRT2","sqrt(2)"],seealso:[]},tau:{name:"tau",category:"Constants",syntax:["tau"],description:"Tau is the ratio constant of a circle's circumference to radius, equal to 2 * pi, approximately 6.2832.",examples:["tau","2 * pi"],seealso:["pi"]},true:{name:"true",category:"Constants",syntax:["true"],description:"Boolean value true",examples:["true"],seealso:["false"]},version:{name:"version",category:"Constants",syntax:["version"],description:"A string with the version number of math.js",examples:["version"],seealso:[]},speedOfLight:{description:"Speed of light in vacuum",examples:["speedOfLight"]},gravitationConstant:{description:"Newtonian constant of gravitation",examples:["gravitationConstant"]},planckConstant:{description:"Planck constant",examples:["planckConstant"]},reducedPlanckConstant:{description:"Reduced Planck constant",examples:["reducedPlanckConstant"]},magneticConstant:{description:"Magnetic constant (vacuum permeability)",examples:["magneticConstant"]},electricConstant:{description:"Electric constant (vacuum permeability)",examples:["electricConstant"]},vacuumImpedance:{description:"Characteristic impedance of vacuum",examples:["vacuumImpedance"]},coulomb:{description:"Coulomb's constant",examples:["coulomb"]},elementaryCharge:{description:"Elementary charge",examples:["elementaryCharge"]},bohrMagneton:{description:"Bohr magneton",examples:["bohrMagneton"]},conductanceQuantum:{description:"Conductance quantum",examples:["conductanceQuantum"]},inverseConductanceQuantum:{description:"Inverse conductance quantum",examples:["inverseConductanceQuantum"]},magneticFluxQuantum:{description:"Magnetic flux quantum",examples:["magneticFluxQuantum"]},nuclearMagneton:{description:"Nuclear magneton",examples:["nuclearMagneton"]},klitzing:{description:"Von Klitzing constant",examples:["klitzing"]},bohrRadius:{description:"Bohr radius",examples:["bohrRadius"]},classicalElectronRadius:{description:"Classical electron radius",examples:["classicalElectronRadius"]},electronMass:{description:"Electron mass",examples:["electronMass"]},fermiCoupling:{description:"Fermi coupling constant",examples:["fermiCoupling"]},fineStructure:{description:"Fine-structure constant",examples:["fineStructure"]},hartreeEnergy:{description:"Hartree energy",examples:["hartreeEnergy"]},protonMass:{description:"Proton mass",examples:["protonMass"]},deuteronMass:{description:"Deuteron Mass",examples:["deuteronMass"]},neutronMass:{description:"Neutron mass",examples:["neutronMass"]},quantumOfCirculation:{description:"Quantum of circulation",examples:["quantumOfCirculation"]},rydberg:{description:"Rydberg constant",examples:["rydberg"]},thomsonCrossSection:{description:"Thomson cross section",examples:["thomsonCrossSection"]},weakMixingAngle:{description:"Weak mixing angle",examples:["weakMixingAngle"]},efimovFactor:{description:"Efimov factor",examples:["efimovFactor"]},atomicMass:{description:"Atomic mass constant",examples:["atomicMass"]},avogadro:{description:"Avogadro's number",examples:["avogadro"]},boltzmann:{description:"Boltzmann constant",examples:["boltzmann"]},faraday:{description:"Faraday constant",examples:["faraday"]},firstRadiation:{description:"First radiation constant",examples:["firstRadiation"]},loschmidt:{description:"Loschmidt constant at T=273.15 K and p=101.325 kPa",examples:["loschmidt"]},gasConstant:{description:"Gas constant",examples:["gasConstant"]},molarPlanckConstant:{description:"Molar Planck constant",examples:["molarPlanckConstant"]},molarVolume:{description:"Molar volume of an ideal gas at T=273.15 K and p=101.325 kPa",examples:["molarVolume"]},sackurTetrode:{description:"Sackur-Tetrode constant at T=1 K and p=101.325 kPa",examples:["sackurTetrode"]},secondRadiation:{description:"Second radiation constant",examples:["secondRadiation"]},stefanBoltzmann:{description:"Stefan-Boltzmann constant",examples:["stefanBoltzmann"]},wienDisplacement:{description:"Wien displacement law constant",examples:["wienDisplacement"]},molarMass:{description:"Molar mass constant",examples:["molarMass"]},molarMassC12:{description:"Molar mass constant of carbon-12",examples:["molarMassC12"]},gravity:{description:"Standard acceleration of gravity (standard acceleration of free-fall on Earth)",examples:["gravity"]},planckLength:{description:"Planck length",examples:["planckLength"]},planckMass:{description:"Planck mass",examples:["planckMass"]},planckTime:{description:"Planck time",examples:["planckTime"]},planckCharge:{description:"Planck charge",examples:["planckCharge"]},planckTemperature:{description:"Planck temperature",examples:["planckTemperature"]},derivative:{name:"derivative",category:"Algebra",syntax:["derivative(expr, variable)","derivative(expr, variable, {simplify: boolean})"],description:"Takes the derivative of an expression expressed in parser Nodes. The derivative will be taken over the supplied variable in the second parameter. If there are multiple variables in the expression, it will return a partial derivative.",examples:['derivative("2x^3", "x")','derivative("2x^3", "x", {simplify: false})','derivative("2x^2 + 3x + 4", "x")','derivative("sin(2x)", "x")','f = parse("x^2 + x")','x = parse("x")',"df = derivative(f, x)","df.evaluate({x: 3})"],seealso:["simplify","parse","evaluate"]},lsolve:{name:"lsolve",category:"Algebra",syntax:["x=lsolve(L, b)"],description:"Finds one solution of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolveAll","lup","lusolve","usolve","matrix","sparse"]},lsolveAll:{name:"lsolveAll",category:"Algebra",syntax:["x=lsolveAll(L, b)"],description:"Finds all solutions of the linear system L * x = b where L is an [n x n] lower triangular matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lsolve(a, b)"],seealso:["lsolve","lup","lusolve","usolve","matrix","sparse"]},lup:{name:"lup",category:"Algebra",syntax:["lup(m)"],description:"Calculate the Matrix LU decomposition with partial pivoting. Matrix A is decomposed in three matrices (L, U, P) where P * A = L * U",examples:["lup([[2, 1], [1, 4]])","lup(matrix([[2, 1], [1, 4]]))","lup(sparse([[2, 1], [1, 4]]))"],seealso:["lusolve","lsolve","usolve","matrix","sparse","slu","qr"]},lusolve:{name:"lusolve",category:"Algebra",syntax:["x=lusolve(A, b)","x=lusolve(lu, b)"],description:"Solves the linear system A * x = b where A is an [n x n] matrix and b is a [n] column vector.",examples:["a = [-2, 3; 2, 1]","b = [11, 9]","x = lusolve(a, b)"],seealso:["lup","slu","lsolve","usolve","matrix","sparse"]},leafCount:{name:"leafCount",category:"Algebra",syntax:["leafCount(expr)"],description:"Computes the number of leaves in the parse tree of the given expression",examples:['leafCount("e^(i*pi)-1")','leafCount(parse("{a: 22/7, b: 10^(1/2)}"))'],seealso:["simplify"]},polynomialRoot:{name:"polynomialRoot",category:"Algebra",syntax:["x=polynomialRoot(-6, 3)","x=polynomialRoot(4, -4, 1)","x=polynomialRoot(-8, 12, -6, 1)"],description:"Finds the roots of a univariate polynomial given by its coefficients starting from constant, linear, and so on, increasing in degree.",examples:["a = polynomialRoot(-6, 11, -6, 1)"],seealso:["cbrt","sqrt"]},resolve:{name:"resolve",category:"Algebra",syntax:["resolve(node, scope)"],description:"Recursively substitute variables in an expression tree.",examples:['resolve(parse("1 + x"), { x: 7 })','resolve(parse("size(text)"), { text: "Hello World" })','resolve(parse("x + y"), { x: parse("3z") })','resolve(parse("3x"), { x: parse("y+z"), z: parse("w^y") })'],seealso:["simplify","evaluate"],mayThrow:["ReferenceError"]},simplify:{name:"simplify",category:"Algebra",syntax:["simplify(expr)","simplify(expr, rules)"],description:"Simplify an expression tree.",examples:['simplify("3 + 2 / 4")','simplify("2x + x")','f = parse("x * (x + 2 + x)")',"simplified = simplify(f)","simplified.evaluate({x: 2})"],seealso:["simplifyCore","derivative","evaluate","parse","rationalize","resolve"]},simplifyConstant:{name:"simplifyConstant",category:"Algebra",syntax:["simplifyConstant(expr)","simplifyConstant(expr, options)"],description:"Replace constant subexpressions of node with their values.",examples:['simplifyConstant("(3-3)*x")','simplifyConstant(parse("z-cos(tau/8)"))'],seealso:["simplify","simplifyCore","evaluate"]},simplifyCore:{name:"simplifyCore",category:"Algebra",syntax:["simplifyCore(node)"],description:"Perform simple one-pass simplifications on an expression tree.",examples:['simplifyCore(parse("0*x"))','simplifyCore(parse("(x+0)*2"))'],seealso:["simplify","simplifyConstant","evaluate"]},symbolicEqual:{name:"symbolicEqual",category:"Algebra",syntax:["symbolicEqual(expr1, expr2)","symbolicEqual(expr1, expr2, options)"],description:"Returns true if the difference of the expressions simplifies to 0",examples:['symbolicEqual("x*y","y*x")','symbolicEqual("abs(x^2)", "x^2")','symbolicEqual("abs(x)", "x", {context: {abs: {trivial: true}}})'],seealso:["simplify","evaluate"]},rationalize:{name:"rationalize",category:"Algebra",syntax:["rationalize(expr)","rationalize(expr, scope)","rationalize(expr, scope, detailed)"],description:"Transform a rationalizable expression in a rational fraction. If rational fraction is one variable polynomial then converts the numerator and denominator in canonical form, with decreasing exponents, returning the coefficients of numerator.",examples:['rationalize("2x/y - y/(x+1)")','rationalize("2x/y - y/(x+1)", true)'],seealso:["simplify"]},slu:{name:"slu",category:"Algebra",syntax:["slu(A, order, threshold)"],description:"Calculate the Matrix LU decomposition with full pivoting. Matrix A is decomposed in two matrices (L, U) and two permutation vectors (pinv, q) where P * A * Q = L * U",examples:["slu(sparse([4.5, 0, 3.2, 0; 3.1, 2.9, 0, 0.9; 0, 1.7, 3, 0; 3.5, 0.4, 0, 1]), 1, 0.001)"],seealso:["lusolve","lsolve","usolve","matrix","sparse","lup","qr"]},usolve:{name:"usolve",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds one solution of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolveAll","lup","lusolve","lsolve","matrix","sparse"]},usolveAll:{name:"usolveAll",category:"Algebra",syntax:["x=usolve(U, b)"],description:"Finds all solutions of the linear system U * x = b where U is an [n x n] upper triangular matrix and b is a [n] column vector.",examples:["x=usolve(sparse([1, 1, 1, 1; 0, 1, 1, 1; 0, 0, 1, 1; 0, 0, 0, 1]), [1; 2; 3; 4])"],seealso:["usolve","lup","lusolve","lsolve","matrix","sparse"]},qr:{name:"qr",category:"Algebra",syntax:["qr(A)"],description:"Calculates the Matrix QR decomposition. Matrix `A` is decomposed in two matrices (`Q`, `R`) where `Q` is an orthogonal matrix and `R` is an upper triangular matrix.",examples:["qr([[1, -1,  4], [1,  4, -2], [1,  4,  2], [1,  -1, 0]])"],seealso:["lup","slu","matrix"]},abs:{name:"abs",category:"Arithmetic",syntax:["abs(x)"],description:"Compute the absolute value.",examples:["abs(3.5)","abs(-4.2)"],seealso:["sign"]},add:{name:"add",category:"Operators",syntax:["x + y","add(x, y)"],description:"Add two values.",examples:["a = 2.1 + 3.6","a - 3.6","3 + 2i","3 cm + 2 inch",'"2.3" + "4"'],seealso:["subtract"]},cbrt:{name:"cbrt",category:"Arithmetic",syntax:["cbrt(x)","cbrt(x, allRoots)"],description:"Compute the cubic root value. If x = y * y * y, then y is the cubic root of x. When `x` is a number or complex number, an optional second argument `allRoots` can be provided to return all three cubic roots. If not provided, the principal root is returned",examples:["cbrt(64)","cube(4)","cbrt(-8)","cbrt(2 + 3i)","cbrt(8i)","cbrt(8i, true)","cbrt(27 m^3)"],seealso:["square","sqrt","cube","multiply"]},ceil:{name:"ceil",category:"Arithmetic",syntax:["ceil(x)","ceil(x, n)","ceil(unit, valuelessUnit)","ceil(unit, n, valuelessUnit)"],description:"Round a value towards plus infinity. If x is complex, both real and imaginary part are rounded towards plus infinity.",examples:["ceil(3.2)","ceil(3.8)","ceil(-4.2)","ceil(3.241cm, cm)","ceil(3.241cm, 2, cm)"],seealso:["floor","fix","round"]},cube:{name:"cube",category:"Arithmetic",syntax:["cube(x)"],description:"Compute the cube of a value. The cube of x is x * x * x.",examples:["cube(2)","2^3","2 * 2 * 2"],seealso:["multiply","square","pow"]},divide:{name:"divide",category:"Operators",syntax:["x / y","divide(x, y)"],description:"Divide two values.",examples:["a = 2 / 3","a * 3","4.5 / 2","3 + 4 / 2","(3 + 4) / 2","18 km / 4.5"],seealso:["multiply"]},dotDivide:{name:"dotDivide",category:"Operators",syntax:["x ./ y","dotDivide(x, y)"],description:"Divide two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a ./ b"],seealso:["multiply","dotMultiply","divide"]},dotMultiply:{name:"dotMultiply",category:"Operators",syntax:["x .* y","dotMultiply(x, y)"],description:"Multiply two values element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","b = [2, 1, 1; 3, 2, 5]","a .* b"],seealso:["multiply","divide","dotDivide"]},dotPow:{name:"dotPow",category:"Operators",syntax:["x .^ y","dotPow(x, y)"],description:"Calculates the power of x to y element wise.",examples:["a = [1, 2, 3; 4, 5, 6]","a .^ 2"],seealso:["pow"]},exp:{name:"exp",category:"Arithmetic",syntax:["exp(x)"],description:"Calculate the exponent of a value.",examples:["exp(1.3)","e ^ 1.3","log(exp(1.3))","x = 2.4","(exp(i*x) == cos(x) + i*sin(x))   # Euler's formula"],seealso:["expm","expm1","pow","log"]},expm:{name:"expm",category:"Arithmetic",syntax:["exp(x)"],description:"Compute the matrix exponential, expm(A) = e^A. The matrix must be square. Not to be confused with exp(a), which performs element-wise exponentiation.",examples:["expm([[0,2],[0,0]])"],seealso:["exp"]},expm1:{name:"expm1",category:"Arithmetic",syntax:["expm1(x)"],description:"Calculate the value of subtracting 1 from the exponential value.",examples:["expm1(2)","pow(e, 2) - 1","log(expm1(2) + 1)"],seealso:["exp","pow","log"]},fix:{name:"fix",category:"Arithmetic",syntax:["fix(x)","fix(x, n)","fix(unit, valuelessUnit)","fix(unit, n, valuelessUnit)"],description:"Round a value towards zero. If x is complex, both real and imaginary part are rounded towards zero.",examples:["fix(3.2)","fix(3.8)","fix(-4.2)","fix(-4.8)","fix(3.241cm, cm)","fix(3.241cm, 2, cm)"],seealso:["ceil","floor","round"]},floor:{name:"floor",category:"Arithmetic",syntax:["floor(x)","floor(x, n)","floor(unit, valuelessUnit)","floor(unit, n, valuelessUnit)"],description:"Round a value towards minus infinity.If x is complex, both real and imaginary part are rounded towards minus infinity.",examples:["floor(3.2)","floor(3.8)","floor(-4.2)","floor(3.241cm, cm)","floor(3.241cm, 2, cm)"],seealso:["ceil","fix","round"]},gcd:{name:"gcd",category:"Arithmetic",syntax:["gcd(a, b)","gcd(a, b, c, ...)"],description:"Compute the greatest common divisor.",examples:["gcd(8, 12)","gcd(-4, 6)","gcd(25, 15, -10)"],seealso:["lcm","xgcd"]},hypot:{name:"hypot",category:"Arithmetic",syntax:["hypot(a, b, c, ...)","hypot([a, b, c, ...])"],description:"Calculate the hypotenuse of a list with values.",examples:["hypot(3, 4)","sqrt(3^2 + 4^2)","hypot(-2)","hypot([3, 4, 5])"],seealso:["abs","norm"]},lcm:{name:"lcm",category:"Arithmetic",syntax:["lcm(x, y)"],description:"Compute the least common multiple.",examples:["lcm(4, 6)","lcm(6, 21)","lcm(6, 21, 5)"],seealso:["gcd"]},log:{name:"log",category:"Arithmetic",syntax:["log(x)","log(x, base)"],description:"Compute the logarithm of a value. If no base is provided, the natural logarithm of x is calculated. If base if provided, the logarithm is calculated for the specified base. log(x, base) is defined as log(x) / log(base).",examples:["log(3.5)","a = log(2.4)","exp(a)","10 ^ 4","log(10000, 10)","log(10000) / log(10)","b = log(1024, 2)","2 ^ b"],seealso:["exp","log1p","log2","log10"]},log2:{name:"log2",category:"Arithmetic",syntax:["log2(x)"],description:"Calculate the 2-base of a value. This is the same as calculating `log(x, 2)`.",examples:["log2(0.03125)","log2(16)","log2(16) / log2(2)","pow(2, 4)"],seealso:["exp","log1p","log","log10"]},log1p:{name:"log1p",category:"Arithmetic",syntax:["log1p(x)","log1p(x, base)"],description:"Calculate the logarithm of a `value+1`",examples:["log1p(2.5)","exp(log1p(1.4))","pow(10, 4)","log1p(9999, 10)","log1p(9999) / log(10)"],seealso:["exp","log","log2","log10"]},log10:{name:"log10",category:"Arithmetic",syntax:["log10(x)"],description:"Compute the 10-base logarithm of a value.",examples:["log10(0.00001)","log10(10000)","10 ^ 4","log(10000) / log(10)","log(10000, 10)"],seealso:["exp","log"]},mod:{name:"mod",category:"Operators",syntax:["x % y","x mod y","mod(x, y)"],description:"Calculates the modulus, the remainder of an integer division.",examples:["7 % 3","11 % 2","10 mod 4","isOdd(x) = x % 2","isOdd(2)","isOdd(3)"],seealso:["divide"]},multiply:{name:"multiply",category:"Operators",syntax:["x * y","multiply(x, y)"],description:"multiply two values.",examples:["a = 2.1 * 3.4","a / 3.4","2 * 3 + 4","2 * (3 + 4)","3 * 2.1 km"],seealso:["divide"]},norm:{name:"norm",category:"Arithmetic",syntax:["norm(x)","norm(x, p)"],description:"Calculate the norm of a number, vector or matrix.",examples:["abs(-3.5)","norm(-3.5)","norm(3 - 4i)","norm([1, 2, -3], Infinity)","norm([1, 2, -3], -Infinity)","norm([3, 4], 2)","norm([[1, 2], [3, 4]], 1)",'norm([[1, 2], [3, 4]], "inf")','norm([[1, 2], [3, 4]], "fro")']},nthRoot:{name:"nthRoot",category:"Arithmetic",syntax:["nthRoot(a)","nthRoot(a, root)"],description:'Calculate the nth root of a value. The principal nth root of a positive real number A, is the positive real solution of the equation "x^root = A".',examples:["4 ^ 3","nthRoot(64, 3)","nthRoot(9, 2)","sqrt(9)"],seealso:["nthRoots","pow","sqrt"]},nthRoots:{name:"nthRoots",category:"Arithmetic",syntax:["nthRoots(A)","nthRoots(A, root)"],description:'Calculate the nth roots of a value. An nth root of a positive real number A, is a positive real solution of the equation "x^root = A". This function returns an array of complex values.',examples:["nthRoots(1)","nthRoots(1, 3)"],seealso:["sqrt","pow","nthRoot"]},pow:{name:"pow",category:"Operators",syntax:["x ^ y","pow(x, y)"],description:"Calculates the power of x to y, x^y.",examples:["2^3","2*2*2","1 + e ^ (pi * i)","pow([[1, 2], [4, 3]], 2)","pow([[1, 2], [4, 3]], -1)"],seealso:["multiply","nthRoot","nthRoots","sqrt"]},round:{name:"round",category:"Arithmetic",syntax:["round(x)","round(x, n)","round(unit, valuelessUnit)","round(unit, n, valuelessUnit)"],description:"round a value towards the nearest integer.If x is complex, both real and imaginary part are rounded towards the nearest integer. When n is specified, the value is rounded to n decimals.",examples:["round(3.2)","round(3.8)","round(-4.2)","round(-4.8)","round(pi, 3)","round(123.45678, 2)","round(3.241cm, 2, cm)","round([3.2, 3.8, -4.7])"],seealso:["ceil","floor","fix"]},sign:{name:"sign",category:"Arithmetic",syntax:["sign(x)"],description:"Compute the sign of a value. The sign of a value x is 1 when x>0, -1 when x<0, and 0 when x=0.",examples:["sign(3.5)","sign(-4.2)","sign(0)"],seealso:["abs"]},sqrt:{name:"sqrt",category:"Arithmetic",syntax:["sqrt(x)"],description:"Compute the square root value. If x = y * y, then y is the square root of x.",examples:["sqrt(25)","5 * 5","sqrt(-1)"],seealso:["square","sqrtm","multiply","nthRoot","nthRoots","pow"]},sqrtm:{name:"sqrtm",category:"Arithmetic",syntax:["sqrtm(x)"],description:"Calculate the principal square root of a square matrix. The principal square root matrix `X` of another matrix `A` is such that `X * X = A`.",examples:["sqrtm([[33, 24], [48, 57]])"],seealso:["sqrt","abs","square","multiply"]},square:{name:"square",category:"Arithmetic",syntax:["square(x)"],description:"Compute the square of a value. The square of x is x * x.",examples:["square(3)","sqrt(9)","3^2","3 * 3"],seealso:["multiply","pow","sqrt","cube"]},subtract:{name:"subtract",category:"Operators",syntax:["x - y","subtract(x, y)"],description:"subtract two values.",examples:["a = 5.3 - 2","a + 2","2/3 - 1/6","2 * 3 - 3","2.1 km - 500m"],seealso:["add"]},unaryMinus:{name:"unaryMinus",category:"Operators",syntax:["-x","unaryMinus(x)"],description:"Inverse the sign of a value. Converts booleans and strings to numbers.",examples:["-4.5","-(-5.6)",'-"22"'],seealso:["add","subtract","unaryPlus"]},unaryPlus:{name:"unaryPlus",category:"Operators",syntax:["+x","unaryPlus(x)"],description:"Converts booleans and strings to numbers.",examples:["+true",'+"2"'],seealso:["add","subtract","unaryMinus"]},xgcd:{name:"xgcd",category:"Arithmetic",syntax:["xgcd(a, b)"],description:"Calculate the extended greatest common divisor for two values. The result is an array [d, x, y] with 3 entries, where d is the greatest common divisor, and d = x * a + y * b.",examples:["xgcd(8, 12)","gcd(8, 12)","xgcd(36163, 21199)"],seealso:["gcd","lcm"]},invmod:{name:"invmod",category:"Arithmetic",syntax:["invmod(a, b)"],description:"Calculate the (modular) multiplicative inverse of a modulo b. Solution to the equation ax \u2263 1 (mod b)",examples:["invmod(8, 12)","invmod(7, 13)","invmod(15151, 15122)"],seealso:["gcd","xgcd"]},bitAnd:{name:"bitAnd",category:"Bitwise",syntax:["x & y","bitAnd(x, y)"],description:"Bitwise AND operation. Performs the logical AND operation on each pair of the corresponding bits of the two given values by multiplying them. If both bits in the compared position are 1, the bit in the resulting binary representation is 1, otherwise, the result is 0",examples:["5 & 3","bitAnd(53, 131)","[1, 12, 31] & 42"],seealso:["bitNot","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitNot:{name:"bitNot",category:"Bitwise",syntax:["~x","bitNot(x)"],description:"Bitwise NOT operation. Performs a logical negation on each bit of the given value. Bits that are 0 become 1, and those that are 1 become 0.",examples:["~1","~2","bitNot([2, -3, 4])"],seealso:["bitAnd","bitOr","bitXor","leftShift","rightArithShift","rightLogShift"]},bitOr:{name:"bitOr",category:"Bitwise",syntax:["x | y","bitOr(x, y)"],description:"Bitwise OR operation. Performs the logical inclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if the first bit is 1 or the second bit is 1 or both bits are 1, otherwise, the result is 0.",examples:["5 | 3","bitOr([1, 2, 3], 4)"],seealso:["bitAnd","bitNot","bitXor","leftShift","rightArithShift","rightLogShift"]},bitXor:{name:"bitXor",category:"Bitwise",syntax:["bitXor(x, y)"],description:"Bitwise XOR operation, exclusive OR. Performs the logical exclusive OR operation on each pair of corresponding bits of the two given values. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but will be 0 if both are 0 or both are 1.",examples:["bitOr(1, 2)","bitXor([2, 3, 4], 4)"],seealso:["bitAnd","bitNot","bitOr","leftShift","rightArithShift","rightLogShift"]},leftShift:{name:"leftShift",category:"Bitwise",syntax:["x << y","leftShift(x, y)"],description:"Bitwise left logical shift of a value x by y number of bits.",examples:["4 << 1","8 >> 1"],seealso:["bitAnd","bitNot","bitOr","bitXor","rightArithShift","rightLogShift"]},rightArithShift:{name:"rightArithShift",category:"Bitwise",syntax:["x >> y","rightArithShift(x, y)"],description:"Bitwise right arithmetic shift of a value x by y number of bits.",examples:["8 >> 1","4 << 1","-12 >> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightLogShift"]},rightLogShift:{name:"rightLogShift",category:"Bitwise",syntax:["x >>> y","rightLogShift(x, y)"],description:"Bitwise right logical shift of a value x by y number of bits.",examples:["8 >>> 1","4 << 1","-12 >>> 2"],seealso:["bitAnd","bitNot","bitOr","bitXor","leftShift","rightArithShift"]},bellNumbers:{name:"bellNumbers",category:"Combinatorics",syntax:["bellNumbers(n)"],description:"The Bell Numbers count the number of partitions of a set. A partition is a pairwise disjoint subset of S whose union is S. `bellNumbers` only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["bellNumbers(3)","bellNumbers(8)"],seealso:["stirlingS2"]},catalan:{name:"catalan",category:"Combinatorics",syntax:["catalan(n)"],description:"The Catalan Numbers enumerate combinatorial structures of many different types. catalan only takes integer arguments. The following condition must be enforced: n >= 0.",examples:["catalan(3)","catalan(8)"],seealso:["bellNumbers"]},composition:{name:"composition",category:"Combinatorics",syntax:["composition(n, k)"],description:"The composition counts of n into k parts. composition only takes integer arguments. The following condition must be enforced: k <= n.",examples:["composition(5, 3)"],seealso:["combinations"]},stirlingS2:{name:"stirlingS2",category:"Combinatorics",syntax:["stirlingS2(n, k)"],description:"he Stirling numbers of the second kind, counts the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. `stirlingS2` only takes integer arguments. The following condition must be enforced: k <= n. If n = k or k = 1, then s(n,k) = 1.",examples:["stirlingS2(5, 3)"],seealso:["bellNumbers"]},config:{name:"config",category:"Core",syntax:["config()","config(options)"],description:"Get configuration or change configuration.",examples:["config()","1/3 + 1/4",'config({number: "Fraction"})',"1/3 + 1/4"],seealso:[]},import:{name:"import",category:"Core",syntax:["import(functions)","import(functions, options)"],description:"Import functions or constants from an object.",examples:["import({myFn: f(x)=x^2, myConstant: 32 })","myFn(2)","myConstant"],seealso:[]},typed:{name:"typed",category:"Core",syntax:["typed(signatures)","typed(name, signatures)"],description:"Create a typed function.",examples:['double = typed({ "number": f(x)=x+x, "string": f(x)=concat(x,x) })',"double(2)",'double("hello")'],seealso:[]},arg:{name:"arg",category:"Complex",syntax:["arg(x)"],description:"Compute the argument of a complex value. If x = a+bi, the argument is computed as atan2(b, a).",examples:["arg(2 + 2i)","atan2(3, 2)","arg(2 + 3i)"],seealso:["re","im","conj","abs"]},conj:{name:"conj",category:"Complex",syntax:["conj(x)"],description:"Compute the complex conjugate of a complex value. If x = a+bi, the complex conjugate is a-bi.",examples:["conj(2 + 3i)","conj(2 - 3i)","conj(-5.2i)"],seealso:["re","im","abs","arg"]},re:{name:"re",category:"Complex",syntax:["re(x)"],description:"Get the real part of a complex number.",examples:["re(2 + 3i)","im(2 + 3i)","re(-5.2i)","re(2.4)"],seealso:["im","conj","abs","arg"]},im:{name:"im",category:"Complex",syntax:["im(x)"],description:"Get the imaginary part of a complex number.",examples:["im(2 + 3i)","re(2 + 3i)","im(-5.2i)","im(2.4)"],seealso:["re","conj","abs","arg"]},evaluate:{name:"evaluate",category:"Expression",syntax:["evaluate(expression)","evaluate(expression, scope)","evaluate([expr1, expr2, expr3, ...])","evaluate([expr1, expr2, expr3, ...], scope)"],description:"Evaluate an expression or an array with expressions.",examples:['evaluate("2 + 3")','evaluate("sqrt(16)")','evaluate("2 inch to cm")','evaluate("sin(x * pi)", { "x": 1/2 })','evaluate(["width=2", "height=4","width*height"])'],seealso:[]},help:{name:"help",category:"Expression",syntax:["help(object)","help(string)"],description:"Display documentation on a function or data type.",examples:["help(sqrt)",'help("complex")'],seealso:[]},distance:{name:"distance",category:"Geometry",syntax:["distance([x1, y1], [x2, y2])","distance([[x1, y1], [x2, y2]])"],description:"Calculates the Euclidean distance between two points.",examples:["distance([0,0], [4,4])","distance([[0,0], [4,4]])"],seealso:[]},intersect:{name:"intersect",category:"Geometry",syntax:["intersect(expr1, expr2, expr3, expr4)","intersect(expr1, expr2, expr3)"],description:"Computes the intersection point of lines and/or planes.",examples:["intersect([0, 0], [10, 10], [10, 0], [0, 10])","intersect([1, 0, 1],  [4, -2, 2], [1, 1, 1, 6])"],seealso:[]},and:{name:"and",category:"Logical",syntax:["x and y","and(x, y)"],description:"Logical and. Test whether two values are both defined with a nonzero/nonempty value.",examples:["true and false","true and true","2 and 4"],seealso:["not","or","xor"]},not:{name:"not",category:"Logical",syntax:["not x","not(x)"],description:"Logical not. Flips the boolean value of given argument.",examples:["not true","not false","not 2","not 0"],seealso:["and","or","xor"]},or:{name:"or",category:"Logical",syntax:["x or y","or(x, y)"],description:"Logical or. Test if at least one value is defined with a nonzero/nonempty value.",examples:["true or false","false or false","0 or 4"],seealso:["not","and","xor"]},xor:{name:"xor",category:"Logical",syntax:["x xor y","xor(x, y)"],description:"Logical exclusive or, xor. Test whether one and only one value is defined with a nonzero/nonempty value.",examples:["true xor false","false xor false","true xor true","0 xor 4"],seealso:["not","and","or"]},mapSlices:{name:"mapSlices",category:"Matrix",syntax:["mapSlices(A, dim, callback)"],description:"Generate a matrix one dimension less than A by applying callback to each slice of A along dimension dim.",examples:["A = [[1, 2], [3, 4]]","mapSlices(A, 1, sum)","mapSlices(A, 2, prod)"],seealso:["map","forEach"]},concat:{name:"concat",category:"Matrix",syntax:["concat(A, B, C, ...)","concat(A, B, C, ..., dim)"],description:"Concatenate matrices. By default, the matrices are concatenated by the last dimension. The dimension on which to concatenate can be provided as last argument.",examples:["A = [1, 2; 5, 6]","B = [3, 4; 7, 8]","concat(A, B)","concat(A, B, 1)","concat(A, B, 2)"],seealso:["det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},count:{name:"count",category:"Matrix",syntax:["count(x)"],description:"Count the number of elements of a matrix, array or string.",examples:["a = [1, 2; 3, 4; 5, 6]","count(a)","size(a)",'count("hello world")'],seealso:["size"]},cross:{name:"cross",category:"Matrix",syntax:["cross(A, B)"],description:"Calculate the cross product for two vectors in three dimensional space.",examples:["cross([1, 1, 0],  [0, 1, 1])","cross([3, -3, 1], [4, 9, 2])","cross([2, 3, 4],  [5, 6, 7])"],seealso:["multiply","dot"]},column:{name:"column",category:"Matrix",syntax:["column(x, index)"],description:"Return a column from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","column(A, 1)","column(A, 2)"],seealso:["row","matrixFromColumns"]},ctranspose:{name:"ctranspose",category:"Matrix",syntax:["x'","ctranspose(x)"],description:"Complex Conjugate and Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","ctranspose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},det:{name:"det",category:"Matrix",syntax:["det(x)"],description:"Calculate the determinant of a matrix",examples:["det([1, 2; 3, 4])","det([-2, 2, 3; -1, 1, 3; 2, 0, -1])"],seealso:["concat","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diag:{name:"diag",category:"Matrix",syntax:["diag(x)","diag(x, k)"],description:"Create a diagonal matrix or retrieve the diagonal of a matrix. When x is a vector, a matrix with the vector values on the diagonal will be returned. When x is a matrix, a vector with the diagonal values of the matrix is returned. When k is provided, the k-th diagonal will be filled in or retrieved, if k is positive, the values are placed on the super diagonal. When k is negative, the values are placed on the sub diagonal.",examples:["diag(1:3)","diag(1:3, 1)","a = [1, 2, 3; 4, 5, 6; 7, 8, 9]","diag(a)"],seealso:["concat","det","identity","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},diff:{name:"diff",category:"Matrix",syntax:["diff(arr)","diff(arr, dim)"],description:["Create a new matrix or array with the difference of the passed matrix or array.","Dim parameter is optional and used to indicate the dimension of the array/matrix to apply the difference","If no dimension parameter is passed it is assumed as dimension 0","Dimension is zero-based in javascript and one-based in the parser","Arrays must be 'rectangular' meaning arrays like [1, 2]","If something is passed as a matrix it will be returned as a matrix but other than that all matrices are converted to arrays"],examples:["A = [1, 2, 4, 7, 0]","diff(A)","diff(A, 1)","B = [[1, 2], [3, 4]]","diff(B)","diff(B, 1)","diff(B, 2)","diff(B, bignumber(2))","diff([[1, 2], matrix([3, 4])], 2)"],seealso:["subtract","partitionSelect"]},dot:{name:"dot",category:"Matrix",syntax:["dot(A, B)","A * B"],description:"Calculate the dot product of two vectors. The dot product of A = [a1, a2, a3, ..., an] and B = [b1, b2, b3, ..., bn] is defined as dot(A, B) = a1 * b1 + a2 * b2 + a3 * b3 + ... + an * bn",examples:["dot([2, 4, 1], [2, 2, 3])","[2, 4, 1] * [2, 2, 3]"],seealso:["multiply","cross"]},getMatrixDataType:{name:"getMatrixDataType",category:"Matrix",syntax:["getMatrixDataType(x)"],description:'Find the data type of all elements in a matrix or array, for example "number" if all items are a number and "Complex" if all values are complex numbers. If a matrix contains more than one data type, it will return "mixed".',examples:["getMatrixDataType([1, 2, 3])","getMatrixDataType([[5 cm], [2 inch]])",'getMatrixDataType([1, "text"])',"getMatrixDataType([1, bignumber(4)])"],seealso:["matrix","sparse","typeOf"]},identity:{name:"identity",category:"Matrix",syntax:["identity(n)","identity(m, n)","identity([m, n])"],description:"Returns the identity matrix with size m-by-n. The matrix has ones on the diagonal and zeros elsewhere.",examples:["identity(3)","identity(3, 5)","a = [1, 2, 3; 4, 5, 6]","identity(size(a))"],seealso:["concat","det","diag","inv","ones","range","size","squeeze","subset","trace","transpose","zeros"]},filter:{name:"filter",category:"Matrix",syntax:["filter(x, test)"],description:"Filter items in a matrix.",examples:["isPositive(x) = x > 0","filter([6, -2, -1, 4, 3], isPositive)","filter([6, -2, 0, 1, 0], x != 0)"],seealso:["sort","map","forEach"]},flatten:{name:"flatten",category:"Matrix",syntax:["flatten(x)"],description:"Flatten a multi dimensional matrix into a single dimensional matrix.",examples:["a = [1, 2, 3; 4, 5, 6]","size(a)","b = flatten(a)","size(b)"],seealso:["concat","resize","size","squeeze"]},forEach:{name:"forEach",category:"Matrix",syntax:["forEach(x, callback)"],description:"Iterates over all elements of a matrix/array, and executes the given callback function.",examples:["numberOfPets = {}","addPet(n) = numberOfPets[n] = (numberOfPets[n] ? numberOfPets[n]:0 ) + 1;",'forEach(["Dog","Cat","Cat"], addPet)',"numberOfPets"],seealso:["map","sort","filter"]},inv:{name:"inv",category:"Matrix",syntax:["inv(x)"],description:"Calculate the inverse of a matrix",examples:["inv([1, 2; 3, 4])","inv(4)","1 / 4"],seealso:["concat","det","diag","identity","ones","range","size","squeeze","subset","trace","transpose","zeros"]},pinv:{name:"pinv",category:"Matrix",syntax:["pinv(x)"],description:"Calculate the Moore\u2013Penrose inverse of a matrix",examples:["pinv([1, 2; 3, 4])","pinv([[1, 0], [0, 1], [0, 1]])","pinv(4)"],seealso:["inv"]},eigs:{name:"eigs",category:"Matrix",syntax:["eigs(x)"],description:"Calculate the eigenvalues and optionally eigenvectors of a square matrix",examples:["eigs([[5, 2.3], [2.3, 1]])","eigs([[1, 2, 3], [4, 5, 6], [7, 8, 9]], { precision: 1e-6, eigenvectors: false })"],seealso:["inv"]},kron:{name:"kron",category:"Matrix",syntax:["kron(x, y)"],description:"Calculates the Kronecker product of 2 matrices or vectors.",examples:["kron([[1, 0], [0, 1]], [[1, 2], [3, 4]])","kron([1,1], [2,3,4])"],seealso:["multiply","dot","cross"]},matrixFromFunction:{name:"matrixFromFunction",category:"Matrix",syntax:["matrixFromFunction(size, fn)","matrixFromFunction(size, fn, format)","matrixFromFunction(size, fn, format, datatype)","matrixFromFunction(size, format, fn)","matrixFromFunction(size, format, datatype, fn)"],description:"Create a matrix by evaluating a generating function at each index.",examples:["f(I) = I[1] - I[2]","matrixFromFunction([3,3], f)","g(I) = I[1] - I[2] == 1 ? 4 : 0",'matrixFromFunction([100, 100], "sparse", g)',"matrixFromFunction([5], random)"],seealso:["matrix","matrixFromRows","matrixFromColumns","zeros"]},matrixFromRows:{name:"matrixFromRows",category:"Matrix",syntax:["matrixFromRows(...arr)","matrixFromRows(row1, row2)","matrixFromRows(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual rows.",examples:["matrixFromRows([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromColumns","matrixFromFunction","zeros"]},matrixFromColumns:{name:"matrixFromColumns",category:"Matrix",syntax:["matrixFromColumns(...arr)","matrixFromColumns(row1, row2)","matrixFromColumns(row1, row2, row3)"],description:"Create a dense matrix from vectors as individual columns.",examples:["matrixFromColumns([1, 2, 3], [[4],[5],[6]])"],seealso:["matrix","matrixFromRows","matrixFromFunction","zeros"]},map:{name:"map",category:"Matrix",syntax:["map(x, callback)","map(x, y, ..., callback)"],description:"Create a new matrix or array with the results of the callback function executed on each entry of the matrix/array or the matrices/arrays.",examples:["map([1, 2, 3], square)","map([1, 2], [3, 4], f(a,b) = a + b)"],seealso:["filter","forEach"]},ones:{name:"ones",category:"Matrix",syntax:["ones(m)","ones(m, n)","ones(m, n, p, ...)","ones([m])","ones([m, n])","ones([m, n, p, ...])"],description:"Create a matrix containing ones.",examples:["ones(3)","ones(3, 5)","ones([2,3]) * 4.5","a = [1, 2, 3; 4, 5, 6]","ones(size(a))"],seealso:["concat","det","diag","identity","inv","range","size","squeeze","subset","trace","transpose","zeros"]},partitionSelect:{name:"partitionSelect",category:"Matrix",syntax:["partitionSelect(x, k)","partitionSelect(x, k, compare)"],description:"Partition-based selection of an array or 1D matrix. Will find the kth smallest value, and mutates the input array. Uses Quickselect.",examples:["partitionSelect([5, 10, 1], 2)",'partitionSelect(["C", "B", "A", "D"], 1, compareText)',"arr = [5, 2, 1]","partitionSelect(arr, 0) # returns 1, arr is now: [1, 2, 5]","arr","partitionSelect(arr, 1, 'desc') # returns 2, arr is now: [5, 2, 1]","arr"],seealso:["sort"]},range:{name:"range",category:"Type",syntax:["start:end","start:step:end","range(start, end)","range(start, end, step)","range(string)"],description:"Create a range. Lower bound of the range is included, upper bound is excluded.",examples:["1:5","3:-1:-3","range(3, 7)","range(0, 12, 2)",'range("4:10")',"range(1m, 1m, 3m)","a = [1, 2, 3, 4; 5, 6, 7, 8]","a[1:2, 1:2]"],seealso:["concat","det","diag","identity","inv","ones","size","squeeze","subset","trace","transpose","zeros"]},resize:{name:"resize",category:"Matrix",syntax:["resize(x, size)","resize(x, size, defaultValue)"],description:"Resize a matrix.",examples:["resize([1,2,3,4,5], [3])","resize([1,2,3], [5])","resize([1,2,3], [5], -1)","resize(2, [2, 3])",'resize("hello", [8], "!")'],seealso:["size","subset","squeeze","reshape"]},reshape:{name:"reshape",category:"Matrix",syntax:["reshape(x, sizes)"],description:"Reshape a multi dimensional array to fit the specified dimensions.",examples:["reshape([1, 2, 3, 4, 5, 6], [2, 3])","reshape([[1, 2], [3, 4]], [1, 4])","reshape([[1, 2], [3, 4]], [4])","reshape([1, 2, 3, 4], [-1, 2])"],seealso:["size","squeeze","resize"]},rotate:{name:"rotate",category:"Matrix",syntax:["rotate(w, theta)","rotate(w, theta, v)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotate([1, 0], pi / 2)",'rotate(matrix([1, 0]), unit("35deg"))','rotate([1, 0, 0], unit("90deg"), [0, 0, 1])','rotate(matrix([1, 0, 0]), unit("90deg"), matrix([0, 0, 1]))'],seealso:["matrix","rotationMatrix"]},rotationMatrix:{name:"rotationMatrix",category:"Matrix",syntax:["rotationMatrix(theta)","rotationMatrix(theta, v)","rotationMatrix(theta, v, format)"],description:"Returns a 2-D rotation matrix (2x2) for a given angle (in radians). Returns a 2-D rotation matrix (3x3) of a given angle (in radians) around given axis.",examples:["rotationMatrix(pi / 2)",'rotationMatrix(unit("45deg"), [0, 0, 1])','rotationMatrix(1, matrix([0, 0, 1]), "sparse")'],seealso:["cos","sin"]},row:{name:"row",category:"Matrix",syntax:["row(x, index)"],description:"Return a row from a matrix or array.",examples:["A = [[1, 2], [3, 4]]","row(A, 1)","row(A, 2)"],seealso:["column","matrixFromRows"]},size:{name:"size",category:"Matrix",syntax:["size(x)"],description:"Calculate the size of a matrix.",examples:["size(2.3)",'size("hello world")',"a = [1, 2; 3, 4; 5, 6]","size(a)","size(1:6)"],seealso:["concat","count","det","diag","identity","inv","ones","range","squeeze","subset","trace","transpose","zeros"]},sort:{name:"sort",category:"Matrix",syntax:["sort(x)","sort(x, compare)"],description:'Sort the items in a matrix. Compare can be a string "asc", "desc", "natural", or a custom sort function.',examples:["sort([5, 10, 1])",'sort(["C", "B", "A", "D"], "natural")',"sortByLength(a, b) = size(a)[1] - size(b)[1]",'sort(["Langdon", "Tom", "Sara"], sortByLength)','sort(["10", "1", "2"], "natural")'],seealso:["map","filter","forEach"]},squeeze:{name:"squeeze",category:"Matrix",syntax:["squeeze(x)"],description:"Remove inner and outer singleton dimensions from a matrix.",examples:["a = zeros(3,2,1)","size(squeeze(a))","b = zeros(1,1,3)","size(squeeze(b))"],seealso:["concat","det","diag","identity","inv","ones","range","size","subset","trace","transpose","zeros"]},subset:{name:"subset",category:"Matrix",syntax:["value(index)","value(index) = replacement","subset(value, [index])","subset(value, [index], replacement)"],description:"Get or set a subset of the entries of a matrix or characters of a string. Indexes are one-based. There should be one index specification for each dimension of the target. Each specification can be a single index, a list of indices, or a range in colon notation `l:u`. In a range, both the lower bound l and upper bound u are included; and if a bound is omitted it defaults to the most extreme valid value. The cartesian product of the indices specified in each dimension determines the target of the operation.",examples:["d = [1, 2; 3, 4]","e = []","e[1, 1:2] = [5, 6]","e[2, :] = [7, 8]","f = d * e","f[2, 1]","f[:, 1]","f[[1,2], [1,3]] = [9, 10; 11, 12]","f"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","trace","transpose","zeros"]},trace:{name:"trace",category:"Matrix",syntax:["trace(A)"],description:"Calculate the trace of a matrix: the sum of the elements on the main diagonal of a square matrix.",examples:["A = [1, 2, 3; -1, 2, 3; 2, 0, 3]","trace(A)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","transpose","zeros"]},transpose:{name:"transpose",category:"Matrix",syntax:["x'","transpose(x)"],description:"Transpose a matrix",examples:["a = [1, 2, 3; 4, 5, 6]","a'","transpose(a)"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","zeros"]},zeros:{name:"zeros",category:"Matrix",syntax:["zeros(m)","zeros(m, n)","zeros(m, n, p, ...)","zeros([m])","zeros([m, n])","zeros([m, n, p, ...])"],description:"Create a matrix containing zeros.",examples:["zeros(3)","zeros(3, 5)","a = [1, 2, 3; 4, 5, 6]","zeros(size(a))"],seealso:["concat","det","diag","identity","inv","ones","range","size","squeeze","subset","trace","transpose"]},fft:{name:"fft",category:"Matrix",syntax:["fft(x)"],description:"Calculate N-dimensional Fourier transform",examples:["fft([[1, 0], [1, 0]])"],seealso:["ifft"]},ifft:{name:"ifft",category:"Matrix",syntax:["ifft(x)"],description:"Calculate N-dimensional inverse Fourier transform",examples:["ifft([[2, 2], [0, 0]])"],seealso:["fft"]},sylvester:{name:"sylvester",category:"Algebra",syntax:["sylvester(A,B,C)"],description:"Solves the real-valued Sylvester equation AX+XB=C for X",examples:["sylvester([[-1, -2], [1, 1]], [[-2, 1], [-1, 2]], [[-3, 2], [3, 0]])","A = [[-1, -2], [1, 1]]; B = [[2, -1], [1, -2]]; C = [[-3, 2], [3, 0]]","sylvester(A, B, C)"],seealso:["schur","lyap"]},schur:{name:"schur",category:"Algebra",syntax:["schur(A)"],description:"Performs a real Schur decomposition of the real matrix A = UTU'",examples:["schur([[1, 0], [-4, 3]])","A = [[1, 0], [-4, 3]]","schur(A)"],seealso:["lyap","sylvester"]},lyap:{name:"lyap",category:"Algebra",syntax:["lyap(A,Q)"],description:"Solves the Continuous-time Lyapunov equation AP+PA'+Q=0 for P",examples:["lyap([[-2, 0], [1, -4]], [[3, 1], [1, 3]])","A = [[-2, 0], [1, -4]]","Q = [[3, 1], [1, 3]]","lyap(A,Q)"],seealso:["schur","sylvester"]},solveODE:{name:"solveODE",category:"Numeric",syntax:["solveODE(func, tspan, y0)","solveODE(func, tspan, y0, options)"],description:"Numerical Integration of Ordinary Differential Equations.",examples:["f(t,y) = y","tspan = [0, 4]","solveODE(f, tspan, 1)","solveODE(f, tspan, [1, 2])",'solveODE(f, tspan, 1, { method:"RK23", maxStep:0.1 })'],seealso:["derivative","simplifyCore"]},combinations:{name:"combinations",category:"Probability",syntax:["combinations(n, k)"],description:"Compute the number of combinations of n items taken k at a time",examples:["combinations(7, 5)"],seealso:["combinationsWithRep","permutations","factorial"]},combinationsWithRep:{name:"combinationsWithRep",category:"Probability",syntax:["combinationsWithRep(n, k)"],description:"Compute the number of combinations of n items taken k at a time with replacements.",examples:["combinationsWithRep(7, 5)"],seealso:["combinations","permutations","factorial"]},factorial:{name:"factorial",category:"Probability",syntax:["n!","factorial(n)"],description:"Compute the factorial of a value",examples:["5!","5 * 4 * 3 * 2 * 1","3!"],seealso:["combinations","combinationsWithRep","permutations","gamma"]},gamma:{name:"gamma",category:"Probability",syntax:["gamma(n)"],description:"Compute the gamma function. For small values, the Lanczos approximation is used, and for large values the extended Stirling approximation.",examples:["gamma(4)","3!","gamma(1/2)","sqrt(pi)"],seealso:["factorial"]},kldivergence:{name:"kldivergence",category:"Probability",syntax:["kldivergence(x, y)"],description:"Calculate the Kullback-Leibler (KL) divergence  between two distributions.",examples:["kldivergence([0.7,0.5,0.4], [0.2,0.9,0.5])"],seealso:[]},lgamma:{name:"lgamma",category:"Probability",syntax:["lgamma(n)"],description:"Logarithm of the gamma function for real, positive numbers and complex numbers, using Lanczos approximation for numbers and Stirling series for complex numbers.",examples:["lgamma(4)","lgamma(1/2)","lgamma(i)","lgamma(complex(1.1, 2))"],seealso:["gamma"]},multinomial:{name:"multinomial",category:"Probability",syntax:["multinomial(A)"],description:"Multinomial Coefficients compute the number of ways of picking a1, a2, ..., ai unordered outcomes from `n` possibilities. multinomial takes one array of integers as an argument. The following condition must be enforced: every ai > 0.",examples:["multinomial([1, 2, 1])"],seealso:["combinations","factorial"]},permutations:{name:"permutations",category:"Probability",syntax:["permutations(n)","permutations(n, k)"],description:"Compute the number of permutations of n items taken k at a time",examples:["permutations(5)","permutations(5, 3)"],seealso:["combinations","combinationsWithRep","factorial"]},pickRandom:{name:"pickRandom",category:"Probability",syntax:["pickRandom(array)","pickRandom(array, number)","pickRandom(array, weights)","pickRandom(array, number, weights)","pickRandom(array, weights, number)"],description:"Pick a random entry from a given array.",examples:["pickRandom(0:10)","pickRandom([1, 3, 1, 6])","pickRandom([1, 3, 1, 6], 2)","pickRandom([1, 3, 1, 6], [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], 2, [2, 3, 2, 1])","pickRandom([1, 3, 1, 6], [2, 3, 2, 1], 2)"],seealso:["random","randomInt"]},random:{name:"random",category:"Probability",syntax:["random()","random(max)","random(min, max)","random(size)","random(size, max)","random(size, min, max)"],description:"Return a random number.",examples:["random()","random(10, 20)","random([2, 3])"],seealso:["pickRandom","randomInt"]},randomInt:{name:"randomInt",category:"Probability",syntax:["randomInt(max)","randomInt(min, max)","randomInt(size)","randomInt(size, max)","randomInt(size, min, max)"],description:"Return a random integer number",examples:["randomInt(10, 20)","randomInt([2, 3], 10)"],seealso:["pickRandom","random"]},compare:{name:"compare",category:"Relational",syntax:["compare(x, y)"],description:"Compare two values. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compare(2, 3)","compare(3, 2)","compare(2, 2)","compare(5cm, 40mm)","compare(2, [1, 2, 3])"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compareNatural","compareText"]},compareNatural:{name:"compareNatural",category:"Relational",syntax:["compareNatural(x, y)"],description:"Compare two values of any type in a deterministic, natural way. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:["compareNatural(2, 3)","compareNatural(3, 2)","compareNatural(2, 2)","compareNatural(5cm, 40mm)",'compareNatural("2", "10")',"compareNatural(2 + 3i, 2 + 4i)","compareNatural([1, 2, 4], [1, 2, 3])","compareNatural([1, 5], [1, 2, 3])","compareNatural([1, 2], [1, 2])","compareNatural({a: 2}, {a: 4})"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare","compareText"]},compareText:{name:"compareText",category:"Relational",syntax:["compareText(x, y)"],description:"Compare two strings lexically. Comparison is case sensitive. Returns 1 when x > y, -1 when x < y, and 0 when x == y.",examples:['compareText("B", "A")','compareText("A", "B")','compareText("A", "A")','compareText("2", "10")','compare("2", "10")',"compare(2, 10)",'compareNatural("2", "10")','compareText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural"]},deepEqual:{name:"deepEqual",category:"Relational",syntax:["deepEqual(x, y)"],description:"Check equality of two matrices element wise. Returns true if the size of both matrices is equal and when and each of the elements are equal.",examples:["deepEqual([1,3,4], [1,3,4])","deepEqual([1,3,4], [1,3])"],seealso:["equal","unequal","smaller","larger","smallerEq","largerEq","compare"]},equal:{name:"equal",category:"Relational",syntax:["x == y","equal(x, y)"],description:"Check equality of two values. Returns true if the values are equal, and false if not.",examples:["2+2 == 3","2+2 == 4","a = 3.2","b = 6-2.8","a == b","50cm == 0.5m"],seealso:["unequal","smaller","larger","smallerEq","largerEq","compare","deepEqual","equalText"]},equalText:{name:"equalText",category:"Relational",syntax:["equalText(x, y)"],description:"Check equality of two strings. Comparison is case sensitive. Returns true if the values are equal, and false if not.",examples:['equalText("Hello", "Hello")','equalText("a", "A")','equal("2e3", "2000")','equalText("2e3", "2000")','equalText("B", ["A", "B", "C"])'],seealso:["compare","compareNatural","compareText","equal"]},larger:{name:"larger",category:"Relational",syntax:["x > y","larger(x, y)"],description:"Check if value x is larger than y. Returns true if x is larger than y, and false if not. Comparing a value with NaN returns false.",examples:["2 > 3","5 > 2*2","a = 3.3","b = 6-2.8","(a > b)","(b < a)","5 cm > 2 inch"],seealso:["equal","unequal","smaller","smallerEq","largerEq","compare"]},largerEq:{name:"largerEq",category:"Relational",syntax:["x >= y","largerEq(x, y)"],description:"Check if value x is larger or equal to y. Returns true if x is larger or equal to y, and false if not.",examples:["2 >= 1+1","2 > 1+1","a = 3.2","b = 6-2.8","(a >= b)"],seealso:["equal","unequal","smallerEq","smaller","compare"]},smaller:{name:"smaller",category:"Relational",syntax:["x < y","smaller(x, y)"],description:"Check if value x is smaller than value y. Returns true if x is smaller than y, and false if not. Comparing a value with NaN returns false.",examples:["2 < 3","5 < 2*2","a = 3.3","b = 6-2.8","(a < b)","5 cm < 2 inch"],seealso:["equal","unequal","larger","smallerEq","largerEq","compare"]},smallerEq:{name:"smallerEq",category:"Relational",syntax:["x <= y","smallerEq(x, y)"],description:"Check if value x is smaller or equal to value y. Returns true if x is smaller than y, and false if not.",examples:["2 <= 1+1","2 < 1+1","a = 3.2","b = 6-2.8","(a <= b)"],seealso:["equal","unequal","larger","smaller","largerEq","compare"]},unequal:{name:"unequal",category:"Relational",syntax:["x != y","unequal(x, y)"],description:"Check unequality of two values. Returns true if the values are unequal, and false if they are equal.",examples:["2+2 != 3","2+2 != 4","a = 3.2","b = 6-2.8","a != b","50cm != 0.5m","5 cm != 2 inch"],seealso:["equal","smaller","larger","smallerEq","largerEq","compare","deepEqual"]},setCartesian:{name:"setCartesian",category:"Set",syntax:["setCartesian(set1, set2)"],description:"Create the cartesian product of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays and the values will be sorted in ascending order before the operation.",examples:["setCartesian([1, 2], [3, 4])"],seealso:["setUnion","setIntersect","setDifference","setPowerset"]},setDifference:{name:"setDifference",category:"Set",syntax:["setDifference(set1, set2)"],description:"Create the difference of two (multi)sets: every element of set1, that is not the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setDifference([1, 2, 3, 4], [3, 4, 5, 6])","setDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setSymDifference"]},setDistinct:{name:"setDistinct",category:"Set",syntax:["setDistinct(set)"],description:"Collect the distinct elements of a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setDistinct([1, 1, 1, 2, 2, 3])"],seealso:["setMultiplicity"]},setIntersect:{name:"setIntersect",category:"Set",syntax:["setIntersect(set1, set2)"],description:"Create the intersection of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIntersect([1, 2, 3, 4], [3, 4, 5, 6])","setIntersect([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setDifference"]},setIsSubset:{name:"setIsSubset",category:"Set",syntax:["setIsSubset(set1, set2)"],description:"Check whether a (multi)set is a subset of another (multi)set: every element of set1 is the element of set2. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setIsSubset([1, 2], [3, 4, 5, 6])","setIsSubset([3, 4], [3, 4, 5, 6])"],seealso:["setUnion","setIntersect","setDifference"]},setMultiplicity:{name:"setMultiplicity",category:"Set",syntax:["setMultiplicity(element, set)"],description:"Count the multiplicity of an element in a multiset. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setMultiplicity(1, [1, 2, 2, 4])","setMultiplicity(2, [1, 2, 2, 4])"],seealso:["setDistinct","setSize"]},setPowerset:{name:"setPowerset",category:"Set",syntax:["setPowerset(set)"],description:"Create the powerset of a (multi)set: the powerset contains very possible subsets of a (multi)set. A multi-dimension array will be converted to a single-dimension array before the operation.",examples:["setPowerset([1, 2, 3])"],seealso:["setCartesian"]},setSize:{name:"setSize",category:"Set",syntax:["setSize(set)","setSize(set, unique)"],description:'Count the number of elements of a (multi)set. When the second parameter "unique" is true, count only the unique values. A multi-dimension array will be converted to a single-dimension array before the operation.',examples:["setSize([1, 2, 2, 4])","setSize([1, 2, 2, 4], true)"],seealso:["setUnion","setIntersect","setDifference"]},setSymDifference:{name:"setSymDifference",category:"Set",syntax:["setSymDifference(set1, set2)"],description:"Create the symmetric difference of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setSymDifference([1, 2, 3, 4], [3, 4, 5, 6])","setSymDifference([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setUnion","setIntersect","setDifference"]},setUnion:{name:"setUnion",category:"Set",syntax:["setUnion(set1, set2)"],description:"Create the union of two (multi)sets. Multi-dimension arrays will be converted to single-dimension arrays before the operation.",examples:["setUnion([1, 2, 3, 4], [3, 4, 5, 6])","setUnion([[1, 2], [3, 4]], [[3, 4], [5, 6]])"],seealso:["setIntersect","setDifference"]},zpk2tf:{name:"zpk2tf",category:"Signal",syntax:["zpk2tf(z, p, k)"],description:"Compute the transfer function of a zero-pole-gain model.",examples:["zpk2tf([1, 2], [-1, -2], 1)","zpk2tf([1, 2], [-1, -2])","zpk2tf([1 - 3i, 2 + 2i], [-1, -2])"],seealso:[]},freqz:{name:"freqz",category:"Signal",syntax:["freqz(b, a)","freqz(b, a, w)"],description:"Calculates the frequency response of a filter given its numerator and denominator coefficients.",examples:["freqz([1, 2], [1, 2, 3])","freqz([1, 2], [1, 2, 3], [0, 1])","freqz([1, 2], [1, 2, 3], 512)"],seealso:[]},erf:{name:"erf",category:"Special",syntax:["erf(x)"],description:"Compute the erf function of a value using a rational Chebyshev approximations for different intervals of x",examples:["erf(0.2)","erf(-0.5)","erf(4)"],seealso:[]},zeta:{name:"zeta",category:"Special",syntax:["zeta(s)"],description:"Compute the Riemann Zeta Function using an infinite series and Riemann's Functional Equation for the entire complex plane",examples:["zeta(0.2)","zeta(-0.5)","zeta(4)"],seealso:[]},cumsum:{name:"cumsum",category:"Statistics",syntax:["cumsum(a, b, c, ...)","cumsum(A)"],description:"Compute the cumulative sum of all values.",examples:["cumsum(2, 3, 4, 1)","cumsum([2, 3, 4, 1])","cumsum([1, 2; 3, 4])","cumsum([1, 2; 3, 4], 1)","cumsum([1, 2; 3, 4], 2)"],seealso:["max","mean","median","min","prod","std","sum","variance"]},mad:{name:"mad",category:"Statistics",syntax:["mad(a, b, c, ...)","mad(A)"],description:"Compute the median absolute deviation of a matrix or a list with values. The median absolute deviation is defined as the median of the absolute deviations from the median.",examples:["mad(10, 20, 30)","mad([1, 2, 3])"],seealso:["mean","median","std","abs"]},max:{name:"max",category:"Statistics",syntax:["max(a, b, c, ...)","max(A)","max(A, dimension)"],description:"Compute the maximum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["max(2, 3, 4, 1)","max([2, 3, 4, 1])","max([2, 5; 4, 3])","max([2, 5; 4, 3], 1)","max([2, 5; 4, 3], 2)","max(2.7, 7.1, -4.5, 2.0, 4.1)","min(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["mean","median","min","prod","std","sum","variance"]},mean:{name:"mean",category:"Statistics",syntax:["mean(a, b, c, ...)","mean(A)","mean(A, dimension)"],description:"Compute the arithmetic mean of a list of values.",examples:["mean(2, 3, 4, 1)","mean([2, 3, 4, 1])","mean([2, 5; 4, 3])","mean([2, 5; 4, 3], 1)","mean([2, 5; 4, 3], 2)","mean([1.0, 2.7, 3.2, 4.0])"],seealso:["max","median","min","prod","std","sum","variance"]},median:{name:"median",category:"Statistics",syntax:["median(a, b, c, ...)","median(A)"],description:"Compute the median of all values. The values are sorted and the middle value is returned. In case of an even number of values, the average of the two middle values is returned.",examples:["median(5, 2, 7)","median([3, -1, 5, 7])"],seealso:["max","mean","min","prod","std","sum","variance","quantileSeq"]},min:{name:"min",category:"Statistics",syntax:["min(a, b, c, ...)","min(A)","min(A, dimension)"],description:"Compute the minimum value of a list of values. If any NaN values are found, the function yields the last NaN in the input.",examples:["min(2, 3, 4, 1)","min([2, 3, 4, 1])","min([2, 5; 4, 3])","min([2, 5; 4, 3], 1)","min([2, 5; 4, 3], 2)","min(2.7, 7.1, -4.5, 2.0, 4.1)","max(2.7, 7.1, -4.5, 2.0, 4.1)"],seealso:["max","mean","median","prod","std","sum","variance"]},mode:{name:"mode",category:"Statistics",syntax:["mode(a, b, c, ...)","mode(A)","mode(A, a, b, B, c, ...)"],description:"Computes the mode of all values as an array. In case mode being more than one, multiple values are returned in an array.",examples:["mode(2, 1, 4, 3, 1)","mode([1, 2.7, 3.2, 4, 2.7])","mode(1, 4, 6, 1, 6)"],seealso:["max","mean","min","median","prod","std","sum","variance"]},prod:{name:"prod",category:"Statistics",syntax:["prod(a, b, c, ...)","prod(A)"],description:"Compute the product of all values.",examples:["prod(2, 3, 4)","prod([2, 3, 4])","prod([2, 5; 4, 3])"],seealso:["max","mean","min","median","min","std","sum","variance"]},quantileSeq:{name:"quantileSeq",category:"Statistics",syntax:["quantileSeq(A, prob[, sorted])","quantileSeq(A, [prob1, prob2, ...][, sorted])","quantileSeq(A, N[, sorted])"],description:"Compute the prob order quantile of a matrix or a list with values. The sequence is sorted and the middle value is returned. Supported types of sequence values are: Number, BigNumber, Unit Supported types of probability are: Number, BigNumber. \n\nIn case of a (multi dimensional) array or matrix, the prob order quantile of all elements will be calculated.",examples:["quantileSeq([3, -1, 5, 7], 0.5)","quantileSeq([3, -1, 5, 7], [1/3, 2/3])","quantileSeq([3, -1, 5, 7], 2)","quantileSeq([-1, 3, 5, 7], 0.5, true)"],seealso:["mean","median","min","max","prod","std","sum","variance"]},std:{name:"std",category:"Statistics",syntax:["std(a, b, c, ...)","std(A)","std(A, dimension)","std(A, normalization)","std(A, dimension, normalization)"],description:'Compute the standard deviation of all values, defined as std(A) = sqrt(variance(A)). Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["std(2, 4, 6)","std([2, 4, 6, 8])",'std([2, 4, 6, 8], "uncorrected")','std([2, 4, 6, 8], "biased")',"std([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","prod","sum","variance"]},sum:{name:"sum",category:"Statistics",syntax:["sum(a, b, c, ...)","sum(A)","sum(A, dimension)"],description:"Compute the sum of all values.",examples:["sum(2, 3, 4, 1)","sum([2, 3, 4, 1])","sum([2, 5; 4, 3])"],seealso:["max","mean","median","min","prod","std","sum","variance"]},variance:{name:"variance",category:"Statistics",syntax:["variance(a, b, c, ...)","variance(A)","variance(A, dimension)","variance(A, normalization)","variance(A, dimension, normalization)"],description:'Compute the variance of all values. Optional parameter normalization can be "unbiased" (default), "uncorrected", or "biased".',examples:["variance(2, 4, 6)","variance([2, 4, 6, 8])",'variance([2, 4, 6, 8], "uncorrected")','variance([2, 4, 6, 8], "biased")',"variance([1, 2, 3; 4, 5, 6])"],seealso:["max","mean","min","median","min","prod","std","sum"]},corr:{name:"corr",category:"Statistics",syntax:["corr(A,B)"],description:"Compute the correlation coefficient of a two list with values, For matrices, the matrix correlation coefficient is calculated.",examples:["corr([2, 4, 6, 8],[1, 2, 3, 6])","corr(matrix([[1, 2.2, 3, 4.8, 5], [1, 2, 3, 4, 5]]), matrix([[4, 5.3, 6.6, 7, 8], [1, 2, 3, 4, 5]]))"],seealso:["max","mean","min","median","min","prod","std","sum"]},acos:{name:"acos",category:"Trigonometry",syntax:["acos(x)"],description:"Compute the inverse cosine of a value in radians.",examples:["acos(0.5)","acos(cos(2.3))"],seealso:["cos","atan","asin"]},acosh:{name:"acosh",category:"Trigonometry",syntax:["acosh(x)"],description:"Calculate the hyperbolic arccos of a value, defined as `acosh(x) = ln(sqrt(x^2 - 1) + x)`.",examples:["acosh(1.5)"],seealso:["cosh","asinh","atanh"]},acot:{name:"acot",category:"Trigonometry",syntax:["acot(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acot(0.5)","acot(cot(0.5))","acot(2)"],seealso:["cot","atan"]},acoth:{name:"acoth",category:"Trigonometry",syntax:["acoth(x)"],description:"Calculate the inverse hyperbolic tangent of a value, defined as `acoth(x) = (ln((x+1)/x) + ln(x/(x-1))) / 2`.",examples:["acoth(2)","acoth(0.5)"],seealso:["acsch","asech"]},acsc:{name:"acsc",category:"Trigonometry",syntax:["acsc(x)"],description:"Calculate the inverse cotangent of a value.",examples:["acsc(2)","acsc(csc(0.5))","acsc(0.5)"],seealso:["csc","asin","asec"]},acsch:{name:"acsch",category:"Trigonometry",syntax:["acsch(x)"],description:"Calculate the inverse hyperbolic cosecant of a value, defined as `acsch(x) = ln(1/x + sqrt(1/x^2 + 1))`.",examples:["acsch(0.5)"],seealso:["asech","acoth"]},asec:{name:"asec",category:"Trigonometry",syntax:["asec(x)"],description:"Calculate the inverse secant of a value.",examples:["asec(0.5)","asec(sec(0.5))","asec(2)"],seealso:["acos","acot","acsc"]},asech:{name:"asech",category:"Trigonometry",syntax:["asech(x)"],description:"Calculate the inverse secant of a value.",examples:["asech(0.5)"],seealso:["acsch","acoth"]},asin:{name:"asin",category:"Trigonometry",syntax:["asin(x)"],description:"Compute the inverse sine of a value in radians.",examples:["asin(0.5)","asin(sin(0.5))"],seealso:["sin","acos","atan"]},asinh:{name:"asinh",category:"Trigonometry",syntax:["asinh(x)"],description:"Calculate the hyperbolic arcsine of a value, defined as `asinh(x) = ln(x + sqrt(x^2 + 1))`.",examples:["asinh(0.5)"],seealso:["acosh","atanh"]},atan:{name:"atan",category:"Trigonometry",syntax:["atan(x)"],description:"Compute the inverse tangent of a value in radians.",examples:["atan(0.5)","atan(tan(0.5))"],seealso:["tan","acos","asin"]},atanh:{name:"atanh",category:"Trigonometry",syntax:["atanh(x)"],description:"Calculate the hyperbolic arctangent of a value, defined as `atanh(x) = ln((1 + x)/(1 - x)) / 2`.",examples:["atanh(0.5)"],seealso:["acosh","asinh"]},atan2:{name:"atan2",category:"Trigonometry",syntax:["atan2(y, x)"],description:"Computes the principal value of the arc tangent of y/x in radians.",examples:["atan2(2, 2) / pi","angle = 60 deg in rad","x = cos(angle)","y = sin(angle)","atan2(y, x)"],seealso:["sin","cos","tan"]},cos:{name:"cos",category:"Trigonometry",syntax:["cos(x)"],description:"Compute the cosine of x in radians.",examples:["cos(2)","cos(pi / 4) ^ 2","cos(180 deg)","cos(60 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["acos","sin","tan"]},cosh:{name:"cosh",category:"Trigonometry",syntax:["cosh(x)"],description:"Compute the hyperbolic cosine of x in radians.",examples:["cosh(0.5)"],seealso:["sinh","tanh","coth"]},cot:{name:"cot",category:"Trigonometry",syntax:["cot(x)"],description:"Compute the cotangent of x in radians. Defined as 1/tan(x)",examples:["cot(2)","1 / tan(2)"],seealso:["sec","csc","tan"]},coth:{name:"coth",category:"Trigonometry",syntax:["coth(x)"],description:"Compute the hyperbolic cotangent of x in radians.",examples:["coth(2)","1 / tanh(2)"],seealso:["sech","csch","tanh"]},csc:{name:"csc",category:"Trigonometry",syntax:["csc(x)"],description:"Compute the cosecant of x in radians. Defined as 1/sin(x)",examples:["csc(2)","1 / sin(2)"],seealso:["sec","cot","sin"]},csch:{name:"csch",category:"Trigonometry",syntax:["csch(x)"],description:"Compute the hyperbolic cosecant of x in radians. Defined as 1/sinh(x)",examples:["csch(2)","1 / sinh(2)"],seealso:["sech","coth","sinh"]},sec:{name:"sec",category:"Trigonometry",syntax:["sec(x)"],description:"Compute the secant of x in radians. Defined as 1/cos(x)",examples:["sec(2)","1 / cos(2)"],seealso:["cot","csc","cos"]},sech:{name:"sech",category:"Trigonometry",syntax:["sech(x)"],description:"Compute the hyperbolic secant of x in radians. Defined as 1/cosh(x)",examples:["sech(2)","1 / cosh(2)"],seealso:["coth","csch","cosh"]},sin:{name:"sin",category:"Trigonometry",syntax:["sin(x)"],description:"Compute the sine of x in radians.",examples:["sin(2)","sin(pi / 4) ^ 2","sin(90 deg)","sin(30 deg)","sin(0.2)^2 + cos(0.2)^2"],seealso:["asin","cos","tan"]},sinh:{name:"sinh",category:"Trigonometry",syntax:["sinh(x)"],description:"Compute the hyperbolic sine of x in radians.",examples:["sinh(0.5)"],seealso:["cosh","tanh"]},tan:{name:"tan",category:"Trigonometry",syntax:["tan(x)"],description:"Compute the tangent of x in radians.",examples:["tan(0.5)","sin(0.5) / cos(0.5)","tan(pi / 4)","tan(45 deg)"],seealso:["atan","sin","cos"]},tanh:{name:"tanh",category:"Trigonometry",syntax:["tanh(x)"],description:"Compute the hyperbolic tangent of x in radians.",examples:["tanh(0.5)","sinh(0.5) / cosh(0.5)"],seealso:["sinh","cosh"]},to:{name:"to",category:"Units",syntax:["x to unit","to(x, unit)"],description:"Change the unit of a value.",examples:["5 inch to cm","3.2kg to g","16 bytes in bits"],seealso:[]},clone:{name:"clone",category:"Utils",syntax:["clone(x)"],description:"Clone a variable. Creates a copy of primitive variables, and a deep copy of matrices",examples:["clone(3.5)","clone(2 - 4i)","clone(45 deg)","clone([1, 2; 3, 4])",'clone("hello world")'],seealso:[]},format:{name:"format",category:"Utils",syntax:["format(value)","format(value, precision)"],description:"Format a value of any type as string.",examples:["format(2.3)","format(3 - 4i)","format([])","format(pi, 3)"],seealso:["print"]},bin:{name:"bin",category:"Utils",syntax:["bin(value)"],description:"Format a number as binary",examples:["bin(2)"],seealso:["oct","hex"]},oct:{name:"oct",category:"Utils",syntax:["oct(value)"],description:"Format a number as octal",examples:["oct(56)"],seealso:["bin","hex"]},hex:{name:"hex",category:"Utils",syntax:["hex(value)"],description:"Format a number as hexadecimal",examples:["hex(240)"],seealso:["bin","oct"]},isNaN:{name:"isNaN",category:"Utils",syntax:["isNaN(x)"],description:"Test whether a value is NaN (not a number)",examples:["isNaN(2)","isNaN(0 / 0)","isNaN(NaN)","isNaN(Infinity)"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isInteger:{name:"isInteger",category:"Utils",syntax:["isInteger(x)"],description:"Test whether a value is an integer number.",examples:["isInteger(2)","isInteger(3.5)","isInteger([3, 0.5, -2])"],seealso:["isNegative","isNumeric","isPositive","isZero"]},isNegative:{name:"isNegative",category:"Utils",syntax:["isNegative(x)"],description:"Test whether a value is negative: smaller than zero.",examples:["isNegative(2)","isNegative(0)","isNegative(-4)","isNegative([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isPositive","isZero"]},isNumeric:{name:"isNumeric",category:"Utils",syntax:["isNumeric(x)"],description:"Test whether a value is a numeric value. Returns true when the input is a number, BigNumber, Fraction, or boolean.",examples:["isNumeric(2)",'isNumeric("2")','hasNumericValue("2")',"isNumeric(0)","isNumeric(bignumber(500))","isNumeric(fraction(0.125))","isNumeric(2 + 3i)",'isNumeric([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","hasNumericValue"]},hasNumericValue:{name:"hasNumericValue",category:"Utils",syntax:["hasNumericValue(x)"],description:"Test whether a value is an numeric value. In case of a string, true is returned if the string contains a numeric value.",examples:["hasNumericValue(2)",'hasNumericValue("2")','isNumeric("2")',"hasNumericValue(0)","hasNumericValue(bignumber(500))","hasNumericValue(fraction(0.125))","hasNumericValue(2 + 3i)",'hasNumericValue([2.3, "foo", false])'],seealso:["isInteger","isZero","isNegative","isPositive","isNaN","isNumeric"]},isPositive:{name:"isPositive",category:"Utils",syntax:["isPositive(x)"],description:"Test whether a value is positive: larger than zero.",examples:["isPositive(2)","isPositive(0)","isPositive(-4)","isPositive([3, 0.5, -2])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isPrime:{name:"isPrime",category:"Utils",syntax:["isPrime(x)"],description:"Test whether a value is prime: has no divisors other than itself and one.",examples:["isPrime(3)","isPrime(-2)","isPrime([2, 17, 100])"],seealso:["isInteger","isNumeric","isNegative","isZero"]},isZero:{name:"isZero",category:"Utils",syntax:["isZero(x)"],description:"Test whether a value is zero.",examples:["isZero(2)","isZero(0)","isZero(-4)","isZero([3, 0, -2, 0])"],seealso:["isInteger","isNumeric","isNegative","isPositive"]},print:{name:"print",category:"Utils",syntax:["print(template, values)","print(template, values, precision)"],description:"Interpolate values into a string template.",examples:['print("Lucy is $age years old", {age: 5})','print("The value of pi is $pi", {pi: pi}, 3)','print("Hello, $user.name!", {user: {name: "John"}})','print("Values: $1, $2, $3", [6, 9, 4])'],seealso:["format"]},typeOf:{name:"typeOf",category:"Utils",syntax:["typeOf(x)"],description:"Get the type of a variable.",examples:["typeOf(3.5)","typeOf(2 - 4i)","typeOf(45 deg)",'typeOf("hello world")'],seealso:["getMatrixDataType"]},numeric:{name:"numeric",category:"Utils",syntax:["numeric(x)"],description:"Convert a numeric input to a specific numeric type: number, BigNumber, bigint, or Fraction.",examples:['numeric("4")','numeric("4", "number")','numeric("4", "bigint")','numeric("4", "BigNumber")','numeric("4", "Fraction")','numeric(4, "Fraction")','numeric(fraction(2, 5), "number")'],seealso:["number","bigint","fraction","bignumber","string","format"]}},nJ="help",rJ=SN(nJ,["typed","mathWithTransform","Help"],(e=>{var{typed:t,mathWithTransform:n,Help:r}=e;return t(nJ,{any:function(e){var t,i=e;if("string"!==typeof e)for(t in n)if(OA(n,t)&&e===n[t]){i=t;break}var a=DC(tJ,i);if(!a){var o="function"===typeof i?i.name:i;throw new Error('No documentation found on "'+o+'"')}return new r(a)}})}));function iJ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var aJ=SN("mapSlices",["typed","isInteger"],(e=>{var{typed:t,isInteger:n}=e,r=$k({typed:t,isInteger:n});return t("mapSlices",{"...any":function(e){var t=e[1];BC(t)?e[1]=t-1:kC(t)&&(e[1]=t.minus(1));try{return r.apply(null,e)}catch(n){throw lQ(n)}}})}),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iJ(Object(n),!0).forEach((function(t){(0,tG.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iJ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({isTransformFunction:!0},$k.meta));function oJ(e,t,n){var r=e.filter((function(e){return MA(e)&&!(e.name in t)&&!n.has(e.name)}))[0];if(!r)throw new Error('No undefined variable found in inline expression "'+e+'"');var i=r.name,a=new Map,o=new PC(n,a,new Set([i])),s=e.compile();return function(e){return a.set(i,e),s.evaluate(o)}}var sJ=SN("transformCallback",["typed"],(e=>{var{typed:t}=e;return function(e,r){return t.isTypedFunction(e)?n(e,r):lJ(e,e.length,r)};function n(e,r){var i=Object.fromEntries(Object.entries(e.signatures).map((e=>{var[i,a]=e,o=i.split(",").length;return t.isTypedFunction(a)?[i,n(a,r)]:[i,lJ(a,o,r)]})));return"string"===typeof e.name?t(e.name,i):t(i)}}));function lJ(e,t,n){return t===n?e:t===n+1?function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=r.slice(0,n),o=cJ(r[n]);return e(...a,o)}:t>n+1?function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=r.slice(0,n),o=cJ(r[n]),s=r.slice(n+1);return e(...a,o,...s)}:e}function cJ(e){return e.map((e=>e+1))}var uJ=SN("filter",["typed"],(e=>{var{typed:t}=e;function n(e,n,i){var a=lB({typed:t}),o=sJ({typed:t});if(0===e.length)return a();var s=e[0];if(1===e.length)return a(s);var l=e.length-1,c=e[l];return s&&(s=r(s,i)),c&&(c=MA(c)||mA(c)?r(c,i):oJ(c,n,i)),a(s,o(c,l))}function r(e,t){return e.compile().evaluate(t)}return n.rawArgs=!0,n}),{isTransformFunction:!0}),hJ=SN("forEach",["typed"],(e=>{var{typed:t}=e,n=fB({typed:t}),r=sJ({typed:t});function i(e,t,i){if(0===e.length)return n();var o=e[0];if(1===e.length)return n(o);var s=e.length-1,l=e[s];return o&&(o=a(o,i)),l&&(l=MA(l)||mA(l)?a(l,i):oJ(l,t,i)),n(o,r(l,s))}function a(e,t){return e.compile().evaluate(t)}return i.rawArgs=!0,i}),{isTransformFunction:!0}),dJ=SN("map",["typed"],(e=>{var{typed:t}=e,n=ZB({typed:t}),r=sJ({typed:t});function i(e,t,i){if(0===e.length)return n();if(1===e.length)return n(e[0]);var a=e.length-1,o=e.slice(0,a),s=e[a];return o=o.map((e=>l(e,i))),s&&(s=MA(s)||mA(s)?l(s,i):oJ(s,t,i)),n(...o,r(s,a));function l(e,t){return e.compile().evaluate(t)}}return i.rawArgs=!0,i}),{isTransformFunction:!0}),fJ=SN("or",["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:a}=e,o=nH({typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:a});function s(e,t,n){var r=e[0].compile().evaluate(n);if(!jC(r)&&o(r,!1))return!0;var i=e[1].compile().evaluate(n);return o(r,i)}return s.rawArgs=!0,s}),{isTransformFunction:!0}),pJ=SN("and",["typed","matrix","zeros","add","equalScalar","not","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,not:a,concat:o}=e,s=EV({typed:t,matrix:n,equalScalar:r,zeros:i,not:a,concat:o});function l(e,t,n){var r=e[0].compile().evaluate(n);if(!jC(r)&&!s(r,!0))return!1;var i=e[1].compile().evaluate(n);return s(r,i)}return l.rawArgs=!0,l}),{isTransformFunction:!0}),mJ=SN("concat",["typed","matrix","isInteger"],(e=>{var{typed:t,matrix:n,isInteger:r}=e,i=FL({typed:t,matrix:n,isInteger:r});return t("concat",{"...any":function(e){var t=e.length-1,n=e[t];BC(n)?e[t]=n-1:kC(n)&&(e[t]=n.minus(1));try{return i.apply(null,e)}catch(r){throw lQ(r)}}})}),{isTransformFunction:!0}),gJ=SN("index",["Index","getMatrixDataType"],(e=>{var{Index:t,getMatrixDataType:n}=e;return function(){for(var e=[],r=0,i=arguments.length;r<i;r++){var a=arguments[r];if(YC(a))a.start--,a.end-=a.step>0?0:2;else if(a&&!0===a.isSet)a=a.map((function(e){return e-1}));else if(GC(a)||qC(a))"boolean"!==n(a)&&(a=a.map((function(e){return e-1})));else if(BC(a)||LC(a))a--;else if(kC(a))a=a.toNumber()-1;else if("string"!==typeof a)throw new TypeError("Dimension must be an Array, Matrix, number, bigint, string, or Range");e[r]=a}var o=new t;return t.apply(o,e),o}}),{isTransformFunction:!0}),vJ="print",yJ=SN(vJ,["typed","matrix","zeros","add"],(e=>{var{typed:t,matrix:n,zeros:r,add:i}=e,a=dk({typed:t,matrix:n,zeros:r,add:i});return t(vJ,{"string, Object | Array":function(e,t){return a(o(e),t)},"string, Object | Array, number | Object":function(e,t,n){return a(o(e),t,n)}});function o(e){return e.replace(uk,(e=>"$"+e.slice(1).split(".").map((function(e){return!isNaN(e)&&e.length>0?parseInt(e)-1:e})).join(".")))}}),{isTransformFunction:!0});function xJ(e){if(2===e.length&&jC(e[0])){var t=(e=e.slice())[1];(BC(n=t)||kC(n))&&(e[1]=function(e){return BC(e)?e-1:kC(e)?e.minus(1):e}(t))}var n;return e}var bJ=SN("sum",["typed","config","add","numeric"],(e=>{var{typed:t,config:n,add:r,numeric:i}=e,a=eG({typed:t,config:n,add:r,numeric:i});return t("sum",{"...any":function(e){e=xJ(e);try{return a.apply(null,e)}catch(t){throw lQ(t)}}})}),{isTransformFunction:!0}),_J=SN("bitAnd",["typed","matrix","zeros","add","equalScalar","not","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,zeros:i,not:a,concat:o}=e,s=$U({typed:t,matrix:n,equalScalar:r,zeros:i,not:a,concat:o});function l(e,t,n){var r=e[0].compile().evaluate(n);if(!jC(r)){if(isNaN(r))return NaN;if(0===r||!1===r)return 0}var i=e[1].compile().evaluate(n);return s(r,i)}return l.rawArgs=!0,l}),{isTransformFunction:!0}),wJ=SN("min",["typed","config","numeric","smaller","isNaN"],(e=>{var{typed:t,config:n,numeric:r,smaller:i,isNaN:a}=e,o=$z({typed:t,config:n,numeric:r,smaller:i,isNaN:a});return t("min",{"...any":function(e){e=xJ(e);try{return o.apply(null,e)}catch(t){throw lQ(t)}}})}),{isTransformFunction:!0}),SJ=SN("subset",["typed","matrix","zeros","add"],(e=>{var{typed:t,matrix:n,zeros:r,add:i}=e,a=dH({typed:t,matrix:n,zeros:r,add:i});return t("subset",{"...any":function(e){try{return a.apply(null,e)}catch(t){throw lQ(t)}}})}),{isTransformFunction:!0}),MJ=SN("bitOr",["typed","matrix","equalScalar","DenseMatrix","concat"],(e=>{var{typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:a}=e,o=tz({typed:t,matrix:n,equalScalar:r,DenseMatrix:i,concat:a});function s(e,t,n){var r=e[0].compile().evaluate(n);if(!jC(r)){if(isNaN(r))return NaN;if(-1===r)return-1;if(!0===r)return 1}var i=e[1].compile().evaluate(n);return o(r,i)}return s.rawArgs=!0,s}),{isTransformFunction:!0}),DJ="cumsum",EJ=SN(DJ,["typed","add","unaryPlus"],(e=>{var{typed:t,add:n,unaryPlus:r}=e,i=oG({typed:t,add:n,unaryPlus:r});return t(DJ,{"...any":function(e){if(2===e.length&&jC(e[0])){var t=e[1];BC(t)?e[1]=t-1:kC(t)&&(e[1]=t.minus(1))}try{return i.apply(null,e)}catch(n){throw lQ(n)}}})}),{isTransformFunction:!0}),CJ="diff",AJ=SN(CJ,["typed","matrix","subtract","number","bignumber"],(e=>{var{typed:t,matrix:n,subtract:r,number:i,bignumber:a}=e,o=NH({typed:t,matrix:n,subtract:r,number:i,bignumber:a});return t(CJ,{"...any":function(e){e=xJ(e);try{return o.apply(null,e)}catch(t){throw lQ(t)}}})}),{isTransformFunction:!0}),TJ=SN("max",["typed","config","numeric","larger","isNaN"],(e=>{var{typed:t,config:n,numeric:r,larger:i,isNaN:a}=e,o=Jz({typed:t,config:n,numeric:r,larger:i,isNaN:a});return t("max",{"...any":function(e){e=xJ(e);try{return o.apply(null,e)}catch(t){throw lQ(t)}}})}),{isTransformFunction:!0}),NJ=SN("range",["typed","config","?matrix","?bignumber","smaller","smallerEq","larger","largerEq","add","isPositive"],(e=>{var{typed:t,config:n,matrix:r,bignumber:i,smaller:a,smallerEq:o,larger:s,largerEq:l,add:c,isPositive:u}=e,h=ZH({typed:t,config:n,matrix:r,bignumber:i,smaller:a,smallerEq:o,larger:s,largerEq:l,add:c,isPositive:u});return t("range",{"...any":function(e){return"boolean"!==typeof e[e.length-1]&&e.push(!0),h.apply(null,e)}})}),{isTransformFunction:!0}),RJ=SN("row",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:n,matrix:r,range:i}=e,a=KH({typed:t,Index:n,matrix:r,range:i});return t("row",{"...any":function(e){var t=e.length-1,n=e[t];BC(n)&&(e[t]=n-1);try{return a.apply(null,e)}catch(r){throw lQ(r)}}})}),{isTransformFunction:!0}),PJ=SN("column",["typed","Index","matrix","range"],(e=>{var{typed:t,Index:n,matrix:r,range:i}=e,a=FV({typed:t,Index:n,matrix:r,range:i});return t("column",{"...any":function(e){var t=e.length-1,n=e[t];BC(n)&&(e[t]=n-1);try{return a.apply(null,e)}catch(r){throw lQ(r)}}})}),{isTransformFunction:!0}),FJ=SN("mean",["typed","add","divide"],(e=>{var{typed:t,add:n,divide:r}=e,i=$G({typed:t,add:n,divide:r});return t("mean",{"...any":function(e){e=xJ(e);try{return i.apply(null,e)}catch(t){throw lQ(t)}}})}),{isTransformFunction:!0}),OJ=SN("quantileSeq",["typed","bignumber","add","subtract","divide","multiply","partitionSelect","compare","isInteger","smaller","smallerEq","larger","mapSlices"],(e=>{var{typed:t,bignumber:n,add:r,subtract:i,divide:a,multiply:o,partitionSelect:s,compare:l,isInteger:c,smaller:u,smallerEq:h,larger:d,mapSlices:f}=e,p=nq({typed:t,bignumber:n,add:r,subtract:i,divide:a,multiply:o,partitionSelect:s,compare:l,isInteger:c,smaller:u,smallerEq:h,larger:d,mapSlices:f});return t("quantileSeq",{"Array | Matrix, number | BigNumber":p,"Array | Matrix, number | BigNumber, number":(e,t,n)=>p(e,t,m(n)),"Array | Matrix, number | BigNumber, boolean":p,"Array | Matrix, number | BigNumber, boolean, number":(e,t,n,r)=>p(e,t,n,m(r)),"Array | Matrix, Array | Matrix":p,"Array | Matrix, Array | Matrix, number":(e,t,n)=>p(e,t,m(n)),"Array | Matrix, Array | Matrix, boolean":p,"Array | Matrix, Array | Matrix, boolean, number":(e,t,n,r)=>p(e,t,n,m(r))});function m(e){return xJ([[],e])[1]}}),{isTransformFunction:!0}),IJ="variance",BJ=SN(IJ,["typed","add","subtract","multiply","divide","mapSlices","isNaN"],(e=>{var{typed:t,add:n,subtract:r,multiply:i,divide:a,mapSlices:o,isNaN:s}=e,l=cq({typed:t,add:n,subtract:r,multiply:i,divide:a,mapSlices:o,isNaN:s});return t(IJ,{"...any":function(e){e=xJ(e);try{return l.apply(null,e)}catch(t){throw lQ(t)}}})}),{isTransformFunction:!0}),kJ=SN("std",["typed","map","sqrt","variance"],(e=>{var{typed:t,map:n,sqrt:r,variance:i}=e,a=wq({typed:t,map:n,sqrt:r,variance:i});return t("std",{"...any":function(e){e=xJ(e);try{return a.apply(null,e)}catch(t){throw lQ(t)}}})}),{isTransformFunction:!0}),LJ={},UJ={},zJ={},HJ=MK({mathWithTransform:UJ}),VJ=EK({Node:HJ}),GJ=HK({Node:HJ}),qJ=GK({Node:HJ}),jJ=jK({Node:HJ}),WJ=XK({Node:HJ}),XJ=ZK({Node:HJ,ResultSet:aj}),YJ=QK({Node:HJ}),ZJ=$K({Node:HJ}),KJ=tQ({Node:HJ}),QJ=nQ({classes:zJ}),JJ=rQ({math:LJ,typed:vj}),$J=aQ({Node:HJ,typed:vj}),e$=sQ({Chain:JJ,typed:vj}),t$=hQ({Node:HJ,subset:tY}),n$=fQ({matrix:IW,Node:HJ,subset:tY}),r$=mQ({Node:HJ,size:vX}),i$=gQ({Unit:jY,Node:HJ,math:LJ}),a$=yQ({Node:HJ,SymbolNode:i$,math:LJ}),o$=bQ({AccessorNode:t$,ArrayNode:WJ,AssignmentNode:n$,BlockNode:XJ,ConditionalNode:YJ,ConstantNode:ZJ,FunctionAssignmentNode:$J,FunctionNode:a$,IndexNode:r$,ObjectNode:VJ,OperatorNode:GJ,ParenthesisNode:qJ,RangeNode:KJ,RelationalNode:jJ,SymbolNode:i$,config:UA,numeric:dX,typed:vj}),s$=_Q({ConstantNode:ZJ,FunctionNode:a$,OperatorNode:GJ,ParenthesisNode:qJ,parse:o$,typed:vj}),l$=DQ({bignumber:CW,fraction:iX,AccessorNode:t$,ArrayNode:WJ,ConstantNode:ZJ,FunctionNode:a$,IndexNode:r$,ObjectNode:VJ,OperatorNode:GJ,SymbolNode:i$,config:UA,mathWithTransform:UJ,matrix:IW,typed:vj}),c$=CQ({parse:o$,typed:vj}),u$=TQ({AccessorNode:t$,ArrayNode:WJ,ConstantNode:ZJ,FunctionNode:a$,IndexNode:r$,ObjectNode:VJ,OperatorNode:GJ,ParenthesisNode:qJ,SymbolNode:i$,add:SX,divide:OZ,equal:rX,isZero:eW,multiply:yY,parse:o$,pow:LY,subtract:nY,typed:vj}),h$=RQ({parse:o$,typed:vj}),d$=PQ({evaluate:h$}),f$=FQ({evaluate:h$,parse:o$}),p$=kQ({AccessorNode:t$,ArrayNode:WJ,ConstantNode:ZJ,FunctionNode:a$,IndexNode:r$,ObjectNode:VJ,OperatorNode:GJ,ParenthesisNode:qJ,SymbolNode:i$,equal:rX,parse:o$,replacer:mj,resolve:s$,simplifyConstant:l$,simplifyCore:u$,typed:vj}),m$=zQ({OperatorNode:GJ,parse:o$,simplify:p$,typed:vj}),g$=GQ({parse:o$,typed:vj}),v$=WQ({Parser:f$,typed:vj}),y$=ZQ({bignumber:CW,fraction:iX,AccessorNode:t$,ArrayNode:WJ,ConstantNode:ZJ,FunctionNode:a$,IndexNode:r$,ObjectNode:VJ,OperatorNode:GJ,ParenthesisNode:qJ,SymbolNode:i$,add:SX,config:UA,divide:OZ,equal:rX,isZero:eW,mathWithTransform:UJ,matrix:IW,multiply:yY,parse:o$,pow:LY,simplify:p$,simplifyConstant:l$,simplifyCore:u$,subtract:nY,typed:vj}),x$=JQ({ConstantNode:ZJ,FunctionNode:a$,OperatorNode:GJ,ParenthesisNode:qJ,SymbolNode:i$,config:UA,equal:rX,isZero:eW,numeric:dX,parse:o$,simplify:p$,typed:vj}),b$=rJ({Help:d$,mathWithTransform:UJ,typed:vj});SC(LJ,{e:Wq,false:Xq,fineStructure:Yq,i:Kq,Infinity:Qq,LN10:Jq,LOG10E:$q,NaN:tj,null:nj,phi:rj,SQRT1_2:oj,sackurTetrode:sj,tau:lj,true:cj,E:Wq,version:uj,efimovFactor:dj,LN2:fj,pi:pj,replacer:mj,reviver:QJ,SQRT2:gj,typed:vj,PI:pj,weakMixingAngle:yj,abs:xj,acos:bj,acot:_j,acsc:wj,addScalar:Sj,arg:Mj,asech:Dj,asinh:Ej,atan:Cj,atanh:Aj,bigint:Tj,bitNot:Nj,boolean:Rj,clone:Pj,combinations:Fj,complex:Oj,conj:Ij,cos:Bj,cot:kj,csc:Lj,cube:Uj,equalScalar:zj,erf:Hj,exp:Vj,expm1:Gj,filter:qj,flatten:jj,forEach:Wj,format:Xj,getMatrixDataType:Yj,hex:Zj,im:Kj,isInteger:Qj,isNegative:Jj,isPositive:$j,isZero:eW,LOG2E:tW,lgamma:nW,log10:rW,log2:iW,map:aW,multiplyScalar:oW,not:sW,number:lW,oct:cW,pickRandom:uW,print:hW,random:dW,re:fW,sec:pW,sign:mW,sin:gW,splitUnit:yW,square:xW,string:bW,subtractScalar:_W,tan:wW,typeOf:SW,acosh:MW,acsch:DW,asec:EW,bignumber:CW,chain:e$,combinationsWithRep:AW,cosh:TW,csch:NW,isNaN:RW,isPrime:PW,mapSlices:FW,matrix:IW,matrixFromFunction:BW,ones:kW,randomInt:LW,reshape:UW,sech:zW,sinh:HW,sparse:VW,sqrt:GW,squeeze:qW,tanh:jW,transpose:WW,xgcd:XW,zeros:YW,acoth:ZW,asin:KW,bin:QW,concat:JW,coth:$W,ctranspose:eX,diag:tX,dotMultiply:nX,equal:rX,fraction:iX,identity:aX,isNumeric:oX,kron:sX,largerEq:lX,leftShift:cX,mode:uX,nthRoot:hX,numeric:dX,prod:fX,resize:pX,rightArithShift:mX,round:gX,size:vX,smaller:yX,to:xX,unaryMinus:bX,unequal:_X,xor:wX,add:SX,atan2:MX,bitAnd:DX,bitOr:EX,bitXor:CX,cbrt:AX,compare:TX,compareText:NX,count:RX,deepEqual:PX,divideScalar:FX,dotDivide:OX,equalText:IX,floor:BX,gcd:kX,hasNumericValue:LX,hypot:UX,larger:VX,log:GX,lsolve:qX,matrixFromColumns:jX,max:WX,min:XX,mod:YX,nthRoots:ZX,or:KX,partitionSelect:QX,qr:JX,rightLogShift:$X,smallerEq:eY,subset:tY,subtract:nY,trace:rY,usolve:iY,catalan:aY,compareNatural:oY,composition:sY,diff:lY,distance:cY,dot:uY,index:dY,invmod:fY,lcm:pY,log1p:mY,lsolveAll:gY,matrixFromRows:vY,multiply:yY,range:xY,row:bY,setCartesian:_Y,setDistinct:wY,setIsSubset:SY,setPowerset:MY,slu:DY,sort:EY,unaryPlus:CY,usolveAll:AY,zpk2tf:TY,and:NY,ceil:RY,column:PY,cross:FY,det:OY,fix:IY,inv:BY,pinv:kY,pow:LY,setDifference:UY,setMultiplicity:zY,setSymDifference:HY,sqrtm:GY,sum:qY,vacuumImpedance:WY,wienDisplacement:XY,atomicMass:YY,bohrMagneton:ZY,boltzmann:KY,conductanceQuantum:QY,coulomb:JY,cumsum:$Y,deuteronMass:eZ,dotPow:tZ,electricConstant:nZ,elementaryCharge:rZ,expm:iZ,faraday:aZ,fft:oZ,gamma:sZ,gravitationConstant:lZ,hartreeEnergy:cZ,ifft:uZ,inverseConductanceQuantum:hZ,klitzing:dZ,loschmidt:fZ,magneticConstant:pZ,molarMass:mZ,molarPlanckConstant:gZ,neutronMass:vZ,nuclearMagneton:yZ,planckCharge:xZ,planckLength:bZ,planckTemperature:_Z,protonMass:wZ,quantumOfCirculation:SZ,reducedPlanckConstant:MZ,rydberg:DZ,secondRadiation:EZ,setSize:CZ,speedOfLight:AZ,stefanBoltzmann:TZ,thomsonCrossSection:NZ,avogadro:RZ,bohrRadius:PZ,createUnit:FZ,divide:OZ,electronMass:IZ,factorial:BZ,firstRadiation:kZ,gravity:LZ,intersect:UZ,lup:zZ,magneticFluxQuantum:HZ,molarMassC12:VZ,multinomial:GZ,parse:o$,permutations:qZ,planckMass:jZ,polynomialRoot:WZ,resolve:s$,setIntersect:XZ,simplifyConstant:l$,solveODE:YZ,stirlingS2:ZZ,unit:KZ,bellNumbers:QZ,compile:c$,eigs:JZ,fermiCoupling:$Z,gasConstant:eK,kldivergence:tK,lusolve:nK,mean:rK,molarVolume:iK,planckConstant:aK,quantileSeq:oK,setUnion:sK,simplifyCore:u$,variance:lK,classicalElectronRadius:cK,evaluate:h$,median:uK,simplify:p$,symbolicEqual:m$,corr:hK,freqz:dK,leafCount:g$,mad:fK,parser:v$,rationalize:y$,std:pK,zeta:mK,derivative:x$,norm:gK,rotationMatrix:vK,help:b$,planckTime:yK,schur:xK,rotate:bK,sylvester:_K,lyap:wK,config:UA}),SC(UJ,LJ,{mapSlices:aJ({isInteger:Qj,typed:vj}),filter:uJ({typed:vj}),forEach:hJ({typed:vj}),map:dJ({typed:vj}),or:fJ({DenseMatrix:hj,concat:JW,equalScalar:zj,matrix:IW,typed:vj}),and:pJ({add:SX,concat:JW,equalScalar:zj,matrix:IW,not:sW,typed:vj,zeros:YW}),concat:mJ({isInteger:Qj,matrix:IW,typed:vj}),index:gJ({Index:HX,getMatrixDataType:Yj}),print:yJ({add:SX,matrix:IW,typed:vj,zeros:YW}),sum:bJ({add:SX,config:UA,numeric:dX,typed:vj}),bitAnd:_J({add:SX,concat:JW,equalScalar:zj,matrix:IW,not:sW,typed:vj,zeros:YW}),min:wJ({config:UA,isNaN:RW,numeric:dX,smaller:yX,typed:vj}),subset:SJ({add:SX,matrix:IW,typed:vj,zeros:YW}),bitOr:MJ({DenseMatrix:hj,concat:JW,equalScalar:zj,matrix:IW,typed:vj}),cumsum:EJ({add:SX,typed:vj,unaryPlus:CY}),diff:AJ({bignumber:CW,matrix:IW,number:lW,subtract:nY,typed:vj}),max:TJ({config:UA,isNaN:RW,larger:VX,numeric:dX,typed:vj}),range:NJ({bignumber:CW,matrix:IW,add:SX,config:UA,isPositive:$j,larger:VX,largerEq:lX,smaller:yX,smallerEq:eY,typed:vj}),row:RJ({Index:HX,matrix:IW,range:xY,typed:vj}),column:PJ({Index:HX,matrix:IW,range:xY,typed:vj}),mean:FJ({add:SX,divide:OZ,typed:vj}),quantileSeq:OJ({add:SX,bignumber:CW,compare:TX,divide:OZ,isInteger:Qj,larger:VX,mapSlices:FW,multiply:yY,partitionSelect:QX,smaller:yX,smallerEq:eY,subtract:nY,typed:vj}),variance:BJ({add:SX,divide:OZ,isNaN:RW,mapSlices:FW,multiply:yY,subtract:nY,typed:vj}),std:kJ({map:aW,sqrt:GW,typed:vj,variance:lK})}),SC(zJ,{BigNumber:qq,Complex:jq,Fraction:Zq,Matrix:ej,Node:HJ,ObjectNode:VJ,OperatorNode:GJ,ParenthesisNode:qJ,Range:ij,RelationalNode:jJ,ResultSet:aj,ArrayNode:WJ,BlockNode:XJ,ConditionalNode:YJ,ConstantNode:ZJ,DenseMatrix:hj,RangeNode:KJ,Chain:JJ,FunctionAssignmentNode:$J,SparseMatrix:vW,ImmutableDenseMatrix:zX,Index:HX,AccessorNode:t$,AssignmentNode:n$,FibonacciHeap:hY,IndexNode:r$,Spa:VY,Unit:jY,SymbolNode:i$,FunctionNode:a$,Help:d$,Parser:f$}),JJ.createProxy(LJ);var _$={createBigNumberClass:EN},w$={createComplexClass:oR},S$={createMatrixClass:$P},M$={MatrixDependencies:S$,createDenseMatrixClass:QF},D$={createFractionClass:JP},E$={BigNumberDependencies:_$,ComplexDependencies:w$,DenseMatrixDependencies:M$,FractionDependencies:D$,createTyped:eO},C$={typedDependencies:E$,createAbs:FO},A$={createNode:MK},T$={typedDependencies:E$,createEqualScalar:JI},N$={MatrixDependencies:S$,equalScalarDependencies:T$,typedDependencies:E$,createSparseMatrixClass:wk},R$={typedDependencies:E$,createAddScalar:iI},P$={typedDependencies:E$,createIsInteger:wB},F$={DenseMatrixDependencies:M$,MatrixDependencies:S$,SparseMatrixDependencies:N$,typedDependencies:E$,createMatrix:nL},O$={isIntegerDependencies:P$,matrixDependencies:F$,typedDependencies:E$,createConcat:FL},I$={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,addScalarDependencies:R$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createAdd:ZU},B$={BigNumberDependencies:_$,matrixDependencies:F$,typedDependencies:E$,createZeros:EL},k$={addDependencies:I$,matrixDependencies:F$,typedDependencies:E$,zerosDependencies:B$,createSubset:dH},L$={NodeDependencies:A$,subsetDependencies:k$,createAccessorNode:hQ},U$={ComplexDependencies:w$,typedDependencies:E$,createAcos:IO},z$={ComplexDependencies:w$,typedDependencies:E$,createAcosh:Ik},H$={BigNumberDependencies:_$,typedDependencies:E$,createAcot:eI},V$={BigNumberDependencies:_$,ComplexDependencies:w$,typedDependencies:E$,createAcoth:AL},G$={BigNumberDependencies:_$,ComplexDependencies:w$,typedDependencies:E$,createAcsc:nI},q$={BigNumberDependencies:_$,typedDependencies:E$,createAcsch:kk},j$={typedDependencies:E$,createNot:nk},W$={concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,notDependencies:j$,typedDependencies:E$,zerosDependencies:B$,createAnd:EV},X$={addDependencies:I$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,notDependencies:j$,typedDependencies:E$,zerosDependencies:B$,createAndTransform:pJ},Y$={typedDependencies:E$,createArg:aI},Z$={NodeDependencies:A$,createArrayNode:XK},K$={BigNumberDependencies:_$,ComplexDependencies:w$,typedDependencies:E$,createAsec:Uk},Q$={BigNumberDependencies:_$,ComplexDependencies:w$,typedDependencies:E$,createAsech:sI},J$={ComplexDependencies:w$,typedDependencies:E$,createAsin:NL},$$={typedDependencies:E$,createAsinh:lI},e0={matrixDependencies:F$,NodeDependencies:A$,subsetDependencies:k$,createAssignmentNode:fQ},t0={typedDependencies:E$,createAtan:cI},n0={BigNumberDependencies:_$,DenseMatrixDependencies:M$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createAtan2:QU},r0={ComplexDependencies:w$,typedDependencies:E$,createAtanh:hI},i0={BigNumberDependencies:_$,typedDependencies:E$,createBignumber:zk},a0={FractionDependencies:D$,typedDependencies:E$,createFraction:tU},o0={typedDependencies:E$,createNumber:rk},s0={bignumberDependencies:i0,fractionDependencies:a0,numberDependencies:o0,createNumeric:DU},l0={numericDependencies:s0,typedDependencies:E$,createDivideScalar:yz},c0={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createEqual:$L},u0={BigNumberDependencies:_$,DenseMatrixDependencies:M$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,zerosDependencies:B$,createRound:IU},h0={DenseMatrixDependencies:M$,equalScalarDependencies:T$,matrixDependencies:F$,roundDependencies:u0,typedDependencies:E$,zerosDependencies:B$,createCeil:RV},d0={DenseMatrixDependencies:M$,equalScalarDependencies:T$,matrixDependencies:F$,roundDependencies:u0,typedDependencies:E$,zerosDependencies:B$,createFloor:Cz},f0={ComplexDependencies:w$,DenseMatrixDependencies:M$,ceilDependencies:h0,equalScalarDependencies:T$,floorDependencies:d0,matrixDependencies:F$,typedDependencies:E$,zerosDependencies:B$,createFix:zV},p0={typedDependencies:E$,createFormat:gB},m0={typedDependencies:E$,createIsNumeric:aU},g0={typedDependencies:E$,createMultiplyScalar:KB},v0={BigNumberDependencies:_$,DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,matrixDependencies:F$,typedDependencies:E$,createIdentity:rU},y0={equalScalarDependencies:T$,typedDependencies:E$,createIsZero:PB},x0={typedDependencies:E$,createConj:VI},b0={matrixDependencies:F$,typedDependencies:E$,createSize:kU},_0={addScalarDependencies:R$,conjDependencies:x0,multiplyScalarDependencies:g0,sizeDependencies:b0,typedDependencies:E$,createDot:FH},w0={addScalarDependencies:R$,dotDependencies:_0,equalScalarDependencies:T$,matrixDependencies:F$,multiplyScalarDependencies:g0,typedDependencies:E$,createMultiply:XH},S0={typedDependencies:E$,createSubtractScalar:Nk},M0={typedDependencies:E$,createUnaryMinus:GU},D0={divideScalarDependencies:l0,isZeroDependencies:y0,matrixDependencies:F$,multiplyDependencies:w0,subtractScalarDependencies:S0,typedDependencies:E$,unaryMinusDependencies:M0,createDet:BV},E0={absDependencies:C$,addScalarDependencies:R$,detDependencies:D0,divideScalarDependencies:l0,identityDependencies:v0,matrixDependencies:F$,multiplyDependencies:w0,typedDependencies:E$,unaryMinusDependencies:M0,createInv:HV},C0={ComplexDependencies:w$,fractionDependencies:a0,identityDependencies:v0,invDependencies:E0,matrixDependencies:F$,multiplyDependencies:w0,numberDependencies:o0,typedDependencies:E$,createPow:qV},A0={BigNumberDependencies:_$,ComplexDependencies:w$,FractionDependencies:D$,absDependencies:C$,addScalarDependencies:R$,divideScalarDependencies:l0,equalDependencies:c0,fixDependencies:f0,formatDependencies:p0,isNumericDependencies:m0,multiplyScalarDependencies:g0,numberDependencies:o0,powDependencies:C0,roundDependencies:u0,subtractScalarDependencies:S0,createUnitClass:iG},T0={BigNumberDependencies:_$,UnitDependencies:A0,createAtomicMass:dP},N0={BigNumberDependencies:_$,UnitDependencies:A0,createAvogadro:fP},R0={typedDependencies:E$,createIsNegative:AB},P0={typedDependencies:E$,createCombinations:LI},F0={BigNumberDependencies:_$,ComplexDependencies:w$,multiplyScalarDependencies:g0,powDependencies:C0,typedDependencies:E$,createGamma:fG},O0={gammaDependencies:F0,typedDependencies:E$,createFactorial:wG},I0={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,bignumberDependencies:i0,concatDependencies:O$,matrixDependencies:F$,typedDependencies:E$,createLarger:Vz},B0={bignumberDependencies:i0,addScalarDependencies:R$,combinationsDependencies:P0,divideScalarDependencies:l0,factorialDependencies:O0,isIntegerDependencies:P$,isNegativeDependencies:R0,largerDependencies:I0,multiplyScalarDependencies:g0,numberDependencies:o0,powDependencies:C0,subtractScalarDependencies:S0,typedDependencies:E$,createStirlingS2:kG},k0={addScalarDependencies:R$,isIntegerDependencies:P$,isNegativeDependencies:R0,stirlingS2Dependencies:B0,typedDependencies:E$,createBellNumbers:HG},L0={typedDependencies:E$,createBigint:dI},U0={formatDependencies:p0,typedDependencies:E$,createBin:RL},z0={concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createBitAnd:$U},H0={addDependencies:I$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,notDependencies:j$,typedDependencies:E$,zerosDependencies:B$,createBitAndTransform:_J},V0={typedDependencies:E$,createBitNot:NI},G0={DenseMatrixDependencies:M$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createBitOr:tz},q0={DenseMatrixDependencies:M$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createBitOrTransform:MJ},j0={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,concatDependencies:O$,matrixDependencies:F$,typedDependencies:E$,createBitXor:rz},W0={createResultSet:tF},X0={NodeDependencies:A$,ResultSetDependencies:W0,createBlockNode:ZK},Y0={BigNumberDependencies:_$,UnitDependencies:A0,createBohrMagneton:WR},Z0={BigNumberDependencies:_$,UnitDependencies:A0,createBohrRadius:JR},K0={BigNumberDependencies:_$,UnitDependencies:A0,createBoltzmann:pP},Q0={typedDependencies:E$,createBoolean:PI},J0={addScalarDependencies:R$,combinationsDependencies:P0,divideScalarDependencies:l0,isIntegerDependencies:P$,isNegativeDependencies:R0,multiplyScalarDependencies:g0,typedDependencies:E$,createCatalan:SH},$0={BigNumberDependencies:_$,ComplexDependencies:w$,FractionDependencies:D$,isNegativeDependencies:R0,matrixDependencies:F$,typedDependencies:E$,unaryMinusDependencies:M0,createCbrt:az},e1={typedDependencies:E$,createChainClass:rQ},t1={ChainDependencies:e1,typedDependencies:E$,createChain:sQ},n1={BigNumberDependencies:_$,UnitDependencies:A0,createClassicalElectronRadius:$R},r1={typedDependencies:E$,createClone:OI},i1={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,bignumberDependencies:i0,concatDependencies:O$,matrixDependencies:F$,typedDependencies:E$,createSmaller:UU},a1={DenseMatrixDependencies:M$,smallerDependencies:i1,createImmutableDenseMatrixClass:Lz},o1={typedDependencies:E$,createGetMatrixDataType:yB},s1={ImmutableDenseMatrixDependencies:a1,getMatrixDataTypeDependencies:o1,createIndexClass:Uz},l1={typedDependencies:E$,createIsPositive:NB},c1={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,concatDependencies:O$,matrixDependencies:F$,typedDependencies:E$,createLargerEq:cU},u1={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,concatDependencies:O$,matrixDependencies:F$,typedDependencies:E$,createSmallerEq:cH},h1={bignumberDependencies:i0,matrixDependencies:F$,addDependencies:I$,isPositiveDependencies:l1,largerDependencies:I0,largerEqDependencies:c1,smallerDependencies:i1,smallerEqDependencies:u1,typedDependencies:E$,createRange:ZH},d1={IndexDependencies:s1,matrixDependencies:F$,rangeDependencies:h1,typedDependencies:E$,createColumn:FV},f1={IndexDependencies:s1,matrixDependencies:F$,rangeDependencies:h1,typedDependencies:E$,createColumnTransform:PJ},p1={typedDependencies:E$,createCombinationsWithRep:Vk},m1={BigNumberDependencies:_$,DenseMatrixDependencies:M$,FractionDependencies:D$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createCompare:lz},g1={compareDependencies:m1,typedDependencies:E$,createCompareNatural:EH},v1={concatDependencies:O$,matrixDependencies:F$,typedDependencies:E$,createCompareText:dz},y1={NodeDependencies:A$,createConditionalNode:QK},x1={NodeDependencies:A$,createConstantNode:$K},b1={NodeDependencies:A$,typedDependencies:E$,createFunctionAssignmentNode:aQ},_1={UnitDependencies:A0,NodeDependencies:A$,createSymbolNode:gQ},w1={NodeDependencies:A$,SymbolNodeDependencies:_1,createFunctionNode:yQ},S1={NodeDependencies:A$,sizeDependencies:b0,createIndexNode:mQ},M1={NodeDependencies:A$,createObjectNode:EK},D1={NodeDependencies:A$,createOperatorNode:HK},E1={NodeDependencies:A$,createParenthesisNode:GK},C1={NodeDependencies:A$,createRangeNode:tQ},A1={NodeDependencies:A$,createRelationalNode:jK},T1={AccessorNodeDependencies:L$,ArrayNodeDependencies:Z$,AssignmentNodeDependencies:e0,BlockNodeDependencies:X0,ConditionalNodeDependencies:y1,ConstantNodeDependencies:x1,FunctionAssignmentNodeDependencies:b1,FunctionNodeDependencies:w1,IndexNodeDependencies:S1,ObjectNodeDependencies:M1,OperatorNodeDependencies:D1,ParenthesisNodeDependencies:E1,RangeNodeDependencies:C1,RelationalNodeDependencies:A1,SymbolNodeDependencies:_1,numericDependencies:s0,typedDependencies:E$,createParse:bQ},N1={parseDependencies:T1,typedDependencies:E$,createCompile:CQ},R1={ComplexDependencies:w$,typedDependencies:E$,createComplex:zI},P1={addScalarDependencies:R$,combinationsDependencies:P0,isIntegerDependencies:P$,isNegativeDependencies:R0,isPositiveDependencies:l1,largerDependencies:I0,typedDependencies:E$,createComposition:AH},F1={isIntegerDependencies:P$,matrixDependencies:F$,typedDependencies:E$,createConcatTransform:mJ},O1={BigNumberDependencies:_$,UnitDependencies:A0,createConductanceQuantum:XR},I1={divideScalarDependencies:l0,equalScalarDependencies:T$,invDependencies:E0,matrixDependencies:F$,multiplyDependencies:w0,typedDependencies:E$,createDivide:bG},B1={addDependencies:I$,divideDependencies:I1,typedDependencies:E$,createMean:$G},k1={ComplexDependencies:w$,typedDependencies:E$,createSqrt:vL},L1={DenseMatrixDependencies:M$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,subtractScalarDependencies:S0,typedDependencies:E$,unaryMinusDependencies:M0,createSubtract:yH},U1={addDependencies:I$,numericDependencies:s0,typedDependencies:E$,createSum:eG},z1={addDependencies:I$,divideDependencies:I1,matrixDependencies:F$,meanDependencies:B1,multiplyDependencies:w0,powDependencies:C0,sqrtDependencies:k1,subtractDependencies:L1,sumDependencies:U1,typedDependencies:E$,createCorr:mq},H1={typedDependencies:E$,createCos:qI},V1={typedDependencies:E$,createCosh:jk},G1={BigNumberDependencies:_$,typedDependencies:E$,createCot:jI},q1={BigNumberDependencies:_$,typedDependencies:E$,createCoth:IL},j1={BigNumberDependencies:_$,UnitDependencies:A0,createCoulomb:qR},W1={multiplyScalarDependencies:g0,numericDependencies:s0,typedDependencies:E$,createProd:AU},X1={prodDependencies:W1,sizeDependencies:b0,typedDependencies:E$,createCount:pz},Y1={UnitDependencies:A0,typedDependencies:E$,createCreateUnit:xG},Z1={matrixDependencies:F$,multiplyDependencies:w0,subtractDependencies:L1,typedDependencies:E$,createCross:IV},K1={BigNumberDependencies:_$,typedDependencies:E$,createCsc:WI},Q1={BigNumberDependencies:_$,typedDependencies:E$,createCsch:Xk},J1={matrixDependencies:F$,typedDependencies:E$,createTranspose:wL},$1={conjDependencies:x0,transposeDependencies:J1,typedDependencies:E$,createCtranspose:kL},e2={typedDependencies:E$,createCube:YI},t2={numericDependencies:s0,typedDependencies:E$,createUnaryPlus:_V},n2={addDependencies:I$,typedDependencies:E$,unaryPlusDependencies:t2,createCumSum:oG},r2={addDependencies:I$,typedDependencies:E$,unaryPlusDependencies:t2,createCumSumTransform:EJ},i2={equalDependencies:c0,typedDependencies:E$,createDeepEqual:gz},a2={createReplacer:JF},o2={ConstantNodeDependencies:x1,FunctionNodeDependencies:w1,OperatorNodeDependencies:D1,ParenthesisNodeDependencies:E1,parseDependencies:T1,typedDependencies:E$,createResolve:_Q},s2={bignumberDependencies:i0,fractionDependencies:a0,AccessorNodeDependencies:L$,ArrayNodeDependencies:Z$,ConstantNodeDependencies:x1,FunctionNodeDependencies:w1,IndexNodeDependencies:S1,ObjectNodeDependencies:M1,OperatorNodeDependencies:D1,SymbolNodeDependencies:_1,matrixDependencies:F$,typedDependencies:E$,createSimplifyConstant:DQ},l2={AccessorNodeDependencies:L$,ArrayNodeDependencies:Z$,ConstantNodeDependencies:x1,FunctionNodeDependencies:w1,IndexNodeDependencies:S1,ObjectNodeDependencies:M1,OperatorNodeDependencies:D1,ParenthesisNodeDependencies:E1,SymbolNodeDependencies:_1,addDependencies:I$,divideDependencies:I1,equalDependencies:c0,isZeroDependencies:y0,multiplyDependencies:w0,parseDependencies:T1,powDependencies:C0,subtractDependencies:L1,typedDependencies:E$,createSimplifyCore:TQ},c2={AccessorNodeDependencies:L$,ArrayNodeDependencies:Z$,ConstantNodeDependencies:x1,FunctionNodeDependencies:w1,IndexNodeDependencies:S1,ObjectNodeDependencies:M1,OperatorNodeDependencies:D1,ParenthesisNodeDependencies:E1,SymbolNodeDependencies:_1,equalDependencies:c0,parseDependencies:T1,replacerDependencies:a2,resolveDependencies:o2,simplifyConstantDependencies:s2,simplifyCoreDependencies:l2,typedDependencies:E$,createSimplify:kQ},u2={ConstantNodeDependencies:x1,FunctionNodeDependencies:w1,OperatorNodeDependencies:D1,ParenthesisNodeDependencies:E1,SymbolNodeDependencies:_1,equalDependencies:c0,isZeroDependencies:y0,numericDependencies:s0,parseDependencies:T1,simplifyDependencies:c2,typedDependencies:E$,createDerivative:JQ},h2={BigNumberDependencies:_$,UnitDependencies:A0,createDeuteronMass:aP},d2={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,matrixDependencies:F$,typedDependencies:E$,createDiag:UL},f2={matrixDependencies:F$,numberDependencies:o0,subtractDependencies:L1,typedDependencies:E$,createDiff:NH},p2={bignumberDependencies:i0,matrixDependencies:F$,numberDependencies:o0,subtractDependencies:L1,typedDependencies:E$,createDiffTransform:AJ},m2={absDependencies:C$,addScalarDependencies:R$,deepEqualDependencies:i2,divideScalarDependencies:l0,multiplyScalarDependencies:g0,sqrtDependencies:k1,subtractScalarDependencies:S0,typedDependencies:E$,createDistance:PH},g2={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,concatDependencies:O$,divideScalarDependencies:l0,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createDotDivide:bz},v2={concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,multiplyScalarDependencies:g0,typedDependencies:E$,createDotMultiply:YL},y2={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,powDependencies:C0,typedDependencies:E$,createDotPow:lG},x2={BigNumberDependencies:_$,createE:MR},b2={BigNumberDependencies:_$,createEfimovFactor:hP},_2={typedDependencies:E$,createFlatten:hB},w2={typedDependencies:E$,createIm:bB},S2={flattenDependencies:_2,matrixDependencies:F$,sizeDependencies:b0,typedDependencies:E$,createMatrixFromColumns:Qz},M2={BigNumberDependencies:_$,FractionDependencies:D$,complexDependencies:R1,typedDependencies:E$,createSign:bk},D2={addScalarDependencies:R$,complexDependencies:R1,conjDependencies:x0,divideScalarDependencies:l0,equalDependencies:c0,identityDependencies:v0,isZeroDependencies:y0,matrixDependencies:F$,multiplyScalarDependencies:g0,signDependencies:M2,sqrtDependencies:k1,subtractScalarDependencies:S0,typedDependencies:E$,unaryMinusDependencies:M0,zerosDependencies:B$,createQr:aH},E2={typedDependencies:E$,createRe:vk},C2={isIntegerDependencies:P$,matrixDependencies:F$,typedDependencies:E$,createReshape:uL},A2={typedDependencies:E$,createSin:_k},T2={DenseMatrixDependencies:M$,divideScalarDependencies:l0,equalScalarDependencies:T$,matrixDependencies:F$,multiplyScalarDependencies:g0,subtractScalarDependencies:S0,typedDependencies:E$,createUsolve:_H},N2={DenseMatrixDependencies:M$,divideScalarDependencies:l0,equalScalarDependencies:T$,matrixDependencies:F$,multiplyScalarDependencies:g0,subtractScalarDependencies:S0,typedDependencies:E$,createUsolveAll:SV},R2={absDependencies:C$,addDependencies:I$,addScalarDependencies:R$,atanDependencies:t0,bignumberDependencies:i0,columnDependencies:d1,complexDependencies:R1,cosDependencies:H1,diagDependencies:d2,divideScalarDependencies:l0,dotDependencies:_0,equalDependencies:c0,flattenDependencies:_2,imDependencies:w2,invDependencies:E0,largerDependencies:I0,matrixDependencies:F$,matrixFromColumnsDependencies:S2,multiplyDependencies:w0,multiplyScalarDependencies:g0,numberDependencies:o0,qrDependencies:D2,reDependencies:E2,reshapeDependencies:C2,sinDependencies:A2,sizeDependencies:b0,smallerDependencies:i1,sqrtDependencies:k1,subtractDependencies:L1,typedDependencies:E$,usolveDependencies:T2,usolveAllDependencies:N2,createEigs:qG},P2={BigNumberDependencies:_$,UnitDependencies:A0,createElectricConstant:VR},F2={BigNumberDependencies:_$,UnitDependencies:A0,createElectronMass:eP},O2={BigNumberDependencies:_$,UnitDependencies:A0,createElementaryCharge:jR},I2={compareTextDependencies:v1,isZeroDependencies:y0,typedDependencies:E$,createEqualText:wz},B2={typedDependencies:E$,createErf:$I},k2={parseDependencies:T1,typedDependencies:E$,createEvaluate:RQ},L2={typedDependencies:E$,createExp:aB},U2={absDependencies:C$,addDependencies:I$,identityDependencies:v0,invDependencies:E0,multiplyDependencies:w0,typedDependencies:E$,createExpm:uG},z2={ComplexDependencies:w$,typedDependencies:E$,createExpm1:sB},H2={createFalse:yR},V2={BigNumberDependencies:_$,UnitDependencies:A0,createFaraday:mP},G2={BigNumberDependencies:_$,UnitDependencies:A0,createFermiCoupling:tP},q2={ComplexDependencies:w$,createI:PR},j2={ComplexDependencies:w$,typedDependencies:E$,createLog2:XB},W2={BigNumberDependencies:_$,createTau:SR},X2={addScalarDependencies:R$,ceilDependencies:h0,conjDependencies:x0,divideScalarDependencies:l0,dotDivideDependencies:g2,expDependencies:L2,iDependencies:q2,log2Dependencies:j2,matrixDependencies:F$,multiplyScalarDependencies:g0,powDependencies:C0,tauDependencies:W2,typedDependencies:E$,createFft:hG},Y2={largerDependencies:I0,smallerDependencies:i1,createFibonacciHeapClass:OH},Z2={typedDependencies:E$,createFilter:lB},K2={typedDependencies:E$,createFilterTransform:uJ},Q2={BigNumberDependencies:_$,createFineStructure:nP},J2={BigNumberDependencies:_$,UnitDependencies:A0,createFirstRadiation:gP},$2={typedDependencies:E$,createForEach:fB},e3={typedDependencies:E$,createForEachTransform:hJ},t3={ComplexDependencies:w$,addDependencies:I$,divideDependencies:I1,matrixDependencies:F$,multiplyDependencies:w0,typedDependencies:E$,createFreqz:yq},n3={BigNumberDependencies:_$,UnitDependencies:A0,createGasConstant:yP},r3={BigNumberDependencies:_$,DenseMatrixDependencies:M$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,roundDependencies:u0,typedDependencies:E$,zerosDependencies:B$,createGcd:Fz},i3={BigNumberDependencies:_$,UnitDependencies:A0,createGravitationConstant:LR},a3={BigNumberDependencies:_$,UnitDependencies:A0,createGravity:CP},o3={BigNumberDependencies:_$,UnitDependencies:A0,createHartreeEnergy:rP},s3={isNumericDependencies:m0,typedDependencies:E$,createHasNumericValue:Iz},l3={evaluateDependencies:k2,createHelpClass:PQ},c3={HelpDependencies:l3,typedDependencies:E$,createHelp:rJ},u3={formatDependencies:p0,typedDependencies:E$,createHex:xB},h3={absDependencies:C$,addScalarDependencies:R$,divideScalarDependencies:l0,isPositiveDependencies:l1,multiplyScalarDependencies:g0,smallerDependencies:i1,sqrtDependencies:k1,typedDependencies:E$,createHypot:kz},d3={conjDependencies:x0,dotDivideDependencies:g2,fftDependencies:X2,typedDependencies:E$,createIfft:mG},f3={IndexDependencies:s1,typedDependencies:E$,createIndex:BH},p3={IndexDependencies:s1,getMatrixDataTypeDependencies:o1,createIndexTransform:gJ},m3={BigNumberDependencies:_$,createInfinity:bR},g3={absDependencies:C$,addDependencies:I$,addScalarDependencies:R$,divideScalarDependencies:l0,equalScalarDependencies:T$,flattenDependencies:_2,isNumericDependencies:m0,isZeroDependencies:y0,matrixDependencies:F$,multiplyDependencies:w0,multiplyScalarDependencies:g0,smallerDependencies:i1,subtractDependencies:L1,typedDependencies:E$,createIntersect:SG},v3={BigNumberDependencies:_$,UnitDependencies:A0,createInverseConductanceQuantum:YR},y3={DenseMatrixDependencies:M$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,roundDependencies:u0,typedDependencies:E$,zerosDependencies:B$,createMod:Az},x3={BigNumberDependencies:_$,matrixDependencies:F$,typedDependencies:E$,createXgcd:ML},b3={BigNumberDependencies:_$,addDependencies:I$,equalDependencies:c0,isIntegerDependencies:P$,modDependencies:y3,smallerDependencies:i1,typedDependencies:E$,xgcdDependencies:x3,createInvmod:LH},_3={typedDependencies:E$,createIsNaN:Zk},w3={typedDependencies:E$,createIsPrime:Qk},S3={typedDependencies:E$,createTypeOf:Fk},M3={ComplexDependencies:w$,divideScalarDependencies:l0,typeOfDependencies:S3,typedDependencies:E$,createLog:Wz},D3={typedDependencies:E$,createMap:ZB},E3={divideDependencies:I1,dotDivideDependencies:g2,isNumericDependencies:m0,logDependencies:M3,mapDependencies:D3,matrixDependencies:F$,multiplyDependencies:w0,sumDependencies:U1,typedDependencies:E$,createKldivergence:WG},C3={BigNumberDependencies:_$,UnitDependencies:A0,createKlitzing:QR},A3={matrixDependencies:F$,multiplyScalarDependencies:g0,typedDependencies:E$,createKron:sU},T3={BigNumberDependencies:_$,createLN10:CR},N3={BigNumberDependencies:_$,createLN2:ER},R3={BigNumberDependencies:_$,createLOG10E:TR},P3={BigNumberDependencies:_$,createLOG2E:AR},F3={concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createLcm:UH},O3={parseDependencies:T1,typedDependencies:E$,createLeafCount:GQ},I3={DenseMatrixDependencies:M$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,zerosDependencies:B$,createLeftShift:gU},B3={ComplexDependencies:w$,typedDependencies:E$,createLgamma:zB},k3={ComplexDependencies:w$,typedDependencies:E$,createLog10:jB},L3={ComplexDependencies:w$,divideScalarDependencies:l0,logDependencies:M3,typedDependencies:E$,createLog1p:HH},U3={BigNumberDependencies:_$,UnitDependencies:A0,createLoschmidt:vP},z3={DenseMatrixDependencies:M$,divideScalarDependencies:l0,equalScalarDependencies:T$,matrixDependencies:F$,multiplyScalarDependencies:g0,subtractScalarDependencies:S0,typedDependencies:E$,createLsolve:Zz},H3={DenseMatrixDependencies:M$,divideScalarDependencies:l0,equalScalarDependencies:T$,matrixDependencies:F$,multiplyScalarDependencies:g0,subtractScalarDependencies:S0,typedDependencies:E$,createLsolveAll:GH},V3={FibonacciHeapDependencies:Y2,addScalarDependencies:R$,equalScalarDependencies:T$,createSpaClass:QV},G3={DenseMatrixDependencies:M$,SpaDependencies:V3,SparseMatrixDependencies:N$,absDependencies:C$,addScalarDependencies:R$,divideScalarDependencies:l0,equalScalarDependencies:T$,largerDependencies:I0,matrixDependencies:F$,multiplyScalarDependencies:g0,subtractScalarDependencies:S0,typedDependencies:E$,unaryMinusDependencies:M0,createLup:MG},q3={SparseMatrixDependencies:N$,absDependencies:C$,addDependencies:I$,divideScalarDependencies:l0,largerDependencies:I0,largerEqDependencies:c1,multiplyDependencies:w0,subtractDependencies:L1,transposeDependencies:J1,typedDependencies:E$,createSlu:vV},j3={DenseMatrixDependencies:M$,lsolveDependencies:z3,lupDependencies:G3,matrixDependencies:F$,sluDependencies:q3,typedDependencies:E$,usolveDependencies:T2,createLusolve:KG},W3={absDependencies:C$,addDependencies:I$,conjDependencies:x0,ctransposeDependencies:$1,eigsDependencies:R2,equalScalarDependencies:T$,largerDependencies:I0,matrixDependencies:F$,multiplyDependencies:w0,powDependencies:C0,smallerDependencies:i1,sqrtDependencies:k1,typedDependencies:E$,createNorm:Aq},X3={identityDependencies:v0,matrixDependencies:F$,multiplyDependencies:w0,normDependencies:W3,qrDependencies:D2,subtractDependencies:L1,typedDependencies:E$,createSchur:Oq},Y3={absDependencies:C$,addDependencies:I$,concatDependencies:O$,identityDependencies:v0,indexDependencies:f3,lusolveDependencies:j3,matrixDependencies:F$,matrixFromColumnsDependencies:S2,multiplyDependencies:w0,rangeDependencies:h1,schurDependencies:X3,subsetDependencies:k$,subtractDependencies:L1,transposeDependencies:J1,typedDependencies:E$,createSylvester:zq},Z3={matrixDependencies:F$,multiplyDependencies:w0,sylvesterDependencies:Y3,transposeDependencies:J1,typedDependencies:E$,createLyap:Gq},K3={compareDependencies:m1,isNaNDependencies:_3,isNumericDependencies:m0,typedDependencies:E$,createPartitionSelect:iH},Q3={addDependencies:I$,compareDependencies:m1,divideDependencies:I1,partitionSelectDependencies:K3,typedDependencies:E$,createMedian:dq},J3={absDependencies:C$,mapDependencies:D3,medianDependencies:Q3,subtractDependencies:L1,typedDependencies:E$,createMad:bq},$3={BigNumberDependencies:_$,UnitDependencies:A0,createMagneticConstant:HR},e4={BigNumberDependencies:_$,UnitDependencies:A0,createMagneticFluxQuantum:ZR},t4={isIntegerDependencies:P$,typedDependencies:E$,createMapSlices:$k},n4={isIntegerDependencies:P$,typedDependencies:E$,createMapSlicesTransform:aJ},r4={typedDependencies:E$,createMapTransform:dJ},i4={isZeroDependencies:y0,matrixDependencies:F$,typedDependencies:E$,createMatrixFromFunction:iL},a4={flattenDependencies:_2,matrixDependencies:F$,sizeDependencies:b0,typedDependencies:E$,createMatrixFromRows:jH},o4={isNaNDependencies:_3,largerDependencies:I0,numericDependencies:s0,typedDependencies:E$,createMax:Jz},s4={isNaNDependencies:_3,largerDependencies:I0,numericDependencies:s0,typedDependencies:E$,createMaxTransform:TJ},l4={addDependencies:I$,divideDependencies:I1,typedDependencies:E$,createMeanTransform:FJ},c4={isNaNDependencies:_3,numericDependencies:s0,smallerDependencies:i1,typedDependencies:E$,createMin:$z},u4={isNaNDependencies:_3,numericDependencies:s0,smallerDependencies:i1,typedDependencies:E$,createMinTransform:wJ},h4={isNaNDependencies:_3,isNumericDependencies:m0,typedDependencies:E$,createMode:yU},d4={BigNumberDependencies:_$,UnitDependencies:A0,createMolarMass:DP},f4={BigNumberDependencies:_$,UnitDependencies:A0,createMolarMassC12:EP},p4={BigNumberDependencies:_$,UnitDependencies:A0,createMolarPlanckConstant:xP},m4={BigNumberDependencies:_$,UnitDependencies:A0,createMolarVolume:bP},g4={addDependencies:I$,divideDependencies:I1,factorialDependencies:O0,isIntegerDependencies:P$,isPositiveDependencies:l1,multiplyDependencies:w0,typedDependencies:E$,createMultinomial:EG},v4={BigNumberDependencies:_$,createNaN:_R},y4={BigNumberDependencies:_$,UnitDependencies:A0,createNeutronMass:oP},x4={BigNumberDependencies:_$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createNthRoot:_U},b4={ComplexDependencies:w$,divideScalarDependencies:l0,typedDependencies:E$,createNthRoots:tH},_4={BigNumberDependencies:_$,UnitDependencies:A0,createNuclearMagneton:KR},w4={createNull:xR},S4={formatDependencies:p0,typedDependencies:E$,createOct:ik},M4={BigNumberDependencies:_$,matrixDependencies:F$,typedDependencies:E$,createOnes:aL},D4={DenseMatrixDependencies:M$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createOr:nH},E4={DenseMatrixDependencies:M$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createOrTransform:fJ},C4={evaluateDependencies:k2,parseDependencies:T1,createParserClass:FQ},A4={ParserDependencies:C4,typedDependencies:E$,createParser:WQ},T4={factorialDependencies:O0,typedDependencies:E$,createPermutations:AG},N4={BigNumberDependencies:_$,createPhi:DR},R4={BigNumberDependencies:_$,createPi:wR},P4={typedDependencies:E$,createPickRandom:ck},F4={ComplexDependencies:w$,addDependencies:I$,ctransposeDependencies:$1,deepEqualDependencies:i2,divideScalarDependencies:l0,dotDependencies:_0,dotDivideDependencies:g2,equalDependencies:c0,invDependencies:E0,matrixDependencies:F$,multiplyDependencies:w0,typedDependencies:E$,createPinv:GV},O4={BigNumberDependencies:_$,UnitDependencies:A0,createPlanckCharge:RP},I4={BigNumberDependencies:_$,UnitDependencies:A0,createPlanckConstant:UR},B4={BigNumberDependencies:_$,UnitDependencies:A0,createPlanckLength:AP},k4={BigNumberDependencies:_$,UnitDependencies:A0,createPlanckMass:TP},L4={BigNumberDependencies:_$,UnitDependencies:A0,createPlanckTemperature:PP},U4={BigNumberDependencies:_$,UnitDependencies:A0,createPlanckTime:NP},z4={addDependencies:I$,cbrtDependencies:$0,divideDependencies:I1,equalScalarDependencies:T$,imDependencies:w2,isZeroDependencies:y0,multiplyDependencies:w0,reDependencies:E2,sqrtDependencies:k1,subtractDependencies:L1,typeOfDependencies:S3,typedDependencies:E$,unaryMinusDependencies:M0,createPolynomialRoot:RG},H4={typedDependencies:E$,createPrint:dk},V4={addDependencies:I$,matrixDependencies:F$,typedDependencies:E$,zerosDependencies:B$,createPrintTransform:yJ},G4={BigNumberDependencies:_$,UnitDependencies:A0,createProtonMass:iP},q4={bignumberDependencies:i0,addDependencies:I$,compareDependencies:m1,divideDependencies:I1,isIntegerDependencies:P$,largerDependencies:I0,mapSlicesDependencies:t4,multiplyDependencies:w0,partitionSelectDependencies:K3,smallerDependencies:i1,smallerEqDependencies:u1,subtractDependencies:L1,typedDependencies:E$,createQuantileSeq:nq},j4={addDependencies:I$,bignumberDependencies:i0,compareDependencies:m1,divideDependencies:I1,isIntegerDependencies:P$,largerDependencies:I0,mapSlicesDependencies:t4,multiplyDependencies:w0,partitionSelectDependencies:K3,smallerDependencies:i1,smallerEqDependencies:u1,subtractDependencies:L1,typedDependencies:E$,createQuantileSeqTransform:OJ},W4={BigNumberDependencies:_$,UnitDependencies:A0,createQuantumOfCirculation:sP},X4={typedDependencies:E$,createRandom:gk},Y4={log2Dependencies:j2,typedDependencies:E$,createRandomInt:lL},Z4={createRangeClass:eF},K4={bignumberDependencies:i0,matrixDependencies:F$,addDependencies:I$,isPositiveDependencies:l1,largerDependencies:I0,largerEqDependencies:c1,smallerDependencies:i1,smallerEqDependencies:u1,typedDependencies:E$,createRangeTransform:NJ},Q4={bignumberDependencies:i0,fractionDependencies:a0,AccessorNodeDependencies:L$,ArrayNodeDependencies:Z$,ConstantNodeDependencies:x1,FunctionNodeDependencies:w1,IndexNodeDependencies:S1,ObjectNodeDependencies:M1,OperatorNodeDependencies:D1,ParenthesisNodeDependencies:E1,SymbolNodeDependencies:_1,addDependencies:I$,divideDependencies:I1,equalDependencies:c0,isZeroDependencies:y0,matrixDependencies:F$,multiplyDependencies:w0,parseDependencies:T1,powDependencies:C0,simplifyDependencies:c2,simplifyConstantDependencies:s2,simplifyCoreDependencies:l2,subtractDependencies:L1,typedDependencies:E$,createRationalize:ZQ},J4={BigNumberDependencies:_$,UnitDependencies:A0,createReducedPlanckConstant:zR},$4={matrixDependencies:F$,createResize:NU},e5={createReviver:nQ},t5={DenseMatrixDependencies:M$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,zerosDependencies:B$,createRightArithShift:PU},n5={DenseMatrixDependencies:M$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,zerosDependencies:B$,createRightLogShift:sH},r5={BigNumberDependencies:_$,DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,addScalarDependencies:R$,cosDependencies:H1,matrixDependencies:F$,multiplyScalarDependencies:g0,normDependencies:W3,sinDependencies:A2,typedDependencies:E$,unaryMinusDependencies:M0,createRotationMatrix:Rq},i5={multiplyDependencies:w0,rotationMatrixDependencies:r5,typedDependencies:E$,createRotate:kq},a5={IndexDependencies:s1,matrixDependencies:F$,rangeDependencies:h1,typedDependencies:E$,createRow:KH},o5={IndexDependencies:s1,matrixDependencies:F$,rangeDependencies:h1,typedDependencies:E$,createRowTransform:RJ},s5={BigNumberDependencies:_$,UnitDependencies:A0,createRydberg:lP},l5={BigNumberDependencies:_$,createSQRT1_2:NR},c5={BigNumberDependencies:_$,createSQRT2:RR},u5={BigNumberDependencies:_$,createSackurTetrode:_P},h5={BigNumberDependencies:_$,typedDependencies:E$,createSec:yk},d5={BigNumberDependencies:_$,typedDependencies:E$,createSech:dL},f5={BigNumberDependencies:_$,UnitDependencies:A0,createSecondRadiation:wP},p5={DenseMatrixDependencies:M$,IndexDependencies:s1,compareNaturalDependencies:g1,sizeDependencies:b0,subsetDependencies:k$,typedDependencies:E$,createSetCartesian:JH},m5={DenseMatrixDependencies:M$,IndexDependencies:s1,compareNaturalDependencies:g1,sizeDependencies:b0,subsetDependencies:k$,typedDependencies:E$,createSetDifference:WV},g5={DenseMatrixDependencies:M$,IndexDependencies:s1,compareNaturalDependencies:g1,sizeDependencies:b0,subsetDependencies:k$,typedDependencies:E$,createSetDistinct:eV},v5={DenseMatrixDependencies:M$,IndexDependencies:s1,compareNaturalDependencies:g1,sizeDependencies:b0,subsetDependencies:k$,typedDependencies:E$,createSetIntersect:FG},y5={IndexDependencies:s1,compareNaturalDependencies:g1,sizeDependencies:b0,subsetDependencies:k$,typedDependencies:E$,createSetIsSubset:nV},x5={IndexDependencies:s1,compareNaturalDependencies:g1,sizeDependencies:b0,subsetDependencies:k$,typedDependencies:E$,createSetMultiplicity:YV},b5={IndexDependencies:s1,compareNaturalDependencies:g1,sizeDependencies:b0,subsetDependencies:k$,typedDependencies:E$,createSetPowerset:iV},_5={compareNaturalDependencies:g1,typedDependencies:E$,createSetSize:vG},w5={IndexDependencies:s1,concatDependencies:O$,setDifferenceDependencies:m5,sizeDependencies:b0,subsetDependencies:k$,typedDependencies:E$,createSetSymDifference:KV},S5={IndexDependencies:s1,concatDependencies:O$,setIntersectDependencies:v5,setSymDifferenceDependencies:w5,sizeDependencies:b0,subsetDependencies:k$,typedDependencies:E$,createSetUnion:aq},M5={typedDependencies:E$,createSinh:pL},D5={absDependencies:C$,addDependencies:I$,bignumberDependencies:i0,divideDependencies:I1,isNegativeDependencies:R0,isPositiveDependencies:l1,largerDependencies:I0,mapDependencies:D3,matrixDependencies:F$,maxDependencies:o4,multiplyDependencies:w0,smallerDependencies:i1,subtractDependencies:L1,typedDependencies:E$,unaryMinusDependencies:M0,createSolveODE:IG},E5={compareDependencies:m1,compareNaturalDependencies:g1,matrixDependencies:F$,typedDependencies:E$,createSort:xV},C5={SparseMatrixDependencies:N$,typedDependencies:E$,createSparse:gL},A5={BigNumberDependencies:_$,UnitDependencies:A0,createSpeedOfLight:kR},T5={typedDependencies:E$,createSplitUnit:Mk},N5={absDependencies:C$,addDependencies:I$,identityDependencies:v0,invDependencies:E0,mapDependencies:D3,maxDependencies:o4,multiplyDependencies:w0,sizeDependencies:b0,sqrtDependencies:k1,subtractDependencies:L1,typedDependencies:E$,createSqrtm:$V},R5={typedDependencies:E$,createSquare:Ek},P5={typedDependencies:E$,createSqueeze:xL},F5={addDependencies:I$,divideDependencies:I1,isNaNDependencies:_3,mapSlicesDependencies:t4,multiplyDependencies:w0,subtractDependencies:L1,typedDependencies:E$,createVariance:cq},O5={mapDependencies:D3,sqrtDependencies:k1,typedDependencies:E$,varianceDependencies:F5,createStd:wq},I5={mapDependencies:D3,sqrtDependencies:k1,typedDependencies:E$,varianceDependencies:F5,createStdTransform:kJ},B5={BigNumberDependencies:_$,UnitDependencies:A0,createStefanBoltzmann:SP},k5={typedDependencies:E$,createString:Ak},L5={addDependencies:I$,matrixDependencies:F$,typedDependencies:E$,zerosDependencies:B$,createSubsetTransform:SJ},U5={addDependencies:I$,numericDependencies:s0,typedDependencies:E$,createSumTransform:bJ},z5={OperatorNodeDependencies:D1,parseDependencies:T1,simplifyDependencies:c2,typedDependencies:E$,createSymbolicEqual:zQ},H5={typedDependencies:E$,createTan:Rk},V5={typedDependencies:E$,createTanh:bL},G5={BigNumberDependencies:_$,UnitDependencies:A0,createThomsonCrossSection:cP},q5={concatDependencies:O$,matrixDependencies:F$,typedDependencies:E$,createTo:HU},j5={addDependencies:I$,matrixDependencies:F$,typedDependencies:E$,createTrace:xH},W5={createTrue:vR},X5={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,concatDependencies:O$,equalScalarDependencies:T$,matrixDependencies:F$,typedDependencies:E$,createUnequal:jU},Y5={UnitDependencies:A0,typedDependencies:E$,createUnitFunction:UG},Z5={eDependencies:x2,createUppercaseE:OR},K5={piDependencies:R4,createUppercasePi:FR},Q5={BigNumberDependencies:_$,UnitDependencies:A0,createVacuumImpedance:GR},J5={addDependencies:I$,divideDependencies:I1,isNaNDependencies:_3,mapSlicesDependencies:t4,multiplyDependencies:w0,subtractDependencies:L1,typedDependencies:E$,createVarianceTransform:BJ},$5={createVersion:IR},e6={BigNumberDependencies:_$,createWeakMixingAngle:uP},t6={BigNumberDependencies:_$,UnitDependencies:A0,createWienDisplacement:MP},n6={DenseMatrixDependencies:M$,SparseMatrixDependencies:N$,concatDependencies:O$,matrixDependencies:F$,typedDependencies:E$,createXor:XU},r6={BigNumberDependencies:_$,ComplexDependencies:w$,addDependencies:I$,divideDependencies:I1,equalDependencies:c0,factorialDependencies:O0,gammaDependencies:F0,isNegativeDependencies:R0,multiplyDependencies:w0,piDependencies:R4,powDependencies:C0,sinDependencies:A2,smallerEqDependencies:u1,subtractDependencies:L1,typedDependencies:E$,createZeta:Dq},i6={ComplexDependencies:w$,addDependencies:I$,multiplyDependencies:w0,numberDependencies:o0,typedDependencies:E$,createZpk2tf:DV},a6=t,o6=n(9841);function s6(e,t,n,r){function i(t,i,o){var s,l;if(o.wrap&&"function"===typeof i&&(i=function(e){var t=function(){for(var t=[],r=0,i=arguments.length;r<i;r++){var a=arguments[r];t[r]=a&&a.valueOf()}return e.apply(n,t)};e.transform&&(t.transform=e.transform);return t}(i)),"function"===typeof(l=i)&&"string"===typeof l.signature&&(i=e(t,{[i.signature]:i})),e.isTypedFunction(n[t])&&e.isTypedFunction(i))return i=o.override?e(t,i.signatures):e(n[t],i),n[t]=i,delete r[t],a(t,i),void n.emit("import",t,(function(){return i}));var c=void 0!==n[t],u=null===(s=n.Unit)||void 0===s?void 0:s.isValuelessUnit(t);if(!c&&!u||o.override)return n[t]=i,delete r[t],a(t,i),void n.emit("import",t,(function(){return i}));if(!o.silent)throw new Error('Cannot import "'+t+'": already exists')}function a(e,t){t&&"function"===typeof t.transform?(n.expression.transform[e]=t.transform,c(e)&&(n.expression.mathWithTransform[e]=t.transform)):(delete n.expression.transform[e],c(e)&&(n.expression.mathWithTransform[e]=t))}function o(e){delete n.expression.transform[e],c(e)?n.expression.mathWithTransform[e]=n[e]:delete n.expression.mathWithTransform[e]}function s(t,i){var a,s,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.fn;if(l.includes("."))throw new Error("Factory name should not contain a nested path. Name: "+JSON.stringify(l));var c=u(t)?n.expression.transform:n,d=l in n.expression.transform,f=OA(c,l)?c[l]:void 0,p=function(){var r={};t.dependencies.map(DN).forEach((e=>{if(e.includes("."))throw new Error("Factory dependency should not contain a nested path. Name: "+JSON.stringify(e));"math"===e?r.math=n:"mathWithTransform"===e?r.mathWithTransform=n.expression.mathWithTransform:"classes"===e?r.classes=n:r[e]=n[e]}));var a=t(r);if(a&&"function"===typeof a.transform)throw new Error('Transforms cannot be attached to factory functions. Please create a separate function for it with export const path = "expression.transform"');if(void 0===f||i.override)return a;if(e.isTypedFunction(f)&&e.isTypedFunction(a))return e(f,a);if(i.silent)return f;throw new Error('Cannot import "'+l+'": already exists')},m=null!==(a=null===(s=t.meta)||void 0===s?void 0:s.formerly)&&void 0!==a?a:"",g=u(t)||function(e){return!e.fn.includes(".")&&!OA(h,e.fn)&&(!e.meta||!e.meta.isClass)}(t),v=n.expression.mathWithTransform;t.meta&&!1===t.meta.lazy?(c[l]=p(),m&&(c[m]=c[l]),f&&d?(o(l),m&&o(m)):g&&(FA(v,l,(()=>c[l])),m&&FA(v,m,(()=>c[l])))):(FA(c,l,p),m&&FA(c,m,p),f&&d?(o(l),m&&o(m)):g&&(FA(v,l,(()=>c[l])),m&&FA(v,m,(()=>c[l])))),r[l]=t,n.emit("import",l,p)}function l(e){return"function"===typeof e||"number"===typeof e||"string"===typeof e||"boolean"===typeof e||null===e||HC(e)||UC(e)||kC(e)||zC(e)||qC(e)||Array.isArray(e)}function c(e){return!OA(h,e)}function u(e){return void 0!==e&&void 0!==e.meta&&!0===e.meta.isTransformFunction||!1}var h={expression:!0,type:!0,docs:!0,error:!0,json:!0,chain:!0};return function(e,t){var n=arguments.length;if(1!==n&&2!==n)throw new TU("import",n,1,2);t||(t={});var r={};for(var a in function e(n,r,i){if(Array.isArray(r))r.forEach((t=>e(n,t)));else if(nA(r)||function(e){return"object"===typeof e&&"Module"===e[Symbol.toStringTag]}(r))for(var a in r)OA(r,a)&&e(n,r[a],a);else if(MN(r)||void 0!==i){var o=MN(r)?u(r)?r.fn+".transform":r.fn:i;if(OA(n,o)&&n[o]!==r&&!t.silent)throw new Error('Cannot import "'+o+'" twice');n[o]=r}else if(!t.silent)throw new TypeError("Factory, Object, or Array expected")}(r,e),r)if(OA(r,a)){var o=r[a];if(MN(o))s(o,t);else if(l(o))i(a,o,t);else if(!t.silent)throw new TypeError("Factory, Object, or Array expected")}}}function l6(e,t){var n=SC({},MC,t);if("function"!==typeof Object.create)throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var r=function(e){var t=new o6;return e.on=t.on.bind(t),e.off=t.off.bind(t),e.once=t.once.bind(t),e.emit=t.emit.bind(t),e}({isNumber:BC,isComplex:UC,isBigNumber:kC,isBigInt:LC,isFraction:zC,isUnit:HC,isString:VC,isArray:GC,isMatrix:qC,isCollection:jC,isDenseMatrix:WC,isSparseMatrix:XC,isRange:YC,isIndex:ZC,isBoolean:KC,isResultSet:QC,isHelp:JC,isFunction:$C,isDate:eA,isRegExp:tA,isObject:nA,isMap:rA,isPartitionedMap:iA,isObjectWrappingMap:aA,isNull:oA,isUndefined:sA,isAccessorNode:lA,isArrayNode:cA,isAssignmentNode:uA,isBlockNode:hA,isConditionalNode:dA,isConstantNode:fA,isFunctionAssignmentNode:mA,isFunctionNode:gA,isIndexNode:vA,isNode:yA,isObjectNode:xA,isOperatorNode:bA,isParenthesisNode:_A,isRangeNode:wA,isRelationalNode:SA,isSymbolNode:MA,isChain:DA});r.config=kA(n,r.emit),r.expression={transform:{},mathWithTransform:{config:r.config}};var i={};function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.typed.apply(r.typed,t)}a.isTypedFunction=XF.isTypedFunction;var o=s6(a,0,r,i);return r.import=o,r.on("config",(()=>{Object.values(i).forEach((e=>{e&&e.meta&&e.meta.recreateOnConfigChange&&o(e,{override:!0})}))})),r.create=l6.bind(null,e),r.factory=SN,r.import(Object.values(RA(e))),r.ArgumentsError=TU,r.DimensionError=fF,r.IndexError=pF,r}var c6=n(2157),u6=n.n(c6);const h6=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return console.log("Using simple QuickHull implementation"),!e||e.length<4?(console.warn("Not enough points for 3D convex hull"),[]):t.skipTriangulation?[[0,1,2,3],[0,3,5,4],[1,0,4,5],[2,1,5,3],[3,2,0,1]]:[[0,1,2],[0,2,3],[0,3,1],[1,3,2]]};console.log("Setting up visualization libraries..."),"undefined"!==typeof window?(window.THREE=i,te.install({THREE:i}),window.CameraControls=te,window.QuickHull=h6,window.Konva=u6(),window.mathjs=r,window.d3=e,console.log("Libraries initialized successfully")):console.warn("Window object not available, libraries not initialized globally"),u6();var d6=n(5043),f6=n(4391),p6=n(9379),m6=n(579);const g6=(0,d6.createContext)({darkMode:!1,toggleTheme:()=>{}}),v6=e=>{let{children:t}=e;const[n,r]=(0,d6.useState)(!1);(0,d6.useEffect)((()=>{n?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}),[n]);return(0,m6.jsx)(g6.Provider,{value:{darkMode:n,toggleTheme:()=>{r(!n)}},children:t})},y6=()=>(0,d6.useContext)(g6),x6=e=>{let{isLoading:t,error:n}=e;return t||n?(0,m6.jsxs)("div",{className:"fixed inset-0 bg-gray-100 flex flex-col items-center justify-center z-50",children:[(0,m6.jsx)("h1",{className:"text-2xl mb-5 ".concat(n?"text-red-600":"text-blue-600"),children:n?"Error":"Math Visualization Framework"}),!n&&(0,m6.jsx)("div",{className:"w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),(0,m6.jsx)("p",{className:"mt-5 ".concat(n?"text-red-600":"text-gray-600"),children:n?"Failed to start: ".concat(n):"Initializing..."})]}):null},b6=e=>{let{activePlugin:t}=e;const{darkMode:n}=y6();return(0,m6.jsxs)("div",{className:"h-full w-full flex items-center justify-center text-gray-400 dark:text-gray-500",children:["Visualization Canvas (",t.name,")"]})},_6=e=>{let{title:t,children:n,className:r="",panelType:i=""}=e;const{darkMode:a}=y6(),[o,s]=(0,d6.useState)(!1),l=r.includes("right")||"structural"===i||"class"===i,c=l?o?"translateX(calc(100% - 30px))":"translateX(0)":o?"translateX(calc(-100% + 30px))":"translateX(0)";return(0,m6.jsx)("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow-lg z-10 ".concat(r),style:{transition:"transform 0.3s ease-in-out",transform:c,overflow:"hidden"},children:(0,m6.jsxs)("div",{className:"p-3 relative",children:[(0,m6.jsxs)("div",{className:"absolute top-3 cursor-pointer w-7 h-7 flex items-center justify-center bg-blue-500 text-white rounded-md text-sm font-bold",style:{[l?"left":"right"]:"12px",zIndex:2},onClick:()=>s(!o),children:["visual"===i&&(0,m6.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:[(0,m6.jsx)("path",{d:"M12 15a3 3 0 100-6 3 3 0 000 6z"}),(0,m6.jsx)("path",{fillRule:"evenodd",d:"M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 010-1.113zM17.25 12a5.25 5.25 0 11-10.5 0 5.25 5.25 0 0110.5 0z",clipRule:"evenodd"})]}),"structural"===i&&(0,m6.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:(0,m6.jsx)("path",{fillRule:"evenodd",d:"M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 00-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 00-2.282.819l-.922 1.597a1.875 1.875 0 00.432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 000 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 00-.432 2.385l.922 1.597a1.875 1.875 0 002.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.57.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 002.28-.819l.923-1.597a1.875 1.875 0 00-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 000-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 00-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 00-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 00-1.85-1.567h-1.843zM12 15.75a3.75 3.75 0 100-7.5 3.75 3.75 0 000 7.5z",clipRule:"evenodd"})}),"actions"===i&&(0,m6.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:(0,m6.jsx)("path",{fillRule:"evenodd",d:"M14.615 1.595a.75.75 0 01.359.852L12.982 9.75h7.268a.75.75 0 01.548 1.262l-10.5 11.25a.75.75 0 01-1.272-.71l1.992-7.302H3.75a.75.75 0 01-.548-1.262l10.5-11.25a.75.75 0 01.913-.143z",clipRule:"evenodd"})}),"class"===i&&(0,m6.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:(0,m6.jsx)("path",{fillRule:"evenodd",d:"M11.47 4.72a.75.75 0 011.06 0l3.75 3.75a.75.75 0 01-1.06 1.06L12 6.31 8.78 9.53a.75.75 0 01-1.06-1.06l3.75-3.75zm-3.75 9.75a.75.75 0 011.06 0L12 17.69l3.22-3.22a.75.75 0 111.06 1.06l-3.75 3.75a.75.75 0 01-1.06 0l-3.75-3.75a.75.75 0 010-1.06z",clipRule:"evenodd"})})]}),(0,m6.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white pb-1 mb-1 border-b border-gray-200 dark:border-gray-600 cursor-pointer text-center",onClick:()=>s(!o),children:t}),(0,m6.jsx)("div",{className:o?"hidden":"mt-2",children:n})]})})},w6=e=>{let{showPluginSelector:t,setShowPluginSelector:n,plugins:r,activePlugin:i,handlePluginSelect:a,isMobile:o=!1}=e;const{darkMode:s}=y6(),l=(0,d6.useRef)(null);if((0,d6.useEffect)((()=>{if(t)return document.addEventListener("mousedown",e,!0),document.addEventListener("touchstart",e,!0),()=>{document.removeEventListener("mousedown",e,!0),document.removeEventListener("touchstart",e,!0)};function e(e){if(l.current&&!l.current.contains(e.target)){let t=e.target,r=!1;for(;t&&t!==document;){if(t.getAttribute&&"true"===t.getAttribute("data-plugin-button")){r=!0;break}t=t.parentNode}r||n(!1)}}}),[t,n]),!t)return null;return(0,m6.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",onClick:e=>{e.target===e.currentTarget&&n(!1)},children:(0,m6.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg ".concat(o?"w-[95%] max-h-[90vh]":"max-w-4xl w-[90%] max-h-[80vh]"," shadow-xl transform transition-all"),ref:l,onClick:e=>{e.stopPropagation()},children:[(0,m6.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[(0,m6.jsx)("h2",{className:"".concat(o?"text-lg":"text-xl"," font-bold text-gray-800 dark:text-white"),children:"Select Visualization"}),(0,m6.jsx)("button",{className:"text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 dark:text-gray-300 rounded-full p-2",onClick:()=>n(!1),children:"\u2715"})]}),(0,m6.jsx)("div",{className:"".concat(o?"p-4 grid grid-cols-1 gap-4":"p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"," overflow-y-auto ").concat(o?"max-h-[calc(90vh-80px)]":"max-h-[calc(80vh-80px)]"),children:r.map((e=>(0,m6.jsx)("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg shadow-md overflow-hidden cursor-pointer transition-transform ".concat(o?"flex":"hover:-translate-y-1 hover:shadow-lg"," ").concat(e.id===i.id?"ring-2 ring-blue-500":""),onClick:()=>a(e.id),children:o?(0,m6.jsxs)(m6.Fragment,{children:[(0,m6.jsxs)("div",{className:"flex-1 p-3 flex flex-col justify-center",children:[(0,m6.jsx)("h3",{className:"font-semibold text-gray-800 dark:text-white mb-1 text-sm",children:e.name}),(0,m6.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-xs leading-tight",children:e.description})]}),(0,m6.jsx)("div",{className:"w-24 h-24 bg-blue-50 dark:bg-gray-600 flex items-center justify-center",children:(0,m6.jsx)("div",{className:"opacity-80 text-blue-500 dark:text-blue-400 w-10 h-10",children:"3d"===e.renderingType?(0,m6.jsx)("svg",{viewBox:"0 0 24 24",className:"w-full h-full",children:(0,m6.jsx)("path",{fill:"currentColor",d:"M12 1L1 5v14l11 4 11-4V5L12 1zM5 7.2l6-2.2 6 2.2v7.1l-6 2.2-6-2.2V7.2z"})}):(0,m6.jsx)("svg",{viewBox:"0 0 24 24",className:"w-full h-full",children:(0,m6.jsx)("path",{fill:"currentColor",d:"M4 4h16v16H4V4z M12 17.5L4.5 10l3-3L12 11.5l4.5-4.5 3 3L12 17.5z"})})})})]}):(0,m6.jsxs)(m6.Fragment,{children:[(0,m6.jsx)("div",{className:"h-36 bg-blue-50 dark:bg-gray-600 flex items-center justify-center",children:(0,m6.jsx)("div",{className:"w-12 h-12 opacity-80 text-blue-500 dark:text-blue-400",children:"3d"===e.renderingType?(0,m6.jsx)("svg",{viewBox:"0 0 24 24",className:"w-full h-full",children:(0,m6.jsx)("path",{fill:"currentColor",d:"M12 1L1 5v14l11 4 11-4V5L12 1zM5 7.2l6-2.2 6 2.2v7.1l-6 2.2-6-2.2V7.2z"})}):(0,m6.jsx)("svg",{viewBox:"0 0 24 24",className:"w-full h-full",children:(0,m6.jsx)("path",{fill:"currentColor",d:"M4 4h16v16H4V4z M12 17.5L4.5 10l3-3L12 11.5l4.5-4.5 3 3L12 17.5z"})})})}),(0,m6.jsxs)("div",{className:"p-3",children:[(0,m6.jsx)("h3",{className:"font-semibold text-gray-800 dark:text-white mb-1 text-sm",children:e.name}),(0,m6.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-xs leading-tight",children:e.description})]})]})},e.id)))})]})})},S6=e=>{let{id:t,label:n,value:r,min:i,max:a,step:o,onChange:s,isMobile:l=!1}=e;return(0,m6.jsxs)("div",{className:"control ".concat(l?"flex items-center":""),children:[(0,m6.jsx)("label",{htmlFor:t,className:"block text-gray-700 dark:text-gray-200 font-medium ".concat(l?"text-sm mr-2 flex-shrink-0":"mb-1"),children:n}),(0,m6.jsxs)("div",{className:"".concat(l?"flex-1 flex items-center":"flex items-center"),children:[(0,m6.jsx)("input",{id:t,type:"range",min:i,max:a,step:o,value:r,onChange:e=>{s(Number(e.target.value))},className:"w-full h-2 bg-gray-200 dark:bg-gray-600 rounded-md appearance-none cursor-pointer"}),(0,m6.jsx)("span",{className:"ml-2 text-gray-600 dark:text-gray-300 text-sm min-w-6 text-right",children:r})]})]})},M6=e=>{let{id:t,label:n,checked:r,onChange:i}=e;return(0,m6.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m6.jsx)("label",{htmlFor:t,className:"text-gray-700 dark:text-gray-200 font-medium",children:n}),(0,m6.jsx)("input",{id:t,type:"checkbox",checked:r,onChange:e=>{i(e.target.checked)},className:"w-4 h-4 text-blue-500 bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500"})]})},D6=e=>{let{id:t,label:n,value:r,onChange:i}=e;return(0,m6.jsxs)("div",{className:"control",children:[(0,m6.jsx)("label",{htmlFor:t,className:"block text-gray-700 dark:text-gray-200 font-medium mb-1",children:n}),(0,m6.jsx)("input",{id:t,type:"color",value:r,onChange:e=>{i(e.target.value)},className:"w-full h-8 bg-gray-200 dark:bg-gray-700 rounded cursor-pointer"})]})},E6=e=>{let{id:t,label:n,value:r,options:i,onChange:a,isMobile:o=!1}=e;return(0,m6.jsxs)("div",{className:"control ".concat(o?"flex items-center":""),children:[(0,m6.jsx)("label",{htmlFor:t,className:"block text-gray-700 dark:text-gray-200 font-medium ".concat(o?"text-sm mr-2 flex-shrink-0":"mb-1"),children:n}),(0,m6.jsx)("select",{id:t,value:r,onChange:e=>{a(e.target.value)},className:"".concat(o?"flex-1":"w-full"," bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md py-1 px-2 text-gray-700 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500"),children:i.map((e=>(0,m6.jsx)("option",{value:e,children:"string"===typeof e?e.charAt(0).toUpperCase()+e.slice(1):e},e)))})]})},C6=e=>{let{rotationX:t=0,rotationY:n=0,onRotationChange:r,onAnimate:i,onResetView:a}=e;const[o,s]=(0,d6.useState)(!0),l=d6.useRef(null);(0,d6.useEffect)((()=>{const e=()=>{s(!0),l.current&&clearTimeout(l.current),l.current=setTimeout((()=>{s(!1)}),2e3)};return document.addEventListener("mousemove",e),l.current=setTimeout((()=>{s(!1)}),5e3),()=>{document.removeEventListener("mousemove",e),l.current&&clearTimeout(l.current)}}),[]);return(0,m6.jsx)("div",{className:"fixed left-1/2 transform -translate-x-1/2 w-[70%] \n                  transition-opacity duration-500 ease-in-out z-20\n                  ".concat(o?"opacity-100":"opacity-0 pointer-events-none"),style:{bottom:"5%"},children:(0,m6.jsx)("div",{className:"bg-transparent p-3 rounded-lg",children:(0,m6.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,m6.jsxs)("div",{className:"bg-gray-800/60 backdrop-blur-sm p-2 rounded-lg flex items-center",children:[(0,m6.jsx)("label",{className:"text-white mr-2 text-sm",children:"Rotation X"}),(0,m6.jsx)("input",{type:"range",className:"w-40",min:"0",max:"360",step:"1",value:t,onChange:e=>{r&&r({x:parseInt(e.target.value),y:n})}}),(0,m6.jsxs)("span",{className:"text-white ml-2 text-xs w-8 text-right",children:[t,"\xb0"]})]}),(0,m6.jsxs)("div",{className:"bg-gray-800/60 backdrop-blur-sm p-2 rounded-lg flex items-center",children:[(0,m6.jsx)("label",{className:"text-white mr-2 text-sm",children:"Rotation Y"}),(0,m6.jsx)("input",{type:"range",className:"w-40",min:"0",max:"360",step:"1",value:n,onChange:e=>{r&&r({x:t,y:parseInt(e.target.value)})}}),(0,m6.jsxs)("span",{className:"text-white ml-2 text-xs w-8 text-right",children:[n,"\xb0"]})]}),(0,m6.jsx)("button",{className:"bg-blue-500/80 hover:bg-blue-600/80 text-white px-4 py-2 rounded-md shadow-lg",onClick:i,children:"Animate"}),(0,m6.jsx)("button",{className:"bg-gray-700/80 hover:bg-gray-800/80 text-white px-4 py-2 rounded-md shadow-lg",onClick:a,children:"Reset View"})]})})})},A6=e=>{let{activePlugin:t,showPluginSelector:n,setShowPluginSelector:r,plugins:i,handlePluginSelect:a,visualParams:o,handleVisualParamChange:s,structuralParams:l,handleStructuralParamChange:c,actions:u,handleActionClick:h,fullscreen:d,toggleFullscreen:f,classData:p=null,selectedClass:m,handleClassChange:g}=e;const{darkMode:v,toggleTheme:y}=y6(),[x,b]=(0,d6.useState)({x:0,y:0});return(0,m6.jsxs)("div",{className:"flex relative h-full w-full",children:[(0,m6.jsx)("div",{className:"absolute inset-0 bg-white dark:bg-gray-900 transition-colors",children:(0,m6.jsx)(b6,{activePlugin:t})}),(0,m6.jsx)("button",{className:"absolute top-5 left-5 w-12 h-12 rounded-full bg-white dark:bg-gray-700 shadow-md z-10 flex items-center justify-center transition-transform hover:scale-105 active:scale-95",onClick:()=>r(!0),"data-plugin-button":"true",children:(0,m6.jsx)("div",{className:"w-8 h-8 bg-blue-500 dark:bg-blue-600 rounded-full flex items-center justify-center",children:(0,m6.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,m6.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z",fill:"white"}),(0,m6.jsx)("circle",{cx:"12",cy:"12",r:"5",fill:"white"})]})})}),(0,m6.jsx)("button",{className:"absolute top-5 right-20 w-10 h-10 rounded-full bg-gray-800/50 dark:bg-gray-600/50 z-10 flex items-center justify-center text-white shadow-md",onClick:y,children:v?"\u2600\ufe0f":"\ud83c\udf19"}),(0,m6.jsx)("button",{className:"absolute top-5 right-5 w-10 h-10 rounded-md bg-gray-800/50 dark:bg-gray-600/50 z-10 flex items-center justify-center text-white shadow-md",onClick:f,children:d?"\u2922":"\u26f6"}),(0,m6.jsx)(C6,{rotationX:x.x,rotationY:x.y,onRotationChange:e=>{b(e),console.log("Rotation updated:",e)},onAnimate:()=>{console.log("Animation toggled")},onResetView:()=>{b({x:0,y:0}),console.log("View reset")}}),(0,m6.jsxs)("div",{className:"".concat(d?"opacity-0 pointer-events-none":"opacity-100"," transition-opacity duration-300"),children:[(0,m6.jsx)(_6,{title:"Visual",className:"absolute top-[11vh] left-5 w-[14vw] max-w-xs overflow-y-auto",panelType:"visual",children:(0,m6.jsxs)("div",{className:"space-y-2",children:[(0,m6.jsx)(S6,{id:"amplitude",label:"Amplitude",value:o.amplitude,min:0,max:100,step:1,onChange:e=>s("amplitude",e)}),(0,m6.jsx)(S6,{id:"frequency",label:"Frequency",value:o.frequency,min:1,max:50,step:1,onChange:e=>s("frequency",e)}),(0,m6.jsx)(M6,{id:"showPoints",label:"Show Points",checked:o.showPoints,onChange:e=>s("showPoints",e)}),(0,m6.jsx)(D6,{id:"color",label:"Line Color",value:o.color,onChange:e=>s("color",e)})]})}),(0,m6.jsx)(_6,{title:"Actions",className:"absolute top-[55vh] left-5 w-[14vw] max-w-xs overflow-y-auto",panelType:"actions",children:(0,m6.jsx)("div",{className:"space-y-2",children:u.map((e=>(0,m6.jsx)("button",{className:"w-full py-2 px-4 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-md shadow transition-colors",onClick:()=>h(e.id),children:e.label},e.id)))})}),p&&p.length>0&&(0,m6.jsx)(_6,{title:"Class Selection",className:"absolute top-[11vh] right-5 w-[14vw] max-w-xs overflow-y-auto",panelType:"class",children:(0,m6.jsx)("div",{className:"space-y-2",children:(0,m6.jsx)(E6,{id:"classSelector",label:"Select Class",value:m,options:p.map((e=>e.name||e.id)),onChange:e=>g(e)})})}),(0,m6.jsx)(_6,{title:"Structural",className:"absolute ".concat(p&&p.length>0?"top-[37vh]":"top-[11vh]"," right-5 w-[14vw] max-w-xs overflow-y-auto"),panelType:"structural",children:(0,m6.jsxs)("div",{className:"space-y-2",children:[(0,m6.jsx)(S6,{id:"resolution",label:"Resolution",value:l.resolution,min:10,max:200,step:1,onChange:e=>c("resolution",e)}),(0,m6.jsx)(S6,{id:"layers",label:"Layers",value:l.layers,min:1,max:10,step:1,onChange:e=>c("layers",e)}),(0,m6.jsx)(E6,{id:"renderQuality",label:"Render Quality",value:l.renderQuality,options:["low","medium","high","ultra"],onChange:e=>c("renderQuality",e)})]})})]}),(0,m6.jsx)(w6,{showPluginSelector:n,setShowPluginSelector:r,plugins:i,activePlugin:t,handlePluginSelect:a})]})},T6=e=>{let{activePlugin:t,showPluginSelector:n,setShowPluginSelector:r,plugins:i,handlePluginSelect:a,visualParams:o,handleVisualParamChange:s,structuralParams:l,handleStructuralParamChange:c,actions:u,handleActionClick:h,fullscreen:d,toggleFullscreen:f}=e;const{darkMode:p,toggleTheme:m}=y6(),[g,v]=(0,d6.useState)(!1),[y,x]=(0,d6.useState)(!1),[b,_]=(0,d6.useState)(!1),[w,S]=(0,d6.useState)({x:0,y:0}),[M,D]=(0,d6.useState)(!0),E=(0,d6.useRef)(null),C=(0,d6.useRef)(null),A=(0,d6.useRef)(null),T=(0,d6.useRef)(null),N=(0,d6.useRef)(null),R=(0,d6.useRef)(null),P=(0,d6.useRef)(null);(0,d6.useEffect)((()=>{n&&(v(!1),x(!1),_(!1))}),[n]);(0,d6.useEffect)((()=>{const e=e=>{g&&C.current&&!C.current.contains(e.target)&&N.current&&!N.current.contains(e.target)&&v(!1),y&&A.current&&!A.current.contains(e.target)&&R.current&&!R.current.contains(e.target)&&x(!1),b&&T.current&&!T.current.contains(e.target)&&P.current&&!P.current.contains(e.target)&&_(!1)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[g,y,b]),(0,d6.useEffect)((()=>{const e=()=>{D(!0),E.current&&clearTimeout(E.current),E.current=setTimeout((()=>{D(!1)}),3e3)};e();const t=["touchstart","touchmove","mousedown","mousemove","click"];return t.forEach((t=>{document.addEventListener(t,e)})),()=>{E.current&&clearTimeout(E.current),t.forEach((t=>{document.removeEventListener(t,e)}))}}),[]);const F=e=>{S(e),console.log("Rotation updated to:",e)};return(0,m6.jsxs)("div",{className:"flex flex-col h-full",children:[!d&&(0,m6.jsxs)("div",{className:"h-8 bg-white dark:bg-gray-700 shadow-sm flex items-center justify-between px-2 z-10",children:[(0,m6.jsx)("div",{className:"w-16"}),(0,m6.jsx)("h1",{className:"text-sm font-medium text-gray-800 dark:text-white",children:t.name}),(0,m6.jsxs)("div",{className:"flex items-center h-full",children:[(0,m6.jsx)("button",{className:"h-8 w-8 flex items-center justify-center text-gray-800 dark:text-white",onClick:m,children:p?"\u2600\ufe0f":"\ud83c\udf19"}),(0,m6.jsx)("button",{className:"h-8 w-8 flex items-center justify-center text-gray-800 dark:text-white",onClick:f,children:d?"\u2922":"\u26f6"})]})]}),!d&&(0,m6.jsx)("div",{className:"bg-white dark:bg-gray-700 shadow-md z-10 overflow-y-auto border-t border-gray-200 dark:border-gray-600",children:(0,m6.jsxs)("div",{className:"p-2 space-y-2",children:[(0,m6.jsx)(E6,{id:"class-selector-mobile",label:"Class",value:"DefaultClass",options:["DefaultClass","Class A","Class B","Class C"],onChange:e=>console.log("Class changed:",e),isMobile:!0}),(0,m6.jsx)(S6,{id:"class-parameter-mobile",label:"Value",value:75,min:0,max:100,step:1,onChange:e=>console.log("Class parameter changed:",e),isMobile:!0})]})}),(0,m6.jsxs)("div",{className:"flex-1 bg-white dark:bg-gray-900 relative",children:[(0,m6.jsx)(b6,{activePlugin:t}),d&&(0,m6.jsxs)("div",{className:"absolute top-0 right-0 m-1 flex items-center",children:[(0,m6.jsx)("button",{className:"h-8 w-8 flex items-center justify-center text-gray-800 dark:text-white bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-md shadow-md mr-1",onClick:m,children:p?"\u2600\ufe0f":"\ud83c\udf19"}),(0,m6.jsx)("button",{className:"h-8 w-8 flex items-center justify-center text-gray-800 dark:text-white bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm rounded-md shadow-md",onClick:f,children:d?"\u2922":"\u26f6"})]})]}),(0,m6.jsx)("div",{className:"fixed bottom-[5rem] left-0 right-0 px-4 z-20 transition-opacity duration-300 ".concat(M?"opacity-100":"opacity-0 pointer-events-none"),children:(0,m6.jsxs)("div",{className:"bg-gray-800/70 backdrop-blur-md rounded-lg shadow-lg p-1 flex flex-wrap justify-between items-center gap-1",children:[(0,m6.jsxs)("div",{className:"flex items-center flex-1 min-w-[120px]",children:[(0,m6.jsx)("label",{className:"text-white text-[9px] mr-1 w-8",children:"X-Axis"}),(0,m6.jsx)("input",{type:"range",className:"w-full h-4",min:"0",max:"360",step:"1",value:w.x,onChange:e=>F((0,p6.A)((0,p6.A)({},w),{},{x:parseInt(e.target.value)}))}),(0,m6.jsxs)("span",{className:"text-white text-[9px] ml-1 w-6 text-right",children:[w.x,"\xb0"]})]}),(0,m6.jsxs)("div",{className:"flex items-center flex-1 min-w-[120px]",children:[(0,m6.jsx)("label",{className:"text-white text-[9px] mr-1 w-8",children:"Y-Axis"}),(0,m6.jsx)("input",{type:"range",className:"w-full h-4",min:"0",max:"360",step:"1",value:w.y,onChange:e=>F((0,p6.A)((0,p6.A)({},w),{},{y:parseInt(e.target.value)}))}),(0,m6.jsxs)("span",{className:"text-white text-[9px] ml-1 w-6 text-right",children:[w.y,"\xb0"]})]}),(0,m6.jsxs)("div",{className:"flex gap-1 ml-1",children:[(0,m6.jsx)("button",{className:"bg-blue-500 text-white text-[9px] py-1 px-2 rounded",onClick:()=>{console.log("Animation toggled")},children:"Animate"}),(0,m6.jsx)("button",{className:"bg-gray-600 text-white text-[9px] py-1 px-2 rounded",onClick:()=>{S({x:0,y:0}),console.log("View reset to default position")},children:"Reset"})]})]})}),!d&&(0,m6.jsx)("div",{className:"fixed bottom-2 left-0 right-0 px-4 z-20",children:(0,m6.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow-lg flex items-center py-1 px-0",children:[(0,m6.jsxs)("button",{className:"flex-1 flex flex-col items-center py-1",onClick:()=>{v(!g),x(!1),_(!1)},ref:N,children:[(0,m6.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,m6.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:g?"#3B82F6":"currentColor",className:"w-5 h-5 text-gray-600 dark:text-gray-300",children:[(0,m6.jsx)("path",{d:"M12 15a3 3 0 100-6 3 3 0 000 6z"}),(0,m6.jsx)("path",{fillRule:"evenodd",d:"M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 010-1.113zM17.25 12a5.25 5.25 0 11-10.5 0 5.25 5.25 0 0110.5 0z",clipRule:"evenodd"})]})}),(0,m6.jsx)("span",{className:"text-[10px] ".concat(g?"text-blue-500 font-medium":"text-gray-600 dark:text-gray-300"),children:"Visual"})]}),(0,m6.jsxs)("button",{className:"flex-1 flex flex-col items-center py-1",onClick:()=>{x(!y),v(!1),_(!1)},ref:R,children:[(0,m6.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,m6.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:y?"#3B82F6":"currentColor",className:"w-5 h-5 text-gray-600 dark:text-gray-300",children:(0,m6.jsx)("path",{fillRule:"evenodd",d:"M11.078 2.25c-.917 0-1.699.663-1.85 1.567L9.05 4.889c-.02.12-.115.26-.297.348a7.493 7.493 0 00-.986.57c-.166.115-.334.126-.45.083L6.3 5.508a1.875 1.875 0 00-2.282.819l-.922 1.597a1.875 1.875 0 00.432 2.385l.84.692c.095.078.17.229.154.43a7.598 7.598 0 000 1.139c.015.2-.059.352-.153.43l-.841.692a1.875 1.875 0 00-.432 2.385l.922 1.597a1.875 1.875 0 002.282.818l1.019-.382c.115-.043.283-.031.45.082.312.214.641.405.985.57.182.088.277.228.297.35l.178 1.071c.151.904.933 1.567 1.85 1.567h1.844c.916 0 1.699-.663 1.85-1.567l.178-1.072c.02-.12.114-.26.297-.349.344-.165.673-.356.985-.57.167-.114.335-.125.45-.082l1.02.382a1.875 1.875 0 002.28-.819l.923-1.597a1.875 1.875 0 00-.432-2.385l-.84-.692c-.095-.078-.17-.229-.154-.43a7.614 7.614 0 000-1.139c-.016-.2.059-.352.153-.43l.84-.692c.708-.582.891-1.59.433-2.385l-.922-1.597a1.875 1.875 0 00-2.282-.818l-1.02.382c-.114.043-.282.031-.449-.083a7.49 7.49 0 00-.985-.57c-.183-.087-.277-.227-.297-.348l-.179-1.072a1.875 1.875 0 00-1.85-1.567h-1.843zM12 15.75a3.75 3.75 0 100-7.5 3.75 3.75 0 000 7.5z",clipRule:"evenodd"})})}),(0,m6.jsx)("span",{className:"text-[10px] ".concat(y?"text-blue-500 font-medium":"text-gray-600 dark:text-gray-300"),children:"Structural"})]}),(0,m6.jsxs)("button",{className:"flex-1 flex flex-col items-center py-1",onClick:()=>{_(!b),v(!1),x(!1)},ref:P,children:[(0,m6.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,m6.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:b?"#3B82F6":"currentColor",className:"w-5 h-5 text-gray-600 dark:text-gray-300",children:(0,m6.jsx)("path",{fillRule:"evenodd",d:"M14.615 1.595a.75.75 0 01.359.852L12.982 9.75h7.268a.75.75 0 01.548 1.262l-10.5 11.25a.75.75 0 01-1.272-.71l1.992-7.302H3.75a.75.75 0 01-.548-1.262l10.5-11.25a.75.75 0 01.913-.143z",clipRule:"evenodd"})})}),(0,m6.jsx)("span",{className:"text-[10px] ".concat(b?"text-blue-500 font-medium":"text-gray-600 dark:text-gray-300"),children:"Actions"})]}),(0,m6.jsxs)("button",{className:"flex-1 flex flex-col items-center py-1",onClick:()=>r(!0),children:[(0,m6.jsx)("div",{className:"w-6 h-6 flex items-center justify-center",children:(0,m6.jsxs)("svg",{viewBox:"0 0 24 24",fill:"#3B82F6",className:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",children:[(0,m6.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),(0,m6.jsx)("circle",{cx:"12",cy:"12",r:"5"})]})}),(0,m6.jsx)("span",{className:"text-[10px] text-gray-600 dark:text-gray-300",children:"Plugins"})]})]})}),(0,m6.jsx)("div",{className:"fixed bottom-12 left-5 w-[280px] bg-white dark:bg-gray-700 rounded-lg shadow-lg z-30 transition-all transform ".concat(g?"translate-y-0 opacity-100":"translate-y-5 opacity-0 pointer-events-none"),ref:C,children:(0,m6.jsxs)("div",{className:"p-4",children:[(0,m6.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white pb-2 border-b border-gray-200 dark:border-gray-600",children:"Visual Options"}),(0,m6.jsxs)("div",{className:"mt-3 space-y-4 max-h-[50vh] overflow-y-auto",children:[(0,m6.jsx)(S6,{id:"amplitude-mobile",label:"Amplitude",value:o.amplitude,min:0,max:100,step:1,onChange:e=>s("amplitude",e)}),(0,m6.jsx)(S6,{id:"frequency-mobile",label:"Frequency",value:o.frequency,min:1,max:50,step:1,onChange:e=>s("frequency",e)}),(0,m6.jsx)(M6,{id:"showPoints-mobile",label:"Show Points",checked:o.showPoints,onChange:e=>s("showPoints",e)}),(0,m6.jsx)(D6,{id:"color-mobile",label:"Line Color",value:o.color,onChange:e=>s("color",e)})]})]})}),(0,m6.jsx)("div",{className:"fixed bottom-12 left-1/2 transform -translate-x-1/2 w-[280px] bg-white dark:bg-gray-700 rounded-lg shadow-lg z-30 transition-all ".concat(y?"translate-y-0 opacity-100":"translate-y-5 opacity-0 pointer-events-none"),ref:A,children:(0,m6.jsxs)("div",{className:"p-4",children:[(0,m6.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white pb-2 border-b border-gray-200 dark:border-gray-600",children:"Structural Parameters"}),(0,m6.jsxs)("div",{className:"mt-3 space-y-4 max-h-[50vh] overflow-y-auto",children:[(0,m6.jsx)(S6,{id:"resolution-menu-mobile",label:"Resolution",value:l.resolution,min:10,max:200,step:1,onChange:e=>c("resolution",e)}),(0,m6.jsx)(S6,{id:"layers-menu-mobile",label:"Layers",value:l.layers,min:1,max:10,step:1,onChange:e=>c("layers",e)}),(0,m6.jsx)(E6,{id:"renderQuality-menu-mobile",label:"Render Quality",value:l.renderQuality,options:["low","medium","high","ultra"],onChange:e=>c("renderQuality",e)})]})]})}),(0,m6.jsx)("div",{className:"fixed bottom-12 right-5 w-[200px] bg-white dark:bg-gray-700 rounded-lg shadow-lg z-30 transition-all transform ".concat(b?"translate-y-0 opacity-100":"translate-y-5 opacity-0 pointer-events-none"),ref:T,children:(0,m6.jsxs)("div",{className:"p-4",children:[(0,m6.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white pb-2 border-b border-gray-200 dark:border-gray-600",children:"Actions"}),(0,m6.jsx)("div",{className:"mt-3 space-y-2",children:u.map((e=>(0,m6.jsx)("button",{className:"w-full py-2 px-4 bg-blue-500 hover:bg-blue-600 text-white font-medium rounded-md shadow transition-colors",onClick:()=>{h(e.id),_(!1)},children:e.label},e.id)))})]})}),(0,m6.jsx)(w6,{showPluginSelector:n,setShowPluginSelector:r,plugins:i,activePlugin:t,handlePluginSelect:a,isMobile:!0})]})};class N6{constructor(){this.events={}}on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}off(e,t){this.events[e]&&(this.events[e]=this.events[e].filter((e=>e!==t)),0===this.events[e].length&&delete this.events[e])}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!this.events[e]&&(this.events[e].forEach((e=>{e(...n)})),!0)}once(e,t){var n=this;const r=function(){t(...arguments),n.off(e,r)};this.on(e,r)}removeAllListeners(e){e?delete this.events[e]:this.events={}}}class R6{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=(0,p6.A)({},e),this.listeners=[]}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e.includes(".")){const n=e.split(".");let r=this.state;for(const e of n){if(void 0===r||null===r)return t;r=r[e]}return void 0!==r?r:t}return void 0!==this.state[e]?this.state[e]:t}set(e,t){if(e.includes(".")){const n=e.split(".");let r=this.state;for(let e=0;e<n.length-1;e++){const t=n[e];r[t]&&"object"===typeof r[t]||(r[t]={}),r=r[t]}const i=n[n.length-1],a=r[i];return r[i]=t,void(a!==t&&this._notifyListeners(e,t,a))}const n=this.state[e];this.state[e]=t,n!==t&&this._notifyListeners(e,t,n)}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter((t=>t!==e))}getAll(){return(0,p6.A)({},this.state)}setMultiple(e){Object.entries(e).forEach((e=>{let[t,n]=e;this.set(t,n)}))}reset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state=(0,p6.A)({},e),this._notifyListeners("*",this.state,null)}_notifyListeners(e,t,n){this.listeners.forEach((r=>{try{r(e,t,n)}catch(i){console.error("Error in state change listener:",i)}}))}}class P6{constructor(){this.controlBuilders={slider:this.createSlider.bind(this),checkbox:this.createCheckbox.bind(this),color:this.createColorPicker.bind(this),dropdown:this.createDropdown.bind(this),number:this.createNumberInput.bind(this),text:this.createTextInput.bind(this)}}createControl(e,t,n){const r=this.controlBuilders[e.type];return r?r(e,t,n):(console.error("Unknown control type: ".concat(e.type)),this.createUnsupportedControl(e))}createControlContainer(){const e=document.createElement("div");return e.className="control",e}createLabel(e,t){const n=document.createElement("label");return n.htmlFor=e,n.textContent=t,n.style.color="var(--text-color)",n}createSlider(e,t,n){const r=this.createControlContainer(),i=this.createLabel(e.id,e.label),a=document.createElement("input");a.type="range",a.id=e.id,a.min=void 0!==e.min?e.min:0,a.max=void 0!==e.max?e.max:100,a.step=void 0!==e.step?e.step:1,a.value=void 0!==t?t:e.default;const o=document.createElement("span");o.className="value-display",o.textContent=void 0!==t?t:e.default,o.style.color="var(--text-secondary)";const s=document.createElement("div");return s.className="input-container",s.appendChild(a),s.appendChild(o),a.addEventListener("input",(e=>{const t=parseFloat(e.target.value);o.textContent=t,n(t)})),r.appendChild(i),r.appendChild(s),r}createCheckbox(e,t,n){const r=document.createElement("div");r.className="control checkbox-container";const i=document.createElement("label");i.htmlFor=e.id,i.textContent=e.label,i.style.color="var(--text-color)";const a=document.createElement("input");return a.type="checkbox",a.id=e.id,a.checked=void 0!==t?t:e.default,a.addEventListener("change",(e=>{n(e.target.checked)})),r.appendChild(i),r.appendChild(a),r}createColorPicker(e,t,n){const r=this.createControlContainer(),i=this.createLabel(e.id,e.label),a=document.createElement("input");return a.type="color",a.id=e.id,a.value=void 0!==t?t:e.default,a.addEventListener("input",(e=>{n(e.target.value)})),r.appendChild(i),r.appendChild(a),r}createDropdown(e,t,n){const r=this.createControlContainer(),i=this.createLabel(e.id,e.label),a=document.createElement("select");return a.id=e.id,a.style.backgroundColor="var(--background-secondary)",a.style.color="var(--text-color)",e.options&&Array.isArray(e.options)&&e.options.forEach((n=>{const r=document.createElement("option");"object"===typeof n&&null!==n?(r.value=n.value,r.textContent=n.label||n.value):(r.value=n,r.textContent=n),(void 0!==t&&n===t||void 0===t&&n===e.default)&&(r.selected=!0),a.appendChild(r)})),a.addEventListener("change",(e=>{n(e.target.value)})),r.appendChild(i),r.appendChild(a),r}createNumberInput(e,t,n){const r=this.createControlContainer(),i=this.createLabel(e.id,e.label),a=document.createElement("input");return a.type="number",a.id=e.id,a.value=void 0!==t?t:e.default,a.style.backgroundColor="var(--background-secondary)",a.style.color="var(--text-color)",void 0!==e.min&&(a.min=e.min),void 0!==e.max&&(a.max=e.max),void 0!==e.step&&(a.step=e.step),a.addEventListener("input",(e=>{n(parseFloat(e.target.value))})),r.appendChild(i),r.appendChild(a),r}createTextInput(e,t,n){const r=this.createControlContainer(),i=this.createLabel(e.id,e.label),a=document.createElement("input");return a.type="text",a.id=e.id,a.value=void 0!==t?t:e.default,a.style.backgroundColor="var(--background-secondary)",a.style.color="var(--text-color)",a.addEventListener("input",(e=>{n(e.target.value)})),r.appendChild(i),r.appendChild(a),r}createUnsupportedControl(e){const t=this.createControlContainer(),n=document.createElement("label");n.textContent=e.label,n.style.color="var(--text-color)";const r=document.createElement("p");return r.textContent="Unsupported control type: ".concat(e.type),r.style.color="var(--error-color)",t.appendChild(n),t.appendChild(r),t}createButton(e,t,n){const r=document.createElement("button");return r.id=e,r.textContent=t,r.style.backgroundColor="var(--accent-color)",r.style.color="white",r.style.padding="10px",r.style.borderRadius="4px",r.style.border="none",r.style.cursor="pointer",r.style.fontWeight="bold",r.style.width="100%",r.style.transition="background-color 0.2s, transform 0.1s",r.addEventListener("mousedown",(()=>{r.style.transform="translateY(1px)",r.style.backgroundColor="var(--control-focus)"})),r.addEventListener("mouseup",(()=>{r.style.transform="none",r.style.backgroundColor="var(--accent-color)"})),r.addEventListener("mouseover",(()=>{r.style.backgroundColor="var(--control-focus)"})),r.addEventListener("mouseout",(()=>{r.style.backgroundColor="var(--accent-color)"})),r.addEventListener("click",n),r}createSectionHeader(e){const t=document.createElement("h3");return t.textContent=e,t.className="section-header",t.style.color="var(--text-color)",t}createNotification(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;document.querySelectorAll(".notification").forEach((e=>document.body.removeChild(e)));const n=document.createElement("div");return n.className="notification",n.textContent=e,Object.assign(n.style,{position:"fixed",bottom:"20px",left:"50%",transform:"translateX(-50%)",backgroundColor:"var(--overlay-bg)",color:"white",padding:"10px 20px",borderRadius:"4px",zIndex:"10000",opacity:"0",transition:"opacity 0.3s ease",fontFamily:"sans-serif"}),document.body.appendChild(n),setTimeout((()=>{n.style.opacity="1"}),10),setTimeout((()=>{n.style.opacity="0",setTimeout((()=>{document.body.contains(n)&&document.body.removeChild(n)}),300)}),t),n}createErrorBox(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8e3;document.querySelectorAll(".error-box").forEach((e=>{e.parentNode&&e.parentNode.removeChild(e)}));const n=document.createElement("div");n.className="error-box";const r=document.createElement("div"),i=document.createElement("span");i.innerHTML="\u26a0\ufe0f",i.style.marginRight="10px",r.appendChild(i);const a=document.createElement("span");a.textContent=e,r.appendChild(a);const o=document.createElement("button");return o.innerHTML="&times;",o.addEventListener("click",(()=>{n.parentNode&&n.parentNode.removeChild(n)})),n.appendChild(r),n.appendChild(o),document.body.appendChild(n),n.style.opacity="0",setTimeout((()=>{n.style.opacity="1"}),10),t>0&&setTimeout((()=>{n.parentNode&&(n.style.opacity="0",setTimeout((()=>{n.parentNode&&n.parentNode.removeChild(n)}),300))}),t),n}createLoadingIndicator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...";const t=document.createElement("div");t.className="loading-indicator",Object.assign(t.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:"var(--overlay-bg)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:"10000"});const n=document.createElement("div");if(n.className="spinner",Object.assign(n.style,{border:"5px solid var(--border-color)",borderTop:"5px solid var(--accent-color)",borderRadius:"50%",width:"50px",height:"50px",animation:"spin 1s linear infinite"}),!document.getElementById("spinner-keyframes")){const e=document.createElement("style");e.id="spinner-keyframes",e.textContent="\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      ",document.head.appendChild(e)}const r=document.createElement("p");return r.textContent=e,r.style.color="white",r.style.marginTop="20px",r.style.fontFamily="sans-serif",t.appendChild(n),t.appendChild(r),t}}function F6(e,t,n,r){const i=e.createControl(t,n,r);i.querySelectorAll("label").forEach((e=>{e.style.color="var(--text-color)"}));return i.querySelectorAll("button").forEach((e=>{e.style.backgroundColor="var(--accent-color)",e.style.color="white"})),i}function O6(e,t){if(e)switch(e.type){case"range":case"number":case"text":if(e.value=t,"range"===e.type){var n;const r=null===(n=e.parentElement)||void 0===n?void 0:n.querySelector(".value-display");r&&(r.textContent=t)}break;case"checkbox":e.checked=t;break;case"color":case"select-one":e.value=t}}function I6(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=document.createElement("button");return i.id=e,i.textContent=t,i.style.backgroundColor=r?"var(--accent-color)":"var(--control-bg)",i.style.color=r?"white":"var(--text-color)",i.style.padding="10px",i.style.borderRadius="4px",i.style.border="none",i.style.cursor="pointer",i.style.fontWeight="bold",i.style.width="100%",i.style.marginBottom="10px",i.style.transition="background-color 0.2s, transform 0.1s",i.addEventListener("mousedown",(()=>{i.style.transform="translateY(1px)",i.style.backgroundColor="var(--control-focus)"})),i.addEventListener("mouseup",(()=>{i.style.transform="none",i.style.backgroundColor=r?"var(--accent-color)":"var(--control-bg)"})),i.addEventListener("click",n),i}function B6(e){const t=document.createElement("p");return t.textContent=e,t.style.fontStyle="italic",t.style.color="var(--text-secondary)",t.style.textAlign="center",t.style.padding="8px",t}function k6(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"control-panel";const r=document.createElement("div");r.id=e,r.className=n;const i=document.createElement("h3");i.textContent=t,i.style.color="var(--text-color)",r.appendChild(i);const a=B6("No parameters available.");return r.appendChild(a),r}function L6(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||!e.colorSchemeManager)return null;const n=e.colorSchemeManager.getActiveScheme(),r=t?"mobile-theme-toggle":"theme-toggle",i=document.createElement("button");return i.className=r,i.setAttribute("aria-label","Toggle color scheme"),i.textContent="light"===n.id?"\ud83c\udf19":"\u2600\ufe0f",i.addEventListener("click",(()=>{const t="light"===e.colorSchemeManager.getActiveScheme().id?"dark":"light";e.colorSchemeManager.setActiveScheme(t)})),i}function U6(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=e?"mobile-fullscreen-button":"desktop-fullscreen-button",r=e?"mobile-fullscreen-button":"fullscreen-button",i=document.getElementById(n);i&&i.parentNode&&i.parentNode.removeChild(i);const a=document.createElement("button");return a.id=n,a.className=r,a.innerHTML='<span class="fullscreen-icon">\u26f6</span>',a.title="Toggle Fullscreen Mode",e&&(a.style.color="var(--text-color)"),a.addEventListener("click",(()=>{document.body.classList.toggle("fullscreen-mode"),document.body.classList.contains("fullscreen-mode")?(a.innerHTML='<span class="fullscreen-icon">\u2922</span>',a.title="Exit Fullscreen Mode",e&&a.classList.add("fullscreen-active")):(a.innerHTML='<span class="fullscreen-icon">\u26f6</span>',a.title="Enter Fullscreen Mode",e&&a.classList.remove("fullscreen-active")),t&&"function"===typeof t&&t(document.body.classList.contains("fullscreen-mode"))})),a}class z6 extends N6{constructor(e){super(),this.uiManager=e,this.builder=e.uiBuilder,this.controls={schema:null,values:{}},this.actions=[],this.plugins=[],this.activePluginId=null,this.initialized=!1,this.loadingIndicator=null,this.handleParameterChange=this.handleParameterChange.bind(this),this.handleOutsideClick=this.handleOutsideClick.bind(this)}async initialize(){return this.initialized=!0,document.addEventListener("click",this.handleOutsideClick),!0}handleOutsideClick(e){}buildControls(e,t){this.controls={schema:e,values:(0,p6.A)({},t)}}updateControls(e){Object.entries(e).forEach((e=>{let[t,n]=e,r=document.getElementById(t);r||(r=document.getElementById("".concat(t,"-mobile"))),O6(r,n)}))}handleParameterChange(e,t){this.controls.values[e]=t,this.emit("parameterChange",e,t)}updateActions(e){this.actions=[...e]}updatePlugins(e,t){this.plugins=[...e],this.activePluginId=t}handleResize(){}showError(e){this.builder.createNotification(e,5e3)}showNotification(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;this.builder.createNotification(e,t)}showLoading(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...";this.hideLoading(),this.loadingIndicator=this.builder.createLoadingIndicator(e),document.body.appendChild(this.loadingIndicator)}hideLoading(){this.loadingIndicator&&this.loadingIndicator.parentNode&&(this.loadingIndicator.parentNode.removeChild(this.loadingIndicator),this.loadingIndicator=null)}dispose(){document.removeEventListener("click",this.handleOutsideClick),this.hideLoading(),this.controls={schema:null,values:{}},this.actions=[],this.plugins=[],this.activePluginId=null,this.initialized=!1}}class H6{constructor(e,t,n,r){this.plugins=e||[],this.activePluginId=t,this.onSelect=n,this.onClose=r,this.element=null,this.visible=!1,this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleOutsideClick=this.handleOutsideClick.bind(this)}create(){if(this.element)return this.element;this.element=document.createElement("div"),this.element.className="selection-window-overlay hidden";const e=document.createElement("div");e.className="selection-window-content";const t=document.createElement("div");t.className="selection-window-header";const n=document.createElement("h2");n.className="selection-window-title",n.textContent="Select Visualization";const r=document.createElement("button");r.className="selection-window-close",r.innerHTML="&times;",r.setAttribute("aria-label","Close"),r.addEventListener("click",this.hide),t.appendChild(n),t.appendChild(r);const i=document.createElement("div");return i.className="selection-window-grid",this.plugins.forEach((e=>{const t=this.createPluginCard(e);i.appendChild(t)})),e.appendChild(t),e.appendChild(i),this.element.appendChild(e),document.body.appendChild(this.element),this.visible=!1,this.element}createPluginCard(e){const t=document.createElement("div");t.className="selection-window-card",e.id===this.activePluginId&&t.classList.add("active");const n=document.createElement("div");n.className="selection-window-card-content";const r=document.createElement("h3");r.className="selection-window-card-title",r.textContent=e.name;const i=document.createElement("p");i.className="selection-window-card-description",i.textContent=e.description;const a=document.createElement("div");a.className="selection-window-card-image";const o=document.createElement("div");return o.className="selection-window-card-icon","3d"===e.renderingType?o.innerHTML='<svg viewBox="0 0 24 24" width="48" height="48"><path fill="currentColor" d="M12 1L1 5v14l11 4 11-4V5L12 1zM5 7.2l6-2.2 6 2.2v7.1l-6 2.2-6-2.2V7.2z"/></svg>':o.innerHTML='<svg viewBox="0 0 24 24" width="48" height="48"><path fill="currentColor" d="M4 4h16v16H4V4z M12 17.5L4.5 10l3-3L12 11.5l4.5-4.5 3 3L12 17.5z"/></svg>',a.appendChild(o),t.addEventListener("click",(()=>{"function"===typeof this.onSelect&&this.onSelect(e.id),this.hide()})),n.appendChild(r),n.appendChild(i),t.appendChild(a),t.appendChild(n),t}show(){this.element||this.create(),this.element&&!this.visible&&(this.element.classList.remove("hidden"),this.visible=!0,document.body.style.overflow="hidden",setTimeout((()=>{this.element&&(this.element.classList.add("visible"),setTimeout((()=>{document.addEventListener("keydown",this.handleKeyDown),requestAnimationFrame((()=>{document.addEventListener("click",this.handleOutsideClick)}))}),100))}),10)),this.updateActivePlugin(this.activePluginId)}hide(){this.element&&this.visible&&(this.element.classList.remove("visible"),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("click",this.handleOutsideClick),setTimeout((()=>{this.element&&(this.element.classList.add("hidden"),this.visible=!1,document.body.style.overflow="","function"===typeof this.onClose&&this.onClose())}),300))}updateActivePlugin(e){if(this.activePluginId=e,this.element){const t=this.element.querySelectorAll(".selection-window-card");t.forEach((n=>{const r=Array.from(t).indexOf(n);this.plugins[r]&&this.plugins[r].id===e?n.classList.add("active"):n.classList.remove("active")}))}}update(e,t){const n=this.visible;this.plugins=e||[],this.activePluginId=t,this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.element=null,this.create(),n?(this.element.classList.remove("hidden"),this.element.classList.add("visible"),this.visible=!0,document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("click",this.handleOutsideClick)):(this.element.classList.add("hidden"),this.element.classList.remove("visible"),this.visible=!1))}handleKeyDown(e){"Escape"===e.key&&this.hide()}handleOutsideClick(e){if(!e.target.closest(".plugin-selector-button")&&!e.target.closest("#mobile-plugin-button")&&this.element&&this.visible){const t=this.element.querySelector(".selection-window-content");t&&!t.contains(e.target)&&this.hide()}}dispose(){this.hide(),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.plugins=[],this.onSelect=null,this.onClose=null}}class V6 extends z6{constructor(e){super(e),this.panels={},this.pluginSelectorButton=null,this.selectionWindow=null,this.themeToggleButton=null,this.parameterGroups={visual:{schema:[],values:{}},structural:{schema:[],values:{}},advanced:{schema:[],values:{}}},this.openSelectionWindow=this.openSelectionWindow.bind(this)}async initialize(){if(this.initialized)return!0;try{return await super.initialize(),this.createPanels(),this.createPluginSelector(),this.createFullscreenButton(),this.createThemeToggleButton(),console.log("Desktop layout initialized"),!0}catch(e){return console.error("Failed to initialize desktop layout:",e),!1}}createPanels(){this.removePanels(),this.panels.visual=k6("visual-panel","Visual Parameters","control-panel"),document.body.appendChild(this.panels.visual),this.panels.structural=k6("structural-panel","Structural Parameters","control-panel right-panel"),document.body.appendChild(this.panels.structural),this.panels.actions=k6("actions-panel","Actions","control-panel export-panel"),document.body.appendChild(this.panels.actions)}removePanels(){Object.values(this.panels).forEach((e=>{e&&e.parentNode&&e.parentNode.removeChild(e)})),this.panels={}}createPluginSelector(){this.pluginSelectorButton=document.createElement("div"),this.pluginSelectorButton.className="plugin-selector-button",this.pluginSelectorButton.title="Visualization Selector",this.pluginSelectorButton.addEventListener("click",this.openSelectionWindow);const e=document.createElement("div");e.className="plugin-selector-button-icon",this.pluginSelectorButton.appendChild(e),document.body.appendChild(this.pluginSelectorButton),this.selectionWindow=new H6(this.plugins,this.activePluginId,(e=>this.emit("pluginSelect",e)),null)}openSelectionWindow(e){e&&e.stopPropagation(),this.selectionWindow&&(this.selectionWindow.update(this.plugins,this.activePluginId),this.selectionWindow.show())}createFullscreenButton(){const e=U6(!1,(e=>{this.emit("action","toggle-fullscreen")}));document.body.appendChild(e)}createThemeToggleButton(){this.themeToggleButton&&this.themeToggleButton.parentNode&&this.themeToggleButton.parentNode.removeChild(this.themeToggleButton),this.themeToggleButton=L6(this.uiManager.core,!1),this.themeToggleButton&&document.body.appendChild(this.themeToggleButton)}handleOutsideClick(e){}updateParameterGroups(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.parameterGroups=e,!t&&this.panels.visual&&this.panels.structural||this.createPanels(),this.updateVisualPanel(e.visual.schema,e.visual.values),this.updateStructuralPanel(e.structural.schema,e.structural.values),e.advanced.schema.length>0?(this.panels.advanced||(this.panels.advanced=k6("advanced-panel","Advanced Options","control-panel advanced-panel"),document.body.appendChild(this.panels.advanced)),this.updateAdvancedPanel(e.advanced.schema,e.advanced.values)):this.panels.advanced&&(this.panels.advanced.parentNode&&this.panels.advanced.parentNode.removeChild(this.panels.advanced),delete this.panels.advanced),this.updateActionsPanel(this.actions)}updateParameterValue(e,t,n){n&&this.parameterGroups[n]&&(this.parameterGroups[n].values[e]=t);let r=e;n&&(r="".concat(n,"-").concat(e));let i=document.getElementById(r);i||(i=document.getElementById(e)),i&&O6(i,t)}updateVisualPanel(e,t){const n=this.panels.visual;for(;n.childNodes.length>1;)n.removeChild(n.lastChild);e&&0!==e.length?e.forEach((e=>{const r="visual-".concat(e.id),i=F6(this.builder,(0,p6.A)((0,p6.A)({},e),{},{id:r}),t[e.id],(t=>this.handleParameterChange(e.id,t,"visual")));n.appendChild(i)})):n.appendChild(B6("No visual parameters available."))}updateStructuralPanel(e,t){const n=this.panels.structural;for(;n.childNodes.length>1;)n.removeChild(n.lastChild);e&&0!==e.length?e.forEach((e=>{const r="structural-".concat(e.id),i=F6(this.builder,(0,p6.A)((0,p6.A)({},e),{},{id:r}),t[e.id],(t=>this.handleParameterChange(e.id,t,"structural")));n.appendChild(i)})):n.appendChild(B6("No structural parameters available."))}updateAdvancedPanel(e,t){const n=this.panels.advanced;for(;n.childNodes.length>1;)n.removeChild(n.lastChild);e&&0!==e.length?e.forEach((e=>{const r="advanced-".concat(e.id),i=F6(this.builder,(0,p6.A)((0,p6.A)({},e),{},{id:r}),t[e.id],(t=>this.handleParameterChange(e.id,t,"advanced")));n.appendChild(i)})):n.appendChild(B6("No advanced parameters available."))}updateActions(e){super.updateActions(e),this.updateActionsPanel(e)}updateActionsPanel(e){const t=this.panels.actions;for(;t.childNodes.length>1;)t.removeChild(t.lastChild);e&&0!==e.length?e.forEach((e=>{const n=I6(e.id,e.label,(()=>this.emit("action",e.id)));t.appendChild(n)})):t.appendChild(B6("No actions available."))}handleParameterChange(e,t,n){n&&this.parameterGroups[n]&&(this.parameterGroups[n].values[e]=t),this.emit("parameterChange",e,t,n)}updatePlugins(e,t){super.updatePlugins(e,t),this.selectionWindow&&this.selectionWindow.update(e,t)}dispose(){super.dispose(),this.removePanels(),this.pluginSelectorButton&&this.pluginSelectorButton.parentNode&&this.pluginSelectorButton.parentNode.removeChild(this.pluginSelectorButton),this.selectionWindow&&(this.selectionWindow.dispose(),this.selectionWindow=null),this.themeToggleButton&&this.themeToggleButton.parentNode&&this.themeToggleButton.parentNode.removeChild(this.themeToggleButton);const e=document.getElementById("desktop-fullscreen-button");e&&e.parentNode&&e.parentNode.removeChild(e),document.body.classList.remove("fullscreen-mode"),console.log("Desktop layout disposed")}}class G6 extends z6{constructor(e){super(e),this.headerTitle=null,this.header=null,this.controlBar=null,this.optionsButton=null,this.exportButton=null,this.pluginButton=null,this.visualMenu=null,this.actionsMenu=null,this.selectionWindow=null,this.themeToggleButton=null,this.parameterGroups={visual:{schema:[],values:{}},structural:{schema:[],values:{}},advanced:{schema:[],values:{}}},this.toggleVisualMenu=this.toggleVisualMenu.bind(this),this.toggleActionsMenu=this.toggleActionsMenu.bind(this),this.openSelectionWindow=this.openSelectionWindow.bind(this)}async initialize(){if(this.initialized)return!0;try{return await super.initialize(),document.body.classList.add("mobile-device"),this.createUIElements(),this.createFullscreenButton(),this.createThemeToggleButton(),console.log("Mobile layout initialized"),!0}catch(e){return console.error("Failed to initialize mobile layout:",e),!1}}createUIElements(){this.removeUIElements(),this.headerTitle=this.createHeaderTitle(),document.body.appendChild(this.headerTitle),this.header=this.createHeader(),document.body.appendChild(this.header),this.controlBar=this.createControlBar(),document.body.appendChild(this.controlBar),this.visualMenu=this.createVisualMenu(),document.body.appendChild(this.visualMenu),this.actionsMenu=this.createActionsMenu(),document.body.appendChild(this.actionsMenu),this.selectionWindow=new H6(this.plugins,this.activePluginId,(e=>this.emit("pluginSelect",e)),null)}removeUIElements(){this.headerTitle&&this.headerTitle.parentNode&&this.headerTitle.parentNode.removeChild(this.headerTitle),this.header&&this.header.parentNode&&this.header.parentNode.removeChild(this.header),this.controlBar&&this.controlBar.parentNode&&this.controlBar.parentNode.removeChild(this.controlBar),this.visualMenu&&this.visualMenu.parentNode&&this.visualMenu.parentNode.removeChild(this.visualMenu),this.actionsMenu&&this.actionsMenu.parentNode&&this.actionsMenu.parentNode.removeChild(this.actionsMenu),this.selectionWindow&&(this.selectionWindow.dispose(),this.selectionWindow=null),this.themeToggleButton&&this.themeToggleButton.parentNode&&this.themeToggleButton.parentNode.removeChild(this.themeToggleButton)}createHeaderTitle(){const e=document.createElement("div");e.className="mobile-header-title";const t=this.plugins.find((e=>e.id===this.activePluginId))||this.plugins[0];return e.textContent=t?t.name:"Visualization",e.style.backgroundColor="var(--control-bg)",e.style.color="var(--text-color)",e}createHeader(){const e=document.createElement("div");return e.className="mobile-header",e.style.backgroundColor="var(--control-bg)",e.style.color="var(--text-color)",e.appendChild(B6("No structural parameters available.")),e}createFullscreenButton(){const e=U6(!0,(e=>{this.emit("action","toggle-fullscreen")}));document.body.appendChild(e)}createThemeToggleButton(){this.themeToggleButton&&this.themeToggleButton.parentNode&&this.themeToggleButton.parentNode.removeChild(this.themeToggleButton),this.themeToggleButton=L6(this.uiManager.core,!0),this.themeToggleButton&&document.body.appendChild(this.themeToggleButton)}createControlBar(){const e=document.createElement("div");e.className="mobile-control-bar",this.optionsButton=document.createElement("button"),this.optionsButton.id="mobile-options-button",this.optionsButton.textContent="Options",this.optionsButton.style.backgroundColor="var(--control-bg)",this.optionsButton.style.color="var(--text-color)",this.optionsButton.addEventListener("click",this.toggleVisualMenu),this.pluginButton=document.createElement("div"),this.pluginButton.id="mobile-plugin-button",this.pluginButton.style.backgroundColor="var(--control-bg)";const t=document.createElement("div");return t.id="mobile-plugin-button-icon",t.style.backgroundColor="var(--accent-color)",this.pluginButton.appendChild(t),this.pluginButton.addEventListener("click",this.openSelectionWindow),this.exportButton=document.createElement("button"),this.exportButton.id="mobile-export-button",this.exportButton.textContent="Actions",this.exportButton.style.backgroundColor="var(--control-bg)",this.exportButton.style.color="var(--text-color)",this.exportButton.addEventListener("click",this.toggleActionsMenu),e.appendChild(this.optionsButton),e.appendChild(this.pluginButton),e.appendChild(this.exportButton),e}createVisualMenu(){const e=document.createElement("div");e.id="mobile-visual-menu",e.className="mobile-options-menu hidden",e.style.backgroundColor="var(--control-bg)";const t=document.createElement("h3");return t.textContent="Visual Options",t.style.color="var(--text-color)",e.appendChild(t),e.appendChild(B6("No visual parameters available.")),e}createActionsMenu(){const e=document.createElement("div");e.id="mobile-export-menu",e.className="mobile-options-menu hidden",e.style.backgroundColor="var(--control-bg)";const t=document.createElement("h3");return t.textContent="Actions",t.style.color="var(--text-color)",e.appendChild(t),e.appendChild(B6("No actions available.")),e}openSelectionWindow(e){e&&e.stopPropagation(),this.visualMenu.classList.add("hidden"),this.actionsMenu.classList.add("hidden"),this.selectionWindow&&(this.selectionWindow.update(this.plugins,this.activePluginId),this.selectionWindow.show())}toggleVisualMenu(e){e.stopPropagation(),this.visualMenu.classList.toggle("hidden"),this.actionsMenu.classList.contains("hidden")||this.actionsMenu.classList.add("hidden")}toggleActionsMenu(e){e.stopPropagation(),this.actionsMenu.classList.toggle("hidden"),this.visualMenu.classList.contains("hidden")||this.visualMenu.classList.add("hidden")}handleOutsideClick(e){this.visualMenu.classList.contains("hidden")||this.visualMenu.contains(e.target)||this.optionsButton.contains(e.target)||this.visualMenu.classList.add("hidden"),this.actionsMenu.classList.contains("hidden")||this.actionsMenu.contains(e.target)||this.exportButton.contains(e.target)||this.actionsMenu.classList.add("hidden")}updateParameterGroups(e){this.parameterGroups=e,this.updateHeaderControls(e.structural.schema,e.structural.values),this.updateVisualMenu(e.visual.schema,e.visual.values),this.updateActionsMenu(this.actions),e.advanced.schema&&e.advanced.schema.length>0&&this.addAdvancedParamsToVisualMenu(e.advanced.schema,e.advanced.values)}updateParameterValue(e,t,n){n&&this.parameterGroups[n]&&(this.parameterGroups[n].values[e]=t);let r="".concat(n,"-").concat(e),i=document.getElementById(r);i||(i=document.getElementById(e)),i&&O6(i,t)}updateHeaderControls(e,t){for(;this.header.childNodes.length>0;)this.header.removeChild(this.header.lastChild);e&&0!==e.length?e.forEach((e=>{const n="structural-".concat(e.id),r=F6(this.builder,(0,p6.A)((0,p6.A)({},e),{},{id:n}),t[e.id],(t=>this.handleParameterChange(e.id,t,"structural")));this.header.appendChild(r)})):this.header.appendChild(B6("No structural parameters available."))}updateVisualMenu(e,t){for(;this.visualMenu.childNodes.length>1;)this.visualMenu.removeChild(this.visualMenu.lastChild);e&&0!==e.length?e.forEach((e=>{const n="visual-".concat(e.id),r=F6(this.builder,(0,p6.A)((0,p6.A)({},e),{},{id:n}),t[e.id],(t=>this.handleParameterChange(e.id,t,"visual")));this.visualMenu.appendChild(r)})):this.visualMenu.appendChild(B6("No visual parameters available."))}addAdvancedParamsToVisualMenu(e,t){if(this.visualMenu.childNodes.length>1){const e=document.createElement("hr");e.style.margin="15px 0",e.style.borderTop="1px solid var(--border-color)",this.visualMenu.appendChild(e);const t=document.createElement("h4");t.textContent="Advanced Options",t.style.color="var(--text-color)",t.style.marginTop="10px",this.visualMenu.appendChild(t)}e.forEach((e=>{const n="advanced-".concat(e.id),r=F6(this.builder,(0,p6.A)((0,p6.A)({},e),{},{id:n}),t[e.id],(t=>this.handleParameterChange(e.id,t,"advanced")));this.visualMenu.appendChild(r)}))}updateActions(e){super.updateActions(e),this.updateActionsMenu(e)}updateActionsMenu(e){for(;this.actionsMenu.childNodes.length>1;)this.actionsMenu.removeChild(this.actionsMenu.lastChild);if(!e||0===e.length)return void this.actionsMenu.appendChild(B6("No actions available."));const t=document.createElement("div");t.className="export-buttons",e.forEach((e=>{const n=I6("".concat(e.id,"-mobile"),e.label,(()=>{this.actionsMenu.classList.add("hidden"),this.emit("action",e.id)}));t.appendChild(n)})),this.actionsMenu.appendChild(t)}handleParameterChange(e,t,n){n&&this.parameterGroups[n]&&(this.parameterGroups[n].values[e]=t),this.emit("parameterChange",e,t,n)}updatePlugins(e,t){super.updatePlugins(e,t),this.selectionWindow&&this.selectionWindow.update(e,t),this.updateHeaderTitle(t)}updateHeaderTitle(e){const t=this.plugins.find((t=>t.id===e));t&&this.headerTitle&&(this.headerTitle.textContent=t.name)}dispose(){super.dispose(),this.removeUIElements();const e=document.getElementById("mobile-fullscreen-button");e&&e.parentNode&&e.parentNode.removeChild(e),document.body.classList.remove("mobile-device"),document.body.classList.remove("fullscreen-mode"),console.log("Mobile layout disposed")}}function q6(e){if(!e||!e.background)return;const t=document.documentElement;t.style.setProperty("--background-color",e.background),t.style.setProperty("--text-color",e.text),t.style.setProperty("--accent-color",e.accent),"light"===e.id?(t.style.setProperty("--background-secondary","#ffffff"),t.style.setProperty("--text-secondary","#666666"),t.style.setProperty("--border-color","#e0e0e0"),t.style.setProperty("--control-bg","#ffffff"),t.style.setProperty("--control-border","#cccccc"),t.style.setProperty("--control-active","#e8f0fe"),t.style.setProperty("--control-focus",e.accent),t.style.setProperty("--error-color","#d93025"),t.style.setProperty("--success-color","#0f9d58"),t.style.setProperty("--warning-color","#f29900"),t.style.setProperty("--info-color","#4285f4"),t.style.setProperty("--overlay-bg","rgba(0, 0, 0, 0.7)"),t.style.setProperty("--overlay-light","rgba(0, 0, 0, 0.3)"),t.style.setProperty("--modal-bg","rgba(255, 255, 255, 0.95)")):(t.style.setProperty("--background-secondary","#2a2a2a"),t.style.setProperty("--text-secondary","#b0b0b0"),t.style.setProperty("--border-color","#444444"),t.style.setProperty("--control-bg","#333333"),t.style.setProperty("--control-border","#555555"),t.style.setProperty("--control-active","#3c4043"),t.style.setProperty("--control-focus",e.accent),t.style.setProperty("--error-color","#f28b82"),t.style.setProperty("--success-color","#81c995"),t.style.setProperty("--warning-color","#fdd663"),t.style.setProperty("--info-color","#8ab4f8"),t.style.setProperty("--overlay-bg","rgba(0, 0, 0, 0.8)"),t.style.setProperty("--overlay-light","rgba(0, 0, 0, 0.5)"),t.style.setProperty("--modal-bg","rgba(42, 42, 42, 0.95)")),document.body.setAttribute("data-theme",e.id),function(e){const t=document.querySelector(".mobile-header"),n=document.querySelector(".mobile-header-title"),r=document.querySelector("#mobile-visual-menu"),i=document.querySelector("#mobile-export-menu"),a=document.querySelector("#mobile-plugin-menu"),o=document.querySelector("#mobile-options-button"),s=document.querySelector("#mobile-export-button"),l=document.querySelector("#mobile-plugin-button"),c=document.querySelector("#mobile-plugin-button-icon"),u=document.querySelectorAll(".mobile-options-menu button"),h="light"===e.id?"#ffffff":"#333333",d=e.text,f=e.accent;t&&(t.style.backgroundColor=h,t.style.color=d);n&&(n.style.backgroundColor=h,n.style.color=d);[r,i,a].forEach((e=>{e&&(e.style.backgroundColor=h,e.style.color=d)})),[o,s].forEach((e=>{e&&(e.style.backgroundColor=h,e.style.color=d)})),l&&(l.style.backgroundColor=h);c&&(c.style.backgroundColor=f);u.forEach((e=>{e.style.backgroundColor=f,e.style.color="white"}));document.querySelectorAll(".mobile-header label").forEach((e=>{e.style.color=d}))}(e),function(e){const t=document.querySelector(".selection-window-overlay");if(!t)return;const n=t.querySelector(".selection-window-content");n&&(n.style.backgroundColor="light"===e.id?"#ffffff":"#2a2a2a");t.querySelectorAll(".selection-window-card").forEach((t=>{t.style.backgroundColor=e.background;const n=t.querySelector(".selection-window-card-title");n&&(n.style.color=e.text);const r=t.querySelector(".selection-window-card-description");r&&(r.style.color="light"===e.id?"#666666":"#b0b0b0");const i=t.querySelector(".selection-window-card-image");i&&(i.style.backgroundColor="light"===e.id?"#e8f0fe":"#3c4043",i.style.color=e.accent)}));const r=t.querySelector(".selection-window-header");if(r){r.style.borderBottomColor="light"===e.id?"#e0e0e0":"#444444";const t=r.querySelector(".selection-window-title");t&&(t.style.color=e.text);const n=r.querySelector(".selection-window-close");n&&(n.style.color="light"===e.id?"#666666":"#b0b0b0")}}(e)}class j6 extends N6{constructor(e){super(),this.core=e,this.uiBuilder=new P6,this.layout=null,this.parameterGroups={visual:{schema:[],values:{}},structural:{schema:[],values:{}},advanced:{schema:[],values:{}}},this.initialized=!1,this.isMobile=this._detectMobile(),this.themeToggleButton=null,this.mobileThemeToggleButton=null,this.updateTheme=this.updateTheme.bind(this),this._handleResize=this._handleResize.bind(this)}async initialize(){if(this.initialized)return!0;try{return this.isMobile?this.layout=new G6(this):this.layout=new V6(this),await this.layout.initialize(),this._registerLayoutEvents(),window.addEventListener("resize",this._handleResize),this.core&&this.core.colorSchemeManager&&(this.updateTheme(this.core.colorSchemeManager.getActiveScheme()),this.core.events.on("colorSchemeChanged",this.updateTheme),this.core.events.on("actionsChanged",this.updateActions.bind(this)),this.createThemeToggleButtons()),this.initialized=!0,console.log("UI manager initialized with ".concat(this.isMobile?"mobile":"desktop"," layout")),!0}catch(e){return console.error("Failed to initialize UI manager:",e),!1}}updateParameterGroups(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{if(!e)return void console.warn("Invalid parameter data provided to updateParameterGroups");e.visual&&(this.parameterGroups.visual=e.visual),e.structural&&(this.parameterGroups.structural=e.structural),e.advanced&&(this.parameterGroups.advanced=e.advanced),this.layout&&"function"===typeof this.layout.updateParameterGroups&&this.layout.updateParameterGroups(this.parameterGroups,t)}catch(n){console.error("Failed to update parameter groups:",n)}}updateParameterValue(e,t,n){try{n||(this.parameterGroups.visual.values.hasOwnProperty(e)?n="visual":this.parameterGroups.structural.values.hasOwnProperty(e)?n="structural":this.parameterGroups.advanced.values.hasOwnProperty(e)&&(n="advanced")),n&&this.parameterGroups[n]&&(this.parameterGroups[n].values[e]=t,this.layout&&"function"===typeof this.layout.updateParameterValue&&this.layout.updateParameterValue(e,t,n))}catch(r){console.error("Failed to update parameter value for ".concat(e,":"),r)}}updateActions(e){try{if(!this.layout||"function"!==typeof this.layout.updateActions)return;this.layout.updateActions(e||[])}catch(t){console.error("Failed to update actions:",t)}}updatePlugins(e,t){this.layout&&"function"===typeof this.layout.updatePlugins&&this.layout.updatePlugins(e||[],t)}showError(e){this.layout&&"function"===typeof this.layout.showError?this.layout.showError(e):console.error("UI Error:",e)}showNotification(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;this.layout&&"function"===typeof this.layout.showNotification?this.layout.showNotification(e,t):console.log("UI Notification:",e)}showLoading(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...";this.layout&&"function"===typeof this.layout.showLoading&&this.layout.showLoading(e)}hideLoading(){this.layout&&"function"===typeof this.layout.hideLoading&&this.layout.hideLoading()}_detectMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<768}_handleResize(){const e=this._detectMobile();e!==this.isMobile?(console.log("Layout changing from ".concat(this.isMobile?"mobile":"desktop"," to ").concat(e?"mobile":"desktop")),this._cleanupUI(),this.isMobile=e,this.layout&&this.layout.dispose(),this.isMobile?this.layout=new G6(this):this.layout=new V6(this),this.layout.initialize().then((()=>{this._registerLayoutEvents(),this.layout&&"function"===typeof this.layout.updateParameterGroups&&this.layout.updateParameterGroups(this.parameterGroups,!0),console.log("Layout changed to ".concat(this.isMobile?"mobile":"desktop"))})).catch((e=>{console.error("Failed to initialize new layout:",e)}))):this.layout&&"function"===typeof this.layout.handleResize&&this.layout.handleResize()}_registerLayoutEvents(){var e=this;this.layout&&(this.layout.removeAllListeners(),this.layout.on("parameterChange",((e,t,n)=>{this.emit("parameterChange",e,t,n)})),this.layout.on("action",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.core&&"function"===typeof e.core.executeAction?e.core.executeAction(t,...r):e.emit("action",t,...r)})),this.layout.on("pluginSelect",(e=>{this.core&&"function"===typeof this.core.loadPlugin?this.core.loadPlugin(e):this.emit("pluginSelect",e)})))}_cleanupUI(){document.querySelectorAll(".theme-toggle").forEach((e=>{e.parentNode&&e.parentNode.removeChild(e)}));document.querySelectorAll(".mobile-theme-toggle").forEach((e=>{e.parentNode&&e.parentNode.removeChild(e)}));const e=document.getElementById("desktop-fullscreen-button");e&&e.parentNode&&e.parentNode.removeChild(e);const t=document.getElementById("mobile-fullscreen-button");t&&t.parentNode&&t.parentNode.removeChild(t)}updateTheme(e){e&&(q6(e),this.updateThemeToggleButton(e.id),document.body.setAttribute("data-theme",e.id))}createThemeToggleButtons(){if(!this.core||!this.core.colorSchemeManager)return;this.themeToggleButton&&this.themeToggleButton.parentNode&&(this.themeToggleButton.parentNode.removeChild(this.themeToggleButton),this.themeToggleButton=null),this.mobileThemeToggleButton&&this.mobileThemeToggleButton.parentNode&&(this.mobileThemeToggleButton.parentNode.removeChild(this.mobileThemeToggleButton),this.mobileThemeToggleButton=null),this._cleanupThemeButtons();const e=this.core.colorSchemeManager.getActiveScheme();if(e)if(this.isMobile){const t=document.createElement("button");t.className="mobile-theme-toggle",t.setAttribute("aria-label","Toggle color scheme"),t.textContent="light"===e.id?"\ud83c\udf19":"\u2600\ufe0f",t.addEventListener("click",(()=>{const e="light"===this.core.colorSchemeManager.getActiveScheme().id?"dark":"light";this.core.colorSchemeManager.setActiveScheme(e)})),document.body.appendChild(t),this.mobileThemeToggleButton=t}else{const t=document.createElement("button");t.className="theme-toggle",t.setAttribute("aria-label","Toggle color scheme"),t.textContent="light"===e.id?"\ud83c\udf19":"\u2600\ufe0f",t.addEventListener("click",(()=>{const e="light"===this.core.colorSchemeManager.getActiveScheme().id?"dark":"light";this.core.colorSchemeManager.setActiveScheme(e)})),document.body.appendChild(t),this.themeToggleButton=t}}_cleanupThemeButtons(){document.querySelectorAll(".theme-toggle").forEach((e=>{e.parentNode&&e.parentNode.removeChild(e)}));document.querySelectorAll(".mobile-theme-toggle").forEach((e=>{e.parentNode&&e.parentNode.removeChild(e)}))}updateThemeToggleButton(e){this.themeToggleButton&&(this.themeToggleButton.textContent="light"===e?"\ud83c\udf19":"\u2600\ufe0f"),this.mobileThemeToggleButton&&(this.mobileThemeToggleButton.textContent="light"===e?"\ud83c\udf19":"\u2600\ufe0f")}cleanup(){this._cleanupUI(),window.removeEventListener("resize",this._handleResize),this.core&&this.core.events&&this.core.events.off("colorSchemeChanged",this.updateTheme),this.layout&&(this.layout.dispose(),this.layout=null),this.parameterGroups={visual:{schema:[],values:{}},structural:{schema:[],values:{}},advanced:{schema:[],values:{}}},this.initialized=!1,this.themeToggleButton=null,this.mobileThemeToggleButton=null,console.log("UI manager cleaned up")}}class W6{constructor(e,t){console.log("Creating Canvas2DEnvironment instance"),this.canvas=e,this.core=t,this.initialized=!1,this.active=!1,this.stage=null,this.layer=null,this.konva=null,this.backgroundColor="#f5f5f5",this.originalCanvas=e,this.ctx=null,this.cameraX=0,this.cameraY=0,this.cameraZoom=1,this.requiresContinuousRendering=!0,this._pluginResources=new Map,this.handleResize=this.handleResize.bind(this)}async initialize(){if(this.initialized)return!0;try{if(console.log("Initializing Canvas2DEnvironment..."),window.Konva&&"function"===typeof window.Konva.Stage)this.konva=window.Konva,console.log("Using Konva from window object");else{console.warn("Konva not found on window object, trying direct import");try{const e=await Promise.resolve().then(n.t.bind(n,2157,23));this.konva=e.default||e,console.log("Konva imported directly:",this.konva)}catch(e){throw console.error("Failed to import Konva:",e),new Error("Konva library not available. Ensure it's properly loaded.")}}if(!this.konva||"function"!==typeof this.konva.Stage)throw console.error("Konva structure:",this.konva),new Error("Konva Stage constructor not found. Incompatible Konva version?");let t=this.originalCanvas.parentElement;return t||(console.log("Canvas parent element not found, creating container"),t=document.createElement("div"),t.id="canvas-container",t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.zIndex="0",document.body.appendChild(t),this.originalCanvas.parentNode&&this.originalCanvas.parentNode.removeChild(this.originalCanvas),t.appendChild(this.originalCanvas),console.log("Created container for canvas:",t)),this.originalCanvas.style.display="none",this.stage=new this.konva.Stage({container:t,width:t.clientWidth||window.innerWidth,height:t.clientHeight||window.innerHeight}),0!==this.stage.width()&&0!==this.stage.height()||(console.warn("Container has zero dimensions, using window size instead"),this.stage.width(window.innerWidth),this.stage.height(window.innerHeight)),this.layer=new this.konva.Layer,this.stage.add(this.layer),this.stage.container().style.backgroundColor=this.backgroundColor,this.ctx=this.originalCanvas.getContext("2d"),this._setupEventForwarding(),this._setupAutomaticCameraControls(),this.initialized=!0,console.log("Canvas2DEnvironment initialized successfully"),!0}catch(t){return console.error("Failed to initialize Canvas2DEnvironment:",t),!1}}activate(){if(this.active)return!0;if(!this.initialized)return console.error("Cannot activate uninitialized 2D environment"),!1;try{return console.log("Activating Canvas2DEnvironment..."),this.stage&&(this.stage.container().style.display="block"),this.originalCanvas.style.display="none",this.handleResize(),this.active=!0,console.log("Canvas2DEnvironment activated"),!0}catch(e){return console.error("Error activating Canvas2DEnvironment:",e),!1}}deactivate(){if(!this.active)return!0;try{return console.log("Deactivating Canvas2DEnvironment..."),this.stage&&(this.stage.container().style.display="none"),this.originalCanvas.style.display="block",this.active=!1,console.log("Canvas2DEnvironment deactivated"),!0}catch(e){return console.error("Error deactivating Canvas2DEnvironment:",e),!1}}handleResize(){if(this.stage)try{const e=this.stage.container(),t=e.clientWidth,n=e.clientHeight;console.log("Resizing Konva stage to ".concat(t,"x").concat(n)),this.stage.width(t),this.stage.height(n),this.originalCanvas.width=t,this.originalCanvas.height=n,this.layer.batchDraw()}catch(e){console.error("Error handling resize in Canvas2DEnvironment:",e)}}_setupEventForwarding(){if(!this.stage)return;["mousedown","mouseup","mousemove","mouseover","mouseout","click","dblclick","contextmenu","touchstart","touchend","touchmove","wheel","dragstart","dragmove","dragend"].forEach((e=>{this.stage.on(e,(t=>{const n=this.core.getActivePlugin();if(n&&"function"===typeof n.handleInteraction){const r=(0,p6.A)({x:t.evt.offsetX,y:t.evt.offsetY,target:t.target,evt:t.evt},this._getEventSpecificData(e,t));n.handleInteraction(e,r)}}))}))}_getEventSpecificData(e,t){switch(e){case"wheel":return{deltaY:t.evt.deltaY,deltaX:t.evt.deltaX,deltaZ:t.evt.deltaZ,deltaMode:t.evt.deltaMode};case"mousedown":case"mouseup":case"click":return{button:t.evt.button,buttons:t.evt.buttons};case"dragstart":case"dragmove":case"dragend":return{dragTarget:t.target};case"touchstart":case"touchmove":case"touchend":return{touches:t.evt.touches,changedTouches:t.evt.changedTouches};default:return{}}}updateBackgroundColor(e){e&&e.background&&(this.backgroundColor=e.background,this.stage&&(this.stage.container().style.backgroundColor=this.backgroundColor))}panCamera(e,t){this.layer&&(this.cameraX+=e,this.cameraY+=t,this.layer.position({x:this.cameraX,y:this.cameraY}),this.layer.batchDraw())}zoomCamera(e,t,n){if(!this.layer)return;const r=this.cameraZoom,i=r*e;if(i<.1||i>10)return;const a=(t-this.cameraX)/r,o=(n-this.cameraY)/r;this.cameraX=t-a*i,this.cameraY=n-o*i,this.cameraZoom=i,this.layer.scale({x:i,y:i}),this.layer.position({x:this.cameraX,y:this.cameraY}),this.layer.batchDraw()}resetCamera(){this.layer&&(this.cameraX=0,this.cameraY=0,this.cameraZoom=1,this.layer.position({x:0,y:0}),this.layer.scale({x:1,y:1}),this.layer.batchDraw())}clearLayer(){this.layer&&(this.layer.destroyChildren(),this.layer.batchDraw())}_setupAutomaticCameraControls(){if(!this.stage)return;this.automaticCameraControls=!0;let e=!1,t={x:0,y:0};this.stage.on("mousedown touchstart",(n=>{this.automaticCameraControls&&("mousedown"===n.evt.type&&1!==n.evt.button||(e=!0,t={x:n.evt.offsetX||(n.evt.touches&&n.evt.touches[0]?n.evt.touches[0].clientX:0),y:n.evt.offsetY||(n.evt.touches&&n.evt.touches[0]?n.evt.touches[0].clientY:0)}))})),this.stage.on("mousemove touchmove",(n=>{if(!this.automaticCameraControls||!e)return;const r={x:n.evt.offsetX||(n.evt.touches&&n.evt.touches[0]?n.evt.touches[0].clientX:t.x),y:n.evt.offsetY||(n.evt.touches&&n.evt.touches[0]?n.evt.touches[0].clientY:t.y)},i=r.x-t.x,a=r.y-t.y;this.panCamera(i,a),t=r})),this.stage.on("mouseup touchend",(()=>{e=!1})),this.stage.on("wheel",(e=>{if(!this.automaticCameraControls)return;e.evt.preventDefault();const t=e.evt.deltaY>0?.9:1.1;this.zoomCamera(t,e.evt.offsetX,e.evt.offsetY)}))}setAutomaticCameraControls(e){this.automaticCameraControls=!!e}prepareRender(e){return e.save(),e.translate(this.cameraX,this.cameraY),e.scale(this.cameraZoom,this.cameraZoom),e}completeRender(e){e.restore()}registerAnimation(e,t){if(!e||!t)return;this._pluginResources.has(e)||this._pluginResources.set(e,{animations:[],eventHandlers:[],tweens:[],shapes:[]});this._pluginResources.get(e).animations.push(t)}registerEventHandler(e,t,n,r){if(!e||!t||!n||!r)return;this._pluginResources.has(e)||this._pluginResources.set(e,{animations:[],eventHandlers:[],tweens:[],shapes:[]});this._pluginResources.get(e).eventHandlers.push({obj:t,eventType:n,handler:r})}registerTween(e,t){if(!e||!t)return;this._pluginResources.has(e)||this._pluginResources.set(e,{animations:[],eventHandlers:[],tweens:[],shapes:[]});this._pluginResources.get(e).tweens.push(t)}registerShape(e,t){if(!e||!t)return;this._pluginResources.has(e)||this._pluginResources.set(e,{animations:[],eventHandlers:[],tweens:[],shapes:[]});this._pluginResources.get(e).shapes.push(t)}cleanupPluginResources(e){if(!e||!this._pluginResources.has(e))return;const t=this._pluginResources.get(e);t.animations.forEach((e=>{e&&"function"===typeof e.stop&&e.stop()})),t.eventHandlers.forEach((e=>{let{obj:t,eventType:n,handler:r}=e;t&&"function"===typeof t.off&&t.off(n,r)})),t.tweens.forEach((e=>{e&&"function"===typeof e.destroy&&e.destroy()})),t.shapes.forEach((e=>{e&&e.destroy()})),this._pluginResources.delete(e),this.layer&&this.layer.batchDraw()}renderWelcomeMessage(){if(this.clearLayer(),!this.stage||!this.konva)return;const e=this.stage.width(),t=this.stage.height(),n=new this.konva.Text({x:e/2,y:t/2-20,text:"Select a Plugin",fontSize:30,fontFamily:"sans-serif",fill:"#f5f5f5"===this.backgroundColor?"#333333":"#f0f0f0",align:"center",verticalAlign:"middle"});n.offsetX(n.width()/2);const r=new this.konva.Text({x:e/2,y:t/2+20,text:"Click the plugin button to choose a visualization",fontSize:16,fontFamily:"sans-serif",fill:"#f5f5f5"===this.backgroundColor?"#666666":"#cccccc",align:"center",verticalAlign:"middle"});r.offsetX(r.width()/2),this.layer.add(n),this.layer.add(r),this.layer.batchDraw()}getStage(){return this.stage}getLayer(){return this.layer}getContext(){return this.ctx}getCanvas(){return this.originalCanvas}dispose(){console.log("Disposing Canvas2DEnvironment..."),this._pluginResources.forEach(((e,t)=>{this.cleanupPluginResources(t)})),this._pluginResources.clear(),this.stage&&(this.stage.destroy(),this.stage=null),this.originalCanvas&&(this.originalCanvas.style.display="block"),this.layer=null,this.initialized=!1,this.active=!1,console.log("Canvas2DEnvironment disposed")}}var X6=n(9435);class Y6{constructor(e,t){this.canvas=e,this.core=t,this.initialized=!1,this.active=!1,this.scene=null,this.camera=null,this.renderer=null,this.controls=null,this.clock=null,this.threeCanvas=null,this.requiresContinuousRendering=!0,this._animationLoopRunning=!1,this.backgroundColor="#f5f5f5",this.lastRenderMode=null,this.lastOpacity=null,this.lastColorPalette=null,this.handleResize=this.handleResize.bind(this),this._onCanvasEvent=this._onCanvasEvent.bind(this)}async initialize(){if(this.initialized)return!0;try{te.install({THREE:i});const e=document.getElementById("three-js-canvas");e&&e.parentElement.removeChild(e),this.threeCanvas=document.createElement("canvas"),this.threeCanvas.id="three-js-canvas",this.threeCanvas.style.position="absolute",this.threeCanvas.style.top="0",this.threeCanvas.style.left="0",this.threeCanvas.style.width="100%",this.threeCanvas.style.height="100%",this.threeCanvas.style.zIndex="0",this.threeCanvas.style.pointerEvents="auto",this.canvas.parentElement?this.canvas.parentElement.appendChild(this.threeCanvas):document.body.appendChild(this.threeCanvas);const t=this.threeCanvas.parentElement,n=t.clientWidth,r=t.clientHeight;if(this.core&&this.core.colorSchemeManager){const e=this.core.colorSchemeManager.getActiveScheme();e&&e.background&&(this.backgroundColor=e.background)}return this.scene=new X6.Z58,this.scene.background=new X6.Q1f(this.backgroundColor),this.camera=new X6.ubm(75,n/r,.1,1e3),this.camera.position.set(0,1,5),this.camera.lookAt(0,0,0),this.renderer=new i.WebGLRenderer({canvas:this.threeCanvas,antialias:!0,alpha:!0}),this.renderer.setSize(n,r,!1),this.renderer.setPixelRatio(window.devicePixelRatio),this.clock=new X6.zD7,this._setupLighting(),this._setupEventListeners(),this.threeCanvas.style.display="none",this.initialized=!0,!0}catch(e){return!1}}activate(){if(this.active)return!0;if(!this.initialized)return!1;if(this.threeCanvas){this.threeCanvas.style.display="block";const e=this.threeCanvas.parentElement;if(e){const t=e.clientWidth,n=e.clientHeight;this.camera&&(this.camera.aspect=t/n,this.camera.updateProjectionMatrix()),this.renderer&&this.renderer.setSize(t,n,!1)}}return this.canvas&&(this.canvas.style.display="none"),this.initializeCameraControls(),this._startAnimationLoop(),this.active=!0,this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera),!0}_setupEventListeners(){if(!this.threeCanvas)return;["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","wheel"].forEach((e=>{this.threeCanvas.addEventListener(e,this._onCanvasEvent,{passive:!1})}))}_onCanvasEvent(e){"wheel"===e.type&&e.preventDefault()}_startAnimationLoop(){if(this._animationLoopRunning)return;this._animationLoopRunning=!0,this.clock.start();const e=()=>{if(this._animationLoopRunning){if(requestAnimationFrame(e),this.controls){const e=this.clock.getDelta();this.controls.update(e)}this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera)}};e()}_stopAnimationLoop(){this._animationLoopRunning=!1}deactivate(){return!this.active||(this._stopAnimationLoop(),this.threeCanvas&&(this.threeCanvas.style.display="none"),this.canvas&&(this.canvas.style.display="block"),this.controls&&"function"===typeof this.controls.dispose&&(this.controls.dispose(),this.controls=null),this.active=!1,!0)}handleResize(){if(!this.initialized||!this.renderer||!this.camera||!this.threeCanvas)return;const e=this.threeCanvas.parentElement,t=e.clientWidth,n=e.clientHeight;this.camera.aspect=t/n,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,n,!1),this.renderer.setPixelRatio(window.devicePixelRatio)}updateBackgroundColor(e){e&&e.background&&(this.backgroundColor=e.background,this.scene&&(this.scene.background=new X6.Q1f(this.backgroundColor)))}render(e){if(!this.active||!this.renderer||!this.scene||!this.camera)return;const t=this.core.getActivePlugin?this.core.getActivePlugin():null;if(e.renderMode&&this.core&&this.core.renderModeManager&&t){const n=t.meshGroup||(t.state?t.state.meshGroup:null);if(n){const t=this.lastRenderMode!==e.renderMode,r=this.lastOpacity!==e.opacity,i=this.lastColorPalette!==e.colorPalette;(t||r||i||!this.renderedOnce)&&(this.core.renderModeManager.applyRenderMode(this.scene,n,e.renderMode,{opacity:e.opacity,colorPalette:this.core.colorSchemeManager.getPalette(e.colorPalette||"default")}),this.lastRenderMode=e.renderMode,this.lastOpacity=e.opacity,this.lastColorPalette=e.colorPalette,this.renderedOnce=!0)}}this.renderer.render(this.scene,this.camera)}initializeCameraControls(){if(!this.camera||!this.renderer)return!1;this.controls=new te(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.mouseButtons&&(this.controls.mouseButtons.left=te.ACTION.ROTATE,this.controls.mouseButtons.middle=te.ACTION.DOLLY,this.controls.mouseButtons.right=te.ACTION.OFFSET),this.controls.touches&&(this.controls.touches.one=te.ACTION.TOUCH_ROTATE,this.controls.touches.two=te.ACTION.TOUCH_DOLLY,this.controls.touches.three=te.ACTION.TOUCH_OFFSET),this.controls.minPolarAngle=-1/0,this.controls.maxPolarAngle=1/0;const e=[0,0,0];return this.controls.setPosition(e[0],e[1],e[2]+5,!1),this.controls.setLookAt(e[0],e[1],e[2]+5,e[0],e[1],e[2],!0),"function"===typeof this.controls.rotate&&this.controls.rotate(Math.PI/7,-Math.PI/6,!0),!0}_setupLighting(){const e=new X6.$p8(4210752,1.5);this.scene.add(e);const t=new X6.ZyN(16777215,.8);t.position.set(1,2,3),this.scene.add(t)}clearScene(){if(this.scene)for(;this.scene.children.length>0;){const e=this.scene.children[0];e.geometry&&e.geometry.dispose(),e.material&&(Array.isArray(e.material)?e.material.forEach((e=>e.dispose())):e.material.dispose()),this.scene.remove(e)}}dispose(){if(this._stopAnimationLoop(),this.deactivate(),this.threeCanvas){["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","wheel"].forEach((e=>{this.threeCanvas.removeEventListener(e,this._onCanvasEvent)}))}this.scene&&this.clearScene(),this.renderer&&(this.renderer.dispose(),this.renderer.forceContextLoss(),this.renderer.domElement=null,this.renderer=null),this.controls&&"function"===typeof this.controls.dispose&&(this.controls.dispose(),this.controls=null),this.threeCanvas&&this.threeCanvas.parentElement&&(this.threeCanvas.parentElement.removeChild(this.threeCanvas),this.threeCanvas=null),this.scene=null,this.camera=null,this.clock=null,this.initialized=!1,this.active=!1,this.canvas&&(this.canvas.style.display="block")}getScene(){return this.scene}getCamera(){return this.camera}getRenderer(){return this.renderer}getControls(){return this.controls}}class Z6{constructor(e){this.core=e,this.canvas=null,this.environments={"2d":null,"3d":null},this.currentEnvironment=null,this.handleResize=this.handleResize.bind(this),this.updateBackgroundColors=this.updateBackgroundColors.bind(this)}async initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"visualization-canvas";try{if(console.log("Initializing EnvironmentManager..."),this.canvas=document.getElementById(e),this.canvas||(console.log("Canvas with id ".concat(e," not found, creating new one")),this.canvas=document.createElement("canvas"),this.canvas.id=e,document.body.appendChild(this.canvas)),this.resizeCanvas(),this.environments["2d"]=new W6(this.canvas,this.core),this.environments["3d"]=new Y6(this.canvas,this.core),await this.setEnvironment("2d"),window.addEventListener("resize",this.handleResize),this.core&&this.core.events&&this.core.colorSchemeManager){this.core.events.on("colorSchemeChanged",this.updateBackgroundColors);const e=this.core.colorSchemeManager.getActiveScheme();e&&this.updateBackgroundColors(e)}return console.log("EnvironmentManager initialized successfully"),!0}catch(t){return console.error("Failed to initialize environment manager:",t),!1}}async setEnvironment(e){if("2d"!==e&&"3d"!==e)return console.error("Invalid environment type: ".concat(e)),!1;try{if(console.log("Setting environment to ".concat(e,"...")),this.currentEnvironment){try{console.log("Disposing current environment"),this.currentEnvironment.dispose()}catch(t){console.error("Error disposing current environment:",t)}this.currentEnvironment=null,await new Promise((e=>setTimeout(e,50)))}if(this.environments[e].initialized||(console.log("Initializing ".concat(e," environment")),await this.environments[e].initialize()),console.log("Activating ".concat(e," environment")),this.currentEnvironment=this.environments[e],await this.currentEnvironment.activate(),this.resizeCanvas(),this.currentEnvironment.handleResize(),this.core&&this.core.colorSchemeManager){const e=this.core.colorSchemeManager.getActiveScheme();e&&this.currentEnvironment&&"function"===typeof this.currentEnvironment.updateBackgroundColor&&this.currentEnvironment.updateBackgroundColor(e)}return console.log("Environment set to ".concat(e," successfully")),!0}catch(n){return console.error("Error setting environment to ".concat(e,":"),n),!1}}resizeCanvas(){if(!this.canvas)return;const e=this.canvas.parentElement||document.body,{width:t,height:n}=e.getBoundingClientRect();this.canvas.width===t&&this.canvas.height===n||(console.log("Resizing main canvas to ".concat(t,"x").concat(n)),this.canvas.width=t,this.canvas.height=n)}handleResize(){this.resizeCanvas(),this.currentEnvironment&&(console.log("Handling resize for ".concat(this.currentEnvironment===this.environments["2d"]?"2D":"3D"," environment")),this.currentEnvironment.handleResize())}updateBackgroundColors(e){e&&(console.log("Updating rendering background colors to match theme: ".concat(e.id)),Object.values(this.environments).forEach((t=>{t&&"function"===typeof t.updateBackgroundColor&&t.updateBackgroundColor(e)})))}getEnvironmentForPlugin(){return this.currentEnvironment===this.environments["2d"]?{type:"2d",konva:this.currentEnvironment.konva,stage:this.currentEnvironment.stage,layer:this.currentEnvironment.layer,panCamera:(e,t)=>this.currentEnvironment.panCamera(e,t),zoomCamera:(e,t,n)=>this.currentEnvironment.zoomCamera(e,t,n),resetCamera:()=>this.currentEnvironment.resetCamera(),setAutomaticCameraControls:e=>this.currentEnvironment.setAutomaticCameraControls(e),context:this.currentEnvironment.ctx,canvas:this.canvas,prepareRender:e=>this.currentEnvironment.prepareRender(e),completeRender:e=>this.currentEnvironment.completeRender(e)}:{type:"3d",scene:this.currentEnvironment.getScene(),camera:this.currentEnvironment.getCamera(),renderer:this.currentEnvironment.getRenderer(),controls:this.currentEnvironment.getControls(),THREE:window.THREE,resetCamera:()=>{const e=this.currentEnvironment.getControls();e&&"function"===typeof e.reset&&e.reset()}}}renderWithCurrentEnvironment(e,t){this.currentEnvironment&&(e?this.currentEnvironment===this.environments["2d"]||this.currentEnvironment===this.environments["3d"]&&"function"===typeof this.currentEnvironment.render&&this.currentEnvironment.render(t):this.renderWelcomeMessage())}renderWelcomeMessage(){if(this.currentEnvironment&&this.canvas)if(this.environments["2d"]===this.currentEnvironment){const e=this.currentEnvironment.getContext();if(!e)return;e.fillStyle=this.currentEnvironment.backgroundColor||"#f5f5f5",e.fillRect(0,0,this.canvas.width,this.canvas.height);const t=this.canvas.width/2,n=this.canvas.height/2;let r="#333333";if(this.core&&this.core.colorSchemeManager){const e=this.core.colorSchemeManager.getActiveScheme();e&&e.text&&(r=e.text)}else{const e=getComputedStyle(document.body).getPropertyValue("--text-color");e&&(r=e)}e.font="30px sans-serif",e.fillStyle=r,e.textAlign="center",e.textBaseline="middle",e.fillText("Select a Plugin",t,n-20),e.font="16px sans-serif",e.fillText("Click the plugin button to choose a visualization",t,n+20)}else this.environments["3d"]===this.currentEnvironment&&this.currentEnvironment.scene&&this.currentEnvironment.renderer&&this.currentEnvironment.camera&&(this.currentEnvironment.clearScene(),this.currentEnvironment.renderer.render(this.currentEnvironment.scene,this.currentEnvironment.camera))}getCanvas(){return this.canvas}getCurrentEnvironment(){return this.currentEnvironment}exportAsPNG(){if(!this.canvas)return!1;const e=this.core.getActivePlugin(),t=e?"".concat(e.id||"visualization","-").concat(Date.now(),".png"):"visualization-".concat(Date.now(),".png");try{const e=document.createElement("a");let n;if(e.download=t,this.currentEnvironment&&this.currentEnvironment.getRenderer&&"function"===typeof this.currentEnvironment.getRenderer){const e=this.currentEnvironment.getRenderer();e&&(e.render&&this.currentEnvironment.getScene&&this.currentEnvironment.getCamera&&e.render(this.currentEnvironment.getScene(),this.currentEnvironment.getCamera()),n=e.domElement.toDataURL("image/png"))}return n||(n=this.canvas.toDataURL("image/png")),e.href=n,e.click(),console.log("Exported visualization as ".concat(t)),!0}catch(n){return console.error("Error exporting as PNG:",n),this.core&&this.core.uiManager&&this.core.uiManager.showError("Failed to export as PNG: ".concat(n.message)),!1}}cleanup(){if(this.currentEnvironment){try{this.currentEnvironment.dispose()}catch(e){console.error("Error disposing current environment during cleanup:",e)}this.currentEnvironment=null}Object.keys(this.environments).forEach((t=>{if(this.environments[t]){try{this.environments[t].dispose()}catch(e){console.error("Error disposing ".concat(t," environment during cleanup:"),e)}this.environments[t]=null}})),window.removeEventListener("resize",this.handleResize),this.core&&this.core.events&&this.core.events.off("colorSchemeChanged",this.updateBackgroundColors),this.canvas=null,this.environments={"2d":null,"3d":null},console.log("Environment manager cleaned up")}}class K6{constructor(e){this.core=e,this.animating=!1,this.animationId=null,this.lastFrameTime=0,this.frameDelta=0,this.fpsHistory=[],this.averageFps=60,this.frameCount=0,this.lastFpsUpdate=0,this.displayFps=60,this.animationQueue=new Set,this.singleFrameQueue=new Set,this.debug=!1,this.animate=this.animate.bind(this),this.requestAnimation=this.requestAnimation.bind(this),this.cancelAnimation=this.cancelAnimation.bind(this),this.requestFrame=this.requestFrame.bind(this)}async initialize(){try{return console.log("Initializing AnimationManager..."),this.debug&&(window.animationManager=this),console.log("AnimationManager initialized successfully"),!0}catch(e){return console.error("Failed to initialize animation manager:",e),!1}}_startAnimationLoop(){this.animating||(this.animating=!0,this.lastFrameTime=performance.now(),this.animationId=requestAnimationFrame(this.animate),this.debug&&console.log("Animation loop started"))}_stopAnimationLoop(){this.animating&&(cancelAnimationFrame(this.animationId),this.animationId=null,this.animating=!1,this.debug&&console.log("Animation loop stopped"))}animate(e){const t=(e-this.lastFrameTime)/1e3;this.lastFrameTime=e,this.frameDelta=t,this._updateFpsStats(e,t);let n=!1;for(const s of this.animationQueue)try{if("function"===typeof s){!1===s(t)?this.animationQueue.delete(s):n=!0}}catch(o){console.error("Error in animation callback:",o),this.animationQueue.delete(s)}for(const s of this.singleFrameQueue)try{"function"===typeof s&&s(t)}catch(o){console.error("Error in single frame callback:",o)}this.singleFrameQueue.clear(),n||this.singleFrameQueue.size>0?this.animationId=requestAnimationFrame(this.animate):this._stopAnimationLoop();const r=this.core.getActivePlugin?this.core.getActivePlugin():null;if(r){var i,a;const e=null===(i=this.core.environmentManager)||void 0===i?void 0:i.getCurrentEnvironment();if(e&&e===(null===(a=this.core.environmentManager)||void 0===a?void 0:a.environments["3d"])){if("function"===typeof e.render){const t=this.core.getAllParameters?this.core.getAllParameters():{};e.render(t)}}else"function"===typeof r.render&&r.render()}}_updateFpsStats(e,t){this.frameCount++;const n=1/t;this.fpsHistory.push(n),this.fpsHistory.length>60&&this.fpsHistory.shift(),this.averageFps=this.fpsHistory.reduce(((e,t)=>e+t),0)/this.fpsHistory.length,e-this.lastFpsUpdate>1e3&&(this.displayFps=Math.round(this.averageFps),this.lastFpsUpdate=e,this.frameCount=0)}requestAnimation(e){return"function"!==typeof e?(console.error("Animation callback must be a function"),null):(this.animationQueue.add(e),this.animating||this._startAnimationLoop(),e)}cancelAnimation(e){this.animationQueue.has(e)&&(this.animationQueue.delete(e),this.debug&&console.log("Animation cancelled"),0===this.animationQueue.size&&0===this.singleFrameQueue.size&&this._stopAnimationLoop())}requestFrame(e){"function"===typeof e?(this.singleFrameQueue.add(e),this.animating||this._startAnimationLoop()):console.error("Frame callback must be a function")}getFps(){return this.displayFps}getDeltaTime(){return this.frameDelta}isAnimating(){return this.animating}getActiveAnimationCount(){return this.animationQueue.size}setDebugMode(e){this.debug=!!e,this.debug?window.animationManager=this:window.animationManager===this&&delete window.animationManager}cleanup(){this.animating&&(cancelAnimationFrame(this.animationId),this.animationId=null,this.animating=!1),this.animationQueue.clear(),this.singleFrameQueue.clear(),this.fpsHistory=[],this.averageFps=60,this.frameCount=0,this.lastFpsUpdate=0,this.displayFps=60,window.animationManager===this&&delete window.animationManager,console.log("Animation manager cleaned up")}}const Q6={light:{id:"light",name:"Light Theme",background:"#f5f5f5",text:"#333333",accent:"#1a73e8",palettes:{default:{name:"Default",structural:{grid:"#cccccc",weak:"#dddddd",strong:"#333333",guide:"#999999",highlight:"#ff0000"},main:["#4285f4","#ea4335","#fbbc04","#34a853","#673ab7","#ff6d00"],functional:{positive:"#34a853",negative:"#ea4335",neutral:"#fbbc04",selected:"#4285f4",interactive:"#1a73e8"}},pastel:{name:"Pastel",structural:{grid:"#dddddd",weak:"#eeeeee",strong:"#999999",guide:"#bbbbbb",highlight:"#ff9999"},main:["#8ab4f8","#f28b82","#fdd663","#81c995","#b39ddb","#ffa726"],functional:{positive:"#81c995",negative:"#f28b82",neutral:"#fdd663",selected:"#8ab4f8",interactive:"#b39ddb"}},blues:{name:"Blues",structural:{grid:"#d0d0d0",weak:"#e0e0e0",strong:"#707070",guide:"#a0a0a0",highlight:"#ff4444"},main:["#0d47a1","#1565c0","#1976d2","#1e88e5","#2196f3","#42a5f5","#64b5f6","#90caf9"],functional:{positive:"#64b5f6",negative:"#0d47a1",neutral:"#1976d2",selected:"#42a5f5",interactive:"#1e88e5"}},greens:{name:"Greens",structural:{grid:"#d0d0d0",weak:"#e0e0e0",strong:"#707070",guide:"#a0a0a0",highlight:"#ff4444"},main:["#1b5e20","#2e7d32","#388e3c","#43a047","#4caf50","#66bb6a","#81c784","#a5d6a7"],functional:{positive:"#81c784",negative:"#1b5e20",neutral:"#388e3c",selected:"#4caf50",interactive:"#43a047"}},reds:{name:"Reds",structural:{grid:"#d0d0d0",weak:"#e0e0e0",strong:"#707070",guide:"#a0a0a0",highlight:"#0044ff"},main:["#b71c1c","#c62828","#d32f2f","#e53935","#f44336","#ef5350","#e57373","#ef9a9a"],functional:{positive:"#ef9a9a",negative:"#b71c1c",neutral:"#d32f2f",selected:"#f44336",interactive:"#e53935"}},rainbow:{name:"Rainbow",structural:{grid:"#cccccc",weak:"#dddddd",strong:"#333333",guide:"#999999",highlight:"#ff0000"},main:["#ff0000","#ff7f00","#ffff00","#00ff00","#0000ff","#4b0082","#9400d3"],functional:{positive:"#00ff00",negative:"#ff0000",neutral:"#ffff00",selected:"#0000ff",interactive:"#9400d3"}},sequential:{name:"Sequential",structural:{grid:"#cccccc",weak:"#dddddd",strong:"#333333",guide:"#999999",highlight:"#ff0000"},main:["#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],functional:{positive:"#9ecae1",negative:"#084594",neutral:"#6baed6",selected:"#4292c6",interactive:"#2171b5"}},diverging:{name:"Diverging",structural:{grid:"#cccccc",weak:"#dddddd",strong:"#333333",guide:"#999999",highlight:"#ff0000"},main:["#2166ac","#67a9cf","#d1e5f0","#f7f7f7","#fddbc7","#ef8a62","#b2182b"],functional:{positive:"#2166ac",negative:"#b2182b",neutral:"#f7f7f7",selected:"#67a9cf",interactive:"#ef8a62"}}}},dark:{id:"dark",name:"Dark Theme",background:"#1a1a1a",text:"#f0f0f0",accent:"#8ab4f8",palettes:{default:{name:"Default",structural:{grid:"#444444",weak:"#333333",strong:"#bbbbbb",guide:"#777777",highlight:"#ff5555"},main:["#8ab4f8","#f08080","#ffe082","#a5d6a7","#ce93d8","#ffab91"],functional:{positive:"#a5d6a7",negative:"#f08080",neutral:"#ffe082",selected:"#8ab4f8",interactive:"#ce93d8"}},pastel:{name:"Pastel",structural:{grid:"#333333",weak:"#222222",strong:"#aaaaaa",guide:"#666666",highlight:"#ff9999"},main:["#4285f4","#ea4335","#fbbc04","#34a853","#673ab7","#ff6d00"],functional:{positive:"#34a853",negative:"#ea4335",neutral:"#fbbc04",selected:"#4285f4",interactive:"#673ab7"}},blues:{name:"Blues",structural:{grid:"#444444",weak:"#333333",strong:"#aaaaaa",guide:"#777777",highlight:"#ff5555"},main:["#90caf9","#64b5f6","#42a5f5","#2196f3","#1e88e5","#1976d2","#1565c0","#0d47a1"],functional:{positive:"#64b5f6",negative:"#0d47a1",neutral:"#1976d2",selected:"#42a5f5",interactive:"#1e88e5"}},greens:{name:"Greens",structural:{grid:"#444444",weak:"#333333",strong:"#aaaaaa",guide:"#777777",highlight:"#ff5555"},main:["#a5d6a7","#81c784","#66bb6a","#4caf50","#43a047","#388e3c","#2e7d32","#1b5e20"],functional:{positive:"#81c784",negative:"#1b5e20",neutral:"#388e3c",selected:"#4caf50",interactive:"#43a047"}},reds:{name:"Reds",structural:{grid:"#444444",weak:"#333333",strong:"#aaaaaa",guide:"#777777",highlight:"#5555ff"},main:["#ef9a9a","#e57373","#ef5350","#f44336","#e53935","#d32f2f","#c62828","#b71c1c"],functional:{positive:"#ef9a9a",negative:"#b71c1c",neutral:"#d32f2f",selected:"#f44336",interactive:"#e53935"}},rainbow:{name:"Rainbow",structural:{grid:"#444444",weak:"#333333",strong:"#bbbbbb",guide:"#777777",highlight:"#ff5555"},main:["#ff5252","#ff7b25","#ffd740","#9ccc65","#4fc3f7","#7e57c2","#ec407a"],functional:{positive:"#9ccc65",negative:"#ff5252",neutral:"#ffd740",selected:"#4fc3f7",interactive:"#7e57c2"}},sequential:{name:"Sequential",structural:{grid:"#444444",weak:"#333333",strong:"#bbbbbb",guide:"#777777",highlight:"#ff5555"},main:["#084594","#2171b5","#4292c6","#6baed6","#9ecae1","#c6dbef"],functional:{positive:"#9ecae1",negative:"#084594",neutral:"#6baed6",selected:"#4292c6",interactive:"#2171b5"}},diverging:{name:"Diverging",structural:{grid:"#444444",weak:"#333333",strong:"#bbbbbb",guide:"#777777",highlight:"#ff5555"},main:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],functional:{positive:"#2166ac",negative:"#b2182b",neutral:"#f7f7f7",selected:"#67a9cf",interactive:"#ef8a62"}}}}};class J6{constructor(e){this.core=e,this.activeScheme="light",this.schemes=Q6,this.eventListeners=[]}async initialize(){try{if(this.core&&this.core.state){const e=this.core.state.get("colorScheme");e&&this.schemes[e]?(this.activeScheme=e,console.log("Using color scheme from state: ".concat(this.activeScheme))):this.core.state.set("colorScheme",this.activeScheme)}try{const e=localStorage.getItem("activeColorScheme");e&&this.schemes[e]&&(this.activeScheme=e,this.core&&this.core.state&&this.core.state.set("colorScheme",this.activeScheme),console.log("Using color scheme from localStorage: ".concat(this.activeScheme)))}catch(e){console.warn("Could not access localStorage for color scheme:",e)}return this._setupSystemThemeListener(),console.log("ColorSchemeManager initialized with scheme: ".concat(this.activeScheme)),!0}catch(t){return console.error("Failed to initialize ColorSchemeManager:",t),!1}}_setupSystemThemeListener(){if(window.matchMedia){const e=window.matchMedia("(prefers-color-scheme: dark)"),t=e=>{if(!localStorage.getItem("activeColorScheme")){const t=e.matches?"dark":"light";this.schemes[t]&&this.activeScheme!==t&&(console.log("System theme changed to ".concat(t,", updating color scheme")),this.setActiveScheme(t))}};e.matches&&"light"===this.activeScheme&&!localStorage.getItem("activeColorScheme")&&this.setActiveScheme("dark"),"function"===typeof e.addEventListener?(e.addEventListener("change",t),this.eventListeners.push({target:e,type:"change",handler:t})):"function"===typeof e.addListener&&(e.addListener(t),this.eventListeners.push({target:e,type:"addListener",handler:t}))}}getSchemes(){return Object.values(this.schemes).map((e=>({id:e.id,name:e.name})))}getActiveScheme(){return this.schemes[this.activeScheme]}getBackgroundColor(){return this.schemes[this.activeScheme].background}getTextColor(){return this.schemes[this.activeScheme].text}getAccentColor(){return this.schemes[this.activeScheme].accent}getPaletteNames(){const e=this.getActiveScheme();return e&&e.palettes?Object.values(e.palettes).map((e=>e.name||e.id)):[]}getPaletteInfo(){const e=this.getActiveScheme();return e&&e.palettes?Object.entries(e.palettes).map((e=>{let[t,n]=e;return{id:t,name:n.name||t}})):[]}getCurrentPaletteName(){return this.core&&this.core.state?this.core.state.get("currentPalette","default"):"default"}setCurrentPalette(e){const t=this.getActiveScheme();return!(!t||!t.palettes[e])&&(!(!this.core||!this.core.state)&&(this.core.state.set("currentPalette",e),this.core.events&&this.core.events.emit("paletteChanged",e),!0))}getPaletteObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.getActiveScheme(),n=e||this.getCurrentPaletteName();if(!t||!t.palettes)return{main:[],structural:{},functional:{}};const r=t.palettes[n];return r?Array.isArray(r)?{main:r,structural:{grid:"#f5f5f5"===t.background?"#cccccc":"#444444",weak:"#f5f5f5"===t.background?"#dddddd":"#333333",strong:"#f5f5f5"===t.background?"#333333":"#bbbbbb",guide:"#f5f5f5"===t.background?"#999999":"#777777",highlight:"#f5f5f5"===t.background?"#ff0000":"#ff5555"},functional:{positive:r[3]||"#34a853",negative:r[1]||"#ea4335",neutral:r[2]||"#fbbc04",selected:r[0]||"#4285f4",interactive:t.accent||"#1a73e8"}}:r:t.palettes.default||{main:[],structural:{},functional:{}}}getStructuralColor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(null===(t=this.getPaletteObject(n).structural)||void 0===t?void 0:t[e])||"#000000"}getMainColor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getPaletteObject(t).main||[];return 0===n.length?"#000000":n[e%n.length]}getMainColors(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.getPaletteObject(e).main||[]}getFunctionalColor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(null===(t=this.getPaletteObject(n).functional)||void 0===t?void 0:t[e])||this.getMainColor(0)}getPalette(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";const t=this.schemes[this.activeScheme].palettes;return t[e]&&t[e].main?t[e].main:Array.isArray(t[e])?t[e]:t.default&&t.default.main?t.default.main:t.default||[]}getColorFromPalette(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.getPalette(e);return n[t%n.length]}setActiveScheme(e){if(!this.schemes[e])return console.error("Color scheme '".concat(e,"' not found")),!1;this.activeScheme=e,this.core&&this.core.state&&this.core.state.set("colorScheme",e);try{localStorage.setItem("activeColorScheme",e)}catch(t){console.warn("Could not save color scheme preference to localStorage:",t)}return this.core&&this.core.events&&"function"===typeof this.core.events.emit&&this.core.events.emit("colorSchemeChanged",this.schemes[e]),console.log("Active color scheme changed to: ".concat(e)),!0}getInterpolatedPalette(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;const n=this.getPalette(e);if(t<=n.length)return n.slice(0,t);const r=[],i=(n.length-1)/(t-1);for(let a=0;a<t;a++){const e=a*i,t=Math.floor(e),o=Math.min(Math.ceil(e),n.length-1);if(t===o)r.push(n[t]);else{const i=e-t;r.push(this.interpolateColor(n[t],n[o],i))}}return r}interpolateColor(e,t,n){const r=e=>{if(e.startsWith("#")){return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16)}}const t=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);return t?{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3])}:{r:0,g:0,b:0}},i=r(e),a=r(t),o=Math.round(i.r+(a.r-i.r)*n),s=Math.round(i.g+(a.g-i.g)*n),l=Math.round(i.b+(a.b-i.b)*n);return"#".concat(o.toString(16).padStart(2,"0")).concat(s.toString(16).padStart(2,"0")).concat(l.toString(16).padStart(2,"0"))}cleanup(){this.eventListeners.forEach((e=>{"addListener"===e.type?e.target&&"function"===typeof e.target.removeListener&&e.target.removeListener(e.handler):e.target&&"function"===typeof e.target.removeEventListener&&e.target.removeEventListener(e.type,e.handler)})),this.eventListeners=[],console.log("ColorSchemeManager cleaned up")}}let $6;try{window.THREE?$6=window.THREE:Promise.resolve().then(n.bind(n,9408)).then((e=>{$6=e})).catch((e=>{console.error("Error importing THREE:",e)}))}catch(gR){console.error("Error setting up THREE:",gR)}class e8{constructor(e){this.core=e,this.currentLights=[],this.currentEffects=[],this.currentMode="standard",this.renderModes={standard:{id:"standard",name:"Standard",description:"Balanced lighting with standard materials",materialSettings:{type:"standard",properties:{roughness:.5,metalness:.2}},lighting:()=>this._createBalancedLighting(),effects:{shadows:!1}},studio:{id:"studio",name:"Studio",description:"Professional lighting with glossy materials",materialSettings:{type:"glossy",properties:{roughness:.1,metalness:.3}},lighting:()=>this._createStudioLighting(),effects:{shadows:!0}},metallic:{id:"metallic",name:"Metallic",description:"Metallic surfaces with dramatic lighting",materialSettings:{type:"metallic",properties:{roughness:.1,metalness:1,reflectivity:1}},lighting:()=>this._createContrastLighting(),effects:{shadows:!0}},matte:{id:"matte",name:"Matte",description:"Matte surfaces with soft diffuse lighting",materialSettings:{type:"matte",properties:{roughness:1,metalness:0}},lighting:()=>this._createSoftLighting(),effects:{shadows:!1}},technical:{id:"technical",name:"Technical",description:"Technical schematic-style rendering",materialSettings:{type:"flatShaded",properties:{flatShading:!0}},lighting:()=>this._createDirectionalLighting(),effects:{shadows:!1,grid:!0}},glass:{id:"glass",name:"Glass",description:"Transparent glass-like materials",materialSettings:{type:"glass",properties:{transmission:.9,roughness:0}},lighting:()=>this._createMultiPointLighting(),effects:{shadows:!1}},toon:{id:"toon",name:"Toon",description:"Cel-shaded cartoon style",materialSettings:{type:"toon",properties:{}},lighting:()=>this._createContrastLighting(),effects:{outlines:!0}},lightweight:{id:"lightweight",name:"Lightweight",description:"Performance-optimized mode for mobile devices",materialSettings:{type:"basic",properties:{}},lighting:()=>this._createAmbientLighting(),effects:{shadows:!1}}},this.materialFactories={},this._initializeMaterialFactories()}_initializeMaterialFactories(){if($6)this._setupMaterialFactories();else{const e=setInterval((()=>{$6&&(this._setupMaterialFactories(),clearInterval(e))}),500);setTimeout((()=>clearInterval(e)),1e4)}}_setupMaterialFactories(){this.materialFactories.standard=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new $6.MeshStandardMaterial({color:e,roughness:void 0!==n.roughness?n.roughness:.5,metalness:void 0!==n.metalness?n.metalness:.2,opacity:t,transparent:t<1,side:$6.DoubleSide})},this.materialFactories.basic=(e,t)=>new $6.MeshBasicMaterial({color:e,opacity:t,transparent:t<1,side:$6.DoubleSide}),this.materialFactories.wireframe=(e,t)=>new $6.MeshBasicMaterial({color:e,wireframe:!0,opacity:t,transparent:t<1,side:$6.DoubleSide}),this.materialFactories.glossy=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new $6.MeshStandardMaterial({color:e,roughness:void 0!==n.roughness?n.roughness:.1,metalness:void 0!==n.metalness?n.metalness:.3,opacity:t,transparent:t<1,side:$6.DoubleSide})},this.materialFactories.metallic=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new $6.MeshPhysicalMaterial({color:e,roughness:void 0!==n.roughness?n.roughness:.1,metalness:void 0!==n.metalness?n.metalness:1,reflectivity:void 0!==n.reflectivity?n.reflectivity:1,opacity:t,transparent:t<1,side:$6.DoubleSide});return r.emissive=e.clone().multiplyScalar(.2),r.emissiveIntensity=.3,r},this.materialFactories.matte=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new $6.MeshStandardMaterial({color:e,roughness:void 0!==n.roughness?n.roughness:1,metalness:void 0!==n.metalness?n.metalness:0,opacity:t,transparent:t<1,side:$6.DoubleSide})},this.materialFactories.glass=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new $6.MeshPhysicalMaterial({color:e,roughness:void 0!==n.roughness?n.roughness:0,metalness:void 0!==n.metalness?n.metalness:0,transmission:void 0!==n.transmission?n.transmission:.9,transparent:!0,opacity:t,side:$6.DoubleSide})},this.materialFactories.toon=(e,t)=>new $6.MeshToonMaterial({color:e,opacity:t,transparent:t<1,side:$6.DoubleSide}),this.materialFactories.neon=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new $6.MeshBasicMaterial({color:e,opacity:t,transparent:t<1,side:$6.DoubleSide});return r.emissive=e.clone(),r.emissiveIntensity=void 0!==n.emissiveIntensity?n.emissiveIntensity:1.5,r},this.materialFactories.flatShaded=(e,t)=>new $6.MeshStandardMaterial({color:e,roughness:.5,metalness:0,flatShading:!0,opacity:t,transparent:t<1,side:$6.DoubleSide})}getAvailableModes(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object.values(this.renderModes).map((t=>{const n={value:t.id,label:t.name};return e&&(n.description=t.description),n}))}applyRenderMode(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!$6)return console.error("THREE is not available, cannot apply render mode"),!1;this._cleanupPreviousMode(e);const i=this.renderModes[n]||this.renderModes.standard;this.currentMode=i.id;return i.lighting().forEach((t=>{e.add(t),this.currentLights.push(t)})),t&&t.children&&this._applyMaterialsToGroup(t,i.materialSettings,r),i.effects&&this._applyEffects(e,i.effects),this.currentScene=e,!0}updateProperties(e,t){t&&this.currentScene&&(void 0!==e.opacity&&this._updateOpacity(t,e.opacity),e.colorPalette&&this._updateColors(t,e.colorPalette))}_applyMaterialsToGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=t.type,i=t.properties||{},a=void 0!==n.opacity?n.opacity:1;if(n.colorPalette)e.children.forEach(((e,t)=>{if(e.isMesh){const o=n.colorPalette,s=t%o.length,l=new $6.Color(o[s]);e.material=this._createMaterial(r,l,a,i)}}));else{const t=n.baseColor||new $6.Color(3447003);e.traverse((e=>{e.isMesh&&(e.material=this._createMaterial(r,t,a,i))}))}}_createMaterial(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=this.materialFactories[e];return i?i(t,n,r):(console.warn('Material type "'.concat(e,'" not found. Using standard.')),this.materialFactories.standard(t,n,r))}_updateOpacity(e,t){e.traverse((e=>{e.material&&(Array.isArray(e.material)?e.material.forEach((e=>{e.opacity=t,e.transparent=t<1,e.needsUpdate=!0})):(e.material.opacity=t,e.material.transparent=t<1,e.material.needsUpdate=!0))}))}_updateColors(e,t){t&&t.length&&e.children.forEach(((e,n)=>{if(e.material){const r=n%t.length,i=t[r];e.material.color.set(i),e.material.emissive&&e.material.emissive.set(i).multiplyScalar(.2),e.material.needsUpdate=!0}}))}_applyEffects(e,t){if($6){if(t.shadows&&this.currentLights.forEach((e=>{void 0!==e.castShadow&&(e.castShadow=!0,e.shadow&&(e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024,e.shadow.camera.near=.5,e.shadow.camera.far=50))})),t.grid){const t=new $6.GridHelper(20,20);e.add(t),this.currentEffects.push(t)}t.outlines,t.bloom}else console.error("THREE is not available, cannot apply effects")}_cleanupPreviousMode(e){this.currentLights.forEach((t=>e.remove(t))),this.currentLights=[],this.currentEffects.forEach((t=>e.remove(t))),this.currentEffects=[]}_createBalancedLighting(){if(!$6)return console.error("THREE is not available, cannot create lighting"),[];const e=new $6.AmbientLight(16777215,.7),t=new $6.DirectionalLight(16777215,1);return t.position.set(5,10,7.5),[e,t]}_createStudioLighting(){if(!$6)return console.error("THREE is not available, cannot create lighting"),[];const e=new $6.DirectionalLight(16777215,1.2);e.position.set(10,10,10);const t=new $6.DirectionalLight(16777215,.6);t.position.set(-10,5,5);const n=new $6.DirectionalLight(16777215,.5);return n.position.set(0,-5,-10),[e,t,n]}_createContrastLighting(){if(!$6)return console.error("THREE is not available, cannot create lighting"),[];const e=new $6.DirectionalLight(16777215,1.5);e.position.set(5,15,5);return[e,new $6.AmbientLight(16777215,.1)]}_createSoftLighting(){if(!$6)return console.error("THREE is not available, cannot create lighting"),[];return[new $6.AmbientLight(16777215,.8),new $6.HemisphereLight(16777147,526368,.6)]}_createAmbientLighting(){if(!$6)return console.error("THREE is not available, cannot create lighting"),[];return[new $6.AmbientLight(16777215,1)]}_createDirectionalLighting(){if(!$6)return console.error("THREE is not available, cannot create lighting"),[];const e=new $6.DirectionalLight(16777215,1);return e.position.set(1,1,1),[e]}_createMultiPointLighting(){if(!$6)return console.error("THREE is not available, cannot create lighting"),[];return[new $6.AmbientLight(16777215,.3),...[[5,5,5],[-5,5,5],[5,5,-5],[-5,5,-5]].map((e=>{const t=new $6.PointLight(16777215,.5,50);return t.position.set(...e),t}))]}_createDarkLighting(){if(!$6)return console.error("THREE is not available, cannot create lighting"),[];return[new $6.AmbientLight(0,.1)]}}class t8{constructor(e){this.core=e,this.plugins=[],this.currentPlugin=null,this.loading=!1}async discoverPlugins(){try{console.log("Discovering plugins...");const t=await fetch("src/lib/plugins/plugin_list.json");if(!t.ok)throw new Error("Failed to load plugin list: ".concat(t.statusText));const r=await t.json(),i=[];for(const a of r)try{const e=(await n(1269)("./".concat(a,"/index.js"))).default;if(!e||!e.id||!e.name){console.error("Invalid plugin: ".concat(a));continue}i.push({id:e.id,name:e.name,description:e.description,renderingType:e.renderingType||"2d",PluginClass:e}),console.log("Discovered plugin: ".concat(e.name," (").concat(e.id,")"))}catch(e){console.error("Error loading plugin ".concat(a,":"),e)}return this.plugins=i,i}catch(e){return console.error("Error discovering plugins:",e),[]}}async loadPlugin(e){if(this.loading)return console.warn("Plugin loading already in progress, ignoring request"),!1;const t=this.plugins.find((t=>t.id===e));if(!t)return console.error("Plugin not found: ".concat(e)),!1;try{this.loading=!0,this.core&&this.core.uiManager&&this.core.uiManager.showLoading("Loading ".concat(t.name,"...")),await this.unloadCurrentPlugin(),console.log("Loading plugin: ".concat(t.name," (").concat(t.id,")")),this.core&&this.core.environmentManager&&await this.core.environmentManager.setEnvironment(t.renderingType||"2d");const e=new t.PluginClass(this.core);return await e.load()?(this.currentPlugin=e,console.log("Plugin ".concat(t.name," loaded successfully")),!0):(console.error("Plugin ".concat(t.id," failed to load")),!1)}catch(n){return console.error("Error loading plugin ".concat(e,":"),n),this.core&&this.core.uiManager&&this.core.uiManager.showError("Failed to load plugin: ".concat(n.message)),!1}finally{this.loading=!1,this.core&&this.core.uiManager&&this.core.uiManager.hideLoading()}}async unloadCurrentPlugin(){if(!this.currentPlugin)return!0;try{return console.log("Unloading plugin: ".concat(this.currentPlugin.constructor.name)),"function"===typeof this.currentPlugin.unload&&await this.currentPlugin.unload(),this.core.clearActions(),"function"===typeof this.core.emptyParameters&&this.core.emptyParameters(),this.currentPlugin=null,!0}catch(e){return console.error("Error unloading plugin:",e),!1}}getCurrentPlugin(){return this.currentPlugin}getPluginMetadata(e){return this.plugins.find((t=>t.id===e))||null}getFirstPluginId(){return this.plugins.length>0?this.plugins[0].id:null}cleanup(){this.unloadCurrentPlugin().catch((e=>{console.error("Error unloading plugin during cleanup:",e)})),this.plugins=[],this.currentPlugin=null,this.loading=!1,console.log("Plugin loader cleaned up")}}class n8{constructor(){this.events=new N6,this.state=new R6,this.environmentManager=null,this.animationManager=null,this.uiManager=null,this.colorSchemeManager=new J6(this),this.renderModeManager=null,this.pluginLoader=new t8(this),this.visualParameters={schema:[],values:{}},this.structuralParameters={schema:[],values:{}},this.advancedParameters={schema:[],values:{}},this._actions=new Map,this._parameterCallbacks=[],this.availablePlugins=[],this.isInitialStartup=!0}async initialize(){try{return console.log("Initializing Math Visualization Framework..."),await this.colorSchemeManager.initialize(),this.environmentManager=new Z6(this),this.animationManager=new K6(this),this.uiManager=new j6(this),this.renderModeManager=new e8(this),await this.environmentManager.initialize(),await this.animationManager.initialize(),await this.uiManager.initialize(),this.availablePlugins=await this.pluginLoader.discoverPlugins(),0===this.availablePlugins.length?console.warn("No plugins discovered"):console.log("Discovered ".concat(this.availablePlugins.length," plugins")),this.uiManager.updatePlugins(this.availablePlugins,null),this.uiManager.on("parameterChange",((e,t,n)=>{this.changeParameter(e,t,n)})),console.log("Math Visualization Framework initialized successfully"),!0}catch(e){return console.error("Failed to initialize Math Visualization Framework:",e),this.uiManager&&this.uiManager.showError("Initialization failed: ".concat(e.message)),!1}}async start(){try{return this.isInitialStartup?(this.animationManager.requestFrame((()=>{this._renderWelcomeMessage()})),this.isInitialStartup=!1,!0):(console.warn("Application already started"),!0)}catch(e){return console.error("Failed to start application:",e),this.uiManager&&this.uiManager.showError("Failed to start application: ".concat(e.message)),!1}}_renderWelcomeMessage(){this.environmentManager&&this.environmentManager.renderWithCurrentEnvironment(null,{})}cleanup(){this.pluginLoader.unloadCurrentPlugin().catch((e=>{console.error("Error unloading current plugin during cleanup:",e)})),this.environmentManager&&(this.environmentManager.cleanup(),this.environmentManager=null),this.animationManager&&(this.animationManager.cleanup(),this.animationManager=null),this.uiManager&&(this.uiManager.cleanup(),this.uiManager=null),this.colorSchemeManager&&this.colorSchemeManager.cleanup(),this._parameterCallbacks=[],this.clearActions(),this.availablePlugins=[],this.isInitialStartup=!0,console.log("Application cleaned up")}async loadPlugin(e){try{this.uiManager&&this.uiManager.showLoading("Loading plugin..."),this.clearActions();const t=await this.pluginLoader.loadPlugin(e);if(this.uiManager&&this.uiManager.hideLoading(),t){const e=this.getActivePlugin();this.uiManager.updatePlugins(this.availablePlugins,(null===e||void 0===e?void 0:e.id)||null)}else this.uiManager.showError('Failed to load plugin "'.concat(e,'"'));return t}catch(t){return console.error("Error loading plugin ".concat(e,":"),t),this.uiManager&&(this.uiManager.hideLoading(),this.uiManager.showError("Error loading plugin: ".concat(t.message))),!1}}getActivePlugin(){return this.pluginLoader.getCurrentPlugin()}addParametersVisual(e){Array.isArray(e)?(this._processParameters(e,"visual"),this.uiManager&&this.uiManager.updateParameterGroups({visual:{schema:this.visualParameters.schema,values:this.visualParameters.values}})):console.error("Visual parameters must be an array")}addParametersAdvanced(e){Array.isArray(e)?(this._processParameters(e,"advanced"),this.uiManager&&this.uiManager.updateParameterGroups({advanced:{schema:this.advancedParameters.schema,values:this.advancedParameters.values}})):console.error("Advanced parameters must be an array")}addParametersStructural(e){Array.isArray(e)?(this._processParameters(e,"structural"),this.uiManager&&this.uiManager.updateParameterGroups({structural:{schema:this.structuralParameters.schema,values:this.structuralParameters.values}})):console.error("Structural parameters must be an array")}_processParameters(e,t){this["".concat(t,"Parameters")]||(this["".concat(t,"Parameters")]={schema:[],values:{}}),this["".concat(t,"Parameters")].schema=[...this["".concat(t,"Parameters")].schema,...e],e.forEach((e=>{e.id&&void 0!==e.default&&(this["".concat(t,"Parameters")].values[e.id]=e.default)}))}changeParameter(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;var i,a;if(!r)if(null!==(i=this.visualParameters)&&void 0!==i&&i.values.hasOwnProperty(e))r="visual";else{if(null===(a=this.structuralParameters)||void 0===a||!a.values.hasOwnProperty(e))return console.warn("Parameter ".concat(e," not found in any group")),!1;r="structural"}return!(!r||null===(n=this["".concat(r,"Parameters")])||void 0===n||!n.values)&&(this["".concat(r,"Parameters")].values[e]=t,this.uiManager&&this.uiManager.updateParameterValue(e,t,r),this._triggerParameterChanged(e,t,r),!0)}removeParameter(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var r,i;if(!n)if(null!==(r=this.visualParameters)&&void 0!==r&&r.values.hasOwnProperty(e))n="visual";else{if(null===(i=this.structuralParameters)||void 0===i||!i.values.hasOwnProperty(e))return console.warn("Parameter ".concat(e," not found in any group")),!1;n="structural"}const a="".concat(n,"Parameters");if(null===(t=this[a])||void 0===t||!t.values.hasOwnProperty(e))return console.warn("Parameter ".concat(e," not found in ").concat(n," group")),!1;if(this[a].schema=this[a].schema.filter((t=>t.id!==e)),delete this[a].values[e],this.uiManager){({})[n]={schema:this[a].schema,values:this[a].values},this.uiManager.updatePluginParameterGroups({["".concat(n,"Parameters")]:this[a]})}return!0}emptyParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const t=e?[e]:["visual","structural","advanced"];if(t.forEach((e=>{const t="".concat(e,"Parameters");this[t]?(this[t].schema=[],this[t].values={}):console.warn("Parameter group ".concat(e," not found"))})),this.uiManager){const e={};t.forEach((t=>{this["".concat(t,"Parameters")]&&(e[t]={schema:[],values:{}})})),this.uiManager.updateParameterGroups(e)}return!0}catch(t){return console.error("Error emptying parameters:",t),!1}}resetParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;let t=!0;return(e?[e]:["visual","structural"]).forEach((e=>{const n="".concat(e,"Parameters");if(this[n]){if(this[n].schema.forEach((t=>{t.id&&void 0!==t.default&&(this[n].values[t.id]=t.default,this._triggerParameterChanged(t.id,t.default,e))})),this.uiManager){({})[e]={schema:this[n].schema,values:this[n].values},this.uiManager.updatePluginParameterGroups({["".concat(e,"Parameters")]:this[n]})}}else t=!1})),t}onParameterChanged(e){return"function"!==typeof e?(console.error("Parameter change callback must be a function"),null):(this._parameterCallbacks.push(e),e)}removeParameterCallback(e){const t=this._parameterCallbacks.indexOf(e);return-1!==t&&(this._parameterCallbacks.splice(t,1),!0)}_triggerParameterChanged(e,t,n){this._parameterCallbacks.forEach((r=>{try{r(e,t,n)}catch(i){console.error("Error in parameter change callback:",i)}}));const r=this.getActivePlugin();if(r&&"function"===typeof r._handleParameterChanged)r._handleParameterChanged(e,t,n);else if(r&&"function"===typeof r.onParameterChanged)try{r.onParameterChanged(e,t,n)}catch(i){console.error("Error in plugin's onParameterChanged handler:",i)}}getAllParameters(){var e,t,n;return(0,p6.A)((0,p6.A)((0,p6.A)({},(null===(e=this.structuralParameters)||void 0===e?void 0:e.values)||{}),(null===(t=this.visualParameters)||void 0===t?void 0:t.values)||{}),(null===(n=this.advancedParameters)||void 0===n?void 0:n.values)||{})}addAction(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!e||"string"!==typeof e)return console.error("Action ID must be a non-empty string"),!1;if("function"!==typeof n)return console.error("Action callback must be a function"),!1;const i=(0,p6.A)({id:e,label:t||e,callback:n},r);return this._actions.set(e,i),this._notifyActionsChanged(),!0}removeAction(e){const t=this._actions.delete(e);return t&&this._notifyActionsChanged(),t}clearActions(){const e=this._actions.size>0;this._actions.clear(),e&&this._notifyActionsChanged()}getActions(){return Array.from(this._actions.values())}_notifyActionsChanged(){const e=this.getActions();this.events&&this.events.emit("actionsChanged",e),this.uiManager&&this.uiManager.updateActions(e)}executeAction(e){const t=this.getActivePlugin();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(t&&"function"===typeof t._handleActionExecution)return t._handleActionExecution(e,...r);const a=this._actions.get(e);if(a&&"function"===typeof a.callback)try{return a.callback(...r)}catch(o){return console.error("Error executing action ".concat(e,":"),o),this.uiManager&&this.uiManager.showError("Action failed: ".concat(o.message)),!1}return console.warn("Action not found: ".concat(e)),!1}getRenderingEnvironment(){return this.environmentManager?this.environmentManager.getEnvironmentForPlugin():null}}const r8=new class{constructor(){this.core=null,this.initialized=!1}async initialize(e){if(this.initialized)return Promise.resolve(this.core);try{return console.log("Initializing visualization bridge..."),this.core=new n8,await this.core.initialize(),console.log("Visualization bridge initialized successfully"),this.initialized=!0,this.core}catch(t){throw console.error("Failed to initialize visualization bridge:",t),t}}async loadPlugin(e){if(!this.core)throw new Error("Core not initialized");try{console.log("Loading plugin: ".concat(e));const t=await this.core.loadPlugin(e);if(!t)throw new Error("Failed to load plugin: ".concat(e));return t}catch(t){throw console.error("Error loading plugin ".concat(e,":"),t),t}}getPlugins(){return this.core&&this.core.availablePlugins||[]}getActivePlugin(){return this.core?this.core.getActivePlugin():null}setParameter(e,t,n){return!!this.core&&this.core.changeParameter(e,t,n)}executeAction(e){if(!this.core)return!1;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.core.executeAction(e,...n)}getParameters(e){if(!this.core)return{schema:[],values:{}};switch(e){case"visual":return this.core.visualParameters||{schema:[],values:{}};case"structural":return this.core.structuralParameters||{schema:[],values:{}};case"advanced":return this.core.advancedParameters||{schema:[],values:{}};default:return this.core.getAllParameters?{values:this.core.getAllParameters()}:{schema:[],values:{}}}}getActions(){return this.core?this.core.getActions():[]}async unloadPlugin(){return!(!this.core||!this.core.pluginLoader)&&await this.core.pluginLoader.unloadCurrentPlugin()}cleanup(){this.core&&(this.core.cleanup(),this.core=null),this.initialized=!1}};const i8=function(){const[e,t]=(0,d6.useState)(!0),[n,r]=(0,d6.useState)(null),[i,a]=(0,d6.useState)(!1),[o,s]=(0,d6.useState)(null),[l,c]=(0,d6.useState)([]),[u,h]=(0,d6.useState)(!1),[d,f]=(0,d6.useState)({}),[p,m]=(0,d6.useState)({}),[g,v]=(0,d6.useState)([]),{isMobile:y}=(()=>{const[e,t]=(0,d6.useState)(window.innerWidth<768);return(0,d6.useEffect)((()=>{const e=()=>{t(window.innerWidth<768)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),{isMobile:e}})(),[x,b]=(0,d6.useState)(!1);(0,d6.useEffect)((()=>(console.log("Initializing application..."),r8.initialize().then((e=>{console.log("Visualization engine initialized successfully");const t=r8.getPlugins();if(console.log("Available plugins:",t),c(t),t.length>0){const e=t[0];return console.log("Loading first plugin: ".concat(e.id)),r8.loadPlugin(e.id).then((()=>{console.log("Plugin ".concat(e.id," loaded successfully")),s(e);const t=r8.getParameters("visual"),n=r8.getParameters("structural");f(t.values||{}),m(n.values||{});const r=r8.getActions();v(r)}))}throw console.log("No plugins available"),new Error("No visualization plugins found")})).then((()=>{t(!1),a(!0),console.log("Application fully initialized")})).catch((e=>{console.error("Failed to initialize:",e),t(!1),r(e.message||"Failed to initialize visualization engine")})),()=>{console.log("Cleaning up visualization bridge"),r8.cleanup()})),[]);const _=y?T6:A6;return(0,m6.jsx)(v6,{children:(0,m6.jsxs)("div",{className:"w-full h-full bg-white dark:bg-gray-900",children:[(0,m6.jsx)(x6,{isLoading:e,error:n}),i&&!n&&o&&(0,m6.jsx)(_,{activePlugin:o,plugins:l,showPluginSelector:u,setShowPluginSelector:h,handlePluginSelect:e=>{console.log("Selecting plugin: ".concat(e)),t(!0),r8.unloadPlugin().then((()=>r8.loadPlugin(e))).then((()=>{const n=l.find((t=>t.id===e));s(n);const r=r8.getParameters("visual"),i=r8.getParameters("structural");f(r.values||{}),m(i.values||{});const a=r8.getActions();v(a),t(!1),h(!1)})).catch((n=>{console.error("Failed to load plugin ".concat(e,":"),n),r("Failed to load plugin: ".concat(n.message)),t(!1)}))},visualParams:d,handleVisualParamChange:(e,t)=>{f((n=>(0,p6.A)((0,p6.A)({},n),{},{[e]:t}))),r8.setParameter(e,t,"visual")},structuralParams:p,handleStructuralParamChange:(e,t)=>{m((n=>(0,p6.A)((0,p6.A)({},n),{},{[e]:t}))),r8.setParameter(e,t,"structural")},actions:g,handleActionClick:e=>{console.log("Executing action: ".concat(e)),r8.executeAction(e)},fullscreen:x,toggleFullscreen:()=>b(!x)}),(0,m6.jsx)("div",{className:"absolute inset-0 z-0",children:(0,m6.jsx)("canvas",{id:"visualization-canvas",className:"w-full h-full"})})]})})},a8=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,6453)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:a,getTTFB:o}=t;n(e),r(e),i(e),a(e),o(e)}))};f6.createRoot(document.getElementById("root")).render((0,m6.jsx)(d6.StrictMode,{children:(0,m6.jsx)(i8,{})})),a8()})()})();
//# sourceMappingURL=main.76b91e1b.js.map